(this["webpackJsonppopulation-arcgis"]=this["webpackJsonppopulation-arcgis"]||[]).push([[72],{1104:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var i=a(0),r=a(28),n=a(108),l=a(243),s=a(509),o=a(22),c=a(2),u=a(446),p=a(1),h=(a(17),a(12),a(10));let b=class extends(Object(l.b)(Object(s.b)(Object(u.b)(n.a.EventedMixin(r.a))))){constructor(e){super(e),this.layer=null,this.parent=null}initialize(){this.when().catch((e=>{if("layerview:create-error"!==e.name){const t=this.layer&&this.layer.id||"no id",a=this.layer&&this.layer.title||"no title";o.a.getLogger(this.declaredClass).error("#resolve()",`Failed to resolve layer view (layer title: '${a}', id: '${t}')`,e)}}))}get fullOpacity(){return Object(c.u)(this.get("layer.opacity"),1)*Object(c.u)(this.get("parent.fullOpacity"),1)}get suspended(){return!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){var e;return!this.suspended&&!0===(null==(e=this.layer)?void 0:e.legendEnabled)}get updating(){var e;return!((null==(e=this.updatingHandles)||!e.updating)&&!this.isUpdating())}get updatingProgress(){return this.updating?0:1}get visible(){var e;return!0===(null==(e=this.layer)?void 0:e.visible)}set visible(e){this._overrideIfSome("visible",e)}canResume(){var e,t,a;return this.visible&&(null==(e=this.layer)?void 0:e.loaded)&&!(null!=(t=this.parent)&&t.suspended)&&(null==(a=this.view)?void 0:a.ready)||!1}getSuspendInfo(){const e=this.parent&&this.parent.suspended?this.parent.suspendInfo:{};return this.view&&this.view.ready||(e.viewNotReady=!0),this.layer&&this.layer.loaded||(e.layerNotLoaded=!0),this.visible||(e.layerInvisible=!0),e}isUpdating(){return!1}};Object(i.a)([Object(p.b)()],b.prototype,"fullOpacity",null),Object(i.a)([Object(p.b)()],b.prototype,"layer",void 0),Object(i.a)([Object(p.b)()],b.prototype,"parent",void 0),Object(i.a)([Object(p.b)({readOnly:!0})],b.prototype,"suspended",null),Object(i.a)([Object(p.b)({readOnly:!0})],b.prototype,"suspendInfo",null),Object(i.a)([Object(p.b)({readOnly:!0})],b.prototype,"legendEnabled",null),Object(i.a)([Object(p.b)({type:Boolean,readOnly:!0})],b.prototype,"updating",null),Object(i.a)([Object(p.b)({readOnly:!0})],b.prototype,"updatingProgress",null),Object(i.a)([Object(p.b)()],b.prototype,"visible",null),Object(i.a)([Object(p.b)()],b.prototype,"view",void 0),b=Object(i.a)([Object(h.a)("esri.views.layers.LayerView")],b);const d=b},1106:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var i=a(0),r=a(226),n=a(23),l=a(13),s=a(1),o=(a(17),a(12),a(10)),c=a(868);const u=e=>{let t=class extends e{constructor(){super(...arguments),this.slicePlaneEnabled=!1,this.supportsHeightUnitConversion=!1}postscript(e){super.postscript(e),Object(c.c)(this.layer)&&this.addResolvingPromise(this._validateHeightModelInfo())}async _validateHeightModelInfo(){const e=new AbortController,t=e.signal;this.handles.add(Object(r.c)((()=>e.abort()))),await Object(l.h)((()=>{var e;return null==(e=this.view.defaultsFromMap)?void 0:e.heightModelInfoReady}),t),Object(n.q)(t);const a=Object(c.b)(this.layer,this.view.heightModelInfo,this.supportsHeightUnitConversion);if(a)throw a}canResume(){const e=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return super.canResume()&&(!e||!e.minScale||!e.maxScale||e.minScale>=e.maxScale)}getSuspendInfo(){const e=super.getSuspendInfo(),t=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return t&&t.minScale&&t.maxScale&&t.minScale<t.maxScale&&(e.outsideScaleRange=!0),e}};return Object(i.a)([Object(s.b)()],t.prototype,"view",void 0),Object(i.a)([Object(s.b)()],t.prototype,"slicePlaneEnabled",void 0),t=Object(i.a)([Object(o.a)("esri.views.3d.layers.LayerView3D")],t),t}},1146:function(e,t,a){"use strict";function i(e,t){return t?"xoffset"in t&&t.xoffset?Math.max(e,Math.abs(t.xoffset)):"yoffset"in t&&t.yoffset?Math.max(e,Math.abs(t.yoffset||0)):e:e}function r(e,t){return"number"==typeof e?e:e&&e.stops&&e.stops.length?function(e){let t=0,a=0;for(let i=0;i<e.length;i++){const r=e[i].size;"number"==typeof r&&(t+=r,a++)}return t/a}(e.stops):t}function n(e,t){if(!t)return e;const a=t.filter((e=>"size"===e.type)).map((t=>{const{maxSize:a,minSize:i}=t;return(r(a,e)+r(i,e))/2}));let i=0;const n=a.length;if(0===n)return e;for(let r=0;r<n;r++)i+=a[r];const l=Math.floor(i/n);return Math.max(l,e)}function l(e){const t=e&&e.renderer,a="touch"===(e&&e.event&&e.event.pointerType)?9:6;if(!t)return a;const r="visualVariables"in t?n(a,t.visualVariables):a;if("simple"===t.type)return i(r,t.symbol);if("unique-value"===t.type){var l;let e=r;return null!=(l=t.uniqueValueInfos)&&l.forEach((t=>{e=i(e,t.symbol)})),e}if("class-breaks"===t.type){let e=r;return t.classBreakInfos.forEach((t=>{e=i(e,t.symbol)})),e}return"dot-density"===t.type||t.type,r}a.d(t,"a",(function(){return l}))},1163:function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var i=a(0),r=a(16),n=a(2),l=a(13),s=a(1),o=(a(17),a(12),a(10)),c=a(904),u=a(29);const p=e=>{let t=class extends e{get imageFormatIsOpaque(){return!1}get fullExtent(){return this.layer.fullExtent}get isOpaque(){return this.fullOpacity>=1&&this.imageFormatIsOpaque}get dataLevelRange(){const e=this.tileInfo.lods,t=e[0].scale,a=e[e.length-1].scale;return this.levelRangeFromScaleRange(t,a)}get displayLevelRange(){const e=this.tileInfo.lods,t=this.layer.minScale||e[0].scale,a=this.layer.maxScale||e[e.length-1].scale,i=this.levelRangeFromScaleRange(t,a);return this.layer.maxScale&&i.maxLevel++,i}getTileUrl(e,t,a){return this.layer.getTileUrl(e,t,a)}_addTilingSchemeMatchPromise(){if(Object(n.k)(this.fullExtent))return this.addResolvingPromise(Promise.reject(new r.a("tilingscheme:extent-not-defined","This layer doesn't define a fullExtent.")));const e=this._getTileInfoSupportError(this.tileInfo,this.fullExtent);if(Object(n.l)(e))return this.addResolvingPromise(Promise.reject(e));const t=Object(l.h)((()=>{var e,t;return null==(e=this.view)||null==(t=e.basemapTerrain)?void 0:t.tilingSchemeLocked})).then((()=>{const e=this.view.basemapTerrain.tilingScheme,t=this._getTileInfoCompatibilityError(this.tileInfo,e);if(t)throw t}));this.addResolvingPromise(t)}_getTileInfoSupportError(e,t){const a=Object(u.d)(e,t,this.view.spatialReference,this.view.state.viewingMode);if(a){const e={layer:this.layer,error:a};let t;switch(a.name){case"tilingscheme:spatial-reference-mismatch":case"tilingscheme:global-unsupported-spatial-reference":case"tilingscheme:local-unsupported-spatial-reference":t=new r.a("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",e);break;default:t=new r.a("layerview:tiling-scheme-unsupported","The tiling scheme of this layer is not supported by SceneView",e)}return t}return null}_getTileInfoCompatibilityError(e,t){return t.compatibleWith(e)?null:new r.a("layerview:tiling-scheme-incompatible","The tiling scheme of this layer is incompatible with the tiling scheme of the surface")}levelRangeFromScaleRange(e,t){const a={minLevel:0,maxLevel:1/0},i=this.view&&this.view.basemapTerrain&&this.view.basemapTerrain.tilingScheme;if(!i)return a;const r=i.levels[0],n=e=>{const t=Math.log(r.scale/e)/Math.LN2;return.5-Math.abs(.5-t%1)<1e-9?Math.round(t):Math.ceil(t)};return null!=e&&e>0&&(a.minLevel=Math.max(0,n(e))),null!=t&&t>0&&(a.maxLevel=Math.max(0,n(t))),a}isUpdating(){return!!(this.view&&this.view.basemapTerrain&&this.view.basemapTerrain.updating)}};return Object(i.a)([Object(s.b)({readOnly:!0})],t.prototype,"imageFormatIsOpaque",null),Object(i.a)([Object(s.b)({readOnly:!0})],t.prototype,"updating",void 0),Object(i.a)([Object(s.b)(c.a)],t.prototype,"updatingProgress",void 0),Object(i.a)([Object(s.b)(c.b)],t.prototype,"updatingProgressValue",void 0),Object(i.a)([Object(s.b)()],t.prototype,"fullExtent",null),Object(i.a)([Object(s.b)({readOnly:!0})],t.prototype,"isOpaque",null),Object(i.a)([Object(s.b)({readOnly:!0})],t.prototype,"dataLevelRange",null),Object(i.a)([Object(s.b)({readOnly:!0})],t.prototype,"displayLevelRange",null),Object(i.a)([Object(s.b)()],t.prototype,"layer",void 0),Object(i.a)([Object(s.b)()],t.prototype,"tileInfo",void 0),t=Object(i.a)([Object(o.a)("esri.views.3d.layers.TiledLayerView3D")],t),t}},1164:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var i=a(0),r=a(22),n=a(23),l=a(13),s=a(1),o=(a(17),a(12),a(10));const c=e=>{let t=class extends e{initialize(){this.handles.add(Object(l.b)((()=>this.layer),"refresh",(e=>{this.doRefresh(e.dataChanged).catch((e=>{Object(n.j)(e)||r.a.getLogger(this.declaredClass).error(e)}))})),"RefreshableLayerView")}};return Object(i.a)([Object(s.b)()],t.prototype,"layer",void 0),t=Object(i.a)([Object(o.a)("esri.layers.mixins.RefreshableLayerView")],t),t}},1165:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return o}));a(167);var i=a(2),r=a(68),n=a(1146),l=a(86);function s(e,t,a,n=new l.a){let s;if("2d"===a.type)s=t*a.resolution;else if("3d"===a.type){const n=a.overlayPixelSizeInMapUnits(e),l=a.basemapSpatialReference;s=Object(i.l)(l)&&!l.equals(a.spatialReference)?Object(r.f)(l)/Object(r.f)(a.spatialReference):t*n}const o=e.x-s,c=e.y-s,u=e.x+s,p=e.y+s,{spatialReference:h}=a;return n.xmin=Math.min(o,u),n.ymin=Math.min(c,p),n.xmax=Math.max(o,u),n.ymax=Math.max(c,p),n.spatialReference=h,n}function o(e,t,a){const r=a.toMap(e);return!Object(i.k)(r)&&s(r,Object(n.a)(),a,c).intersects(t)}const c=new l.a},1654:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return m}));var i=a(0),r=a(16),n=a(2),l=a(1),s=(a(17),a(12),a(10)),o=a(40),c=a(1106),u=a(1163),p=a(1104),h=a(1164),b=a(23),d=a(1146);const y=e=>{let t=class extends e{async fetchPopupFeatures(e,t){const{layer:a}=this;if(!e)throw new r.a("tilelayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:a});if("tile"!==a.type)throw new r.a("tilelayerview:fetchPopupFeatures","Layer type should be 'tile'",{type:a.type});const i=this.get("view.scale"),l=a.allSublayers.toArray().filter((e=>{const t=0===e.minScale||i<=e.minScale,a=0===e.maxScale||i>=e.maxScale;return e.popupTemplate&&e.popupEnabled&&e.visible&&t&&a}));return Object(b.g)(l.map((async a=>{const i=a.createQuery(),r=Object(n.l)(t)?t.event:null,l=Object(d.a)({renderer:a.renderer,event:r});return i.geometry=this.createFetchPopupFeaturesQueryGeometry(e,l),i.outFields=await a.popupTemplate.getRequiredFields(),(await a.queryFeatures(i)).features}))).then((e=>[].concat(...e.map((e=>e.value)).filter(Boolean))))}};return Object(i.a)([Object(l.b)()],t.prototype,"layer",void 0),t=Object(i.a)([Object(s.a)("esri.layers.mixins.TileLayerView")],t),t};var f=a(1165);let g=class extends(Object(h.a)(Object(u.a)(y(Object(c.a)(p.a))))){constructor(){super(...arguments),this.type="tile-3d"}get imageFormatIsOpaque(){return"jpg"===this.layer.tileInfo.format}get hasMixedImageFormats(){return"mixed"===this.layer.tileInfo.format}get tileInfo(){var e;return null==(e=this.layer)?void 0:e.tileInfo}get dataLevelRange(){if(this.tileInfo){const e=this.tileInfo.lods,t=e[0].scale,a=e[e.length-1].scale;return this.levelRangeFromScaleRange(t,a)}return{minLevel:0,maxLevel:0}}initialize(){if("web-tile"===this.layer.type){const e=this.layer.get("fullExtent.spatialReference"),t=this.layer.get("tileInfo.spatialReference");if(Object(n.k)(e)||Object(n.k)(t)||!Object(o.b)(e,t)){const e="defaults"===this.layer.originOf("fullExtent")||Object(n.k)(this.layer.fullExtent)?"SceneView requires fullExtent to be specified by the user on WebTileLayer":"SceneView requires fullExtent to be specified in the same spatial reference as tileInfo on WebTileLayer";this.addResolvingPromise(Promise.reject(new r.a("layerview:incompatible-fullextent",e)))}}this._addTilingSchemeMatchPromise()}createFetchPopupFeaturesQueryGeometry(e,t){return Object(f.a)(e,t,this.view)}async doRefresh(){this.suspended||this.emit("data-changed")}};Object(i.a)([Object(l.b)()],g.prototype,"imageFormatIsOpaque",null),Object(i.a)([Object(l.b)()],g.prototype,"hasMixedImageFormats",null),Object(i.a)([Object(l.b)()],g.prototype,"layer",void 0),Object(i.a)([Object(l.b)()],g.prototype,"tileInfo",null),Object(i.a)([Object(l.b)()],g.prototype,"dataLevelRange",null),g=Object(i.a)([Object(s.a)("esri.views.3d.layers.TileLayerView3D")],g);const m=g}}]);
//# sourceMappingURL=72.eeecdd8d.chunk.js.map