{"version":3,"sources":["../node_modules/@arcgis/core/symbols/support/previewCIMSymbol.js"],"names":["h","n","m","e","s","size","c","maxSize","u","lineWidth","async","d","node","opacity","symbolConfig","p","g","isSquareFill","w","cimOptions","b","geometryType","r","data","symbol","M","t","width","height","y","feature","j","fieldMap","v","i","resolveSymbolOverrides","clone","type","primitiveOverrides","l","fetchResources","resourceManager","length","Promise","all","o","getEnvelope","isFinite","Math","min","max","S","rasterizeCIMSymbolAsync","Preview","Legend","C","I","P","document","createElement","getContext","putImageData","x","z","F","Image","src","toDataURL","style","G","effectView","shape","fill","stroke","offset","a","appendChild"],"mappings":"iIAAA,mHAIwY,MAAMA,EAAE,IAAIC,sBAAE,MAAK,GAAIC,EAAEC,YAAEC,IAAEC,MAAMC,EAAEH,YAAEC,IAAEG,SAASC,EAAEL,YAAEC,IAAEK,WAA+NC,eAAeC,EAAER,EAAEF,EAAE,CAAC,GAAE,QAAC,MAAMW,KAAKR,EAAES,QAAQF,EAAEG,aAAaC,GAAGd,EAAEe,EAAE,iBAAiBD,GAAG,iBAAiBA,GAAGA,EAAEE,aAAaC,EAAEjB,EAAEkB,YAAYlB,EAAEmB,EAAEF,EAAEG,cAAcC,YAAG,OAAF,EAACnB,IAAO,OAAN,EAAD,EAAGoB,WAAF,EAAD,EAASC,QAAQC,EAAlY,SAAWtB,GAAG,MAAMuB,EAAG,MAADvB,OAAC,EAADA,EAAGE,KAAK,MAAG,iBAAiBqB,EAAQ,CAACC,MAAMD,EAAEE,OAAOF,GAAS,CAACC,MAAM,MAAMD,GAAG,iBAAiBA,GAAG,UAAUA,EAAEA,EAAEC,MAAM,KAAKC,OAAO,MAAMF,GAAG,iBAAiBA,GAAG,WAAWA,EAAEA,EAAEE,OAAO,KAAK,CAAqLC,CAAE5B,IAAI6B,QAAQC,EAAEC,SAASC,GAAGf,EAAE,GAAG,MAAMO,EAAEE,OAAO,MAAMF,EAAEG,OAAO,CAAC,MAAMF,QAAQQ,IAAEC,uBAAuBhC,EAAEoB,KAAKQ,EAAE,KAAKE,EAAEb,GAAG,IAAIM,EAAE,OAAO,MAAMvB,EAAEA,EAAEiC,SAASb,KAAK,CAACc,KAAK,qBAAqBb,OAAOE,GAAGvB,EAAEoB,KAAKe,mBAAmB,KAAK,MAAMrC,EAAE,GAAGsC,IAAEC,eAAed,EAAE1B,EAAEyC,gBAAgBxC,GAAGA,EAAEyC,OAAO,SAASC,QAAQC,IAAI3C,GAAG,MAAM0B,MAAMkB,EAAEjB,OAAON,GAAGiB,IAAEO,YAAYpB,EAAE,KAAK1B,EAAEyC,iBAAiBhB,EAAEE,MAAM,wBAAwBP,EAAElB,EAAE,yBAAyBkB,EAAEZ,EAAE,MAAMqC,GAAGE,SAASF,GAAGG,KAAKC,IAAIJ,EAAEvC,GAAGJ,EAAEuB,EAAEG,OAAO,wBAAwBR,EAAElB,EAAE,MAAMoB,GAAGyB,SAASzB,GAAG0B,KAAKE,IAAIF,KAAKC,IAAI3B,EAAEhB,GAAj7B,GAAu7BJ,CAAC,CAAC,MAAMiD,QAAQnD,EAAEoD,wBAAwBjD,EAAE4B,EAAEN,EAAET,GAAG,wBAAwBI,EAAEyB,gBAAEQ,QAAQR,gBAAES,OAAOrB,EAAEb,GAAG,IAAI+B,EAAE,OAAO,KAAK,MAAMxB,MAAM4B,EAAE3B,OAAO4B,GAAGL,EAAEM,EAAEC,SAASC,cAAc,UAAUF,EAAE9B,MAAM4B,EAAEE,EAAE7B,OAAO4B,EAAEC,EAAEG,WAAW,MAAMC,aAAaV,EAAE,EAAE,GAAG,MAAMW,EAAEpC,YAAED,EAAEE,OAAOoC,EAAErC,YAAED,EAAEG,QAAQoC,EAAE,IAAIC,MAAMH,EAAEC,GAAGC,EAAEE,IAAIT,EAAEU,YAAY,MAAMxD,IAAIqD,EAAEI,MAAMvD,QAAS,GAAEF,KAAK,IAAI0D,EAAEL,EAAE,GAAG,MAAM/D,EAAEqE,WAAW,CAAC,MAAMnE,EAAE,CAACoE,MAAM,CAAClC,KAAK,QAAQyB,EAAE,EAAEjC,EAAE,EAAEF,MAAMmC,EAAElC,OAAOmC,EAAEG,IAAIF,EAAEE,KAAKM,KAAK,KAAKC,OAAO,KAAKC,OAAO,CAAC,EAAE,IAAIL,EAAEM,YAAE,CAAC,CAACxE,IAAI,CAAC2D,EAAEC,GAAG,CAACO,WAAWrE,EAAEqE,YAAY,CAAC,OAAOlE,GAAGiE,GAAGjE,EAAEwE,YAAYP,GAAGA,CAAC,C","file":"static/js/197.022f1ebe.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{px2pt as e,pt2px as t}from\"../../core/screenUtils.js\";import{OverrideHelper as i,CIMSymbolHelper as l}from\"../cim/CIMSymbolHelper.js\";import{CIMSymbolRasterizer as n,GeometryStyle as o}from\"../cim/CIMSymbolRasterizer.js\";import{mapCIMSymbolToGeometryType as r}from\"../cim/utils.js\";import{SymbolSizeDefaults as s}from\"./previewUtils.js\";import{renderSymbol as a}from\"./renderUtils.js\";const h=new n(null,!0),m=e(s.size),c=e(s.maxSize),u=e(s.lineWidth),f=1;function y(e){const t=e?.size;if(\"number\"==typeof t)return{width:t,height:t};return{width:null!=t&&\"object\"==typeof t&&\"width\"in t?t.width:null,height:null!=t&&\"object\"==typeof t&&\"height\"in t?t.height:null}}async function d(e,n={}){const{node:s,opacity:d,symbolConfig:p}=n,g=\"object\"==typeof p&&\"isSquareFill\"in p&&p.isSquareFill,w=n.cimOptions||n,b=w.geometryType||r(e?.data?.symbol),M=y(n),{feature:j,fieldMap:v}=w;if(null==M.width||null==M.height){const t=await i.resolveSymbolOverrides(e.data,j,null,v,b);if(!t)return null;(e=e.clone()).data={type:\"CIMSymbolReference\",symbol:t},e.data.primitiveOverrides=null;const n=[];l.fetchResources(t,h.resourceManager,n),n.length>0&&await Promise.all(n);const{width:o,height:r}=l.getEnvelope(t,null,h.resourceManager);M.width=\"esriGeometryPolygon\"===b?m:\"esriGeometryPolyline\"===b?u:null!=o&&isFinite(o)?Math.min(o,c):m,M.height=\"esriGeometryPolygon\"===b?m:null!=r&&isFinite(r)?Math.max(Math.min(r,c),f):m}const S=await h.rasterizeCIMSymbolAsync(e,j,M,g||\"esriGeometryPolygon\"!==b?o.Preview:o.Legend,v,b);if(!S)return null;const{width:C,height:I}=S,P=document.createElement(\"canvas\");P.width=C,P.height=I;P.getContext(\"2d\").putImageData(S,0,0);const x=t(M.width),z=t(M.height),F=new Image(x,z);F.src=P.toDataURL(),null!=d&&(F.style.opacity=`${d}`);let G=F;if(null!=n.effectView){const e={shape:{type:\"image\",x:0,y:0,width:x,height:z,src:F.src},fill:null,stroke:null,offset:[0,0]};G=a([[e]],[x,z],{effectView:n.effectView})}return s&&G&&s.appendChild(G),G}export{d as previewCIMSymbol};\n"],"sourceRoot":""}