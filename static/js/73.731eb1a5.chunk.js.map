{"version":3,"sources":["../node_modules/@arcgis/core/views/interactive/snapping/featureSources/FeatureCollectionSnappingSource.js","../node_modules/@arcgis/core/views/interactive/snapping/hints/PointSnappingHint.js","../node_modules/@arcgis/core/views/interactive/snapping/candidates/VertexSnappingCandidate.js","../node_modules/@arcgis/core/views/interactive/snapping/featureSources/snappingCandidateElevationAlignment.js","../node_modules/@arcgis/core/views/interactive/snapping/featureSources/snappingCandidateElevationFilter.js","../node_modules/@arcgis/core/views/interactive/snapping/featureSources/symbologySnappingCandidates.js","../node_modules/@arcgis/core/views/interactive/snapping/candidates/DrapedEdgeSnappingCandidate.js","../node_modules/@arcgis/core/views/interactive/snapping/featureSources/queryEngineUtils.js"],"names":["f","t","constructor","e","super","this","view","_layerView3D","availability","updating","layerSource","_snappingElevationAligner","layer","r","o","type","m","elevationInfo","alignPointsInFeatures","async","i","whenLayerView","elevationAlignPointsInFeatures","spatialReference","_snappingElevationFilter","d","_symbologySnappingFetcher","v","_symbologySnappingSupported","n","queryForSymbologySnapping","candidates","symbologySnappingSupported","initialize","then","addHandles","elevationProvider","on","context","l","notifyElevationSourceChange","a","processor","renderer","notifySymbologyChange","refresh","coordinateHelper","source","querySnapping","s","c","p","g","signal","h","alignCandidates","fetch","length","filter","hasZ","y","S","_getGroundElevation","map","u","constructOnly","prototype","point","equals","constraint","targetPoint","hints","domain","_elevationInfo","_alignPointsInFeatures","_alignmentsCache","_cacheVersion","_metersPerVerticalUnit","mode","featureExpressionInfo","_alignAbsoluteElevationCandidates","_alignComputedElevationCandidates","clear","offset","unit","start","z","end","target","Map","objectId","push","_prepareQuery","_applyCacheAndResponse","drapedObjectIds","failedObjectIds","has","draped","_addToQueriesOrCachedResult","points","get","elevations","apply","put","x","distance","_updateCandidatesTo3D","sort","Math","min","max","sqrt","_getSymbologyCandidates","_candidatesCache","sourceCandidateIndices","concat","toString","edgeStart","edgeEnd","getGroundElevation","REFERENCE","pointToVector","getElevation"],"mappings":"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","file":"static/js/73.731eb1a5.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import t from\"../../../../core/Accessor.js\";import{isSome as o}from\"../../../../core/maybe.js\";import{throwIfAborted as r,whenOrAbort as i}from\"../../../../core/promiseUtils.js\";import{watch as n,initial as a}from\"../../../../core/reactiveUtils.js\";import{property as s}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/arrayUtils.js\";import\"../../../../core/accessorSupport/ensureType.js\";import{subclass as p}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{elevationContextAffectsAlignment as l,absoluteHeightElevationInfo as y}from\"../../../../support/elevationInfoUtils.js\";import{makeFilter as c,makeSnappingQuery as g}from\"../snappingUtils.js\";import{convertSnappingCandidate as u,makeGetGroundElevation as h}from\"./queryEngineUtils.js\";import{getSnappingCandidateElevationAligner as m}from\"./snappingCandidateElevationAlignment.js\";import{getSnappingCandidateElevationFilter as d}from\"./snappingCandidateElevationFilter.js\";import{getSymbologySnappingCandidatesFetcher as v}from\"./symbologySnappingCandidates.js\";let f=class extends t{constructor(e){super(e),this.view=null,this._layerView3D=null}get availability(){return 1}get updating(){return this.layerSource.updating}get _snappingElevationAligner(){const{view:e}=this,{layer:t}=this.layerSource,r=o(e)&&\"3d\"===e.type;if(!r||\"subtype-group\"===t.type)return m();const n=async(o,r)=>(await i(e.whenLayerView(t),r)).elevationAlignPointsInFeatures(o,r);return m(r,{elevationInfo:t.elevationInfo,alignPointsInFeatures:n,spatialReference:e.spatialReference})}get _snappingElevationFilter(){const{view:e}=this,t=o(e)&&\"3d\"===e.type&&\"subtype-group\"!==this.layerSource.layer.type;return d(t)}get _symbologySnappingFetcher(){const{view:e}=this,{layer:t}=this.layerSource;return o(e)&&\"3d\"===e.type&&\"subtype-group\"!==t.type?v(this._symbologySnappingSupported,(async(o,i)=>{const n=await e.whenLayerView(t);return r(i),n.queryForSymbologySnapping({candidates:o,spatialReference:e.spatialReference},i)})):v()}get _symbologySnappingSupported(){return o(this._layerView3D)&&this._layerView3D.symbologySnappingSupported}initialize(){const{view:e}=this,{layer:t}=this.layerSource;o(e)&&\"3d\"===e.type&&\"subtype-group\"!==t.type&&(e.whenLayerView(t).then((e=>this._layerView3D=e)),this.addHandles([e.elevationProvider.on(\"elevation-change\",(({context:e})=>{const{elevationInfo:o}=t;l(e,o)&&this._snappingElevationAligner.notifyElevationSourceChange()})),n((()=>t.elevationInfo),(()=>this._snappingElevationAligner.notifyElevationSourceChange()),a),n((()=>o(this._layerView3D)?this._layerView3D.processor?.renderer:null),(()=>this._symbologySnappingFetcher.notifySymbologyChange()),a)]))}refresh(){}async fetchCandidates(e,t){const{layer:o}=this.layerSource,{coordinateHelper:i,elevationInfo:n}=e,a=o.source;if(!a.querySnapping)return[];const s=c(o),p=g(e,s),l=await a.querySnapping(p,{signal:t});r(t);const h=await this._snappingElevationAligner.alignCandidates(l.candidates,t);r(t);const m=await this._symbologySnappingFetcher.fetch(h,t);r(t);const d=0===m.length?h:[...h,...m],v=this._snappingElevationFilter.filter(p,d),f=i.hasZ()?y:n,S=this._getGroundElevation;return v.map((e=>u(e,i,f,S)))}get _getGroundElevation(){return h(this.view)}};e([s({constructOnly:!0})],f.prototype,\"layerSource\",void 0),e([s({constructOnly:!0})],f.prototype,\"view\",void 0),e([s()],f.prototype,\"_snappingElevationAligner\",null),e([s()],f.prototype,\"_snappingElevationFilter\",null),e([s()],f.prototype,\"_symbologySnappingFetcher\",null),e([s()],f.prototype,\"_layerView3D\",void 0),e([s()],f.prototype,\"_symbologySnappingSupported\",null),e([s()],f.prototype,\"_getGroundElevation\",null),f=e([p(\"esri.views.interactive.snapping.featureSources.FeatureCollectionSnappingSource\")],f);export{f as FeatureCollectionSnappingSource};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{objectEqual as t}from\"../snappingUtils.js\";import{SnappingHint as n}from\"./SnappingHint.js\";class s extends n{constructor(t,n,s){super(n,s),this.point=t}equals(n){return n instanceof s&&t(this.point,n.point)}}export{s as PointSnappingHint};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{PointConstraint as t}from\"../SnappingConstraint.js\";import{FeatureSnappingCandidate as n}from\"./FeatureSnappingCandidate.js\";import{PointSnappingHint as i}from\"../hints/PointSnappingHint.js\";class o extends n{constructor(n){super({...n,constraint:new t(n.coordinateHelper,n.targetPoint)})}get hints(){return[new i(this.targetPoint,this.elevationInfo,this.domain)]}}export{o as VertexSnappingCandidate};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport\"../../../../core/has.js\";import e from\"../../../../core/LRUCache.js\";import{getOrCreateMapValue as t}from\"../../../../core/MapUtils.js\";import{isSome as s,isNone as n}from\"../../../../core/maybe.js\";import{throwIfAborted as o}from\"../../../../core/promiseUtils.js\";import{getMetersPerVerticalUnitForSR as i}from\"../../../../core/unitUtils.js\";import{getMetersPerUnit as a}from\"../../../../symbols/support/unitConversionUtils.js\";function r(e=!1,t){if(e){const{elevationInfo:e,alignPointsInFeatures:s,spatialReference:n}=t;return new l(e,s,n)}return new c}class c{async alignCandidates(e,t){return e}notifyElevationSourceChange(){}}const h=1024;class l{constructor(t,s,n){this._elevationInfo=t,this._alignPointsInFeatures=s,this.spatialReference=n,this._alignmentsCache=new e(h),this._cacheVersion=0,this._metersPerVerticalUnit=i(n)}async alignCandidates(e,t){const n=this._elevationInfo;return s(n)&&\"absolute-height\"===n.mode&&!n.featureExpressionInfo?(this._alignAbsoluteElevationCandidates(e,n),e):this._alignComputedElevationCandidates(e,t)}notifyElevationSourceChange(){this._alignmentsCache.clear(),this._cacheVersion++}_alignAbsoluteElevationCandidates(e,t){const{offset:s,unit:o}=t;if(n(s))return;const i=s*(a(o??\"meters\")/this._metersPerVerticalUnit);for(const n of e)switch(n.type){case\"edge\":n.start.z+=i,n.end.z+=i;continue;case\"vertex\":n.target.z+=i;continue}}async _alignComputedElevationCandidates(e,s){const n=new Map;for(const o of e)t(n,o.objectId,p).push(o);const[i,a,r]=this._prepareQuery(n),c=await this._alignPointsInFeatures(i,s);o(s);if(r!==this._cacheVersion)return this._alignComputedElevationCandidates(e,s);this._applyCacheAndResponse(i,c,a);const{drapedObjectIds:h,failedObjectIds:l}=c,d=[];for(const t of e){const{objectId:e}=t;h.has(e)&&\"edge\"===t.type&&(t.draped=!0),l.has(e)||d.push(t)}return d}_prepareQuery(e){const t=[],s=[];for(const[n,o]of e){const e=[];for(const t of o)this._addToQueriesOrCachedResult(n,t.target,e,s),\"edge\"===t.type&&(this._addToQueriesOrCachedResult(n,t.start,e,s),this._addToQueriesOrCachedResult(n,t.end,e,s));0!==e.length&&t.push({objectId:n,points:e})}return[t,s,this._cacheVersion]}_addToQueriesOrCachedResult(e,t,n,o){const i=u(e,t),a=this._alignmentsCache.get(i);s(a)?o.push(new d(t,a)):n.push(t)}_applyCacheAndResponse(e,{elevations:t,drapedObjectIds:s,failedObjectIds:n},o){for(const r of o)r.apply();let i=0;const a=this._alignmentsCache;for(const{objectId:r,points:c}of e){if(n.has(r)){i+=c.length;continue}const e=!s.has(r);for(const s of c){const n=u(r,s),o=t[i++];s.z=o,e&&a.put(n,o,1)}}}}class d{constructor(e,t){this.point=e,this.z=t}apply(){this.point.z=this.z}}function u(e,{x:t,y:s,z:n}){return`${e}-${t}-${s}-${n??0}}`}function p(){return[]}export{r as getSnappingCandidateElevationAligner};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport\"../../../../core/has.js\";class t{filter(t,n){return n}notifyElevationSourceChange(){}}class n{filter(t,n){const{point:r,distance:c}=t,{z:i}=r;if(!(null!=i))return n;if(0===n.length)return n;const o=s(c),u=this._updateCandidatesTo3D(n,r,o).filter(e);return u.sort(a),u}_updateCandidatesTo3D(t,n,e){for(const r of t)switch(r.type){case\"edge\":c(r,n,e);continue;case\"vertex\":o(r,n,e);continue}return t}}function e(t){return t.distance<=1}function r(e=!1){return e?new n:new t}function c(t,n,{x:e,y:r,z:c}){const{start:o,end:s,target:a}=t;t.draped||i(a,n,o,s);const u=(n.x-a.x)/e,d=(n.y-a.y)/r,f=(n.z-a.z)/c;t.distance=Math.sqrt(u*u+d*d+f*f)}function i(t,n,e,r){const c=r.x-e.x,i=r.y-e.y,o=r.z-e.z,s=c*c+i*i+o*o,a=(n.x-e.x)*c+(n.y-e.y)*i+o*(n.z-e.z),u=Math.min(1,Math.max(0,a/s)),d=e.x+c*u,f=e.y+i*u,x=e.z+o*u;t.x=d,t.y=f,t.z=x}function o(t,n,{x:e,y:r,z:c}){const{target:i}=t,o=(n.x-i.x)/e,s=(n.y-i.y)/r,a=(n.z-i.z)/c,u=Math.sqrt(o*o+s*s+a*a);t.distance=u}function s(t){return\"number\"==typeof t?{x:t,y:t,z:t}:t}function a(t,n){return t.distance-n.distance}export{r as getSnappingCandidateElevationFilter};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport\"../../../../core/has.js\";import{clone as t}from\"../../../../core/lang.js\";import e from\"../../../../core/LRUCache.js\";import{throwIfAborted as s}from\"../../../../core/promiseUtils.js\";import{numericHash as o}from\"../../../../core/string.js\";function n(t=!1,e){return t?new i(e):new c}class c{async fetch(){return[]}notifySymbologyChange(){}}const r=1024;class i{constructor(t){this._getSymbologyCandidates=t,this._candidatesCache=new e(r),this._cacheVersion=0}async fetch(e,o){if(0===e.length)return[];const n=[],c=[],r=this._candidatesCache;for(const s of e){const e=a(s),o=r.get(e);if(o)for(const s of o)c.push(t(s));else n.push(s),r.put(e,[],1)}if(0===n.length)return c;const i=this._cacheVersion,{candidates:h,sourceCandidateIndices:d}=await this._getSymbologyCandidates(n,o);s(o);if(i!==this._cacheVersion)return this.fetch(e,o);const f=[],{length:g}=h;for(let s=0;s<g;++s){const e=h[s],o=a(n[d[s]]),c=r.get(o);c.push(e),r.put(o,c,c.length),f.push(t(e))}return c.concat(f)}notifySymbologyChange(){this._candidatesCache.clear(),this._cacheVersion++}}function a(t){switch(t.type){case\"vertex\":{const{objectId:e,target:s}=t,n=`${e}-vertex-${s.x}-${s.y}-${s.z??0}`;return o(n).toString()}case\"edge\":{const{objectId:e,start:s,end:n}=t,c=`${e}-edge-${s.x}-${s.y}-${s.z??0}-to-${n.x}-${n.y}-${n.z??0}`;return o(c).toString()}default:return\"\"}}export{n as getSymbologySnappingCandidatesFetcher};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{DrapedLineConstraint as t}from\"../SnappingConstraint.js\";import{LineSegmentHintType as n}from\"../snappingUtils.js\";import{FeatureSnappingCandidate as i}from\"./FeatureSnappingCandidate.js\";import{LineSnappingHint as e}from\"../hints/LineSnappingHint.js\";class r extends i{constructor(n){super({...n,constraint:new t(n.coordinateHelper,n.edgeStart,n.edgeEnd,n.getGroundElevation)})}get hints(){return[new e(n.REFERENCE,this.constraint.start,this.constraint.end,this.elevationInfo,this.domain)]}}export{r as DrapedEdgeSnappingCandidate};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../../../core/maybe.js\";import{DrapedEdgeSnappingCandidate as t}from\"../candidates/DrapedEdgeSnappingCandidate.js\";import{EdgeSnappingCandidate as o}from\"../candidates/EdgeSnappingCandidate.js\";import{VertexSnappingCandidate as n}from\"../candidates/VertexSnappingCandidate.js\";function r(e,r,a,d){switch(e.type){case\"edge\":return e.draped?new t({coordinateHelper:r,edgeStart:r.pointToVector(e.start),edgeEnd:r.pointToVector(e.end),targetPoint:r.pointToVector(e.target),objectId:e.objectId,getGroundElevation:d,elevationInfo:a}):new o({coordinateHelper:r,edgeStart:r.pointToVector(e.start),edgeEnd:r.pointToVector(e.end),targetPoint:r.pointToVector(e.target),objectId:e.objectId,elevationInfo:a});case\"vertex\":return new n({coordinateHelper:r,targetPoint:r.pointToVector(e.target),objectId:e.objectId,elevationInfo:a})}}function a(t){return e(t)&&\"3d\"===t.type?(e,o,n)=>t.elevationProvider.getElevation(e,o,n,t.spatialReference,\"ground\"):()=>null}export{r as convertSnappingCandidate,a as makeGetGroundElevation};\n"],"sourceRoot":""}