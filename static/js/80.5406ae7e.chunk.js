(this["webpackJsonppopulation-arcgis"]=this["webpackJsonppopulation-arcgis"]||[]).push([[80],{1102:function(e,t,i){"use strict";i.d(t,"a",(function(){return l})),i.d(t,"b",(function(){return o})),i.d(t,"c",(function(){return r})),i.d(t,"d",(function(){return s})),i.d(t,"e",(function(){return u})),i.d(t,"f",(function(){return d})),i.d(t,"g",(function(){return c})),i.d(t,"h",(function(){return h})),i.d(t,"i",(function(){return b}));var n=i(2),a=i(68);function s(e,t){return{type:Object(a.x)(t),value:e,unit:t}}function r(e,t){return{type:Object(a.x)(t),value:e,unit:t}}function o(e,t){return{type:Object(a.x)(t),value:e,unit:t}}function l(e,t,i="arithmetic"){return{type:Object(a.x)(t),value:e,unit:t,rotationType:i}}function c(e,t){return s(Object(a.d)(e.value,e.unit,t),t)}function u(e,t){return Object(n.k)(e)?t:Object(n.k)(t)||e.value>Object(a.d)(t.value,t.unit,e.unit)?e:t}function d(e,t){return Object(n.k)(e)?null:{...e,value:e.value*t}}const h=r(0,"meters"),b=o(0,"square-meters");l(0,"radians")},1167:function(e,t,i){"use strict";i.d(t,"a",(function(){return h})),i.d(t,"b",(function(){return j})),i.d(t,"c",(function(){return r})),i.d(t,"d",(function(){return u})),i.d(t,"e",(function(){return d})),i.d(t,"f",(function(){return O})),i.d(t,"g",(function(){return l})),i.d(t,"h",(function(){return c})),i.d(t,"i",(function(){return b})),i.d(t,"j",(function(){return p})),i.d(t,"k",(function(){return _})),i.d(t,"l",(function(){return g}));var n=i(2),a=i(1102),s=i(928);function r(e,t,i,n=2,r="abbr"){return Object(s.c)(e,Object(a.g)(t,i).value,i,n,r)}function o(e,t,i,n=2,r="abbr"){return Object(s.p)(e,Object(a.g)(t,i).value,i,n,r)}function l(e,t,i=2,n="abbr"){return Object(s.k)(e,t.value,t.unit,i,n)}function c(e,t,i=2,n="abbr"){return Object(s.n)(e,t.value,t.unit,i,n)}function u(e,t,i=2,n="abbr"){return Object(s.f)(e,t.value,t.unit,i,n)}function d(e,t,i=2,n="abbr"){return Object(s.i)(e,t.value,t.unit,i,n)}function h(e,t,i){return Object(s.a)(e.value,e.unit,e.rotationType,t,i)}function b(e,t,i){return Object(s.o)(e.value,e.unit,e.rotationType,t,i)}function O(e,t,i,a,s="abbr"){switch(a=Object(n.u)(a,2),i){case"imperial":return u(e,t,a,s);case"metric":return l(e,t,a,s);default:return r(e,t,i,a,s)}}function p(e,t,i,n=2,a="abbr"){switch(i){case"imperial":return function(e,t,i=2,n="abbr"){return Object(s.g)(e,t.value,t.unit,i,n)}(e,t,n,a);case"metric":return function(e,t,i=2,n="abbr"){return Object(s.l)(e,t.value,t.unit,i,n)}(e,t,n,a);default:return o(e,t,i,n,a)}}function g(e,t,i,n=2,a="abbr"){switch(i){case"imperial":return d(e,t,n,a);case"metric":return c(e,t,n,a);default:return r(e,t,i,n,a)}}function _(e,t,i,n=2,a="abbr"){switch(i){case"imperial":return function(e,t,i=2,n="abbr"){return Object(s.h)(e,t.value,t.unit,i,n)}(e,t,n,a);case"metric":return function(e,t,i=2,n="abbr"){return Object(s.m)(e,t.value,t.unit,i,n)}(e,t,n,a);default:return o(e,t,i,n,a)}}function j(e,t,i,n=2,a="abbr"){switch(i){case"imperial":return function(e,t,i=2,n="abbr"){return Object(s.e)(e,t.value,t.unit,i,n)}(e,t,n,a);case"metric":return function(e,t,i=2,n="abbr"){return Object(s.j)(e,t.value,t.unit,i,n)}(e,t,n,a);default:return r(e,t,i,n,a)}}},1268:function(e,t,i){"use strict";i.d(t,"a",(function(){return m}));var n=i(64),a=i(2),s=i(13),r=i(30),o=i(35),l=i(5),c=i(9),u=i(60),d=i(401),h=i(55),b=i(1117),O=i(169),p=i(285),g=i(102),_=i(11),j=i(871),v=i(475);class m extends b.a{constructor(e){super(e),this._handles=new n.a,this._quadMaterial=null,this._outlineMaterial=null,this._maxSize=0,this._position=Object(c.f)(),this._up=Object(c.f)(),this._right=Object(c.f)(),this._renderOccluded=g.c.OccludeAndTransparent,this._color=Object(d.c)(1,0,0,1),this._outlineColor=Object(d.c)(0,0,0,1),this._outlineSize=0,this._size=32,this._outlineRenderOccluded=g.c.Opaque,this.applyProps(e)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateQuadMaterial())}get color(){return this._color}set color(e){Object(u.c)(this._color,e),this._updateQuadMaterial()}get outlineColor(){return this._outlineColor}set outlineColor(e){Object(u.c)(this._outlineColor,e),this._updateOutlineMaterial()}get outlineSize(){return this._outlineSize}set outlineSize(e){const t=0===this._outlineSize!=(0===e);this._outlineSize=e,t?this.recreateGeometry():this._updateOutlineMaterial()}get size(){return this._size}set size(e){e!==this._size&&(this._size=e,this._updateTransform())}get outlineRenderOccluded(){return this._outlineRenderOccluded}set outlineRenderOccluded(e){this._outlineRenderOccluded=e,this._updateOutlineMaterial()}set geometry({previous:e,center:t,next:i}){this._maxSize=Math.min(Object(l.r)(t,e),Object(l.r)(t,i))/3,Object(l.w)(this._up,Object(l.k)(this._up,e,t)),Object(l.w)(this._right,Object(l.k)(this._right,i,t)),Object(l.l)(this._position,t),this.recreateGeometry()}createExternalResources(){this._quadMaterial=new j.a(this._quadMaterialParameters),this._outlineMaterial=new v.a(this._outlineMaterialParameters),this._handles.add(Object(s.f)((()=>this.view.state.camera),(()=>this._updateTransform())))}destroyExternalResources(){this._quadMaterial=null,this._outlineMaterial=null,this._handles.removeAll()}forEachExternalMaterial(e){e(this._quadMaterial),e(this._outlineMaterial)}createGeometries(e){Object(l.t)(this._up,c.c)&&Object(l.t)(this._right,c.c)||(this._createQuadGeometry(e),this._createOutlineGeometry(e),this._updateTransform(e))}_createQuadGeometry(e){const t=this._quadGeometryData(this._up,this._right);e.addGeometry(t,this._quadMaterial)}_createOutlineGeometry(e){if(0===this._outlineSize)return;const t=Object(l.j)(h.d.get(),this._up,this._right),i=Object(p.j)([this._up,t,this._right]);e.addGeometry(i,this._outlineMaterial)}_updateTransform(e=this.object){const t=this.view.state.camera,i=this._size*t.computeScreenPixelSizeAt(this._position),n=Math.min(this._maxSize,i);Object(r.i)(y,this._position),Object(r.n)(y,y,[n,n,n]),Object(a.l)(e)&&(e.transformation=y)}_quadGeometryData(e,t){const i=Object(l.j)(h.d.get(),e,t);return new O.a([[_.a.POSITION,{size:3,data:[0,0,0,...t,...e,...i],exclusive:!0}]],[[_.a.POSITION,[0,1,2,1,2,3]]])}get _quadMaterialParameters(){return{color:this._color,transparent:!0,writeDepth:!1,polygonOffset:!0,renderOccluded:this._renderOccluded}}_updateQuadMaterial(){this._quadMaterial&&this._quadMaterial.setParameters(this._quadMaterialParameters)}get _outlineMaterialParameters(){return{color:this._outlineColor,width:this._outlineSize,renderOccluded:this._outlineRenderOccluded}}_updateOutlineMaterial(){this._outlineMaterial&&this._outlineMaterial.setParameters(this._outlineMaterialParameters)}}const y=Object(o.d)()},1376:function(e,t,i){"use strict";i.d(t,"a",(function(){return u})),i.d(t,"b",(function(){return c}));var n=i(135),a=i(90),s=i(49),r=i(8),o=i(74),l=i(11);function c(e){const t=new o.a,{vertex:i,fragment:c}=t;Object(n.b)(i,e),i.uniforms.add(new s.a("width",(e=>e.width))),t.attributes.add(l.a.POSITION,"vec3"),t.attributes.add(l.a.NORMAL,"vec3"),t.attributes.add(l.a.UV0,"vec2"),t.attributes.add(l.a.AUXPOS1,"float"),t.varyings.add("vtc","vec2"),t.varyings.add("vlength","float"),t.varyings.add("vradius","float"),i.code.add(r.b`void main(void) {
vec3 bitangent = normal;
vtc = uv0;
vlength = auxpos1;
vradius = 0.5 * width;
vec4 pos = view * vec4(position + vradius * bitangent * uv0.y, 1.0);
gl_Position = proj * pos;
}`),c.uniforms.add([new s.a("outlineSize",(e=>e.outlineSize)),new a.a("outlineColor",(e=>e.outlineColor)),new s.a("stripeLength",(e=>e.stripeLength)),new a.a("stripeEvenColor",(e=>e.stripeEvenColor)),new a.a("stripeOddColor",(e=>e.stripeOddColor))]);const u=1/Math.sqrt(2);return c.code.add(r.b`
    const float INV_SQRT2 = ${r.b.float(u)};

    vec4 arrowColor(vec2 tc, float len) {
      float d = INV_SQRT2 * (tc.x - abs(tc.y));
      d = min(d, INV_SQRT2 * (len - tc.x - abs(tc.y)));
      d = min(d, 1.0 - abs(tc.y));

      if (d < 0.0) {
        return vec4(0.0);
      } else if (d < outlineSize) {
        return outlineColor;
      } else {
        return fract(0.5 / stripeLength * tc.x * vradius) >= 0.5 ? stripeOddColor : stripeEvenColor;
      }
    }

    void main(void) {
      vec2 ntc = vec2(vtc.x / vradius, vtc.y);
      vec4 color = arrowColor(ntc, vlength / vradius);
      if (color.a == 0.0) {
        discard;
      }
      gl_FragColor = color;
    }
  `),t}const u=Object.freeze(Object.defineProperty({__proto__:null,build:c},Symbol.toStringTag,{value:"Module"}))},1645:function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return Ne}));var n=i(0),a=i(28),s=i(2),r=i(1),o=(i(17),i(12),i(10)),l=i(1462),c=i(1179),u=i(1263),d=i(64),h=i(22),b=i(1102),O=i(13),p=i(5),g=i(9),_=i(907),j=i(250),v=i(40),m=i(66),y=i(916),f=i(1180),w=i(1463);const P="esri.views.3d.analysis.DirectLineMeasurement.DirectLineMeasurementController",S=h.a.getLogger(P);let L=class extends a.a{constructor(e){super(e),this._unitNormalizer=new w.a,this._handles=new d.a,this._tempStartPosition=Object(g.f)(),this._tempEndPosition=Object(g.f)(),this._tempCornerPosition=Object(g.f)()}initialize(){const e=this.view.spatialReference,t=Object(m.g)(e),i=t===m.a?m.d:t;this._sphericalPCPF=i;const n=Object(v.b)(e,i);this._unitNormalizer.spatialReference=n?i:e,this._handles.add([Object(O.f)((()=>({viewData:this.viewData,startPoint:this.analysis.startPoint})),(({viewData:e,startPoint:t})=>{e.elevationAlignedStartPoint=this._applyProjectionAndElevationAlignment(t)}),O.e),Object(O.f)((()=>({viewData:this.viewData,endPoint:this.analysis.endPoint})),(({viewData:e,endPoint:t})=>{e.elevationAlignedEndPoint=this._applyProjectionAndElevationAlignment(t)}),O.e),Object(O.f)((()=>({result:this._computedResult,viewData:this.viewData})),(({result:e,viewData:t})=>{t.result=e}),O.e)])}destroy(){this._handles=Object(s.e)(this._handles)}_applyProjectionAndElevationAlignment(e){if(Object(s.k)(e))return e;const t=Object(f.a)(e,this.view.spatialReference,this.view.elevationProvider);return Object(s.k)(t)?(Object(f.b)(this.analysis,e.spatialReference,S),null):t}get _computedResult(){const{elevationAlignedStartPoint:e,elevationAlignedEndPoint:t,measurementMode:i}=this.viewData;if(Object(s.k)(e)||Object(s.k)(t))return null;const n=this._euclideanDistances(e,t),a=this._geodesicDistance(e,t,n.horizontal.value),r=i===u.a.Geodesic||i===u.a.Auto&&n.horizontal.value>1e5?"geodesic":"euclidean";return{mode:r,distance:"euclidean"===r?n.direct:a,directDistance:n.direct,horizontalDistance:n.horizontal,verticalDistance:n.vertical,geodesicDistance:a}}_euclideanDistances(e,t){const i=e.clone();i.z=t.z;const n=this._tempStartPosition,a=this._tempEndPosition,s=this._tempCornerPosition,r=this.view.spatialReference,o=this._sphericalPCPF,l=Object(v.b)(r,o)?o:r;Object(v.v)(e,n,l),Object(v.v)(t,a,l),Object(v.v)(i,s,l);const c=Object(p.r)(n,a),u=Object(p.r)(s,a),d=Math.abs(t.z-e.z),h=e=>this._unitNormalizer.normalizeDistance(e),O=h(c),g=h(u),_=h(d);return{direct:Object(b.d)(O,"meters"),horizontal:Object(b.d)(g,"meters"),vertical:Object(b.d)(_,"meters")}}_geodesicDistance(e,t,i){const n=e.spatialReference,a=new j.a({spatialReference:n});a.addPath([e,t]);const r=n.isGeographic&&Object(y.f)(n)?Object(y.d)([a],"meters")[0]:n.isWebMercator?Object(_.geodesicLength)(a,"meters"):null,o=Object(s.l)(r)?r:this._fallbackGeodesicDistance(e,t,i);return Object(b.d)(o,"meters")}_fallbackGeodesicDistance(e,t,i){if(Object(v.w)(e,z)&&Object(v.w)(t,A)){const e=new y.a;return Object(y.e)(e,z,A),e.distance}return i}};Object(n.a)([Object(r.b)()],L.prototype,"view",void 0),Object(n.a)([Object(r.b)()],L.prototype,"analysis",void 0),Object(n.a)([Object(r.b)()],L.prototype,"viewData",void 0),Object(n.a)([Object(r.b)()],L.prototype,"_computedResult",null),L=Object(n.a)([Object(o.a)(P)],L);const z=Object(g.f)(),A=Object(g.f)();var M,E,C,V=i(46),D=(i(402),i(1372)),x=i(14),T=i(1167),G=i(31),R=i(68),k=i(26);(C=M||(M={}))[C.None=0]="None",C[C.Direct=1]="Direct",C[C.Triangle=2]="Triangle",C[C.ProjectedGeodesic=3]="ProjectedGeodesic",function(e){e[e.Auto=0]="Auto",e[e.AboveSegment=1]="AboveSegment",e[e.BelowSegment=2]="BelowSegment"}(E||(E={}));var N=i(1370),q=i(1317),B=i(1181),I=i(35),H=i(41),U=i(55),Q=i(1117),F=i(285),W=i(102),J=i(132),X=i(20),$=i(326),K=i(52),Y=i(11),Z=i(75),ee=i(80),te=i(21),ie=i(77),ne=i(101),ae=i(76),se=i(70),re=i(227),oe=i(1376),le=i(7),ce=i(36);class ue extends ee.a{constructor(e,t,i){super(e,t,i)}initializeProgram(e){return new ae.a(e.rctx,ue.shader.get().build(this.configuration),ie.a)}_setPipelineState(e){const t=e===se.a.NONE,i=this.configuration;return Object(ce.g)({blending:i.transparent?t?ne.d:Object(ne.f)(e):null,polygonOffset:this.configuration.polygonOffsetEnabled&&{factor:0,units:-4},depthTest:{func:le.h.LESS},depthWrite:ce.e,colorWrite:ce.d})}initializePipeline(){return this._setPipelineState(this.configuration.transparencyPassType)}get primitiveType(){return le.r.TRIANGLE_STRIP}}ue.shader=new Z.a(oe.a,(()=>i.e(242).then(i.bind(null,1630))));class de extends re.a{constructor(){super(...arguments),this.polygonOffsetEnabled=!1,this.transparent=!1,this.transparencyPassType=se.a.NONE}}Object(n.a)([Object(te.b)()],de.prototype,"polygonOffsetEnabled",void 0),Object(n.a)([Object(te.b)()],de.prototype,"transparent",void 0),Object(n.a)([Object(te.b)({count:se.a.COUNT})],de.prototype,"transparencyPassType",void 0);class he extends W.a{constructor(e){super(e,new Oe),this._configuration=new de}getConfiguration(e,t){return this._configuration.polygonOffsetEnabled=this.parameters.polygonOffset,this._configuration.transparent=this.parameters.stripeEvenColor[3]<1||this.parameters.stripeOddColor[3]<1||this.parameters.outlineColor[3]<1,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration}dispose(){}intersect(){}requiresSlot(e,t){return t===X.a.Color&&e===K.a.OPAQUE_MATERIAL}createGLMaterial(e){return new be(e)}createBufferWriter(){return new ye}}class be extends $.a{beginSlot(e){return this.ensureTechnique(ue,e)}}class Oe extends W.b{constructor(){super(...arguments),this.width=32,this.outlineSize=.2,this.outlineColor=Object(H.g)(1,.5,0,1),this.stripeEvenColor=Object(H.g)(1,1,1,1),this.stripeOddColor=Object(H.g)(1,.5,0,1),this.stripeLength=1,this.polygonOffset=!1}}const pe=Object(J.a)().vec3f(Y.a.POSITION).vec3f(Y.a.NORMAL).vec2f(Y.a.UV0).f32(Y.a.AUXPOS1),ge=Object(g.f)(),_e=Object(g.f)(),je=Object(g.f)(),ve=Object(g.f)(),me=Object(g.f)();class ye{constructor(){this.vertexBufferLayout=pe}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){return 2*(e.indices.get(Y.a.POSITION).length/2+1)}write(e,t,i,n,a){const s=i.vertexAttributes.get(Y.a.POSITION).data,r=i.vertexAttributes.get(Y.a.NORMAL).data,o=s.length/3,l=i&&i.indices&&i.indices.get(Y.a.POSITION);l&&l.length!==2*(o-1)&&console.warn("MeasurementArrowMaterial does not support indices");const c=ge,u=_e,d=je,h=ve,b=me,O=n.position,g=n.normal,_=n.uv0;let j=0;for(let m=0;m<o;++m){const i=3*m;if(Object(p.B)(c,s[i],s[i+1],s[i+2]),m<o-1){const e=3*(m+1);Object(p.B)(u,s[e],s[e+1],s[e+2]),Object(p.B)(b,r[e],r[e+1],r[e+2]),Object(p.w)(b,b),Object(p.k)(d,u,c),Object(p.w)(d,d),Object(p.o)(h,b,d),Object(p.w)(h,h)}const n=Object(p.r)(c,u);e&&t&&(Object(p.v)(c,c,e),Object(p.v)(u,u,e),Object(p.v)(h,h,t));const l=a+2*m,v=l+1;O.setVec(l,c),O.setVec(v,c),g.setVec(l,h),g.setVec(v,h),_.set(l,0,j),_.set(l,1,-1),_.set(v,0,j),_.set(v,1,1),m<o-1&&(j+=n)}const v=n.auxpos1;for(let p=0;p<2*o;++p)v.set(a+p,j)}}class fe extends Q.a{constructor(e){super(e),this._parameters={arrowWidth:16,arrowOutlineColor:V.a.toUnitRGBA(Object(D.a)()),arrowStripeEvenColor:V.a.toUnitRGBA(Object(D.b)()),arrowStripeOddColor:V.a.toUnitRGBA(Object(D.a)()),arrowSubdivisions:128},this._handles=null,this._origin=Object(g.f)(),this._originTransform=Object(I.d)(),this._arrowCenter=Object(g.f)(),this._renderOccluded=W.c.OccludeAndTransparent,this._geometry=null,this._stripeLength=1,this._stripesEnabled=!0,this._opacity=1,this.applyProps(e)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._arrowMaterial&&this._arrowMaterial.setParameters({renderOccluded:e}))}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this._geometryChanged()}get stripeLength(){return this._stripeLength}set stripeLength(e){this._stripeLength=e,this.attached&&this._arrowMaterial.setParameters({stripeLength:this._stripeLength})}get stripesEnabled(){return this._stripesEnabled}set stripesEnabled(e){if(this._stripesEnabled=e,this.attached){const e=this.opacity,{arrowStripeEvenColor:t,arrowStripeOddColor:i}=this._parameters,n=Object(x.c)(we,this._stripesEnabled?t:i,e);this._arrowMaterial.setParameters({stripeEvenColor:n})}}get opacity(){return this._opacity}set opacity(e){e!==this._opacity&&(this._opacity=e,this._updateArrowOpacity())}createExternalResources(){const{arrowStripeEvenColor:e,arrowStripeOddColor:t,arrowOutlineColor:i}=this._parameters,n=this._stripesEnabled?e:t;this._arrowMaterial=new he({outlineColor:i,stripeEvenColor:n,stripeOddColor:t,renderOccluded:this.renderOccluded,polygonOffset:!0}),this._handles=new d.a,this._handles.add(Object(O.f)((()=>this.view.state.camera),(()=>{this._viewChanged()})))}destroyExternalResources(){this._arrowMaterial=null,this._handles.destroy(),this._handles=null}forEachExternalMaterial(e){e(this._arrowMaterial)}createGeometries(e){if(Object(s.k)(this._geometry)||Object(s.k)(this._geometry.startRenderSpace)||Object(s.k)(this._geometry.endRenderSpace))return;const t=this._createArrowGeometry(this._geometry.startRenderSpace,this._geometry.endRenderSpace,this._origin,this._geometry);e.addGeometry(t,this._arrowMaterial,this._originTransform),this._viewChanged()}_createArrowGeometry(e,t,i,n){const a=this.view.renderCoordsHelper,s=[],r=[],o=(e,t)=>{const n=U.d.get();Object(p.k)(n,e,i),s.push(n),r.push(t)};if("euclidean"===n.type){n.eval(.5,this._arrowCenter);const i=U.d.get();a.worldUpAtPosition(this._arrowCenter,i),o(e,i),o(t,i)}else{n.eval(.5,this._arrowCenter);const e=this._parameters.arrowSubdivisions+1&-2;for(let t=0;t<e;++t){const i=t/(e-1),s=U.d.get(),r=U.d.get();n.eval(i,s),a.worldUpAtPosition(s,r),o(s,r)}}return Object(F.j)(s,r)}_geometryChanged(){this.recreateGeometry()}_viewChanged(){if(this.view.ready&&this.attached&&Object(s.l)(this._geometry)){const e=this.view.state.camera.computeScreenPixelSizeAt(this._arrowCenter);this._arrowMaterial.setParameters({width:this._parameters.arrowWidth*e})}}_updateArrowOpacity(){const e=this.opacity,{arrowStripeEvenColor:t,arrowStripeOddColor:i,arrowOutlineColor:n}=this._parameters,a=Object(x.c)(we,this._stripesEnabled?t:i,e),s=Object(x.c)(Pe,n,e),r=Object(x.c)(Se,i,e);this._arrowMaterial.setParameters({stripeEvenColor:a,outlineColor:s,stripeOddColor:r})}}const we=Object(H.e)(),Pe=Object(H.e)(),Se=Object(H.e)();var Le=i(1268),ze=i(1230),Ae=i(734),Me=i(204),Ee=i(404);let Ce=class extends a.a{constructor(e){super(e),this._params={triangleColor:new Float32Array(V.a.toUnitRGBA(Object(D.a)(.75))),triangleLineWidth:3,geodesicProjectionLineWidth:2,geodesicProjectionLineColor:new Float32Array(V.a.toUnitRGBA(Object(D.a)(.75))),guideLineWidth:2,guideStippleLengthPixels:6,direcLabelFontSize:16,horizontalLabelFontSize:12,verticalLabelFontSize:12},this._handles=new d.a,this._segmentVisualElement=null,this._triangleVisualElement=null,this._rightAngleQuad=null,this._projectedGeodesicLine=null,this._geodesicStartHint=null,this._geodesicEndHint=null,this._segmentLabel=null,this._verticalLabel=null,this._horizontalLabel=null,this._startPosition=Object(g.f)(),this._endPosition=Object(g.f)(),this._cornerPosition=Object(g.f)(),this._startPositionAtSeaLevel=Object(g.f)(),this._endPositionAtSeaLevel=Object(g.f)(),this._triangleOrientationOverride=null,this.messages=null,this.loadingMessages=!0,this.visualElementOrientation=E.Auto,this.triangleCollapseRatioThreshold=.03}get visible(){return this.analysisView.visible}get viewMode(){const{elevationAlignedStartPoint:e,elevationAlignedEndPoint:t}=this.analysisView;if(Object(s.k)(e)||Object(s.k)(t)||e.equals(t))return M.None;const i=this.analysisView.result;if(Object(s.k)(i))return M.Direct;if("geodesic"===i.mode)return this._requiresGeodesicGuideAt(this._startPosition)||this._requiresGeodesicGuideAt(this._endPosition)?M.ProjectedGeodesic:M.Direct;const{verticalDistance:n,horizontalDistance:a}=i,r=n.value,o=a.value;return Math.min(r/o,o/r)<this.triangleCollapseRatioThreshold?M.Direct:M.Triangle}get actualVisualizedMeasurement(){if(Object(s.k)(this.analysisView.result))switch(this.analysisView.measurementMode){case u.a.Auto:case u.a.Euclidean:default:return"euclidean";case u.a.Geodesic:return"geodesic"}return this.analysisView.result.mode}get allowVisualElementsOrientationChange(){return Object(s.k)(this._triangleOrientationOverride)}set allowVisualElementsOrientationChange(e){Object(s.k)(this._triangleOrientationOverride)!==e&&(Object(s.k)(this._triangleOrientationOverride)?this._triangleOrientationOverride=this._actualVisualElementsOrientation:this._triangleOrientationOverride=null)}get labels(){const e="geodesic"===this.actualVisualizedMeasurement;return{direct:this._segmentLabel,horizontal:e?this._segmentLabel:this._horizontalLabel,vertical:this._verticalLabel}}initialize(){const e=this._params,t={attached:!0,view:this.view};this._segmentVisualElement=new fe({...t,geometry:null,renderOccluded:W.c.OccludeAndTransparent}),this._triangleVisualElement=new B.a({...t,width:e.triangleLineWidth,color:e.triangleColor,renderOccluded:W.c.OccludeAndTransparent}),this._rightAngleQuad=new Le.a({...t,color:new Float32Array(V.a.toUnitRGBA(Object(D.a)(.75))),renderOccluded:W.c.OccludeAndTransparent});const i={...t,polygonOffset:!0,renderOccluded:W.c.OccludeAndTransparent};this._projectedGeodesicLine=new B.a({...i,width:e.geodesicProjectionLineWidth,color:e.geodesicProjectionLineColor,stipplePattern:Object(Ae.a)(e.guideStippleLengthPixels)}),this._geodesicStartHint=new B.a({...i,width:e.guideLineWidth,color:e.geodesicProjectionLineColor,stipplePattern:Object(Ae.a)(e.guideStippleLengthPixels)}),this._geodesicEndHint=new B.a({...i,width:e.guideLineWidth,color:e.geodesicProjectionLineColor,stipplePattern:Object(Ae.a)(e.guideStippleLengthPixels)});const n={...t,backgroundColor:Object(D.d)(.6),textColor:Object(D.c)()};this._segmentLabel=new q.a({...n,fontSize:e.direcLabelFontSize}),this._verticalLabel=new q.a({...n,fontSize:e.verticalLabelFontSize}),this._horizontalLabel=new q.a({...n,fontSize:e.horizontalLabelFontSize}),this._handles.add([Object(O.f)((()=>{const{elevationAlignedStartPoint:e,elevationAlignedEndPoint:t}=this.analysisView,i=this.view;return{view:i,camera:i.state.camera,viewMode:this.viewMode,elevationAlignedStartPoint:e,elevationAlignedEndPoint:t,orientation:this._actualVisualElementsOrientation,visualizedMeasurement:this.actualVisualizedMeasurement,stripeLength:this._measurementArrowStripeLength}}),(e=>this._updateGeometryAndViewMode(e)),O.e),Object(O.f)((()=>({visible:this.visible,viewMode:this.viewMode})),(e=>this._updateVisualElementVisibility(e)),O.e),Object(O.f)((()=>({text:this._labelsText,visualizedMeasurement:this.actualVisualizedMeasurement})),(e=>this._updateLabelText(e)),O.e),Object(O.f)((()=>({visible:this.visible,viewMode:this.viewMode})),(e=>this._updateLabelVisibility(e)),O.e),Object(O.f)((()=>this._measurementArrowStripeLength),(e=>this._updateSegmentStripeLength(e)),O.e),Object(Me.c)((async()=>this._updateMessageBundle()))]),this._updateMessageBundle()}destroy(){this._handles=Object(s.e)(this._handles),this._segmentVisualElement=Object(s.e)(this._segmentVisualElement),this._triangleVisualElement=Object(s.e)(this._triangleVisualElement),this._rightAngleQuad=Object(s.e)(this._rightAngleQuad),this._projectedGeodesicLine=Object(s.e)(this._projectedGeodesicLine),this._geodesicStartHint=Object(s.e)(this._geodesicStartHint),this._geodesicEndHint=Object(s.e)(this._geodesicEndHint),this._segmentLabel=Object(s.e)(this._segmentLabel),this._verticalLabel=Object(s.e)(this._verticalLabel),this._horizontalLabel=Object(s.e)(this._horizontalLabel),this.set("view",null)}_updateVisualElementVisibility({visible:e,viewMode:t}){if(this._segmentVisualElement.visible=!1,this._triangleVisualElement.visible=!1,this._rightAngleQuad.visible=!1,this._projectedGeodesicLine.visible=!1,this._geodesicStartHint.visible=!1,this._geodesicEndHint.visible=!1,e)switch(t){case M.None:break;case M.Direct:this._segmentVisualElement.visible=!0;break;case M.Triangle:this._segmentVisualElement.visible=!0,this._triangleVisualElement.visible=!0,this._rightAngleQuad.visible=!0;break;case M.ProjectedGeodesic:this._segmentVisualElement.visible=!0,this._projectedGeodesicLine.visible=!0,this._geodesicStartHint.visible=!0,this._geodesicEndHint.visible=!0}}_updateGeometryAndViewMode({view:e,camera:t,viewMode:i,elevationAlignedStartPoint:n,elevationAlignedEndPoint:a,orientation:r,visualizedMeasurement:o,stripeLength:l}){const c=e.renderCoordsHelper;if(Object(s.k)(c)||Object(s.k)(n)||Object(s.k)(a)||n.equals(a))return;let u=this._startPosition,d=this._endPosition;c.toRenderCoords(n,u),c.toRenderCoords(a,d);const h=r===E.AboveSegment?1:-1,b=h*(c.getAltitude(d)-c.getAltitude(u));b<0&&(u=this._endPosition,d=this._startPosition);const O="geodesic"===o?new ze.b(this._startPosition,this._endPosition,c.spatialReference):new ze.a(this._startPosition,this._endPosition);switch(this._segmentVisualElement.geometry=O,this._updateSegmentStripeLength(l),i){case M.Direct:this._updateSegment(O,r);break;case M.Triangle:this._updateSegmentAndTriangle({view:e,camera:t,segment:O,orientation:r,startPosition:u,endPosition:d,deltaSign:h,altitudeDelta:b});break;case M.ProjectedGeodesic:this._updateSegmentAndProjection({view:e,orientation:r,startPosition:u,endPosition:d})}}_updateSegment(e,t){this._segmentLabel.anchor=t===E.AboveSegment?"top":"bottom",this._segmentLabel.geometry={type:"segment",segment:e,sampleLocation:"center"}}_updateSegmentAndTriangle({view:{renderCoordsHelper:e},camera:t,segment:i,orientation:n,startPosition:a,endPosition:s,deltaSign:r,altitudeDelta:o}){const l=this._cornerPosition;e.worldUpAtPosition(a,l),Object(p.p)(l,l,r*Math.abs(o)),Object(p.j)(l,l,a),this._triangleVisualElement.geometry=[[[a[0],a[1],a[2]],[l[0],l[1],l[2]],[s[0],s[1],s[2]]]],this._rightAngleQuad.geometry={previous:a,center:l,next:s};const c=new ze.a(a,l),u=new ze.a(l,s),d=function(e,t,i,n,a){const s=De,r=xe;a.projectToRenderScreen(i,s),a.projectToRenderScreen(t,r);const o={segment:"bottom",horizontal:"top",vertical:s[0]<r[0]?"left":"right"};{const n=Te,s=Ge;if(Object(N.b)(e,i,n,a),Object(N.b)(e,t,s,a),Object(k.h)(n,s)>=Ve){const e=Math.sign(n[1])===Math.sign(s[1]);o.segment=e?Object(q.b)(o.vertical):o.vertical}else{const e=Re;Object(N.b)(i,t,e,a),Object(k.h)(e,s)>=Ve&&(o.segment=Math.sign(e[0])===Math.sign(s[0])?Object(q.b)(o.horizontal):o.horizontal)}}if(n===E.BelowSegment){const e=e=>"top"===e?"bottom":"top";o.segment=e(o.segment),o.horizontal=e(o.horizontal),o.vertical=e(o.vertical)}return o}(a,s,l,n,t);this._segmentLabel.anchor=d.segment,this._segmentLabel.geometry={type:"segment",segment:i,sampleLocation:"center"},this._verticalLabel.geometry={type:"segment",segment:c,sampleLocation:"center"},this._verticalLabel.anchor=d.vertical,this._horizontalLabel.geometry={type:"segment",segment:u,sampleLocation:"center"},this._horizontalLabel.anchor=d.horizontal}_updateSegmentAndProjection({view:{renderCoordsHelper:e},orientation:t,startPosition:i,endPosition:n}){e.setAltitude(this._startPositionAtSeaLevel,0,i),e.setAltitude(this._endPositionAtSeaLevel,0,n);const a=new ze.b(this._startPositionAtSeaLevel,this._endPositionAtSeaLevel,e.spatialReference);this._projectedGeodesicLine.setGeometryFromSegment(a),this._geodesicStartHint.setGeometryFromSegment(new ze.a(this._startPositionAtSeaLevel,i)),this._geodesicEndHint.setGeometryFromSegment(new ze.a(this._endPositionAtSeaLevel,n)),this._segmentLabel.geometry={type:"segment",segment:a,sampleLocation:"center"},this._segmentLabel.anchor=t===E.AboveSegment?"top":"bottom"}_updateLabelText({text:e,visualizedMeasurement:t}){Object(s.l)(e)?(this._segmentLabel.text="euclidean"===t?e.euclideanDistance:e.geodesicDistance,this._horizontalLabel.text=e.horizontalDistance,this._verticalLabel.text=e.verticalDistance):(this._segmentLabel.text=null,this._horizontalLabel.text=null,this._verticalLabel.text=null),this.notifyChange("labels")}_updateLabelVisibility({visible:e,viewMode:t}){const i=this._segmentLabel,n=this._horizontalLabel,a=this._verticalLabel;if(i.visible=!1,n.visible=!1,a.visible=!1,e)switch(t){case M.Direct:i.visible=!0;break;case M.Triangle:i.visible=!0,n.visible=!0,a.visible=!0;break;case M.ProjectedGeodesic:i.visible=!0;case M.None:}}get _labelsText(){if(this.destroyed)return null;const e=this.messages,t=this.analysisView.result;if(Object(s.k)(t)||Object(s.k)(e))return null;const{directDistance:i,horizontalDistance:n,verticalDistance:a,geodesicDistance:r}=t,o=this.analysisView.unit,l=e=>({euclideanDistance:"",geodesicDistance:"",horizontalDistance:"",verticalDistance:"",...e});switch(o){case"metric":return l({euclideanDistance:i&&Object(T.g)(e,i),geodesicDistance:r&&Object(T.g)(e,r),horizontalDistance:n&&Object(T.g)(e,n),verticalDistance:a&&Object(T.h)(e,a)});case"imperial":return l({euclideanDistance:i&&Object(T.d)(e,i),geodesicDistance:r&&Object(T.d)(e,r),horizontalDistance:n&&Object(T.d)(e,n),verticalDistance:a&&Object(T.e)(e,a)});default:return l({euclideanDistance:i&&Object(T.c)(e,i,o),geodesicDistance:r&&Object(T.c)(e,r,o),horizontalDistance:n&&Object(T.c)(e,n,o),verticalDistance:a&&Object(T.c)(e,a,o)})}}_updateSegmentStripeLength(e){const t=this._segmentVisualElement;Object(s.l)(e)?(t.stripeLength=e,t.stripesEnabled=!0):t.stripesEnabled=!1}get _actualVisualElementsOrientation(){if(Object(s.l)(this._triangleOrientationOverride))return this._triangleOrientationOverride;const e=this.visualElementOrientation;return e===E.Auto?this.view.state.camera.aboveGround?E.AboveSegment:E.BelowSegment:e}_requiresGeodesicGuideAt(e){const t=this.view;if(null==t||!t.state)return!1;const i=t.state.camera,n=t.renderCoordsHelper,a=i.computeScreenPixelSizeAt(e);return n.getAltitude(e)/a>=10}get _measurementArrowStripeLength(){const{result:e,unit:t}=this.analysisView;if(Object(s.k)(e))return null;let i=null;const n=e.directDistance;switch(t){case"metric":i=n&&Object(b.g)(n,"meters");break;case"imperial":i=n&&Object(b.g)(n,Object(R.p)(n.value,n.unit));break;default:i=n&&Object(b.g)(n,t)}return Object(s.k)(i)?null:Object(x.n)(i.value/30)*Object(R.d)(1,i.unit,"meters")}_updateMessageBundle(){this.loadingMessages=!0,Object(Ee.a)("esri/core/t9n/Units").then((e=>{this.messages=e})).finally((()=>{this.loadingMessages=!1}))}get testData(){var e;return{labels:this.labels,stripeLength:null==(e=this._segmentVisualElement)?void 0:e.stripeLength}}};Object(n.a)([Object(r.b)()],Ce.prototype,"_triangleOrientationOverride",void 0),Object(n.a)([Object(r.b)()],Ce.prototype,"messages",void 0),Object(n.a)([Object(r.b)()],Ce.prototype,"view",void 0),Object(n.a)([Object(r.b)()],Ce.prototype,"analysis",void 0),Object(n.a)([Object(r.b)()],Ce.prototype,"analysisView",void 0),Object(n.a)([Object(r.b)()],Ce.prototype,"loadingMessages",void 0),Object(n.a)([Object(r.b)()],Ce.prototype,"visible",null),Object(n.a)([Object(r.b)()],Ce.prototype,"viewMode",null),Object(n.a)([Object(r.b)()],Ce.prototype,"actualVisualizedMeasurement",null),Object(n.a)([Object(r.b)()],Ce.prototype,"visualElementOrientation",void 0),Object(n.a)([Object(r.b)()],Ce.prototype,"triangleCollapseRatioThreshold",void 0),Object(n.a)([Object(r.b)()],Ce.prototype,"allowVisualElementsOrientationChange",null),Object(n.a)([Object(r.b)()],Ce.prototype,"labels",null),Object(n.a)([Object(r.b)()],Ce.prototype,"_labelsText",null),Object(n.a)([Object(r.b)()],Ce.prototype,"_actualVisualElementsOrientation",null),Object(n.a)([Object(r.b)()],Ce.prototype,"_measurementArrowStripeLength",null),Ce=Object(n.a)([Object(o.a)("esri.views.3d.analysis.DirectLineMeasurement.DirectLineMeasurementVisualization")],Ce);const Ve=Math.cos(Object(x.h)(12)),De=Object(G.e)(),xe=Object(G.e)(),Te=Object(G.d)(),Ge=Object(G.d)(),Re=Object(G.d)();let ke=class extends(Object(c.a)(a.a)){constructor(e){super(e),this.type="direct-line-measurement-view-3d",this.analysis=null,this.result=null,this.measurementMode=u.a.Auto,this.elevationAlignedStartPoint=null,this.elevationAlignedEndPoint=null}initialize(){const e=this.view,t=this.analysis;this._analysisVisualization=new Ce({view:e,analysis:t,analysisView:this}),this._analysisController=new L({view:e,analysis:t,viewData:this})}destroy(){this._analysisController=Object(s.e)(this._analysisController),this._analysisVisualization=Object(s.e)(this._analysisVisualization)}get updating(){var e;return!(null==(e=this._analysisVisualization)||!e.loadingMessages)}get viewMode(){return this._analysisVisualization.viewMode}get actualVisualizedMeasurement(){return this._analysisVisualization.actualVisualizedMeasurement}get visualElementOrientation(){return this._analysisVisualization.visualElementOrientation}set visualElementOrientation(e){this._analysisVisualization.visualElementOrientation=e}get allowVisualElementsOrientationChange(){return this._analysisVisualization.allowVisualElementsOrientationChange}set allowVisualElementsOrientationChange(e){this._analysisVisualization.allowVisualElementsOrientationChange=e}get triangleCollapseRatioThreshold(){return this._analysisVisualization.triangleCollapseRatioThreshold}set triangleCollapseRatioThreshold(e){this._analysisVisualization.triangleCollapseRatioThreshold=e}get directLabelText(){return this._analysisVisualization.labels.direct.text}get horizontalLabelText(){return this._analysisVisualization.labels.horizontal.text}get verticalLabelText(){return this._analysisVisualization.labels.vertical.text}get unit(){return Object(s.u)(this.analysis.unit,this._defaultUnit)}get testData(){var e;return this.destroyed?{labels:null,stripeLength:null,visualization:null,controller:null}:{...null==(e=this._analysisVisualization)?void 0:e.testData,visualization:this._analysisVisualization,controller:this._analysisController}}};Object(n.a)([Object(r.b)()],ke.prototype,"updating",null),Object(n.a)([Object(r.b)({readOnly:!0})],ke.prototype,"type",void 0),Object(n.a)([Object(r.b)({constructOnly:!0,nonNullable:!0})],ke.prototype,"analysis",void 0),Object(n.a)([Object(r.b)()],ke.prototype,"result",void 0),Object(n.a)([Object(r.b)()],ke.prototype,"measurementMode",void 0),Object(n.a)([Object(r.b)()],ke.prototype,"elevationAlignedStartPoint",void 0),Object(n.a)([Object(r.b)()],ke.prototype,"elevationAlignedEndPoint",void 0),Object(n.a)([Object(r.b)({readOnly:!0})],ke.prototype,"viewMode",null),Object(n.a)([Object(r.b)({readOnly:!0})],ke.prototype,"actualVisualizedMeasurement",null),Object(n.a)([Object(r.b)()],ke.prototype,"visualElementOrientation",null),Object(n.a)([Object(r.b)()],ke.prototype,"allowVisualElementsOrientationChange",null),Object(n.a)([Object(r.b)()],ke.prototype,"triangleCollapseRatioThreshold",null),Object(n.a)([Object(r.b)({readOnly:!0})],ke.prototype,"directLabelText",null),Object(n.a)([Object(r.b)({readOnly:!0})],ke.prototype,"horizontalLabelText",null),Object(n.a)([Object(r.b)({readOnly:!0})],ke.prototype,"verticalLabelText",null),Object(n.a)([Object(r.b)()],ke.prototype,"_analysisVisualization",void 0),Object(n.a)([Object(r.b)()],ke.prototype,"_analysisController",void 0),Object(n.a)([Object(r.b)()],ke.prototype,"unit",null),Object(n.a)([Object(r.b)(l.a)],ke.prototype,"_defaultUnit",void 0),ke=Object(n.a)([Object(o.a)("esri.views.3d.analysis.DirectLineMeasurementAnalysisView3D")],ke);const Ne=ke}}]);
//# sourceMappingURL=80.5406ae7e.chunk.js.map