(this["webpackJsonppopulation-arcgis"]=this["webpackJsonppopulation-arcgis"]||[]).push([[197],{1067:function(e,t,i){"use strict";i.r(t),i.d(t,"previewCIMSymbol",(function(){return d}));var n=i(31),l=i(1293),o=i(1500),a=i(247),r=i(223),s=i(488);const c=new o.CIMSymbolRasterizer(null,!0),h=Object(n.i)(r.a.size),u=Object(n.i)(r.a.maxSize),y=Object(n.i)(r.a.lineWidth);async function d(e,t={}){var i,r;const{node:d,opacity:m,symbolConfig:g}=t,p="object"==typeof g&&"isSquareFill"in g&&g.isSquareFill,f=t.cimOptions||t,w=f.geometryType||Object(a.z)(null==(i=e)||null==(r=i.data)?void 0:r.symbol),b=function(e){const t=null==e?void 0:e.size;return"number"==typeof t?{width:t,height:t}:{width:null!=t&&"object"==typeof t&&"width"in t?t.width:null,height:null!=t&&"object"==typeof t&&"height"in t?t.height:null}}(t),{feature:v,fieldMap:j}=f;if(null==b.width||null==b.height){const t=await l.b.resolveSymbolOverrides(e.data,v,null,j,w);if(!t)return null;(e=e.clone()).data={type:"CIMSymbolReference",symbol:t},e.data.primitiveOverrides=null;const i=[];l.a.fetchResources(t,c.resourceManager,i),i.length>0&&await Promise.all(i);const{width:n,height:o}=l.a.getEnvelope(t,null,c.resourceManager);b.width="esriGeometryPolygon"===w?h:"esriGeometryPolyline"===w?y:null!=n&&isFinite(n)?Math.min(n,u):h,b.height="esriGeometryPolygon"===w?h:null!=o&&isFinite(o)?Math.max(Math.min(o,u),1):h}const M=await c.rasterizeCIMSymbolAsync(e,v,b,p||"esriGeometryPolygon"!==w?o.GeometryStyle.Preview:o.GeometryStyle.Legend,j,w);if(!M)return null;const{width:O,height:S}=M,C=document.createElement("canvas");C.width=O,C.height=S,C.getContext("2d").putImageData(M,0,0);const z=Object(n.h)(b.width),G=Object(n.h)(b.height),I=new Image(z,G);I.src=C.toDataURL(),null!=m&&(I.style.opacity=`${m}`);let P=I;if(null!=t.effectView){const e={shape:{type:"image",x:0,y:0,width:z,height:G,src:I.src},fill:null,stroke:null,offset:[0,0]};P=Object(s.a)([[e]],[z,G],{effectView:t.effectView})}return d&&P&&d.appendChild(P),P}}}]);
//# sourceMappingURL=197.022f1ebe.chunk.js.map