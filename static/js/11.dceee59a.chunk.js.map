{"version":3,"sources":["../node_modules/@arcgis/core/views/layers/LayerView.js","../node_modules/@arcgis/core/views/3d/layers/LayerView3D.js","../node_modules/@arcgis/core/views/layers/RefreshableLayerView.js","../node_modules/@arcgis/core/views/3d/layers/support/projectExtentUtils.js","../node_modules/@arcgis/core/chunks/ImageMaterial.glsl.js","../node_modules/@arcgis/core/views/3d/webgl-engine/shaders/ImageMaterialTechnique.js","../node_modules/@arcgis/core/views/3d/webgl-engine/materials/ImageMaterial.js","../node_modules/@arcgis/core/views/3d/layers/support/overlayImageUtils.js","../node_modules/@arcgis/core/views/3d/layers/DynamicLayerView3D.js"],"names":["d","s","i","l","r","EventedMixin","t","constructor","e","super","this","layer","parent","initialize","when","catch","name","id","title","o","getLogger","declaredClass","error","fullOpacity","n","get","suspended","canResume","suspendInfo","getSuspendInfo","legendEnabled","updating","updatingHandles","isUpdating","updatingProgress","visible","_overrideIfSome","loaded","view","ready","viewNotReady","layerNotLoaded","layerInvisible","a","prototype","readOnly","type","Boolean","p","u","c","arguments","slicePlaneEnabled","supportsHeightUnitConversion","postscript","addResolvingPromise","_validateHeightModelInfo","async","AbortController","signal","handles","add","abort","defaultsFromMap","heightModelInfoReady","heightModelInfo","effectiveScaleRange","minScale","maxScale","outsideScaleRange","doRefresh","dataChanged","spatialReference","fullExtent","Promise","resolve","equals","clone","state","isLocal","portalItem","then","destroyed","f","w","vertex","h","fragment","b","include","attributes","v","POSITION","UV0","varyings","hasMultipassTerrain","uniforms","texture","descriptor","textureCoordinateScaleFactor","code","g","opacity","output","Alpha","float","transparencyPassType","m","Color","Object","freeze","defineProperty","__proto__","build","Symbol","toStringTag","value","N","_","initializeProgram","rctx","shader","configuration","_setPipelineState","y","NONE","FrontFace","j","blending","transparent","C","culling","O","cullFace","depthTest","func","depthWrite","writeDepth","S","colorWrite","stencilWrite","hasOccludees","stencilTest","polygonOffset","enableOffset","initializePipeline","_occludeePipelineState","getPipelineState","P","T","ONE","ONE_MINUS_SRC_ALPHA","None","hasSlicePlane","cullAboveGround","count","COUNT","supportsEdges","_configuration","getConfiguration","parameters","camera","relativeElevation","multipassTerrain","enabled","intersect","requiresSlot","Highlight","DRAPED_MATERIAL","OPAQUE_MATERIAL","TRANSPARENT_MATERIAL","TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL","createGLMaterial","createBufferWriter","material","_updateParameters","updateTexture","_material","textureId","setParameters","textureBindParameters","ensureTechnique","_updateOccludeeState","beginSlot","_output","initTextureTransparent","z","H","E","U","drapeSourceType","RasterImage","updatePolicy","M","SYNC","fullExtentInLocalViewSpatialReference","maximumDataResolution","_images","Array","_extents","_overlays","updateWhenStationary","_drapeSourceRenderer","refreshDebounced","_doRefresh","basemapTerrain","overlayManager","registerGeometryDrapeSource","unregisterDrapeSource","_set","_suspendedChangeHandler","resourceController","scheduler","registerIdleStateCallbacks","_isScaleRangeActive","notifyChange","_isScaleRangeLayer","destroy","clear","setDrapingExtent","_spatialReference","forEach","index","_updateImageExtent","_clippedExtent","extent","q","width","height","Math","round","resolution","pixelRatio","imageMaxWidth","imageMaxHeight","floor","_imageSizeEquals","imageSize","_fetch","length","_clearImage","push","scale","some","loadingPromise","HTMLImageElement","HTMLCanvasElement","image","findExtentInfoAt","contains","getFetchOptions","_createStageObjects","x","R","abs","D","TESTS_DISABLE_OPTIMIZATIONS","renderGeometry","loadingAbortController","pixelData","renderExtent","_waitFetchReady","requestAsImageElement","fetchImage","warnOnce","processResult","finally","aborted","removeGeometries","UPDATE","_stage","remove","preMultiplyAlpha","wrap","V","CLAMP_TO_EDGE","L","INNER","OUTER","I","min","max","Float64Array","Float32Array","A","size","data","exclusive","NORMAL","loadImmediate","G","origin","renderLocalOrigin","addGeometries","viewingMode","stationary","F"],"mappings":"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","file":"static/js/11.dceee59a.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import t from\"../../core/Accessor.js\";import r from\"../../core/Evented.js\";import{HandleOwnerMixin as s}from\"../../core/HandleOwner.js\";import{IdentifiableMixin as i}from\"../../core/Identifiable.js\";import o from\"../../core/Logger.js\";import{unwrapOr as n}from\"../../core/maybe.js\";import{EsriPromiseMixin as l}from\"../../core/Promise.js\";import{property as a}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as p}from\"../../core/accessorSupport/decorators/subclass.js\";let d=class extends(s(i(l(r.EventedMixin(t))))){constructor(e){super(e),this.layer=null,this.parent=null}initialize(){this.when().catch((e=>{if(\"layerview:create-error\"!==e.name){const t=this.layer&&this.layer.id||\"no id\",r=this.layer&&this.layer.title||\"no title\";o.getLogger(this.declaredClass).error(\"#resolve()\",`Failed to resolve layer view (layer title: '${r}', id: '${t}')`,e)}}))}get fullOpacity(){return n(this.get(\"layer.opacity\"),1)*n(this.get(\"parent.fullOpacity\"),1)}get suspended(){return!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){return!this.suspended&&!0===this.layer?.legendEnabled}get updating(){return!(!this.updatingHandles?.updating&&!this.isUpdating())}get updatingProgress(){return this.updating?0:1}get visible(){return!0===this.layer?.visible}set visible(e){this._overrideIfSome(\"visible\",e)}canResume(){return this.visible&&this.layer?.loaded&&!this.parent?.suspended&&this.view?.ready||!1}getSuspendInfo(){const e=this.parent&&this.parent.suspended?this.parent.suspendInfo:{},t=this;return t.view&&t.view.ready||(e.viewNotReady=!0),this.layer&&this.layer.loaded||(e.layerNotLoaded=!0),this.visible||(e.layerInvisible=!0),e}isUpdating(){return!1}};e([a()],d.prototype,\"fullOpacity\",null),e([a()],d.prototype,\"layer\",void 0),e([a()],d.prototype,\"parent\",void 0),e([a({readOnly:!0})],d.prototype,\"suspended\",null),e([a({readOnly:!0})],d.prototype,\"suspendInfo\",null),e([a({readOnly:!0})],d.prototype,\"legendEnabled\",null),e([a({type:Boolean,readOnly:!0})],d.prototype,\"updating\",null),e([a({readOnly:!0})],d.prototype,\"updatingProgress\",null),e([a()],d.prototype,\"visible\",null),e([a()],d.prototype,\"view\",void 0),d=e([p(\"esri.views.layers.LayerView\")],d);const u=d;export{u as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import{makeHandle as s}from\"../../../core/handleUtils.js\";import{throwIfAborted as t}from\"../../../core/promiseUtils.js\";import{whenOnce as r}from\"../../../core/reactiveUtils.js\";import{property as o}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as i}from\"../../../core/accessorSupport/decorators/subclass.js\";import{supportsHeightModelInfo as a,rejectLayerError as l}from\"../../../geometry/support/heightModelInfoUtils.js\";const n=n=>{let c=class extends n{constructor(){super(...arguments),this.slicePlaneEnabled=!1,this.supportsHeightUnitConversion=!1}postscript(e){super.postscript(e),a(this.layer)&&this.addResolvingPromise(this._validateHeightModelInfo())}async _validateHeightModelInfo(){const e=new AbortController,o=e.signal;this.handles.add(s((()=>e.abort()))),await r((()=>this.view.defaultsFromMap?.heightModelInfoReady),o),t(o);const i=l(this.layer,this.view.heightModelInfo,this.supportsHeightUnitConversion);if(i)throw i}canResume(){const e=this.layer&&\"effectiveScaleRange\"in this.layer?this.layer.effectiveScaleRange:null;return super.canResume()&&(!e||!e.minScale||!e.maxScale||e.minScale>=e.maxScale)}getSuspendInfo(){const e=super.getSuspendInfo(),s=this.layer&&\"effectiveScaleRange\"in this.layer?this.layer.effectiveScaleRange:null;return s&&s.minScale&&s.maxScale&&s.minScale<s.maxScale&&(e.outsideScaleRange=!0),e}};return e([o()],c.prototype,\"view\",void 0),e([o()],c.prototype,\"slicePlaneEnabled\",void 0),c=e([i(\"esri.views.3d.layers.LayerView3D\")],c),c};export{n as LayerView3D};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../chunks/tslib.es6.js\";import e from\"../../core/Logger.js\";import{isAbortError as s}from\"../../core/promiseUtils.js\";import{on as o}from\"../../core/reactiveUtils.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as a}from\"../../core/accessorSupport/decorators/subclass.js\";const i=i=>{let c=class extends i{initialize(){this.handles.add(o((()=>this.layer),\"refresh\",(r=>{this.doRefresh(r.dataChanged).catch((r=>{s(r)||e.getLogger(this.declaredClass).error(r)}))})),\"RefreshableLayerView\")}};return r([t()],c.prototype,\"layer\",void 0),c=r([a(\"esri.layers.mixins.RefreshableLayerView\")],c),c};export{i as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{isSome as e,isNone as r}from\"../../../../core/maybe.js\";import{project as o}from\"../../../../geometry/support/webMercatorUtils.js\";import{projectGeometry as t}from\"../../../../portal/support/geometryServiceUtils.js\";function l(l){const s=l.view.spatialReference,i=l.layer.fullExtent,n=e(i)&&i.spatialReference;if(r(i)||!n)return Promise.resolve(null);if(n.equals(s))return Promise.resolve(i.clone());const a=o(i,s);return e(a)?Promise.resolve(a):l.view.state.isLocal?t(i,s,l.layer.portalItem).then((e=>!l.destroyed&&e?e:void 0)).catch((()=>null)):Promise.resolve(null)}export{l as toViewIfLocal};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../core/maybe.js\";import{O as r}from\"./vec2f64.js\";import{ShaderOutput as o}from\"../views/3d/webgl-engine/core/shaderLibrary/ShaderOutput.js\";import{SliceDraw as i}from\"../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js\";import{Transform as a}from\"../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl.js\";import{multipassTerrainTest as t}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";import{defaultMaskAlphaCutoff as s}from\"../views/3d/webgl-engine/core/shaderLibrary/util/AlphaCutoff.js\";import{ColorConversion as d}from\"../views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl.js\";import{addProjViewLocalOrigin as l}from\"../views/3d/webgl-engine/core/shaderLibrary/util/View.glsl.js\";import{Float2PassUniform as n}from\"../views/3d/webgl-engine/core/shaderModules/Float2PassUniform.js\";import{FloatPassUniform as g}from\"../views/3d/webgl-engine/core/shaderModules/FloatPassUniform.js\";import{glsl as p}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as c}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";import{Texture2DPassUniform as u}from\"../views/3d/webgl-engine/core/shaderModules/Texture2DPassUniform.js\";import{TransparencyPassType as m}from\"../views/3d/webgl-engine/lib/TransparencyPassType.js\";import{VertexAttribute as v}from\"../views/3d/webgl-engine/lib/VertexAttribute.js\";function f(f){const w=new c,{vertex:h,fragment:b}=w;return l(h,f),w.include(a,f),w.attributes.add(v.POSITION,\"vec3\"),w.attributes.add(v.UV0,\"vec2\"),w.varyings.add(\"vpos\",\"vec3\"),f.hasMultipassTerrain&&w.varyings.add(\"depth\",\"float\"),h.uniforms.add(new n(\"textureCoordinateScaleFactor\",(o=>e(o.texture)&&e(o.texture.descriptor.textureCoordinateScaleFactor)?o.texture.descriptor.textureCoordinateScaleFactor:r))),h.code.add(p`\n    void main(void) {\n      vpos = position;\n      ${f.hasMultipassTerrain?\"depth = (view * vec4(vpos, 1.0)).z;\":\"\"}\n      vTexCoord = uv0 * textureCoordinateScaleFactor;\n      gl_Position = transformPosition(proj, view, vpos);\n    }\n  `),w.include(i,f),w.include(t,f),b.uniforms.add([new u(\"tex\",(e=>e.texture)),new g(\"opacity\",(e=>e.opacity))]),w.varyings.add(\"vTexCoord\",\"vec2\"),f.output===o.Alpha?b.code.add(p`\n    void main() {\n      discardBySlice(vpos);\n      ${f.hasMultipassTerrain?\"terrainDepthTest(gl_FragCoord, depth);\":\"\"}\n\n      float alpha = texture2D(tex, vTexCoord).a * opacity;\n      if (alpha  < ${p.float(s)}) {\n        discard;\n      }\n\n      gl_FragColor = vec4(alpha);\n    }\n    `):(b.include(d),b.code.add(p`\n    void main() {\n      discardBySlice(vpos);\n      ${f.hasMultipassTerrain?\"terrainDepthTest(gl_FragCoord, depth);\":\"\"}\n      gl_FragColor = texture2D(tex, vTexCoord) * opacity;\n\n      if (gl_FragColor.a < ${p.float(s)}) {\n        discard;\n      }\n\n      gl_FragColor = highlightSlice(gl_FragColor, vpos);\n      ${f.transparencyPassType===m.Color?\"gl_FragColor = premultiplyAlpha(gl_FragColor);\":\"\"}\n    }\n    `)),w}const w=Object.freeze(Object.defineProperty({__proto__:null,build:f},Symbol.toStringTag,{value:\"Module\"}));export{w as I,f as b};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import{ShaderOutput as t}from\"../core/shaderLibrary/ShaderOutput.js\";import{NoParameters as r}from\"../core/shaderModules/interfaces.js\";import{ReloadableShaderModule as i}from\"../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as s}from\"../core/shaderTechnique/ShaderTechnique.js\";import{parameter as o}from\"../core/shaderTechnique/ShaderTechniqueConfiguration.js\";import{CullFaceOptions as a}from\"../lib/basicInterfaces.js\";import{Default3D as n}from\"../lib/DefaultVertexAttributeLocations.js\";import{oitBlending as l,oitDepthTest as p,oitDepthWrite as c,getOITPolygonOffset as u}from\"../lib/OrderIndependentTransparency.js\";import{Program as h}from\"../lib/Program.js\";import{stencilWriteMaskOn as d,stencilToolMaskBaseParams as m,stencilBaseAllZerosParams as f}from\"../lib/StencilUtils.js\";import{TransparencyPassType as y}from\"../lib/TransparencyPassType.js\";import{DefaultTechniqueConfiguration as b}from\"../materials/DefaultTechniqueConfiguration.js\";import{I as g}from\"../../../../chunks/ImageMaterial.glsl.js\";import{BlendFactor as T}from\"../../../webgl/enums.js\";import{simpleBlendingParams as P,makePipelineState as j,cullingParams as O,defaultDepthWriteParams as S,defaultColorWriteParams as v}from\"../../../webgl/renderState.js\";class N extends r{}class _ extends s{initializeProgram(e){return new h(e.rctx,_.shader.get().build(this.configuration),n)}_setPipelineState(e,r){const i=this.configuration,s=e===y.NONE,o=e===y.FrontFace;return j({blending:i.output!==t.Color&&i.output!==t.Alpha||!i.transparent?null:s?C:l(e),culling:O(i.cullFace),depthTest:{func:p(e)},depthWrite:s?i.writeDepth&&S:c(e),colorWrite:v,stencilWrite:i.hasOccludees?d:null,stencilTest:i.hasOccludees?r?m:f:null,polygonOffset:s||o?null:u(i.enableOffset)})}initializePipeline(){return this._occludeePipelineState=this._setPipelineState(this.configuration.transparencyPassType,!0),this._setPipelineState(this.configuration.transparencyPassType,!1)}getPipelineState(e,t){return t?this._occludeePipelineState:super.getPipelineState(e,t)}}_.shader=new i(g,(()=>import(\"./ImageMaterial.glsl.js\")));const C=P(T.ONE,T.ONE_MINUS_SRC_ALPHA);class w extends b{constructor(){super(...arguments),this.output=t.Color,this.cullFace=a.None,this.hasSlicePlane=!1,this.transparent=!1,this.enableOffset=!0,this.writeDepth=!0,this.hasOccludees=!1,this.transparencyPassType=y.NONE,this.hasMultipassTerrain=!1,this.cullAboveGround=!1}}e([o({count:t.COUNT})],w.prototype,\"output\",void 0),e([o({count:a.COUNT})],w.prototype,\"cullFace\",void 0),e([o()],w.prototype,\"hasSlicePlane\",void 0),e([o()],w.prototype,\"transparent\",void 0),e([o()],w.prototype,\"enableOffset\",void 0),e([o()],w.prototype,\"writeDepth\",void 0),e([o()],w.prototype,\"hasOccludees\",void 0),e([o({count:y.COUNT})],w.prototype,\"transparencyPassType\",void 0),e([o()],w.prototype,\"hasMultipassTerrain\",void 0),e([o()],w.prototype,\"cullAboveGround\",void 0);export{N as ImageMaterialPassParameters,_ as ImageMaterialTechnique,w as ImageMaterialTechniqueConfiguration};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{ShaderOutput as e}from\"../core/shaderLibrary/ShaderOutput.js\";import{CullFaceOptions as t}from\"../lib/basicInterfaces.js\";import{GLTextureMaterial as r}from\"../lib/GLTextureMaterial.js\";import{Material as a,MaterialParameters as s}from\"../lib/Material.js\";import{OITPolygonOffsetLimit as i}from\"../lib/OrderIndependentTransparency.js\";import{RenderSlot as n}from\"../lib/RenderSlot.js\";import{DefaultBufferWriter as u,PositionUVLayout as o}from\"./internal/DefaultBufferWriter.js\";import{intersectTriangleGeometry as h}from\"./internal/MaterialUtil.js\";import{ImageMaterialTechniqueConfiguration as l,ImageMaterialTechnique as c}from\"../shaders/ImageMaterialTechnique.js\";class p extends a{constructor(e){super(e,new d),this.supportsEdges=!0,this._configuration=new l}getConfiguration(e,t){return this._configuration.output=e,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this.parameters.transparent,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.hasOccludees=this.parameters.hasOccludees,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.enableOffset=t.camera.relativeElevation<i,this._configuration.hasMultipassTerrain=t.multipassTerrain.enabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration}intersect(e,t,r,a,s,i,n){h(e,t,a,s,i,void 0,n)}requiresSlot(t,r){if(r===e.Color||r===e.Alpha||r===e.Highlight){if(t===n.DRAPED_MATERIAL)return!0;if(r===e.Highlight)return t===n.OPAQUE_MATERIAL;return t===(this.parameters.transparent?this.parameters.writeDepth?n.TRANSPARENT_MATERIAL:n.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL:n.OPAQUE_MATERIAL)}return!1}createGLMaterial(e){return new m(e)}createBufferWriter(){return new u(o)}}class m extends r{constructor(e){super({...e,...e.material.parameters})}_updateParameters(e){return this.updateTexture(this._material.parameters.textureId),this._material.setParameters(this.textureBindParameters),this.ensureTechnique(c,e)}_updateOccludeeState(e){e.hasOccludees!==this._material.parameters.hasOccludees&&(this._material.setParameters({hasOccludees:e.hasOccludees}),this._updateParameters(e))}beginSlot(t){return this._output!==e.Color&&this._output!==e.Alpha||this._updateOccludeeState(t),this._updateParameters(t)}}class d extends s{constructor(){super(...arguments),this.transparent=!1,this.writeDepth=!0,this.hasSlicePlane=!1,this.cullFace=t.None,this.hasOccludees=!1,this.opacity=1,this.textureId=null,this.initTextureTransparent=!0}}export{p as ImageMaterial,d as Parameters};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{width as t,height as e,intersects as n}from\"../../../../geometry/support/aaBoundingRect.js\";import{Geometry as i}from\"../../webgl-engine/lib/Geometry.js\";import{createSquareGeometry as r}from\"../../webgl-engine/lib/GeometryUtil.js\";import{VertexAttribute as o}from\"../../webgl-engine/lib/VertexAttribute.js\";function a(n,i,r){const o=t(n)/e(n),a={width:r,height:r};return o>1.0001?a.height=r/o:o<.9999&&(a.width=r*o),a.width=Math.round(a.width/(t(n)/t(i))),a.height=Math.round(a.height/(e(n)/e(i))),a}function h(t){return r([[t[0],t[1],-1],[t[2],t[1],-1],[t[2],t[3],-1],[t[0],t[3],-1]])}function l(t,e){if(!n(t,e))return h(e);const r=[t[1]-e[1],Math.min(t[3],e[3])-Math.max(t[1],e[1]),e[3]-t[3],123456],a=[t[0]-e[0],Math.min(t[2],e[2])-Math.max(t[0],e[0]),e[2]-t[2],123456],l=e[2]-e[0],u=e[3]-e[1],m=a[0]>0&&a[2]>0?3:2,c=r[0]>0&&r[2]>0?3:2,g=(c+1)*(m+1),w=new Float64Array(3*g),f=new Float32Array(2*g),d=new Array(6*(c*m-1));let M=0,b=0,p=0,x=0,y=0;for(let n=0;n<4;n++){const t=r[n];if(t<=0)continue;let i=0;for(let r=0;r<4;r++){const t=a[r];t<=0||(w[b++]=e[0]+i,w[b++]=e[1]+M,w[b++]=-1,f[p++]=i/l,f[p++]=M/u,r<3&&n<3&&(1!==r||1!==n)&&(d[y++]=x,d[y++]=x+1,d[y++]=x+m+1,d[y++]=x+1,d[y++]=x+m+2,d[y++]=x+m+1),x++,i+=t)}M+=t}const A=new Array(d.length);return new i([[o.POSITION,{size:3,data:w,exclusive:!0}],[o.NORMAL,{size:3,data:s,exclusive:!0}],[o.UV0,{size:2,data:f,exclusive:!0}]],[[o.POSITION,d],[o.NORMAL,A],[o.UV0,d]])}const s=[0,0,1];export{a as computeImageExportSize,h as createGeometryForExtent,l as createOuterImageGeometry};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import{forEach as t,result as r}from\"../../../core/asyncUtils.js\";import{makeHandle as i}from\"../../../core/handleUtils.js\";import s from\"../../../core/Logger.js\";import{isNone as a,isSome as n}from\"../../../core/maybe.js\";import{debounce as o,isAbortError as l,eachAlways as h,onAbort as d,isAborted as m,createAbortError as c,throwIfAborted as g}from\"../../../core/promiseUtils.js\";import{whenOnce as u}from\"../../../core/reactiveUtils.js\";import{property as p}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as f}from\"../../../core/accessorSupport/decorators/subclass.js\";import y from\"../../../geometry/Extent.js\";import{equals as _,create as w,width as x,height as R,copy as v,intersection as b}from\"../../../geometry/support/aaBoundingRect.js\";import{DrapeSourceType as S}from\"./interfaces.js\";import{LayerView3D as E}from\"./LayerView3D.js\";import{computeImageExportSize as j,createGeometryForExtent as I,createOuterImageGeometry as A}from\"./support/overlayImageUtils.js\";import{toViewIfLocal as C}from\"./support/projectExtentUtils.js\";import D from\"../support/debugFlags.js\";import{OverlayIndex as L}from\"../terrain/interfaces.js\";import{UpdatePolicy as M}from\"../webgl-engine/lib/basicInterfaces.js\";import{DirtyOperation as T}from\"../webgl-engine/lib/ModelDirtyTypes.js\";import{RenderGeometry as G}from\"../webgl-engine/lib/RenderGeometry.js\";import{Texture as P}from\"../webgl-engine/lib/Texture.js\";import{ImageMaterial as O}from\"../webgl-engine/materials/ImageMaterial.js\";import U from\"../../layers/LayerView.js\";import H from\"../../layers/RefreshableLayerView.js\";import{isScaleRangeActive as N}from\"../../support/layerViewUtils.js\";import{TextureWrapMode as V}from\"../../webgl/enums.js\";let z=class extends(H(E(U))){constructor(){super(...arguments),this.drapeSourceType=S.RasterImage,this.updatePolicy=M.SYNC,this.fullExtentInLocalViewSpatialReference=null,this.maximumDataResolution=null,this._images=new Array,this._extents=new Array,this._overlays=new Array,this.updateWhenStationary=!0,this._drapeSourceRenderer=null,this.refreshDebounced=o((async e=>{this.destroyed||await this._doRefresh(e).catch((e=>{l(e)||s.getLogger(this.declaredClass).error(e)}))}),2e3)}initialize(){this._drapeSourceRenderer=this.view.basemapTerrain.overlayManager.registerGeometryDrapeSource(this),this.handles.add(i((()=>this.view.basemapTerrain.overlayManager.unregisterDrapeSource(this)))),this.addResolvingPromise(C(this).then((e=>this._set(\"fullExtentInLocalViewSpatialReference\",e)))),this.updatingHandles.add((()=>this.suspended),(()=>this._suspendedChangeHandler())),this.handles.add(this.view.resourceController.scheduler.registerIdleStateCallbacks((()=>{this._isScaleRangeActive()&&this.notifyChange(\"suspended\")}),(()=>{}))),this._isScaleRangeLayer()&&this.updatingHandles.add((()=>this.layer.effectiveScaleRange),(()=>this.notifyChange(\"suspended\")))}destroy(){this.clear()}setDrapingExtent(e,t){this._spatialReference=t,e.forEach((e=>{this._overlays[e.index]=e,this._updateImageExtent(e)}))}_updateImageExtent(e){const t=this._clippedExtent(e.extent,q);if(a(t))return;const r=j(e.extent,t,e.resolution);let i=e.pixelRatio*this.view.state.pixelRatio;if(\"imageMaxWidth\"in this.layer||\"imageMaxHeight\"in this.layer){const e=this.layer.imageMaxWidth,t=this.layer.imageMaxHeight;if(r.width>e){const t=e/r.width;r.height=Math.floor(r.height*t),r.width=e,i*=t}if(r.height>t){const e=t/r.height;r.width=Math.floor(r.width*e),r.height=t,i*=e}}const n=this._extents[e.index];n&&_(n.extent,t)&&this._imageSizeEquals(t,n.imageSize,r)||(this._extents[e.index]={extent:w(t),imageSize:r,pixelRatio:i},this.suspended||this._fetch(e.index).catch((e=>{l(e)||s.getLogger(this.declaredClass).error(e)})))}clear(){for(let e=0;e<this._images.length;e++)this._clearImage(e)}async doRefresh(){return this._doRefresh()}async _doRefresh(e){if(this.suspended)return;const t=[];for(let r=0;r<this._extents.length;r++)this._extents[r]&&t.push(this._fetch(r,e));await h(t)}canResume(){if(!super.canResume())return!1;const e=this.layer;if(this._isScaleRangeActive()){const{minScale:t,maxScale:r}=e.effectiveScaleRange,i=this.view.scale;if(i<r||t>0&&i>t)return!1}return!0}isUpdating(){return this._images.some((e=>!!e.loadingPromise))}async processResult(e,t,r){(t instanceof HTMLImageElement||t instanceof HTMLCanvasElement)&&(e.image=t)}findExtentInfoAt(e){for(const t of this._extents){const r=t.extent;if(new y(r[0],r[1],r[2],r[3],this._spatialReference).contains(e))return t}return null}getFetchOptions(){}async redraw(e,r){await t(this._images,(async(t,i)=>{t&&(await e(t,r),await this._createStageObjects(i,t.image,r))}))}_imageSizeEquals(e,t,r){if(!this.maximumDataResolution)return!1;const i=x(e)/this.maximumDataResolution.x,s=R(e)/this.maximumDataResolution.y,a=i/t.width,n=s/t.height,o=i/r.width,l=s/r.height,h=Math.abs(a-o),d=Math.abs(n-l),m=D.TESTS_DISABLE_OPTIMIZATIONS?0:1.5;return h<=m&&d<=m}async _fetch(e,t){if(this.suspended)return;const r=this._extents[e],i=r.extent;this._images[e]||(this._images[e]={texture:null,material:null,renderGeometry:null,loadingPromise:null,loadingAbortController:null,image:null,pixelData:null,renderExtent:w(i)});const a=this._images[e];a.loadingAbortController&&(a.loadingAbortController.abort(),a.loadingAbortController=null);const n=new y(i[0],i[1],i[2],i[3],this._spatialReference);if(0===n.width||0===n.height)return void this._clearImage(e);const o=new AbortController;a.loadingAbortController=o,d(t,(()=>o.abort()));const h=o.signal,g=this._waitFetchReady(h).then((async()=>{const t={requestAsImageElement:!0,pixelRatio:this._overlays[e].pixelRatio,...this.getFetchOptions(),signal:h},{height:i,width:s}=r.imageSize;return this.layer.fetchImage(n,s,i,t)})).then((e=>{if(m(h))throw s.getLogger(this.declaredClass).warnOnce(\"A call to fetchImage resolved even though the request was aborted. fetchImage should not resolve if options.signal.aborted is true.\"),c();return this.processResult(a,e)})).then((()=>{v(a.renderExtent,i)})).finally((()=>{g===a.loadingPromise&&(a.loadingPromise=null,a.loadingAbortController=null)}));a.loadingPromise=g,this.notifyChange(\"updating\"),await g.then((async()=>{if(h.aborted)throw c();await this._createStageObjects(e,a.image,h),this.notifyChange(\"updating\")})).catch((e=>{throw e&&!l(e)&&s.getLogger(this.declaredClass).error(e),this.notifyChange(\"updating\"),e}))}_clearImage(e){const t=this._images[e];if(t){n(t.renderGeometry)&&(this._drapeSourceRenderer.removeGeometries([t.renderGeometry],T.UPDATE),t.renderGeometry=null);const e=this.view._stage;e.remove(t.texture),t.texture=null,e.remove(t.material),t.material=null,t.loadingAbortController&&(t.loadingAbortController.abort(),t.loadingAbortController=null),t.loadingPromise=null,t.image=null,t.pixelData=null}}async _createStageObjects(e,t,i){const s=this.view._stage,o=this._images[e],l=()=>{s.remove(o.texture),o.texture=null,n(o.renderGeometry)&&(this._drapeSourceRenderer.removeGeometries([o.renderGeometry],T.UPDATE),o.renderGeometry=null)};if(t){const n=new P(t,{width:t.width,height:t.height,preMultiplyAlpha:!0,wrap:{s:V.CLAMP_TO_EDGE,t:V.CLAMP_TO_EDGE}});let h;if(await r(this._images[e===L.INNER?L.OUTER:L.INNER].loadingPromise),g(i),e===L.INNER)h=I(o.renderExtent);else{const e=this._images[0].renderExtent;if(!e)return void l();h=A(e,o.renderExtent)}l(),s.add(n),await s.loadImmediate(n),o.texture=n,a(o.material)?(o.material=new O({transparent:!0,textureId:n.id}),s.add(o.material)):o.material.setParameters({textureId:n.id}),o.renderGeometry=new G(h,o.material),o.renderGeometry.origin=this._overlays[e].renderLocalOrigin,this._drapeSourceRenderer.addGeometries([o.renderGeometry],T.UPDATE)}else l(),s.remove(o.material),o.material=null}_isScaleRangeLayer(){return\"effectiveScaleRange\"in this.layer}_isScaleRangeActive(){const e=this.layer;if(!this._isScaleRangeLayer())return!1;const{minScale:t,maxScale:r}=e.effectiveScaleRange;return N(t,r)}_clippedExtent(e,t){if(\"local\"!==this.view.viewingMode)return v(t,e);const r=this.view.basemapTerrain;return r.ready?b(e,r.extent,t):v(t,e)}_suspendedChangeHandler(){this.suspended?this.clear():this.refreshDebounced()}async _waitFetchReady(e){await u((()=>this.view.stationary),e),g(e)}};e([p()],z.prototype,\"layer\",void 0),e([p()],z.prototype,\"suspended\",void 0),e([p({readOnly:!0})],z.prototype,\"fullExtentInLocalViewSpatialReference\",void 0),e([p()],z.prototype,\"updating\",void 0),z=e([f(\"esri.views.3d.layers.DynamicLayerView3D\")],z);const F=z,q=w();export{F as default};\n"],"sourceRoot":""}