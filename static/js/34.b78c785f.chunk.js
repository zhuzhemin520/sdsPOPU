(this["webpackJsonppopulation-arcgis"]=this["webpackJsonppopulation-arcgis"]||[]).push([[34],{1253:function(t,e,n){"use strict";n.d(e,"a",(function(){return w})),n.d(e,"b",(function(){return L})),n.d(e,"c",(function(){return G})),n.d(e,"d",(function(){return C})),n.d(e,"e",(function(){return _})),n.d(e,"f",(function(){return O})),n.d(e,"g",(function(){return I})),n.d(e,"h",(function(){return N})),n.d(e,"i",(function(){return v})),n.d(e,"j",(function(){return m})),n.d(e,"k",(function(){return q})),n.d(e,"l",(function(){return H}));n(167);var r,s,o=n(16),i=n(2),a=n(68),c=n(779),l=n(40),u=n(86),p=n(62),f=n(180),h=n(57);function m(t,e,n){return!Object(l.b)(t,e,n)}function b(t,e,n){const r=m(t,e,n);if(r&&!Object(l.h)())throw new o.a("rasterprojectionhelper-project","projection engine is not loaded");return r}(s=r||(r={}))[s.None=0]="None",s[s.North=1]="North",s[s.South=2]="South",s[s.Both=3]="Both";const d=(t,e,n,r=0)=>{if(1===n[0])return[0,0];let s=1,o=-1,i=1,a=-1;for(let d=0;d<t.length;d+=2)isNaN(t[d])||(s=s>t[d]?t[d]:s,o=o>t[d]?o:t[d],i=i>t[d+1]?t[d+1]:i,a=a>t[d+1]?a:t[d+1]);const{cols:c,rows:l}=e,u=(o-s)/c/n[0],p=(a-i)/l/n[1],f=2*r;let h=0,m=!1,b=[0,0];for(let d=0;d<c-3;d++){for(let e=0;e<l-3;e++){const n=d*l*2+2*e,r=(t[n]+t[n+4]+t[n+4*l]+t[n+4*l+4])/4,s=(t[n+1]+t[n+5]+t[n+4*l+1]+t[n+4*l+5])/4,o=Math.abs((r-t[n+2*l+2])/u),i=Math.abs((s-t[n+2*l+3])/p);if(o+i>h&&(h=o+i,b=[o,i]),f&&h>f){m=!0;break}}if(m)break}return b},g={3395:20037508.342789244,3410:17334193.943686873,3857:20037508.342788905,3975:17367530.445161372,4087:20037508.342789244,4088:20015108.787169147,6933:17367530.445161372,32662:20037508.342789244,53001:20015086.79602057,53002:10007543.39801029,53003:20015086.79602057,53004:20015086.79602057,53016:14152803.599503474,53017:17333573.624304302,53034:20015086.79602057,53079:20015114.352186374,53080:20015114.352186374,54001:20037508.342789244,54002:10018754.171394624,54003:20037508.342789244,54004:20037508.342789244,54016:14168658.027268292,54017:17367530.44516137,54034:20037508.342789244,54079:20037508.342789244,54080:20037508.342789244,54100:20037508.342789244,54101:20037508.342789244},y=new Map,j=new Map,x=500;async function O(){Object(l.h)()||await Object(l.i)()}function w(t,e,n){return b(t.spatialReference,e)?n?Object(l.f)(e,t.spatialReference,t):Object(l.f)(t.spatialReference,e,t):null}function v(t,e,n,r=null){const s=t.spatialReference;if(s.equals(e))return t;b(s,e,r);const o=n.center,c=new u.a({xmin:o.x-t.x/2,xmax:o.x+t.x/2,ymin:o.y-t.y/2,ymax:o.y+t.y/2,spatialReference:s}),p=Object(l.m)(c,e,r),f=C(e);let h;if(Object(i.k)(p)||Object(i.l)(f)&&p.width>=f){const n=Object(a.f)(s)/Object(a.f)(e);h={x:t.x*n,y:t.y*n}}else h={x:p.width,y:p.height};return h}function A(t,e=.01){return Object(a.f)(t)?e/Object(a.f)(t):0}function N(t,e,n=null,r=!0){const s=t.spatialReference;if(s.equals(e))return t;b(s,e,n);const o=Object(l.m)(t,e,n);return r&&o?(S([t],[o],s,e),o):o}function S(t,e,n,r){const s=E(n,!0),o=E(r,!0),a=A(n,x),c=A(r,x);if(a&&Object(i.l)(s)&&Object(i.l)(o))for(let i=0;i<t.length;i++){const n=e[i];if(!n)continue;const{x:r}=t[i],{x:l}=n;l>=o[1]-c&&Math.abs(r-s[0])<a?n.x-=o[1]-o[0]:l<=o[0]+c&&Math.abs(r-s[1])<a&&(n.x+=o[1]-o[0])}}function R(t){const{inSR:e,outSR:n,datumTransformation:r,preferPE:s}=t;if(e.equals(n)){const{points:e}=k(t,null);return e}if(e.isWebMercator&&n.isWGS84||e.isWGS84&&n.isWebMercator)return function(t){const{cols:e,rows:n,xres:r,yres:s,usePixelCenter:o,inSR:i,outSR:a}=t;let{xmin:c,ymax:u}=t;o&&(c+=r/2,u-=s/2);const f=[],h=[],m=Math.max(e,n);for(let d=0;d<m;d++){const t=c+r*Math.min(e,d),o=u-s*Math.min(n,d),m=Object(l.m)(new p.a({x:t,y:o,spatialReference:i}),a);d<=e&&f.push(m.x),d<=n&&h.push(m.y)}const b=[];for(let l=0;l<e;l++)for(let t=0;t<n;t++)b.push([f[l],h[t]]);return b}(t);if(b(e,n,r)&&s){if(e.isGeographic)return T(t);const n=M(e);if(Object(i.l)(n))return T(t)}return function(t){const{points:e}=k(t,null),{inSR:n,outSR:r,datumTransformation:s}=t,o=e.map((t=>new p.a(t[0],t[1],n))),i=Object(l.m)(o,r,s);return s&&S(o,i,n,r),i.map((t=>t?[t.x,t.y]:[NaN,NaN]))}(t)}function T(t){const{inSR:e,outSR:n,datumTransformation:r}=t,s=M(e),{points:o,mask:a}=k(t,s);if(!e.isGeographic){const t=e.wkid?c.a.coordsys(e.wkid):c.a.fromString(e.isGeographic?c.b.PE_TYPE_GEOGCS:c.b.PE_TYPE_PROJCS,e.wkt);c.c.projToGeog(t,o.length,o)}if(Object(i.l)(r)&&r.steps.length){let t;const e=179.9955;if(n.isGeographic&&(t=o.map((([t])=>t>e?1:t<-e?-1:0))),r.steps.forEach((t=>{const e=t.wkid?c.a.geogtran(t.wkid):c.a.fromString(c.b.PE_TYPE_GEOGTRAN,t.wkt);c.d.geogToGeog(e,o.length,o,null,t.isInverse?c.b.PE_TRANSFORM_2_TO_1:c.b.PE_TRANSFORM_1_TO_2)})),t)for(let n=0;n<o.length;n++){const r=t[n],s=o[n][0],i=s>e?1:s<-e?-1:0;r&&i&&r!==i&&(o[n][0]=r>0?s+360:s-360)}}if(!n.isGeographic){const t=M(n,!0),e=Object(i.l)(t)&&t.isEnvelope?[t.bbox[1],t.bbox[3]]:[-90,90];!function(t,e){const[n,r]=e;for(let s=0;s<t.length;s++){const e=t[s][1];(e<n||e>r)&&(t[s]=[NaN,NaN])}}(o,e);const r=n.wkid?c.a.coordsys(n.wkid):c.a.fromString(n.isGeographic?c.b.PE_TYPE_GEOGCS:c.b.PE_TYPE_PROJCS,n.wkt);c.c.geogToProj(r,o.length,o)}let l=o;if(a&&o.length!==a.length){l=[];for(let t=0,e=0;t<a.length;t++)a[t]?l.push(o[e++]):l.push([NaN,NaN])}return l}function M(t,e=!1){let n=t.wkid||t.wkt;if(!n||t.isGeographic)return null;if(n=String(n),y.has(n)){const t=y.get(n);return e?null==t?void 0:t.gcs:null==t?void 0:t.pcs}const r=t.wkid?c.a.coordsys(t.wkid):c.a.fromString(t.isGeographic?c.b.PE_TYPE_GEOGCS:c.b.PE_TYPE_PROJCS,t.wkt),s=F(r,A(t,1e-4)),o=F(r,0,!0);return y.set(n,{pcs:s,gcs:o}),e?o:s}function F(t,e=0,n=!1){const r=c.f.generate(t),s=n?t.horizonGcsGenerate():t.horizonPcsGenerate();if(!r||null==s||!s.length)return null;let o=!1,i=s.find((t=>1===t.getInclusive()&&1===t.getKind()));if(!i){if(i=s.find((t=>1===t.getInclusive()&&0===t.getKind())),!i)return null;o=!0}const a=n?0:(2===r.getNorthPoleLocation()?1:0)|(2===r.getSouthPoleLocation()?2:0),l=r.isPannableRectangle(),u=i.getCoord();if(o)return{isEnvelope:o,isPannable:l,vertices:u,coef:null,bbox:[u[0][0]-e,u[0][1]-e,u[1][0]+e,u[1][1]+e],poleLocation:a};let p=0;const f=[];let[h,m]=u[0],[b,d]=u[0];for(let c=0,g=u.length;c<g;c++){p++,p===g&&(p=0);const[t,e]=u[c],[n,r]=u[p];if(r===e)f.push([t,n,e,r,2]);else{const s=(n-t)/(r-e||1e-4),o=t-s*e;e<r?f.push([s,o,e,r,0]):f.push([s,o,r,e,1])}h=h<t?h:t,m=m<e?m:e,b=b>t?b:t,d=d>e?d:e}return{isEnvelope:!1,isPannable:l,vertices:u,coef:f,bbox:[h,m,b,d],poleLocation:a}}function k(t,e){const n=[],{cols:r,rows:s,xres:o,yres:a,usePixelCenter:c}=t;let{xmin:l,ymax:u}=t;if(c&&(l+=o/2,u-=a/2),Object(i.k)(e)){for(let t=0;t<r;t++)for(let e=0;e<s;e++)n.push([l+o*t,u-a*e]);return{points:n}}const p=new Uint8Array(r*s);if(e.isEnvelope){const{bbox:[t,i,c,f]}=e;for(let h=0,m=0;h<r;h++){const r=l+o*h,b=e.isPannable||r>=t&&r<=c;for(let t=0;t<s;t++,m++){const e=u-a*t;b&&e>=i&&e<=f&&(n.push([r,e]),p[m]=1)}}return{points:n,mask:p}}const f=e.coef,h=[];for(let i=0;i<s;i++){const t=u-a*i,e=[],n=[];for(let s=0;s<f.length;s++){const[r,o,i,a,c]=f[s];if(t===i&&i===a)e.push(r),e.push(o),n.push(2),n.push(2);else if(t>=i&&t<=a){const s=r*t+o;e.push(s),n.push(c)}}let r=e;if(e.length>2){let t=2===n[0]?0:n[0],s=e[0];r=[];for(let o=1;o<n.length;o++)2===n[o]&&o!==n.length-1||(n[o]!==t&&(r.push(0===t?Math.min(s,e[o-1]):Math.max(s,e[o-1])),t=n[o],s=e[o]),o===n.length-1&&r.push(0===n[o]?Math.min(s,e[o]):Math.max(s,e[o])));r.sort(((t,e)=>t-e))}else e[0]>e[1]&&(r=[e[1],e[0]]);h.push(r)}for(let i=0,m=0;i<r;i++){const t=l+o*i;for(let e=0;e<s;e++,m++){const r=u-a*e,s=h[e];if(2===s.length)t>=s[0]&&t<=s[1]&&(n.push([t,r]),p[m]=1);else if(s.length>2){let e=!1;for(let n=0;n<s.length;n+=2)if(t>=s[n]&&t<=s[n+1]){e=!0;break}e&&(n.push([t,r]),p[m]=1)}}}return{points:n,mask:p}}function P(t){const e=C(t[0].spatialReference);if(t.length<2||Object(i.k)(e))return t[0];let{xmin:n,xmax:r,ymin:s,ymax:o}=t[0];for(let i=1;i<t.length;i++){const n=t[i];r=n.xmax+e*i,s=Math.min(s,n.ymin),o=Math.max(o,n.ymax)}return new u.a({xmin:n,xmax:r,ymin:s,ymax:o,spatialReference:t[0].spatialReference})}function I(t,e,n=null,s=!0){const o=t.spatialReference;if(o.equals(e))return t;const a=_(t),c=C(o,!0),p=C(e);if(0===a||Object(i.k)(c)||Object(i.k)(p)){const a=B(t,e,n,s);if(Object(i.k)(c)&&Object(i.l)(p)&&Math.abs(a.width-p)<A(e)&&Object(l.h)()){const n=M(o);if(Object(i.l)(n)&&n.poleLocation===r.None&&t.width<(n.bbox[2]-n.bbox[0])/2)return function(t,e){const n=C(e);if(Object(i.k)(n))return null;let{xmin:r,ymin:s,xmax:o,ymax:a}=t;const c=t.spatialReference,p=new f.a({spatialReference:c,rings:[[[r,s],[o,s],[o,a],[r,a],[r,s]]]}),h=Object(l.m)(p,e);if(2!==h.rings.length||!h.rings[0].length||!h.rings[1].length)return null;const{rings:m}=h,b=A(c),d=new u.a({spatialReference:e});for(let i=0;i<2;i++){r=o=m[i][0][0],s=a=m[i][0][1];for(let t=0;t<m[i].length;t++)r=r>m[i][t][0]?m[i][t][0]:r,o=o<m[i][t][0]?m[i][t][0]:o,s=s>m[i][t][1]?m[i][t][1]:s,a=a<m[i][t][1]?m[i][t][1]:a;if(0===i)d.ymin=s,d.ymax=a,d.xmin=r,d.xmax=o;else if(d.ymin=Math.min(d.ymin,s),d.ymax=Math.max(d.ymax,a),Math.abs(o-n/2)<b)d.xmin=r,d.xmax=d.xmax+n;else{if(!(Math.abs(r+n/2)<b))return null;d.xmax=o+n}}return d}(t,e)||a}return a}const h=t.clone().normalize();if(1===h.length&&t.xmax<c&&t.xmax-c/2>A(o)){const{xmin:e,xmax:n}=t;for(let r=0;r<=a;r++){const s=0===r?e:-c/2,i=r===a?n-c*r:c/2;h[r]=new u.a({xmin:s,xmax:i,ymin:t.ymin,ymax:t.ymax,spatialReference:o})}}return P(h.map((t=>B(t,e,n,s))).filter(i.l))}function B(t,e,n=null,r=!0,s=!0){const o=t.spatialReference;if(o.equals(e)||!e)return t;b(o,e,n);const a=Object(l.m)(t,e,n);if(s&&e.isWebMercator&&a&&(a.ymax=Math.min(20037508.342787,a.ymax),a.ymin=Math.max(-20037508.342787,a.ymin),a.ymin>=a.ymax))return null;if(!r||!a)return a;const c=E(o,!0),u=E(e,!0);if(Object(i.k)(c)||Object(i.k)(u))return a;const f=A(o,.001),h=A(o,x),m=A(e,.001);if(Math.abs(a.xmin-u[0])<m&&Math.abs(a.xmax-u[1])<m){const r=Math.abs(t.xmin-c[0]),s=Math.abs(c[1]-t.xmax);if(r<f&&s>h){a.xmin=u[0];const r=[];r.push(new p.a(t.xmax,t.ymin,o)),r.push(new p.a(t.xmax,(t.ymin+t.ymax)/2,o)),r.push(new p.a(t.xmax,t.ymax,o));const s=r.map((t=>N(t,e,n))).filter((t=>!isNaN(null==t?void 0:t.x))).map((t=>t.x));a.xmax=Math.max.apply(null,s)}if(s<f&&r>h){a.xmax=u[1];const r=[];r.push(new p.a(t.xmin,t.ymin,o)),r.push(new p.a(t.xmin,(t.ymin+t.ymax)/2,o)),r.push(new p.a(t.xmin,t.ymax,o));const s=r.map((t=>N(t,e,n))).filter((t=>!isNaN(null==t?void 0:t.x))).map((t=>t.x));a.xmin=Math.min.apply(null,s)}}else{const t=A(e,.001);Math.abs(a.xmin-u[0])<t&&(a.xmin=u[0]),Math.abs(a.xmax-u[1])<t&&(a.xmax=u[1])}return a}function C(t,e=!1){if(!t)return null;const n=e?20037508.342787:20037508.342788905;return t.isWebMercator?2*n:t.wkid&&t.isGeographic?360:2*g[t.wkid]||null}function E(t,e=!1){if(t.isGeographic)return[-180,180];const n=C(t,e);return Object(i.l)(n)?[-n/2,n/2]:null}function D(t,e,n,r){let s=(t-e)/n;return s-Math.floor(s)!=0?s=Math.floor(s):r&&(s-=1),s}function _(t,e=!1){const n=C(t.spatialReference);if(Object(i.k)(n))return 0;const r=e?0:-n/2,s=A(t.spatialReference),o=!e&&Math.abs(t.xmax-n/2)<s?n/2:t.xmax,a=!e&&Math.abs(t.xmin+n/2)<s?-n/2:t.xmin;return D(o,r,n,!0)-D(a,r,n,!1)}function G(t){const e=t.storageInfo.origin.x,n=C(t.spatialReference,!0);if(Object(i.k)(n))return{originX:e,halfWorldWidth:null,pyramidsInfo:null};const r=n/2,{nativePixelSize:s,storageInfo:o,extent:a}=t,{maximumPyramidLevel:c,blockWidth:l,pyramidScalingFactor:u}=o;let p=s.x;const f=[],h=Object(i.l)(t.transform)&&"gcs-shift"===t.transform.type,m=e+(h?0:r),b=h?n-e:r-e;for(let i=0;i<=c;i++){const t=(a.xmax-e)/p/l,n=t-Math.floor(t)==0?t:Math.ceil(t),r=b/p/l,s=r-Math.floor(r)==0?r:Math.ceil(r),o=Math.floor(m/p/l),i=Math.round(m/p)%l,c=(l-Math.round(b/p)%l)%l;f.push({resolutionX:p,blockWidth:l,datsetColumnCount:n,worldColumnCountFromOrigin:s,leftMargin:i,rightPadding:c,originColumnOffset:o}),p*=u}return{originX:e,halfWorldWidth:r,pyramidsInfo:f,hasGCSSShiftTransform:h}}function L(t){const e=t.isAdaptive&&null==t.spacing;let n=t.spacing||[32,32],r=z(t),s={cols:r.size[0]+1,rows:r.size[1]+1};const o=r.outofBoundPointCount>0&&r.outofBoundPointCount<r.offsets.length/2;let a=r.outofBoundPointCount===r.offsets.length/2||e&&o?[0,0]:d(r.offsets,s,n,4);const l=(a[0]+a[1])/2,u=t.projectedExtent.spatialReference,p=t.srcBufferExtent.spatialReference;if(e&&(o||l>4)&&(m(u,p,t.datumTransformation)&&(u.isGeographic||Object(i.l)(M(u))),n=[4,4],r=z({...t,spacing:n}),s={cols:r.size[0]+1,rows:r.size[1]+1},a=d(r.offsets,s,n,4)),r.error=a,n[0]>1&&(r.coefficients=V(r.offsets,s,o)),t.includeGCSGrid&&!u.isGeographic&&!u.isWebMercator)if(p.isGeographic)r.gcsGrid={offsets:r.offsets,coefficients:r.coefficients,spacing:n};else{const e=M(u);if(Object(i.l)(e)&&!e.isEnvelope){const e=function(t){if(!t||t.isGeographic)return t;const e=String(t.wkid||t.wkt);let n;return j.has(e)?n=j.get(e):(n=(t.wkid?c.a.coordsys(t.wkid):c.a.fromString(c.b.PE_TYPE_PROJCS,t.wkt)).getGeogcs().getCode(),j.set(e,n)),new h.a({wkid:n})}(u),i=I(t.projectedExtent,e),{offsets:a}=z({...t,srcBufferExtent:i,spacing:n}),l=V(a,s,o);r.gcsGrid={offsets:a,coefficients:l,spacing:n}}}return r}function z(t){const{projectedExtent:e,srcBufferExtent:n,pixelSize:r,datumTransformation:s,rasterTransform:o}=t,a=e.spatialReference,c=n.spatialReference,l=b(a,c),{xmin:u,ymin:f,xmax:h,ymax:m}=e,d=C(c),g=Object(i.l)(d)&&(t.hasWrapAround||"gcs-shift"===(null==o?void 0:o.type)),y=t.spacing||[32,32],j=y[0]*r.x,O=y[1]*r.y,w=1===y[0],v=Math.ceil((h-u)/j-.1/y[0])+(w?0:1),N=Math.ceil((m-f)/O-.1/y[1])+(w?0:1),S=R({cols:v,rows:N,xmin:u,ymax:m,xres:j,yres:O,inSR:a,outSR:c,datumTransformation:s,preferPE:y[0]<=4,usePixelCenter:w}),T=[];let F,k=0;const P=w?-1:NaN,{xmin:I,xmax:B,ymax:E,width:D,height:_}=n,G=A(c,x),L=Object(i.l)(d)&&I>0&&B>d/2;let z=!1;if(l){const t=M(a);z=Object(i.l)(t)&&t.poleLocation>0}for(let i=0;i<v;i++){const t=[];for(let e=0;e<N;e++){let n=S[i*N+e];if(g&&n[0]>B&&n[0]>d/2-G?n[0]-=d:g&&0===i&&n[0]<0&&L&&!o&&(n[0]+=d),!n||isNaN(n[0])||isNaN(n[1]))T.push(P),T.push(P),t.push(null),k++;else{if(o){const t=o.inverseTransform(new p.a({x:n[0],y:n[1],spatialReference:c}));n=[t.x,t.y]}t.push(n),i>0&&g&&F[e]&&n[0]<F[e][0]&&(n[0]+=d,z&&n[0]>B&&n[0]>d&&(n[0]-=d)),T.push((n[0]-I)/D),T.push((E-n[1])/_)}}F=t}return{offsets:T,error:null,coefficients:null,outofBoundPointCount:k,spacing:y,size:w?[v,N]:[v-1,N-1]}}function V(t,e,n){const{cols:r,rows:s}=e,o=new Float32Array((r-1)*(s-1)*2*6),i=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),a=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let c=0;c<r-1;c++){for(let e=0;e<s-1;e++){let n=c*s*2+2*e;const l=t[n],u=t[n+1],p=t[n+2],f=t[n+3];n+=2*s;const h=t[n],m=t[n+1],b=t[n+2],d=t[n+3];let g=0,y=12*(e*(r-1)+c);for(let t=0;t<3;t++)o[y++]=i[g++]*l+i[g++]*p+i[g++]*b;g=0;for(let t=0;t<3;t++)o[y++]=i[g++]*u+i[g++]*f+i[g++]*d;g=0;for(let t=0;t<3;t++)o[y++]=a[g++]*l+a[g++]*h+a[g++]*b;g=0;for(let t=0;t<3;t++)o[y++]=a[g++]*u+a[g++]*m+a[g++]*d}if(n)for(let t=0;t<o.length;t++)isNaN(o[t])&&(o[t]=-1)}return o}function q(t){const e=t.clone().normalize();return 1===e.length?e[0]:P(e)}function H(t,e,n){const{storageInfo:r,pixelSize:s}=e;let o=0,c=!1;const{pyramidResolutions:l}=r;if(Object(i.l)(l)&&l.length){const r=(t.x+t.y)/2,i=l[l.length-1],u=(i.x+i.y)/2,f=(s.x+s.y)/2;if(r<=f)o=0;else if(r>=u)o=l.length,c=r/u>8;else{let t,e=f;for(let s=1;s<=l.length;s++){if(t=(l[s-1].x+l[s-1].y)/2,r<=t){r===t?o=s:"down"===n?(o=s-1,c=r/e>8):o="up"===n||r-e>t-r||r/e>2?s:s-1;break}e=t}}const h=0===o?s:l[o-1];return c&&Math.min(h.x,h.y)*Object(a.f)(e.spatialReference)>19567&&(c=!1),{pyramidLevel:o,pyramidResolution:new p.a({x:h.x,y:h.y,spatialReference:e.spatialReference}),excessiveReading:c}}const u=Math.log(t.x/s.x)/Math.LN2,f=Math.log(t.y/s.y)/Math.LN2,h=e.storageInfo.maximumPyramidLevel||0;o="down"===n?Math.floor(Math.min(u,f)):"up"===n?Math.ceil(Math.max(u,f)):Math.round((u+f)/2),o<0?o=0:o>h&&(c=o>h+3,o=h);const m=2**o;return{pyramidLevel:o,pyramidResolution:new p.a({x:m*e.nativePixelSize.x,y:m*e.nativePixelSize.y,spatialReference:e.spatialReference}),excessiveReading:c}}},1291:function(t,e,n){"use strict";n.d(e,"a",(function(){return b}));var r=n(0),s=(n(167),n(1)),o=(n(17),n(12),n(54)),i=n(51),a=n(10),c=n(50),l=n(1341),u=n(62),p=n(86);function f(t,e,n){const{x:r,y:s}=e;if(n<2)return{x:t[0]+r*t[2]+s*t[4],y:t[1]+r*t[3]+s*t[5]};if(2===n){const e=r*r,n=s*s,o=r*s;return{x:t[0]+r*t[2]+s*t[4]+e*t[6]+o*t[8]+n*t[10],y:t[1]+r*t[3]+s*t[5]+e*t[7]+o*t[9]+n*t[11]}}const o=r*r,i=s*s,a=r*s,c=o*r,l=o*s,u=r*i,p=s*i;return{x:t[0]+r*t[2]+s*t[4]+o*t[6]+a*t[8]+i*t[10]+c*t[12]+l*t[14]+u*t[16]+p*t[18],y:t[1]+r*t[3]+s*t[5]+o*t[7]+a*t[9]+i*t[11]+c*t[13]+l*t[15]+u*t[17]+p*t[19]}}function h(t,e,n){const{xmin:r,ymin:s,xmax:o,ymax:i,spatialReference:a}=e;let c=[];if(n<2)c.push({x:r,y:i}),c.push({x:o,y:i}),c.push({x:r,y:s}),c.push({x:o,y:s});else{let t=10;for(let e=0;e<t;e++)c.push({x:r,y:s+(i-s)*e/(t-1)}),c.push({x:o,y:s+(i-s)*e/(t-1)});t=8;for(let e=1;e<=t;e++)c.push({x:r+(o-r)*e/t,y:s}),c.push({x:r+(o-r)*e/t,y:i})}c=c.map((e=>f(t,e,n)));const l=c.map((t=>t.x)),u=c.map((t=>t.y));return new p.a({xmin:Math.min.apply(null,l),xmax:Math.max.apply(null,l),ymin:Math.min.apply(null,u),ymax:Math.max.apply(null,u),spatialReference:a})}let m=class extends l.a{constructor(){super(...arguments),this.polynomialOrder=1,this.type="polynomial"}readForwardCoefficients(t,e){const{coeffX:n,coeffY:r}=e;if(null==n||!n.length||null==r||!r.length||n.length!==r.length)return null;const s=[];for(let o=0;o<n.length;o++)s.push(n[o]),s.push(r[o]);return s}writeForwardCoefficients(t,e,n){const r=[],s=[];for(let o=0;o<(null==t?void 0:t.length);o++)o%2==0?r.push(t[o]):s.push(t[o]);e.coeffX=r,e.coeffY=s}get inverseCoefficients(){let t=this._get("inverseCoefficients");const e=this._get("forwardCoefficients");return!t&&e&&this.polynomialOrder<2&&(t=function(t){const[e,n,r,s,o,i]=t,a=r*i-o*s,c=o*s-r*i;return[(o*n-e*i)/a,(r*n-e*s)/c,i/a,s/c,-o/a,-r/c]}(e)),t}set inverseCoefficients(t){this._set("inverseCoefficients",t)}readInverseCoefficients(t,e){const{inverseCoeffX:n,inverseCoeffY:r}=e;if(null==n||!n.length||null==r||!r.length||n.length!==r.length)return null;const s=[];for(let o=0;o<n.length;o++)s.push(n[o]),s.push(r[o]);return s}writeInverseCoefficients(t,e,n){const r=[],s=[];for(let o=0;o<(null==t?void 0:t.length);o++)o%2==0?r.push(t[o]):s.push(t[o]);e.inverseCoeffX=r,e.inverseCoeffY=s}get affectsPixelSize(){return this.polynomialOrder>0}forwardTransform(t){if("point"===t.type){const e=f(this.forwardCoefficients,t,this.polynomialOrder);return new u.a({x:e.x,y:e.y,spatialReference:t.spatialReference})}return h(this.forwardCoefficients,t,this.polynomialOrder)}inverseTransform(t){if("point"===t.type){const e=f(this.inverseCoefficients,t,this.polynomialOrder);return new u.a({x:e.x,y:e.y,spatialReference:t.spatialReference})}return h(this.inverseCoefficients,t,this.polynomialOrder)}};Object(r.a)([Object(s.b)({json:{write:!0}})],m.prototype,"polynomialOrder",void 0),Object(r.a)([Object(s.b)()],m.prototype,"forwardCoefficients",void 0),Object(r.a)([Object(i.a)("forwardCoefficients",["coeffX","coeffY"])],m.prototype,"readForwardCoefficients",null),Object(r.a)([Object(c.a)("forwardCoefficients")],m.prototype,"writeForwardCoefficients",null),Object(r.a)([Object(s.b)({json:{write:!0}})],m.prototype,"inverseCoefficients",null),Object(r.a)([Object(i.a)("inverseCoefficients",["inverseCoeffX","inverseCoeffY"])],m.prototype,"readInverseCoefficients",null),Object(r.a)([Object(c.a)("inverseCoefficients")],m.prototype,"writeInverseCoefficients",null),Object(r.a)([Object(s.b)()],m.prototype,"affectsPixelSize",null),Object(r.a)([Object(o.a)({PolynomialXform:"polynomial"})],m.prototype,"type",void 0),m=Object(r.a)([Object(a.a)("esri.layers.support.rasterTransforms.PolynomialTransform")],m);const b=m},1341:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(0),s=n(27),o=n(1),i=(n(17),n(12),n(10));let a=class extends s.a{get affectsPixelSize(){return!1}forwardTransform(t){return t}inverseTransform(t){return t}};Object(r.a)([Object(o.b)()],a.prototype,"affectsPixelSize",null),Object(r.a)([Object(o.b)({json:{write:!0}})],a.prototype,"spatialReference",void 0),a=Object(r.a)([Object(i.a)("esri.layers.support.rasterTransforms.BaseRasterTransform")],a);const c=a},1400:function(t,e,n){"use strict";n.d(e,"a",(function(){return on}));var r=n(16),s=n(0),o=n(2),i=n(1),a=(n(17),n(12),n(10)),c=(n(22),n(32),n(27));let l=class extends c.a{constructor(){super(...arguments),this.raster=void 0}};Object(s.a)([Object(i.b)({json:{write:!0}})],l.prototype,"raster",void 0),l=Object(s.a)([Object(a.a)("esri.layers.support.rasterFunctions.AspectFunctionArguments")],l);const u=l;var p;let f=p=class extends u{clone(){return new p({raster:this.raster})}};f=p=Object(s.a)([Object(a.a)("esri.layers.support.rasterFunctions.AspectFunctionArguments")],f);const h=f;var m=n(72);let b=class extends c.a{constructor(){super(...arguments),this.functionArguments=null,this.readingBufferSize=0}bind(t,e=!1){const n=this._getRasterValues();for(let r=0;r<n.length;r++){const s=n[r];if(s&&"object"==typeof s&&"bind"in s&&(!s.rasterInfo||e)){const n=s.bind(t,e);if(!n.success)return n}}return!this.rasterInfo||e?(this.sourceRasterInfos=this._getSourceRasterInfos(t),this._bindSourceRasters()):{success:!0}}process(t){const e=this._getRasterValues().map((e=>this._readRasterValue(e,t)));return this._processPixels({...t,pixelBlocks:e})}getPrimaryRasters(){const t=[],e=[];return this._getPrimaryRasters(this,t,e),{rasters:t,rasterIds:e}}_getOutputPixelType(t){var e;return"unknown"===this.outputPixelType?t:null!=(e=this.outputPixelType)?e:t}_getRasterValues(){const{rasterArgumentNames:t}=this;return"rasters"===t[0]&&Array.isArray(this.functionArguments.rasters)?this.functionArguments.rasters:t.map((t=>this.functionArguments[t]))}_getSourceRasterInfos(t){const e=this._getRasterValues(),{rasterInfos:n,rasterIds:r}=t;return e.map((t=>t&&"object"==typeof t&&"bind"in t&&t.rasterInfo?t.rasterInfo:"string"==typeof t&&r.includes(t)?n[r.indexOf(t)]:n[0]))}_getPrimaryRasterId(t){return null==t?void 0:t.url}_getPrimaryRasters(t,e=[],n=[]){for(let r=0;r<t.sourceRasters.length;r++){const s=t.sourceRasters[r];if("number"!=typeof s)if("bind"in s)this._getPrimaryRasters(s,e,n);else{const t=s,r=this._getPrimaryRasterId(t);if(null==r)continue;n.includes(r)||(this.mainPrimaryRasterId===r?(e.unshift(t),n.unshift(r)):(e.push(t),n.push(r)))}}}_readRasterValue(t,e){const{primaryPixelBlocks:n}=e;if(Object(o.k)(t)||"$$"===t){const t=n[0];return Object(o.k)(t)?null:t.clone()}if("string"==typeof t){const r=e.primaryRasterIds.indexOf(t);return-1===r?null:n[r]}if("number"==typeof t){const e=n[0];if(Object(o.k)(e))return null;const r=new Float32Array(e.width*e.height);r.fill(t);const s=e.clone();return s.pixels=s.pixels.map((()=>r)),s}return t.process(e)}};Object(s.a)([Object(i.b)({json:{write:!0}})],b.prototype,"functionName",void 0),Object(s.a)([Object(i.b)({json:{write:!0}})],b.prototype,"functionArguments",void 0),Object(s.a)([Object(i.b)()],b.prototype,"rasterArgumentNames",void 0),Object(s.a)([Object(i.b)({json:{write:!0}}),Object(m.a)((t=>null==t?void 0:t.toLowerCase()))],b.prototype,"outputPixelType",void 0),Object(s.a)([Object(i.b)({json:{write:!0}})],b.prototype,"mainPrimaryRasterId",void 0),Object(s.a)([Object(i.b)()],b.prototype,"sourceRasters",void 0),Object(s.a)([Object(i.b)({json:{write:!0}})],b.prototype,"sourceRasterInfos",void 0),Object(s.a)([Object(i.b)({json:{write:!0}})],b.prototype,"rasterInfo",void 0),Object(s.a)([Object(i.b)({json:{write:!0}})],b.prototype,"readingBufferSize",void 0),b=Object(s.a)([Object(a.a)("esri.layers.support.rasterFunctions.BaseRasterFunction")],b);const d=b;var g=n(1339);let y=class extends d{constructor(){super(...arguments),this.functionName="Aspect",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.isGCS=!1}_bindSourceRasters(){const t=this.sourceRasterInfos[0];this.isGCS=t.spatialReference.isGeographic,this.outputPixelType=this._getOutputPixelType("f32");const e=t.clone();return e.pixelType=this.outputPixelType,e.statistics=null,e.histograms=null,this.rasterInfo=e,{success:!0}}_processPixels(t){var e;const n=null==(e=t.pixelBlocks)?void 0:e[0];if(Object(o.k)(n))return null;const{extent:r}=t,s=r?{x:r.width/n.width,y:r.height/n.height}:{x:1,y:1};return Object(g.a)(n,{resolution:s})}};Object(s.a)([Object(i.b)({json:{write:!0,name:"rasterFunction"}})],y.prototype,"functionName",void 0),Object(s.a)([Object(i.b)({type:h,json:{write:!0,name:"rasterFunctionArguments"}})],y.prototype,"functionArguments",void 0),Object(s.a)([Object(i.b)()],y.prototype,"rasterArgumentNames",void 0),Object(s.a)([Object(i.b)({json:{write:!0}})],y.prototype,"isGCS",void 0),y=Object(s.a)([Object(a.a)("esri.layers.support.rasterFunctions.AspectFunction")],y);const j=y;var x=n(25),O=n(54),w=n(61),v=n(1141);const A=new Set(["+","-","*","/","(",")"]);function N(t,e,n,r){if("number"==typeof n&&"number"==typeof r)return n+r;let s;if("number"==typeof n){s=r.length;const t=n;(n=new Float32Array(s)).fill(t)}else if(s=n.length,r.constructor===Number){const t=r;(r=new Float32Array(s)).fill(t)}const o=new Float32Array(s);switch(e){case"+":for(let e=0;e<s;e++)(null==t||t[e])&&(o[e]=n[e]+r[e]);break;case"-":for(let e=0;e<s;e++)(null==t||t[e])&&(o[e]=n[e]-r[e]);break;case"*":for(let e=0;e<s;e++)(null==t||t[e])&&(o[e]=n[e]*r[e]);break;case"/":for(let e=0;e<s;e++)(null==t||t[e])&&r[e]&&(o[e]=n[e]/r[e]);break;case"(":case")":throw"encountered error with custom band index equation"}return o}function S(t,e){t.splice(e,1);let n=0,r=0;do{n=0,r=0;for(let e=0;e<t.length;e++)if("("===t[e])n=e;else if(")"===t[e]){r=e;break}r===n+1&&t.splice(n,2)}while(r===n+1);return t}function R(t){if(1===t.length)return{opIndex:0,numIndex:0};let e=0,n=0;for(let i=0;i<t.length;i++)if("("===t[i])e=i;else if(")"===t[i]){n=i;break}const r=0===n?t:t.slice(e+1,n);let s=-1;for(let i=0;i<r.length;i++)if("*"===r[i]||"/"===r[i]){s=i;break}if(s>-1)n>0&&(s+=e+1);else{for(let t=0;t<r.length;t++)if("+"===r[t]||"-"===r[t]){s=t;break}n>0&&(s+=e+1)}let o=0;for(let i=0;i<s;i++)"("===t[i]&&o++;return{opIndex:s,numIndex:s-o}}function T(t,e,n){let r,{ops:s,nums:o}=function(t,e){(t=t.replace(/ /g,"")).startsWith("-")&&(t="0"+t),t.startsWith("+")&&(t=t.slice(1,t.length));const n=t.split(""),r=[],s=[];let o="";for(let i=0;i<n.length;i++){const t=n[i];if(A.has(t))""!==o&&s.push(parseFloat(o)),r.push(t),o="";else{if("b"===t.toLowerCase()){i++,o=t.concat(n[i]),s.push(e[parseInt(o[1],10)-1]),o="";continue}o=o.concat(t),i===n.length-1&&s.push(parseFloat(o))}}return{ops:r,nums:s}}(n,e);if(0===s.length){const t=1===o.length?o[0]:e[0];if(t instanceof Float32Array)return[t];const n=new Float32Array(e[0].length);return"number"==typeof t?n.fill(t):n.set(t),[n]}for(;s.length>0;){const{numIndex:e,opIndex:n}=R(s);if(r=N(t,s[n],o[e],o[e+1]),1===s.length)break;s=S(s,n),o.splice(e,2,r)}return[r]}var M=n(1122);const F=new w.a({0:"custom",1:"ndvi",2:"savi",3:"tsavi",4:"msavi",5:"gemi",6:"pvi",7:"gvitm",8:"sultan",9:"vari",10:"gndvi",11:"sr",12:"ndvi-re",13:"sr-re",14:"mtvi2",15:"rtvi-core",16:"ci-re",17:"ci-g",18:"ndwi",19:"evi",20:"iron-oxide",21:"ferrous-minerals",22:"clay-minerals",23:"wndwi",24:"bai",25:"nbr",26:"ndbi",27:"ndmi",28:"ndsi",29:"mndwi"},{useNumericKeys:!0});function k(t,e){var n;if(!Object(M.k)(t))return t;const{equation:r,method:s}=e,i=e.bandIndexes.map((t=>t-1)),{pixels:a,mask:c}=t;let l;switch(s){case"gndvi":case"nbr":case"ndbi":case"ndvi":case"ndvi-re":case"ndsi":case"ndmi":case"mndwi":l=P(c,a[i[0]],a[i[1]]);break;case"ndwi":l=P(c,a[i[1]],a[i[0]]);break;case"sr":case"sr-re":case"iron-oxide":case"ferrous-minerals":case"clay-minerals":l=function(t,e,n){const r=n.length,s=new Float32Array(r);for(let o=0;o<r;o++)if(null==t||t[o]){const t=e[o],r=n[o];r&&(s[o]=t/r)}return[s]}(c,a[i[0]],a[i[1]]);break;case"ci-g":case"ci-re":l=function(t,e,n){const r=e.length,s=new Float32Array(r);for(let o=0;o<r;o++)if(null==t||t[o]){const t=e[o],r=n[o];r&&(s[o]=t/r-1)}return[s]}(c,a[i[0]],a[i[1]]);break;case"savi":l=function(t,e,n,r){const s=n.length,o=new Float32Array(s);for(let i=0;i<s;i++)if(null==t||t[i]){const t=n[i],s=e[i],a=s+t+r;a&&(o[i]=(s-t)/a*(1+r))}return[o]}(c,a[i[0]],a[i[1]],i[2]+1);break;case"tsavi":l=function(t,e,n,r,s,o){const i=n.length,a=new Float32Array(i),c=-s*r+o*(1+r*r);for(let l=0;l<i;l++)if(null==t||t[l]){const t=n[l],o=e[l],i=s*o+t+c;i&&(a[l]=r*(o-r*t-s)/i)}return[a]}(c,a[i[0]],a[i[1]],i[2]+1,i[3]+1,i[4]+1);break;case"msavi":l=function(t,e,n){const r=n.length,s=new Float32Array(r);for(let o=0;o<r;o++)if(null==t||t[o]){const t=n[o],r=e[o];s[o]=.5*(2*(r+1)-Math.sqrt((2*r+1)**2-8*(r-t)))}return[s]}(c,a[i[0]],a[i[1]]);break;case"gemi":l=function(t,e,n){const r=n.length,s=new Float32Array(r);for(let o=0;o<r;o++)if(null==t||t[o]){const t=n[o],r=e[o];if(1!==t){const e=(2*(r*r-t*t)+1.5*r+.5*t)/(r+t+.5);s[o]=e*(1-.25*e)-(t-.125)/(1-t)}}return[s]}(c,a[i[0]],a[i[1]]);break;case"pvi":l=function(t,e,n,r,s){const o=n.length,i=new Float32Array(o),a=Math.sqrt(1+r*r);for(let c=0;c<o;c++)if(null==t||t[c]){const t=n[c],o=e[c];i[c]=(o-r*t-s)/a}return[i]}(c,a[i[0]],a[i[1]],i[2]+1,i[3]+1);break;case"gvitm":l=function(t,e){const[n,r,s,o,i,a]=e,c=n.length,l=new Float32Array(c);for(let u=0;u<c;u++)(null==t||t[u])&&(l[u]=-.2848*n[u]-.2435*r[u]-.5436*s[u]+.7243*o[u]+.084*i[u]-1.18*a[u]);return[l]}(c,[a[i[0]],a[i[1]],a[i[2]],a[i[3]],a[i[4]],a[i[5]]]);break;case"sultan":l=function(t,e){const[n,,r,s,o,i]=e,a=n.length,c=new Float32Array(a),l=new Float32Array(a),u=new Float32Array(a);for(let p=0;p<a;p++)(null==t||t[p])&&(c[p]=i[p]?o[p]/i[p]*100:0,l[p]=n[p]?o[p]/n[p]*100:0,u[p]=s[p]?r[p]/s[p]*(o[p]/s[p])*100:0);return[c,l,u]}(c,[a[i[0]],a[i[1]],a[i[2]],a[i[3]],a[i[4]],a[i[5]]]);break;case"vari":l=function(t,e){const[n,r,s]=e,o=n.length,i=new Float32Array(o);for(let a=0;a<o;a++)if(null==t||t[a])for(a=0;a<o;a++){const t=n[a],e=r[a],o=e+t-s[a];o&&(i[a]=(e-t)/o)}return[i]}(c,[a[i[0]],a[i[1]],a[i[2]]]);break;case"mtvi2":l=function(t,e){const[n,r,s]=e,o=n.length,i=new Float32Array(o);for(let a=0;a<o;a++)if(null==t||t[a])for(a=0;a<o;a++){const t=n[a],e=r[a],o=s[a],c=Math.sqrt((2*t+1)**2-6*t-5*Math.sqrt(e)-.5);i[a]=1.5*(1.2*(t-o)-2.5*(e-o))*c}return[i]}(c,[a[i[0]],a[i[1]],a[i[2]]]);break;case"rtvi-core":l=function(t,e){const[n,r,s]=e,o=n.length,i=new Float32Array(o);for(let a=0;a<o;a++)if(null==t||t[a])for(a=0;a<o;a++){const t=n[a],e=r[a],o=s[a];i[a]=100*(t-e)-10*(t-o)}return[i]}(c,[a[i[0]],a[i[1]],a[i[2]]]);break;case"evi":l=function(t,e){const[n,r,s]=e,o=n.length,i=new Float32Array(o);for(let a=0;a<o;a++)if(null==t||t[a])for(a=0;a<o;a++){const t=n[a],e=r[a],o=t+6*e-7.5*s[a]+1;o&&(i[a]=2.5*(t-e)/o)}return[i]}(c,[a[i[0]],a[i[1]],a[i[2]]]);break;case"wndwi":l=function(t,e,n=.5){const[r,s,o]=e,i=s.length,a=new Float32Array(i);for(let c=0;c<i;c++)if(null==t||t[c])for(c=0;c<i;c++){const t=r[c],e=s[c],i=o[c],l=t+n*e+(1-n)*i;l&&(a[c]=(t-n*e-(1-n)*i)/l)}return[a]}(c,[a[i[0]],a[i[1]],a[i[2]]],null!=(n=i[3])?n:.5);break;case"bai":l=function(t,e,n){const r=n.length,s=new Float32Array(r);for(let o=0;o<r;o++)if(null==t||t[o])for(o=0;o<r;o++){const t=(.1-e[o])**2+(.06-n[o])**2;t&&(s[o]=1/t)}return[s]}(c,a[i[0]],a[i[1]]);break;case"custom":l=T(c,a,r);break;default:return t}const u=Object(o.l)(c)?new Uint8Array(c.length):null;Object(o.l)(c)&&Object(o.l)(u)&&u.set(c);const p=new v.a({width:t.width,height:t.height,pixelType:"f32",pixels:l,mask:u});return p.updateStatistics(),p}function P(t,e,n){const r=n.length,s=new Float32Array(r);for(let o=0;o<r;o++)if(null==t||t[o]){const t=e[o],r=n[o],i=t+r;i&&(s[o]=(t-r)/i)}return[s]}var I;let B=I=class extends u{constructor(){super(...arguments),this.method="custom"}clone(){return new I({method:this.method,bandIndexes:this.bandIndexes,raster:Object(x.a)(this.raster)})}};Object(s.a)([Object(i.b)({json:{type:String,write:!0}})],B.prototype,"bandIndexes",void 0),Object(s.a)([Object(O.a)(F)],B.prototype,"method",void 0),B=I=Object(s.a)([Object(a.a)("esri.layers.support.rasterFunctions.BandArithmeticFunctionArguments")],B);const C=B;let E=class extends d{constructor(){super(...arguments),this.functionName="BandArithmetic",this.functionArguments=null,this.rasterArgumentNames=["raster"]}_bindSourceRasters(){this.outputPixelType=this._getOutputPixelType("f32");const t=this.sourceRasterInfos[0],e=t.clone();return e.pixelType=this.outputPixelType,e.statistics=null,e.histograms=null,e.bandCount="sultan"===this.functionArguments.method?t.bandCount:1,this.rasterInfo=e,{success:!0}}_processPixels(t){var e;const n=null==(e=t.pixelBlocks)?void 0:e[0];if(Object(o.k)(n))return n;const{method:r,bandIndexes:s}=this.functionArguments,i=s.split(" ").map((t=>parseFloat(t)));return k(n,{method:r,bandIndexes:i,equation:s})}};Object(s.a)([Object(i.b)({json:{write:!0,name:"rasterFunction"}})],E.prototype,"functionName",void 0),Object(s.a)([Object(i.b)({type:C,json:{write:!0,name:"rasterFunctionArguments"}})],E.prototype,"functionArguments",void 0),Object(s.a)([Object(i.b)()],E.prototype,"rasterArgumentNames",void 0),E=Object(s.a)([Object(a.a)("esri.layers.support.rasterFunctions.BandArithmeticFunction")],E);const D=E;var _,G=n(51),L=n(610);let z=_=class extends u{readColorRamp(t){return Object(L.a)(t)}clone(){var t;return new _({colormap:Object(x.a)(this.colormap),colormapName:this.colormapName,colorRamp:null==(t=this.colorRamp)?void 0:t.clone(),colorRampName:this.colorRampName})}};Object(s.a)([Object(i.b)({type:[[Number]],json:{write:!0}})],z.prototype,"colormap",void 0),Object(s.a)([Object(i.b)({type:String,json:{write:!0}})],z.prototype,"colormapName",void 0),Object(s.a)([Object(i.b)({types:L.b,json:{write:!0}})],z.prototype,"colorRamp",void 0),Object(s.a)([Object(G.a)("colorRamp")],z.prototype,"readColorRamp",null),Object(s.a)([Object(i.b)({type:String,json:{write:!0}})],z.prototype,"colorRampName",void 0),z=_=Object(s.a)([Object(a.a)("esri.layers.support.rasterFunctions.ColormapFunctionArguments")],z);const V=z;var q=n(1252);let H=class extends d{constructor(){super(...arguments),this.functionName="Colormap",this.functionArguments=null,this.rasterArgumentNames=["raster"]}_bindSourceRasters(){var t,e;const n=this.sourceRasterInfos[0];if(n.bandCount>1)return{success:!1,error:"colormap-function: source data must be single band"};let{colormap:r,colorRamp:s}=this.functionArguments;if(null!=(t=r)&&t.length||s&&(r=Object(q.c)(s,256,!0)),null==(e=r)||!e.length)return{success:!1,error:"colormap-function: missing colormap argument"};this.outputPixelType=this._getOutputPixelType("u8");const o=n.clone();return o.pixelType=this.outputPixelType,o.colormap=r,this.rasterInfo=o,{success:!0}}_processPixels(t){var e;return null==(e=t.pixelBlocks)?void 0:e[0]}};Object(s.a)([Object(i.b)({json:{write:!0,name:"rasterFunction"}})],H.prototype,"functionName",void 0),Object(s.a)([Object(i.b)({type:V,json:{write:!0,name:"rasterFunctionArguments"}})],H.prototype,"functionArguments",void 0),Object(s.a)([Object(i.b)()],H.prototype,"rasterArgumentNames",void 0),Object(s.a)([Object(i.b)({json:{write:!0}})],H.prototype,"indexedColormap",void 0),H=Object(s.a)([Object(a.a)("esri.layers.support.rasterFunctions.ColormapFunction")],H);const W=H;var X,U=n(50);let Y=X=class extends u{writeRasters(t,e){e.rasters=t.map((t=>"number"==typeof t||"string"==typeof t?t:t.toJSON()))}clone(){return new X({rasters:Object(x.a)(this.rasters)})}};Object(s.a)([Object(i.b)({json:{write:!0}})],Y.prototype,"rasters",void 0),Object(s.a)([Object(U.a)("rasters")],Y.prototype,"writeRasters",null),Y=X=Object(s.a)([Object(a.a)("esri.layers.support.rasterFunctions.CompositeBandFunctionArguments")],Y);const J=Y;let K=class extends d{constructor(){super(...arguments),this.functionName="CompositeBand",this.functionArguments=null,this.rasterArgumentNames=["rasters"]}_bindSourceRasters(){const{sourceRasterInfos:t}=this,e=t[0];this.outputPixelType=this._getOutputPixelType(e.pixelType);const n=e.clone();if(n.attributeTable=null,n.colormap=null,n.pixelType=this.outputPixelType,n.bandCount=t.map((({bandCount:t})=>t)).reduce(((t,e)=>t+e)),t.every((({statistics:t})=>Object(o.l)(t)&&t.length))){const e=[];t.forEach((({statistics:t})=>Object(o.l)(t)&&e.push(...t))),n.statistics=e}if(t.every((({histograms:t})=>Object(o.l)(t)&&t.length))){const e=[];t.forEach((({histograms:t})=>Object(o.l)(t)&&e.push(...t))),n.histograms=e}return this.rasterInfo=n,{success:!0}}_processPixels(t){const{pixelBlocks:e}=t;if(!e)return null;const n=null==e?void 0:e[0];return Object(o.k)(n)?null:Object(M.e)(e)}};Object(s.a)([Object(i.b)({json:{write:!0,name:"rasterFunction"}})],K.prototype,"functionName",void 0),Object(s.a)([Object(i.b)({type:J,json:{write:!0,name:"rasterFunctionArguments"}})],K.prototype,"functionArguments",void 0),Object(s.a)([Object(i.b)()],K.prototype,"rasterArgumentNames",void 0),K=Object(s.a)([Object(a.a)("esri.layers.support.rasterFunctions.CompositeBandFunction")],K);const $=K;var Q,Z;(Z=Q||(Q={}))[Z.UserDefined=-1]="UserDefined",Z[Z.LineDetectionHorizontal=0]="LineDetectionHorizontal",Z[Z.LineDetectionVertical=1]="LineDetectionVertical",Z[Z.LineDetectionLeftDiagonal=2]="LineDetectionLeftDiagonal",Z[Z.LineDetectionRightDiagonal=3]="LineDetectionRightDiagonal",Z[Z.GradientNorth=4]="GradientNorth",Z[Z.GradientWest=5]="GradientWest",Z[Z.GradientEast=6]="GradientEast",Z[Z.GradientSouth=7]="GradientSouth",Z[Z.GradientNorthEast=8]="GradientNorthEast",Z[Z.GradientNorthWest=9]="GradientNorthWest",Z[Z.SmoothArithmeticMean=10]="SmoothArithmeticMean",Z[Z.Smoothing3x3=11]="Smoothing3x3",Z[Z.Smoothing5x5=12]="Smoothing5x5",Z[Z.Sharpening3x3=13]="Sharpening3x3",Z[Z.Sharpening5x5=14]="Sharpening5x5",Z[Z.Laplacian3x3=15]="Laplacian3x3",Z[Z.Laplacian5x5=16]="Laplacian5x5",Z[Z.SobelHorizontal=17]="SobelHorizontal",Z[Z.SobelVertical=18]="SobelVertical",Z[Z.Sharpen=19]="Sharpen",Z[Z.Sharpen2=20]="Sharpen2",Z[Z.PointSpread=21]="PointSpread",Z[Z.None=255]="None";const tt=new Map;function et(t,e,n,r,s,o,i){const a=new Float32Array(e*n),c=o.length,l=i?0:r,u=i?r:0,p=i?1:e;for(let f=l;f<n-l;f++){const n=f*e;for(let i=u;i<e-u;i++){if(s&&!s[n+i])continue;let e=0;for(let s=0;s<c;s++)e+=t[n+i+(s-r)*p]*o[s];a[n+i]=e}}return a}function nt(t,e,n,r,s,o,i){const a=new Float32Array(e*n),c=Math.floor(r/2),l=Math.floor(s/2);for(let u=c;u<n-c;u++){const n=u*e;for(let u=l;u<e-l;u++){if(o&&!o[n+u])continue;let p=0;for(let o=0;o<r;o++)for(let r=0;r<s;r++)p+=t[n+u+(o-c)*e+r-l]*i[o*s+r];a[n+u]=p}}return a}function rt(t,e,n,r,s){const o=Math.floor(r/2);for(let a=0;a<o;a++)for(let r=0;r<e;r++)t[a*e+r]=t[(s-1-a)*e+r],t[(n-1-a)*e+r]=t[(n-s+a)*e+r];const i=Math.floor(s/2);for(let a=0;a<n;a++){const n=a*e;for(let r=0;r<i;r++)t[n+r]=t[n+s-1-r],t[n+e-r-1]=t[n+e+r-s]}}function st(t,e){const n=function(t){const e=Math.sqrt(t.length),n=t.slice(0,e),r=[1];for(let s=1;s<e;s++){let n=null;for(let r=0;r<e;r++){const o=t[r+s*e],i=t[r];if(null==n)if(0===i){if(o)return{separable:!1,row:null,col:null}}else n=o/i;else if(o/i!==n)return{separable:!1,row:null,col:null}}if(null==n)return{separable:!1,row:null,col:null};r.push(n)}return{separable:!0,row:n,col:r}}(e.kernel),r=!1!==e.mirrorEdges,s=n.separable?function(t,e,n,r=!0){const{pixels:s,width:o,height:i,pixelType:a,mask:c}=t,l=s.length,u=[],p=e.length,f=n.length,h=Math.floor(p/2),m=Math.floor(f/2);for(let b=0;b<l;b++){let t=et(s[b],o,i,h,c,e,!0);t=et(t,o,i,m,c,n,!1),r&&rt(t,o,i,p,f),u.push(t)}return new v.a({width:o,height:i,pixelType:a,pixels:u,mask:c})}(t,n.row,n.col,r):function(t,e,n=!0){const{pixels:r,width:s,height:o,pixelType:i,mask:a}=t,c=r.length,l=[],{kernel:u,rows:p,cols:f}=e;for(let h=0;h<c;h++){const t=nt(r[h],s,o,p,f,a,u);n&&rt(t,s,o,p,f),l.push(t)}return new v.a({width:s,height:o,pixelType:i,pixels:l,mask:a})}(t,e,r),{outputPixelType:o}=e;return o&&s.clamp(o),s}var ot;tt.set(Q.None,[0,0,0,0,1,0,0,0,0]),tt.set(Q.LineDetectionHorizontal,[-1,-1,-1,2,2,2,-1,-1,-1]),tt.set(Q.LineDetectionVertical,[-1,2,-1,-1,2,-1,-1,2,-1]),tt.set(Q.LineDetectionLeftDiagonal,[2,-1,-1,-1,2,-1,-1,-1,2]),tt.set(Q.LineDetectionRightDiagonal,[-1,-1,2,-1,2,-1,2,-1,-1]),tt.set(Q.GradientNorth,[-1,-2,-1,0,0,0,1,2,1]),tt.set(Q.GradientWest,[-1,0,1,-2,0,2,-1,0,1]),tt.set(Q.GradientEast,[1,0,-1,2,0,-2,1,0,-1]),tt.set(Q.GradientSouth,[1,2,1,0,0,0,-1,-2,-1]),tt.set(Q.GradientNorthEast,[0,-1,-2,1,0,-1,2,1,0]),tt.set(Q.GradientNorthWest,[-2,-1,0,-1,0,1,0,1,2]),tt.set(Q.SmoothArithmeticMean,[.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111]),tt.set(Q.Smoothing3x3,[.0625,.125,.0625,.125,.25,.125,.0625,.125,.0625]),tt.set(Q.Smoothing5x5,[1,1,1,1,1,1,4,4,4,1,1,4,12,4,1,1,4,4,4,1,1,1,1,1,1]),tt.set(Q.Sharpening3x3,[-1,-1,-1,-1,9,-1,-1,-1,-1]),tt.set(Q.Sharpening5x5,[-1,-3,-4,-3,-1,-3,0,6,0,-3,-4,6,21,6,-4,-3,0,6,0,-3,-1,-3,-4,-3,-1]),tt.set(Q.Laplacian3x3,[0,-1,0,-1,4,-1,0,-1,0]),tt.set(Q.Laplacian5x5,[0,0,-1,0,0,0,-1,-2,-1,0,-1,-2,17,-2,-1,0,-1,-2,-1,0,0,0,-1,0,0]),tt.set(Q.SobelHorizontal,[-1,-2,-1,0,0,0,1,2,1]),tt.set(Q.SobelVertical,[-1,0,1,-2,0,2,-1,0,1]),tt.set(Q.Sharpen,[0,-.25,0,-.25,2,-.25,0,-.25,0]),tt.set(Q.Sharpen2,[-.25,-.25,-.25,-.25,3,-.25,-.25,-.25,-.25]),tt.set(Q.PointSpread,[-.627,.352,-.627,.352,2.923,.352,-.627,.352,-.627]);let it=ot=class extends u{constructor(){super(...arguments),this.rows=3,this.cols=3,this.kernel=[0,0,0,0,1,0,0,0,0]}set kernelType(t){this._set("kernelType",t);const e=tt.get(t);if(!e||t===Q.UserDefined||t===Q.None)return;const n=Math.sqrt(e.length);this._set("kernel",e),this._set("cols",n),this._set("rows",n)}clone(){return new ot({cols:this.cols,rows:this.rows,kernel:[...this.kernel],kernelType:this.kernelType,raster:Object(x.a)(this.raster)})}};Object(s.a)([Object(i.b)({json:{type:Number,write:!0}})],it.prototype,"rows",void 0),Object(s.a)([Object(i.b)({json:{type:Number,write:!0}})],it.prototype,"cols",void 0),Object(s.a)([Object(i.b)({json:{name:"type",type:Number,write:!0}})],it.prototype,"kernelType",null),Object(s.a)([Object(i.b)({json:{type:[Number],write:!0}})],it.prototype,"kernel",void 0),it=ot=Object(s.a)([Object(a.a)("esri.layers.support.rasterFunctions.ConvolutionFunctionArguments")],it);const at=it;let ct=class extends d{constructor(){super(...arguments),this.functionName="Convolution",this.rasterArgumentNames=["raster"]}_bindSourceRasters(){const{kernelType:t,rows:e,cols:n,kernel:r}=this.functionArguments;if(!tt.has(t))return{success:!1,error:`convolution-function: the specified kernel type is not supported ${t}`};if(t!==Q.None&&e*n!==r.length)return{success:!1,error:"convolution-function: the specified rows and cols do not match the length of the kernel"};const s=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType(s.pixelType);const o=s.clone();o.pixelType=this.outputPixelType;const i=[Q.None,Q.Sharpen,Q.Sharpen2,Q.Sharpening3x3,Q.Sharpening5x5];return"u8"===this.outputPixelType||i.includes(t)||(o.statistics=null,o.histograms=null),this.rasterInfo=o,{success:!0}}_processPixels(t){var e;const n=null==(e=t.pixelBlocks)?void 0:e[0];if(Object(o.k)(n)||this.functionArguments.kernelType===Q.None)return n;let{kernel:r,rows:s,cols:i}=this.functionArguments;const a=r.reduce(((t,e)=>t+e));return 0!==a&&1!==a&&(r=r.map((t=>t/a))),st(n,{kernel:r,rows:s,cols:i,outputPixelType:this.outputPixelType})}};Object(s.a)([Object(i.b)({json:{write:!0,name:"rasterFunction"}})],ct.prototype,"functionName",void 0),Object(s.a)([Object(i.b)({type:at,json:{write:!0,name:"rasterFunctionArguments"}})],ct.prototype,"functionArguments",void 0),Object(s.a)([Object(i.b)()],ct.prototype,"rasterArgumentNames",void 0),ct=Object(s.a)([Object(a.a)("esri.layers.support.rasterFunctions.ConvolutionFunction")],ct);const lt=ct;var ut;let pt=ut=class extends u{constructor(){super(...arguments),this.bandIDs=[],this.missingBandAction=M.a.bestMatch}clone(){return new ut({bandIDs:[...this.bandIDs],missingBandAction:this.missingBandAction})}};Object(s.a)([Object(i.b)({json:{write:!0}})],pt.prototype,"bandIDs",void 0),Object(s.a)([Object(i.b)({json:{write:!0}})],pt.prototype,"missingBandAction",void 0),pt=ut=Object(s.a)([Object(a.a)("esri.layers.support.rasterFunctions.ExtractBandFunctionArguments")],pt);const ft=pt;let ht=class extends d{constructor(){super(...arguments),this.functionName="ExtractBand",this.functionArguments=null,this.rasterArgumentNames=["raster"]}_bindSourceRasters(){const{sourceRasterInfos:t}=this,e=t[0],{bandCount:n}=e,{bandIDs:r,missingBandAction:s}=this.functionArguments;if(s===M.a.fail&&r.some((t=>t<0||t>=n)))return{success:!1,error:"extract-band-function: invalid bandIDs"};this.outputPixelType=this._getOutputPixelType("f32");const i=e.clone();i.pixelType=this.outputPixelType;const{statistics:a,histograms:c}=i;return Object(o.l)(a)&&a.length&&(i.statistics=r.map((t=>a[t]||a[a.length-1]))),Object(o.l)(c)&&c.length&&(i.histograms=r.map((t=>c[t]||c[c.length-1]))),this.rasterInfo=i,{success:!0}}_processPixels(t){var e;const n=null==(e=t.pixelBlocks)?void 0:e[0];if(Object(o.k)(n))return null;const r=n.pixels.length,s=this.functionArguments.bandIDs.map((t=>t>=r?r-1:t));return n.extractBands(s)}};Object(s.a)([Object(i.b)({json:{write:!0,name:"rasterFunction"}})],ht.prototype,"functionName",void 0),Object(s.a)([Object(i.b)({type:ft,json:{write:!0,name:"rasterFunctionArguments"}})],ht.prototype,"functionArguments",void 0),Object(s.a)([Object(i.b)()],ht.prototype,"rasterArgumentNames",void 0),ht=Object(s.a)([Object(a.a)("esri.layers.support.rasterFunctions.ExtractBandFunction")],ht);const mt=ht;var bt;let dt=bt=class extends u{constructor(){super(...arguments),this.rasters=[],this.processAsMultiband=!1}writeRasters(t,e){e.rasters=t.map((t=>"number"==typeof t||"string"==typeof t?t:t.toJSON()))}clone(){return new bt({method:this.operation,processAsMultiband:this.processAsMultiband,rasters:Object(x.a)(this.rasters)})}};Object(s.a)([Object(i.b)({json:{write:!0}})],dt.prototype,"operation",void 0),Object(s.a)([Object(i.b)({json:{write:!0}})],dt.prototype,"rasters",void 0),Object(s.a)([Object(U.a)("rasters")],dt.prototype,"writeRasters",null),Object(s.a)([Object(i.b)({json:{write:!0}})],dt.prototype,"processAsMultiband",void 0),dt=bt=Object(s.a)([Object(a.a)("esri.layers.support.rasterFunctions.LocalFunctionArguments")],dt);const gt=dt;var yt,jt;(jt=yt||(yt={}))[jt.Plus=1]="Plus",jt[jt.Minus=2]="Minus",jt[jt.Times=3]="Times",jt[jt.SquareRoot=4]="SquareRoot",jt[jt.Power=5]="Power",jt[jt.ACos=6]="ACos",jt[jt.ASin=7]="ASin",jt[jt.ATan=8]="ATan",jt[jt.ATanH=9]="ATanH",jt[jt.Abs=10]="Abs",jt[jt.BitwiseAnd=11]="BitwiseAnd",jt[jt.BitwiseLeftShift=12]="BitwiseLeftShift",jt[jt.BitwiseNot=13]="BitwiseNot",jt[jt.BitwiseOr=14]="BitwiseOr",jt[jt.BitwiseRightShift=15]="BitwiseRightShift",jt[jt.BitwiseXOr=16]="BitwiseXOr",jt[jt.BooleanAnd=17]="BooleanAnd",jt[jt.BooleanNot=18]="BooleanNot",jt[jt.BooleanOr=19]="BooleanOr",jt[jt.BooleanXOr=20]="BooleanXOr",jt[jt.Cos=21]="Cos",jt[jt.CosH=22]="CosH",jt[jt.Divide=23]="Divide",jt[jt.EqualTo=24]="EqualTo",jt[jt.Exp=25]="Exp",jt[jt.Exp10=26]="Exp10",jt[jt.Exp2=27]="Exp2",jt[jt.GreaterThan=28]="GreaterThan",jt[jt.GreaterThanEqual=29]="GreaterThanEqual",jt[jt.Int=30]="Int",jt[jt.IsNull=31]="IsNull",jt[jt.Float=32]="Float",jt[jt.LessThan=33]="LessThan",jt[jt.LessThanEqual=34]="LessThanEqual",jt[jt.Ln=35]="Ln",jt[jt.Log10=36]="Log10",jt[jt.Log2=37]="Log2",jt[jt.Majority=38]="Majority",jt[jt.Max=39]="Max",jt[jt.Mean=40]="Mean",jt[jt.Med=41]="Med",jt[jt.Min=42]="Min",jt[jt.Minority=43]="Minority",jt[jt.Mod=44]="Mod",jt[jt.Negate=45]="Negate",jt[jt.NotEqual=46]="NotEqual",jt[jt.Range=47]="Range",jt[jt.RoundDown=48]="RoundDown",jt[jt.RoundUp=49]="RoundUp",jt[jt.SetNull=50]="SetNull",jt[jt.Sin=51]="Sin",jt[jt.SinH=52]="SinH",jt[jt.Square=53]="Square",jt[jt.Std=54]="Std",jt[jt.Sum=55]="Sum",jt[jt.Tan=56]="Tan",jt[jt.TanH=57]="TanH",jt[jt.Variety=58]="Variety",jt[jt.ACosH=59]="ACosH",jt[jt.ASinH=60]="ASinH",jt[jt.ATan2=61]="ATan2",jt[jt.FloatDivide=64]="FloatDivide",jt[jt.FloorDivide=65]="FloorDivide",jt[jt.MajorityIgnoreNoData=66]="MajorityIgnoreNoData",jt[jt.MaxIgnoreNoData=67]="MaxIgnoreNoData",jt[jt.MeanIgnoreNoData=68]="MeanIgnoreNoData",jt[jt.MedIgnoreNoData=69]="MedIgnoreNoData",jt[jt.MinIgnoreNoData=70]="MinIgnoreNoData",jt[jt.MinorityIgnoreNoData=71]="MinorityIgnoreNoData",jt[jt.RangeIgnoreNoData=72]="RangeIgnoreNoData",jt[jt.StdIgnoreNoData=73]="StdIgnoreNoData",jt[jt.SumIgnoreNoData=74]="SumIgnoreNoData",jt[jt.VarietyIgnoreNoData=75]="VarietyIgnoreNoData",jt[jt.Con=76]="Con";function xt(t,e,n){const[r,s]=t,o=r.length,i=v.a.createEmptyBand(n,o);for(let a=0;a<o;a++)e&&!e[a]||(i[a]=r[a]+s[a]);return i}function Ot(t,e,n){const[r]=t,s=r.length,o=v.a.createEmptyBand("f32",s);return o.set(r),o}function wt(t,e,n){const[r,s]=t,o=r.length,i=v.a.createEmptyBand(n,o);for(let a=0;a<o;a++)e&&!e[a]||(i[a]=r[a]-s[a]);return i}function vt(t,e,n){const[r,s]=t,o=r.length,i=v.a.createEmptyBand(n,o);for(let a=0;a<o;a++)e&&!e[a]||(i[a]=r[a]*s[a]);return i}function At(t,e,n){const[r,s]=t,o=r.length,i=v.a.createEmptyBand(n,o);for(let a=0;a<o;a++)e&&!e[a]||(i[a]=0===s[a]?0:r[a]/s[a]);return i}function Nt(t,e,n){return At(t,e,"f32")}function St(t,e,n){const[r,s]=t,o=r.length,i=v.a.createEmptyBand(n,o);for(let a=0;a<o;a++)e&&!e[a]||(i[a]=0===s[a]?0:Math.floor(r[a]/s[a]));return i}function Rt(t,e,n,r){const[s]=t,o=s.length,i=v.a.createEmptyBand(n,o);for(let a=0;a<o;a++)e&&!e[a]||(i[a]=r(s[a]));return i}function Tt(t,e,n,r){const[s,o]=t,i=s.length,a=v.a.createEmptyBand(n,i);for(let c=0;c<i;c++)e&&!e[c]||(a[c]=r(s[c],o[c]));return a}function Mt(t,e,n){const[r,s]=t,o=r.length,i=v.a.createEmptyBand(n,o);for(let a=0;a<o;a++)e&&!e[a]||(i[a]=r[a]&s[a]);return i}function Ft(t,e,n){const[r,s]=t,o=r.length,i=v.a.createEmptyBand(n,o);for(let a=0;a<o;a++)e&&!e[a]||(i[a]=r[a]<<s[a]);return i}function kt(t,e,n){const[r]=t,s=r.length,o=v.a.createEmptyBand(n,s);for(let i=0;i<s;i++)e&&!e[i]||(o[i]=~r[i]);return o}function Pt(t,e,n){const[r,s]=t,o=r.length,i=v.a.createEmptyBand(n,o);for(let a=0;a<o;a++)e&&!e[a]||(i[a]=r[a]|s[a]);return i}function It(t,e,n){const[r,s]=t,o=r.length,i=v.a.createEmptyBand(n,o);for(let a=0;a<o;a++)e&&!e[a]||(i[a]=r[a]>>s[a]);return i}function Bt(t,e,n){const[r,s]=t,o=r.length,i=v.a.createEmptyBand(n,o);for(let a=0;a<o;a++)e&&!e[a]||(i[a]=r[a]^s[a]);return i}function Ct(t,e,n){const[r,s]=t,o=r.length,i=v.a.createEmptyBand(n,o);for(let a=0;a<o;a++)e&&!e[a]||(i[a]=r[a]&&s[a]?1:0);return i}function Et(t,e,n){const[r]=t,s=r.length,o=v.a.createEmptyBand(n,s);for(let i=0;i<s;i++)e&&!e[i]||(o[i]=r[i]?0:1);return o}function Dt(t,e,n){const[r,s]=t,o=r.length,i=v.a.createEmptyBand(n,o);for(let a=0;a<o;a++)e&&!e[a]||(i[a]=r[a]||s[a]?1:0);return i}function _t(t,e,n){const[r,s]=t,o=r.length,i=v.a.createEmptyBand(n,o);for(let a=0;a<o;a++)e&&!e[a]||(i[a]=(r[a]?1:0)^(s[a]?1:0));return i}function Gt(t,e,n){const[r,s]=t,o=r.length,i=v.a.createEmptyBand(n,o);for(let a=0;a<o;a++)e&&!e[a]||(i[a]=r[a]===s[a]?1:0);return i}function Lt(t,e,n,r){const[s]=t,o=s.length,i=v.a.createEmptyBand(n,o);for(let a=0;a<o;a++)e&&!e[a]||(i[a]=r**s[a]);return i}function zt(t,e,n){return Lt(t,e,n,10)}function Vt(t,e,n){return Lt(t,e,n,2)}function qt(t,e,n){const[r,s]=t,o=r.length,i=v.a.createEmptyBand(n,o);for(let a=0;a<o;a++)e&&!e[a]||(i[a]=r[a]>s[a]?1:0);return i}function Ht(t,e,n){const[r,s]=t,o=r.length,i=v.a.createEmptyBand(n,o);for(let a=0;a<o;a++)e&&!e[a]||(i[a]=r[a]>=s[a]?1:0);return i}function Wt(t,e,n){const[r,s]=t,o=r.length,i=v.a.createEmptyBand(n,o);for(let a=0;a<o;a++)e&&!e[a]||(i[a]=r[a]<s[a]?1:0);return i}function Xt(t,e,n){const[r,s]=t,o=r.length,i=v.a.createEmptyBand(n,o);for(let a=0;a<o;a++)e&&!e[a]||(i[a]=r[a]<=s[a]?1:0);return i}function Ut(t,e,n){const[r]=t,s=r.length,o=v.a.createEmptyBand(n,s);if(!e)return o;for(let i=0;i<s;i++)o[i]=e[i]?0:1;return o}function Yt(t,e,n){const[r,s]=t,o=r.length,i=v.a.createEmptyBand(n,o);for(let a=0;a<o;a++)e&&!e[a]||(i[a]=r[a]%s[a]);return i}function Jt(t,e,n){const[r]=t,s=r.length,o=v.a.createEmptyBand(n,s);for(let i=0;i<s;i++)e&&!e[i]||(o[i]=-r[i]);return o}function Kt(t,e,n){const[r,s]=t,o=r.length,i=v.a.createEmptyBand(n,o);for(let a=0;a<o;a++)e&&!e[a]||(i[a]=r[a]===s[a]?0:1);return i}function $t(t,e,n){const[r,s]=t,o=r.length,i=v.a.createEmptyBand(n,o),a=new Uint8Array(o);for(let c=0;c<o;c++)null!=e&&!e[c]||0!==r[c]||(i[c]=s[c],a[c]=255);return{band:i,mask:a}}function Qt(t,e,n){const[r,s,o]=t,i=r.length,a=v.a.createEmptyBand(n,i);for(let c=0;c<i;c++)e&&!e[c]||(a[c]=r[c]?s[c]:o[c]);return a}function Zt(t,e,n){const r=t.length;if(r<2)return t[0];const[s]=t,o=s.length,i=v.a.createEmptyBand(n,o);i.set(s);for(let a=0;a<o;a++)if(!e||e[a])for(let e=1;e<r;e++){const n=t[e];i[a]<n[a]&&(i[a]=n[a])}return i}function te(t,e,n){const r=t.length;if(r<2)return t[0];const[s]=t,o=s.length,i=v.a.createEmptyBand(n,o);i.set(s);for(let a=0;a<o;a++)if(!e||e[a])for(let e=1;e<r;e++){const n=t[e];i[a]>n[a]&&(i[a]=n[a])}return i}function ee(t,e,n){const r=t.length;if(r<2)return t[0];const[s]=t,o=s.length,i=v.a.createEmptyBand(n,o);i.set(s);for(let a=0;a<o;a++)if(!e||e[a]){let e=i[a];for(let n=1;n<r;n++){const r=t[n];i[a]<r[a]&&(i[a]=r[a]),e>r[a]&&(e=r[a])}i[a]-=e}return i}function ne(t,e,n){const r=t.length;if(r<2)return t[0];const[s]=t,o=s.length,i=v.a.createEmptyBand(n,o);i.set(s);for(let a=0;a<o;a++)if(!e||e[a]){for(let e=1;e<r;e++){const n=t[e];i[a]+=n[a]}i[a]/=r}return i}function re(t,e,n){const r=t.length;if(r<2)return t[0];const[s]=t,o=s.length,i=v.a.createEmptyBand(n,o);i.set(s);for(let a=0;a<o;a++)if(!e||e[a])for(let e=1;e<r;e++){const n=t[e];i[a]+=n[a]}return i}function se(t,e,n){const r=t.length;if(r<2)return t[0];const[s]=t,o=s.length,i=v.a.createEmptyBand(n,o);for(let a=0;a<o;a++)if(!e||e[a]){const e=new Float32Array(r);let n=0;for(let o=0;o<r;o++){const r=t[o];n+=r[a],e[o]=r[a]}n/=r;let s=0;for(let t=0;t<r;t++)s+=(e[t]-n)*e[t]-n;i[a]=Math.sqrt(s/r-1)}return i}function oe(t,e,n){const r=t.length;if(r<2)return t[0];const s=Math.floor(r/2),[o]=t,i=o.length,a=v.a.createEmptyBand(n,i),c=new Float32Array(r);for(let l=0;l<i;l++)if(!e||e[l]){for(let e=0;e<r;e++)c[e]=t[e][l];c.sort(),a[l]=c[s]}return a}function ie(t,e,n){const r=t.length;if(r<2)return t[0];const[s]=t,o=s.length,i=v.a.createEmptyBand(n,o),a=new Map;for(let c=0;c<o;c++)if(!e||e[c]){let e;a.clear();for(let o=0;o<r;o++)e=t[o][c],a.set(e,a.has(e)?a.get(e)+1:1);let n=0,s=0;for(const t of a.keys())n=a.get(t),n>s&&(s=n,e=t);i[c]=e}return i}function ae(t,e,n){const r=t.length;if(r<2)return t[0];const[s]=t,o=s.length,i=v.a.createEmptyBand(n,o),a=new Map;for(let c=0;c<o;c++)if(!e||e[c]){let e;a.clear();for(let o=0;o<r;o++)e=t[o][c],a.set(e,a.has(e)?a.get(e)+1:1);let n=0,s=t.length;for(const t of a.keys())n=a.get(t),n<s&&(s=n,e=t);i[c]=e}return i}function ce(t,e,n){const r=t.length;if(r<2)return t[0];const[s]=t,o=s.length,i=v.a.createEmptyBand(n,o),a=new Set;for(let c=0;c<o;c++)if(!e||e[c]){let e;a.clear();for(let n=0;n<r;n++)e=t[n][c],a.add(e);i[c]=a.size}return i}function le(t,e,n){return ie(t,null,n)}function ue(t,e,n){return ae(t,null,n)}function pe(t,e,n){return ce(t,null,n)}function fe(t,e,n){return Zt(t,null,n)}function he(t,e,n){return te(t,null,n)}function me(t,e,n){return se(t,null,n)}function be(t,e,n){return re(t,null,n)}function de(t,e,n){return ne(t,null,n)}function ge(t,e,n){return oe(t,null,n)}function ye(t,e,n){return ee(t,null,n)}const je=new Map,xe=new Map,Oe=new Map;function we(t,e,n={}){je.size||(je.set(4,Math.sqrt),je.set(6,Math.acos),je.set(7,Math.asin),je.set(8,Math.atan),je.set(9,Math.atanh),je.set(10,Math.abs),je.set(21,Math.cos),je.set(22,Math.cosh),je.set(25,Math.exp),je.set(30,Math.floor),je.set(35,Math.log),je.set(36,Math.log10),je.set(37,Math.log2),je.set(48,Math.floor),je.set(49,Math.ceil),je.set(51,Math.sin),je.set(52,Math.sinh),je.set(56,Math.tan),je.set(57,Math.tanh),je.set(59,Math.acosh),je.set(60,Math.asinh),je.set(65,Math.floor),xe.set(5,Math.pow),xe.set(61,Math.atan2),Oe.set(1,xt),Oe.set(2,wt),Oe.set(3,vt),Oe.set(11,Mt),Oe.set(12,Ft),Oe.set(12,Ft),Oe.set(13,kt),Oe.set(14,Pt),Oe.set(15,It),Oe.set(16,Bt),Oe.set(17,Ct),Oe.set(18,Et),Oe.set(19,Dt),Oe.set(20,_t),Oe.set(23,At),Oe.set(24,Gt),Oe.set(26,zt),Oe.set(27,Vt),Oe.set(28,qt),Oe.set(29,Ht),Oe.set(31,Ut),Oe.set(32,Ot),Oe.set(33,Wt),Oe.set(34,Xt),Oe.set(44,Yt),Oe.set(45,Jt),Oe.set(46,Kt),Oe.set(64,Nt),Oe.set(65,St),Oe.set(76,Qt),Oe.set(38,ie),Oe.set(39,Zt),Oe.set(40,ne),Oe.set(41,oe),Oe.set(42,te),Oe.set(43,ae),Oe.set(47,ee),Oe.set(54,se),Oe.set(55,re),Oe.set(58,ce),Oe.set(66,le),Oe.set(67,fe),Oe.set(68,de),Oe.set(69,ge),Oe.set(70,he),Oe.set(71,ue),Oe.set(72,ye),Oe.set(73,me),Oe.set(74,be),Oe.set(75,pe));const r=Object(o.t)(function(t){const e=t.map((t=>t.mask)).filter((t=>Object(o.l)(t)));if(0===e.length)return null;const n=e[0].length,r=new Uint8Array(n);if(1===e.length)return r.set(e[0]),r;let s,i=e[0];for(let o=1;o<e.length;o++){s=e[o];for(let t=0;t<n;t++)r[t]=i[t]|s[t];i=s}return r}(t)),{processAsMultiband:s,outputPixelType:i="f32"}=n,a=s?t[0].pixels.length:1,c=[];let l;for(let o=0;o<a;o++){const n=t.map((t=>t.pixels[o]));let s;if(e===yt.SetNull){const t=$t(n,r,i);s=t.band,l=t.mask}else Oe.has(e)?s=Oe.get(e)(n,r,i):je.has(e)?s=Rt(n,r,i,je.get(e)):xe.has(e)&&(s=Tt(n,r,i,xe.get(e)));if(null==s)return null;c.push(s)}l||e===yt.IsNull||(l=r);const u=t[0];return new v.a({width:u.width,height:u.height,pixelType:i,mask:l,pixels:c})}let ve=class extends d{constructor(){super(...arguments),this.functionName="Local",this.functionArguments=null,this.rasterArgumentNames=["rasters"]}_bindSourceRasters(){const{sourceRasterInfos:t}=this,e=t[0],{bandCount:n}=e,{processAsMultiband:r}=this.functionArguments;if(r&&t.some((t=>t.bandCount!==n)))return{success:!1,error:"local-function: input rasters do not have same band count"};this.outputPixelType=this._getOutputPixelType("f32");const s=e.clone();return s.pixelType=this.outputPixelType,s.statistics=null,s.histograms=null,r||(s.bandCount=1),this.rasterInfo=s,{success:!0}}_processPixels(t){var e;const{pixelBlocks:n}=t;return Object(o.k)(n)||n.some((t=>Object(o.k)(t)))?null:we(n,this.functionArguments.operation,{processAsMultiband:this.functionArguments.processAsMultiband,outputPixelType:null!=(e=this.outputPixelType)?e:void 0})}};Object(s.a)([Object(i.b)({json:{write:!0,name:"rasterFunction"}})],ve.prototype,"functionName",void 0),Object(s.a)([Object(i.b)({type:gt,json:{write:!0,name:"rasterFunctionArguments"}})],ve.prototype,"functionArguments",void 0),Object(s.a)([Object(i.b)()],ve.prototype,"rasterArgumentNames",void 0),ve=Object(s.a)([Object(a.a)("esri.layers.support.rasterFunctions.LocalFunction")],ve);const Ae=ve;var Ne;let Se=Ne=class extends u{constructor(){super(...arguments),this.includedRanges=null,this.noDataValues=null,this.noDataInterpretation=M.b.matchAny}clone(){var t,e,n,r;return new Ne({includedRanges:null!=(t=null==(e=this.includedRanges)?void 0:e.slice())?t:[],noDataValues:null!=(n=null==(r=this.noDataValues)?void 0:r.slice())?n:[],noDataInterpretation:this.noDataInterpretation})}};Object(s.a)([Object(i.b)({json:{write:!0}})],Se.prototype,"includedRanges",void 0),Object(s.a)([Object(i.b)({json:{write:!0}})],Se.prototype,"noDataValues",void 0),Object(s.a)([Object(i.b)({json:{write:!0}})],Se.prototype,"noDataInterpretation",void 0),Se=Ne=Object(s.a)([Object(a.a)("esri.layers.support.rasterFunctions.MaskFunctionArguments")],Se);const Re=Se;let Te=class extends d{constructor(){super(...arguments),this.functionName="Mask",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.lookup=null}_bindSourceRasters(){const t=this.sourceRasterInfos[0].clone(),{pixelType:e}=t;this.outputPixelType=this._getOutputPixelType(e),t.pixelType=this.outputPixelType,this.rasterInfo=t;const{includedRanges:n,noDataValues:r}=this.functionArguments;return null!=n&&n.length||null!=r&&r.length?(this.lookup=Object(M.g)(e,this.functionArguments.includedRanges,this.functionArguments.noDataValues),{success:!0}):{success:!1,error:"missing includedRanges or noDataValues argument"}}_processPixels(t){var e;const n=null==(e=t.pixelBlocks)?void 0:e[0];if(Object(o.k)(n))return null;const{outputPixelType:r,lookup:s}=this,{includedRanges:i,noDataValues:a,noDataInterpretation:c}=this.functionArguments,l=c===M.b.matchAll;return Object(M.m)(n,{includedRanges:i,noDataValues:a,outputPixelType:r,matchAll:l,lookup:s})}};Object(s.a)([Object(i.b)({json:{write:!0,name:"rasterFunction"}})],Te.prototype,"functionName",void 0),Object(s.a)([Object(i.b)({type:Re,json:{write:!0,name:"rasterFunctionArguments"}})],Te.prototype,"functionArguments",void 0),Object(s.a)([Object(i.b)()],Te.prototype,"rasterArgumentNames",void 0),Object(s.a)([Object(i.b)({json:{write:!0}})],Te.prototype,"lookup",void 0),Te=Object(s.a)([Object(a.a)("esri.layers.support.rasterFunctions.MaskFunction")],Te);const Me=Te;var Fe;let ke=Fe=class extends u{constructor(){super(...arguments),this.visibleBandID=0,this.infraredBandID=1,this.scaled=!0}clone(){const{visibleBandID:t,infraredBandID:e,scaled:n}=this;return new Fe({visibleBandID:t,infraredBandID:e,scaled:n})}};Object(s.a)([Object(i.b)({json:{write:!0}})],ke.prototype,"visibleBandID",void 0),Object(s.a)([Object(i.b)({json:{write:!0}})],ke.prototype,"infraredBandID",void 0),Object(s.a)([Object(i.b)({json:{write:!0}})],ke.prototype,"scaled",void 0),ke=Fe=Object(s.a)([Object(a.a)("esri.layers.support.rasterFunctions.NDVIFunctionArguments")],ke);const Pe=ke;let Ie=class extends d{constructor(){super(...arguments),this.functionName="NDVI",this.functionArguments=null,this.rasterArgumentNames=["raster"]}_bindSourceRasters(){const{scaled:t}=this.functionArguments;this.outputPixelType=this._getOutputPixelType(t?"u8":"f32");const e=this.sourceRasterInfos[0].clone();e.pixelType=this.outputPixelType,e.colormap=null,e.histograms=null;const[n,r,s,o]=t?[0,200,100,10]:[-1,1,0,.1];return e.statistics=[{min:n,max:r,avg:s,stddev:o}],this.rasterInfo=e,{success:!0}}_processPixels(t){var e;const n=null==(e=t.pixelBlocks)?void 0:e[0];if(Object(o.k)(n))return null;const{visibleBandID:r,infraredBandID:s,scaled:i}=this.functionArguments;return function(t,e,n,r){const{mask:s,pixels:o,width:i,height:a}=t,c=o[n],l=o[e],u=l.length,p=r?new Uint8Array(u):new Float32Array(u),f=r?100:1,h=r?100:0;for(let b=0;b<u;b++)if(null==s||s[b]){const t=c[b],e=l[b],n=t+e;n&&(p[b]=(t-e)/n*f+h)}const m=new v.a({width:i,height:a,mask:s,pixelType:r?"u8":"f32",pixels:[p]});return m.updateStatistics(),m}(n,r,s,i)}};Object(s.a)([Object(i.b)({json:{write:!0,name:"rasterFunction"}})],Ie.prototype,"functionName",void 0),Object(s.a)([Object(i.b)({type:Pe,json:{write:!0,name:"rasterFunctionArguments"}})],Ie.prototype,"functionArguments",void 0),Object(s.a)([Object(i.b)()],Ie.prototype,"rasterArgumentNames",void 0),Ie=Object(s.a)([Object(a.a)("esri.layers.support.rasterFunctions.NDVIFunction")],Ie);const Be=Ie;var Ce;let Ee=Ce=class extends u{constructor(){super(...arguments),this.inputRanges=null,this.outputValues=null,this.noDataRanges=null,this.allowUnmatched=!1}clone(){return new Ce({inputRanges:[...this.inputRanges],outputValues:[...this.outputValues],noDataRanges:[...this.noDataRanges],allowUnmatched:this.allowUnmatched})}};Object(s.a)([Object(i.b)({json:{write:!0}})],Ee.prototype,"inputRanges",void 0),Object(s.a)([Object(i.b)({json:{write:!0}})],Ee.prototype,"outputValues",void 0),Object(s.a)([Object(i.b)({json:{write:!0}})],Ee.prototype,"noDataRanges",void 0),Object(s.a)([Object(i.b)({json:{write:!0}})],Ee.prototype,"allowUnmatched",void 0),Ee=Ce=Object(s.a)([Object(a.a)("esri.layers.support.rasterFunctions.RemapFunctionArguments")],Ee);const De=Ee;let _e=class extends d{constructor(){super(...arguments),this.functionName="Remap",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.lookup=null}_bindSourceRasters(){const t=this.sourceRasterInfos[0].clone(),{pixelType:e}=t;this.outputPixelType=this._getOutputPixelType(e),t.pixelType=this.outputPixelType,t.colormap=null,t.histograms=null;const{statistics:n}=t,{allowUnmatched:r,outputValues:s}=this.functionArguments;if(Object(o.l)(n)&&n.length&&!r){let t=s[0],e=t;for(let n=0;n<s.length;n++)t=t>s[n]?s[n]:t,e=e>s[n]?e:s[n];for(let r=0;r<n.length;r++)n[r]={...n[r],min:t,max:e}}return this.rasterInfo=t,this.lookup=r?null:Object(M.h)(e,this.functionArguments.inputRanges,s),{success:!0}}_processPixels(t){var e;const n=null==(e=t.pixelBlocks)?void 0:e[0];if(Object(o.k)(n))return null;const{lookup:r,outputPixelType:s}=this;if(r)return Object(M.l)(n,{lut:[r.lut],offset:r.offset,outputPixelType:s});const{inputRanges:i,outputValues:a,noDataRanges:c,allowUnmatched:l}=this.functionArguments;return Object(M.o)(n,{inputRanges:i,outputValues:a,noDataRanges:c,allowUnmatched:l,outputPixelType:s})}};Object(s.a)([Object(i.b)({json:{write:!0,name:"rasterFunction"}})],_e.prototype,"functionName",void 0),Object(s.a)([Object(i.b)({type:De,json:{write:!0,name:"rasterFunctionArguments"}})],_e.prototype,"functionArguments",void 0),Object(s.a)([Object(i.b)()],_e.prototype,"rasterArgumentNames",void 0),Object(s.a)([Object(i.b)({json:{write:!0}})],_e.prototype,"lookup",void 0),_e=Object(s.a)([Object(a.a)("esri.layers.support.rasterFunctions.RemapFunction")],_e);const Ge=_e;var Le;const ze=new w.a({0:"degree",1:"percent-rise",2:"adjusted"},{useNumericKeys:!0});let Ve=Le=class extends u{constructor(){super(...arguments),this.slopeType="degree",this.zFactor=1,this.pixelSizePower=.664,this.pixelSizeFactor=.024}clone(){return new Le({slopeType:this.slopeType,zFactor:this.zFactor,pixelSizePower:this.pixelSizePower,pixelSizeFactor:this.pixelSizeFactor,raster:this.raster})}};Object(s.a)([Object(O.a)(ze)],Ve.prototype,"slopeType",void 0),Object(s.a)([Object(i.b)({type:Number,json:{write:!0}})],Ve.prototype,"zFactor",void 0),Object(s.a)([Object(i.b)({type:Number,json:{name:"psPower",write:!0}})],Ve.prototype,"pixelSizePower",void 0),Object(s.a)([Object(i.b)({type:Number,json:{name:"psFactor",write:!0}})],Ve.prototype,"pixelSizeFactor",void 0),Ve=Le=Object(s.a)([Object(a.a)("esri.layers.support.rasterFunctions.SlopeFunctionArguments")],Ve);const qe=Ve;let He=class extends d{constructor(){super(...arguments),this.functionName="Slope",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.isGCS=!1}_bindSourceRasters(){this.outputPixelType=this._getOutputPixelType("f32");const t=this.sourceRasterInfos[0].clone();return t.pixelType=this.outputPixelType,t.statistics=null,t.histograms=null,this.rasterInfo=t,this.isGCS=t.spatialReference.isGeographic,{success:!0}}_processPixels(t){var e;const n=null==(e=t.pixelBlocks)?void 0:e[0];if(Object(o.k)(n))return null;const{zFactor:r,slopeType:s,pixelSizePower:i,pixelSizeFactor:a}=this.functionArguments,{isGCS:c}=this,{extent:l}=t,u=l?{x:l.width/n.width,y:l.height/n.height}:{x:1,y:1};return Object(g.d)(n,{zFactor:r,slopeType:s,pixelSizePower:i,pixelSizeFactor:a,isGCS:c,resolution:u})}};Object(s.a)([Object(i.b)({json:{write:!0,name:"rasterFunction"}})],He.prototype,"functionName",void 0),Object(s.a)([Object(i.b)({type:qe,json:{write:!0,name:"rasterFunctionArguments"}})],He.prototype,"functionArguments",void 0),Object(s.a)([Object(i.b)()],He.prototype,"rasterArgumentNames",void 0),Object(s.a)([Object(i.b)({json:{write:!0}})],He.prototype,"isGCS",void 0),He=Object(s.a)([Object(a.a)("esri.layers.support.rasterFunctions.SlopeFunction")],He);const We=He;var Xe;let Ue=Xe=class extends u{constructor(){super(...arguments),this.statistics=null,this.histograms=null}clone(){return new Xe({statistics:Object(x.a)(this.statistics),histograms:Object(x.a)(this.histograms)})}};Object(s.a)([Object(i.b)({json:{write:!0}})],Ue.prototype,"statistics",void 0),Object(s.a)([Object(i.b)({json:{write:!0}})],Ue.prototype,"histograms",void 0),Ue=Xe=Object(s.a)([Object(a.a)("esri.layers.support.rasterFunctions.StatisticsHistogramsFunctionArguments")],Ue);const Ye=Ue;let Je=class extends d{constructor(){super(...arguments),this.functionName="StatisticsHistograms",this.functionArguments=null,this.rasterArgumentNames=["raster"]}_bindSourceRasters(){const t=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType("u8");const e=t.clone(),{statistics:n,histograms:r}=this.functionArguments;return e.histograms=r,n&&(e.statistics=n.map((([t,e,n,r])=>({min:t,max:e,avg:n,stddev:r})))),this.rasterInfo=e,{success:!0}}_processPixels(t){var e;return null==(e=t.pixelBlocks)?void 0:e[0]}};Object(s.a)([Object(i.b)({json:{write:!0,name:"rasterFunction"}})],Je.prototype,"functionName",void 0),Object(s.a)([Object(i.b)({type:Ye,json:{write:!0,name:"rasterFunctionArguments"}})],Je.prototype,"functionArguments",void 0),Object(s.a)([Object(i.b)()],Je.prototype,"rasterArgumentNames",void 0),Object(s.a)([Object(i.b)({json:{write:!0}})],Je.prototype,"indexedColormap",void 0),Je=Object(s.a)([Object(a.a)("esri.layers.support.rasterFunctions.StatisticsHistogramsFunction")],Je);const Ke=Je;var $e;const Qe=new w.a({0:"none",3:"standard-deviation",4:"histogram-equalization",5:"min-max",6:"percent-clip",7:"sigmoid"},{useNumericKeys:!0});let Ze=$e=class extends u{constructor(){super(...arguments),this.computeGamma=!1,this.dynamicRangeAdjustment=!1,this.gamma=[],this.histograms=null,this.statistics=null,this.stretchType="none",this.useGamma=!1}writeStatistics(t,e,n){var r;(null==(r=t)?void 0:r.length)&&(Array.isArray(t[0])||(t=t.map((t=>[t.min,t.max,t.avg,t.stddev]))),e[n]=t)}clone(){return new $e({stretchType:this.stretchType,outputMin:this.outputMin,outputMax:this.outputMax,useGamma:this.useGamma,computeGamma:this.computeGamma,statistics:Object(x.a)(this.statistics),gamma:Object(x.a)(this.gamma),sigmoidStrengthLevel:this.sigmoidStrengthLevel,numberOfStandardDeviations:this.numberOfStandardDeviations,minPercent:this.minPercent,maxPercent:this.maxPercent,histograms:Object(x.a)(this.histograms),dynamicRangeAdjustment:this.dynamicRangeAdjustment,raster:this.raster})}};Object(s.a)([Object(i.b)({type:Boolean,json:{write:!0}})],Ze.prototype,"computeGamma",void 0),Object(s.a)([Object(i.b)({type:Boolean,json:{name:"dra",write:!0}})],Ze.prototype,"dynamicRangeAdjustment",void 0),Object(s.a)([Object(i.b)({type:[Number],json:{write:!0}})],Ze.prototype,"gamma",void 0),Object(s.a)([Object(i.b)()],Ze.prototype,"histograms",void 0),Object(s.a)([Object(i.b)({type:Number,json:{write:!0}})],Ze.prototype,"maxPercent",void 0),Object(s.a)([Object(i.b)({type:Number,json:{write:!0}})],Ze.prototype,"minPercent",void 0),Object(s.a)([Object(i.b)({type:Number,json:{write:!0}})],Ze.prototype,"numberOfStandardDeviations",void 0),Object(s.a)([Object(i.b)({type:Number,json:{name:"max",write:!0}})],Ze.prototype,"outputMax",void 0),Object(s.a)([Object(i.b)({type:Number,json:{name:"min",write:!0}})],Ze.prototype,"outputMin",void 0),Object(s.a)([Object(i.b)({type:Number,json:{write:!0}})],Ze.prototype,"sigmoidStrengthLevel",void 0),Object(s.a)([Object(i.b)({json:{type:[[Number]],write:!0}})],Ze.prototype,"statistics",void 0),Object(s.a)([Object(U.a)("statistics")],Ze.prototype,"writeStatistics",null),Object(s.a)([Object(O.a)(Qe)],Ze.prototype,"stretchType",void 0),Object(s.a)([Object(i.b)({type:Boolean,json:{write:!0}})],Ze.prototype,"useGamma",void 0),Ze=$e=Object(s.a)([Object(a.a)("esri.layers.support.rasterFunctions.StretchFunctionArguments")],Ze);const tn=Ze;var en=n(1195);let nn=class extends d{constructor(){super(...arguments),this.functionName="Stretch",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.lookup=null,this.cutOffs=null}_bindSourceRasters(){this.lookup=null,this.cutOffs=null;const t=this.sourceRasterInfos[0],{pixelType:e}=t,{functionArguments:n}=this,{dynamicRangeAdjustment:r,gamma:s,useGamma:o}=n;if(!r&&["u8","u16","s8","s16"].includes(e)){const r=Object(en.f)(n.toJSON(),{rasterInfo:t});this.lookup=Object(en.c)({pixelType:e,...r,gamma:o?s:null})}else r&&(this.cutOffs=Object(en.f)(n.toJSON(),{rasterInfo:t}));this.outputPixelType=this._getOutputPixelType(e);const i=t.clone();return i.pixelType=this.outputPixelType,i.statistics=null,i.histograms=null,"u8"===this.outputPixelType&&(i.keyProperties.DataType="processed"),this.rasterInfo=i,{success:!0}}_processPixels(t){var e;const n=null==(e=t.pixelBlocks)?void 0:e[0];if(Object(o.k)(n))return n;const{lookup:r}=this;if(r)return Object(M.l)(n,{...r,outputPixelType:this.rasterInfo.pixelType});const{functionArguments:s}=this,i=this.cutOffs||Object(en.f)(s.toJSON(),{rasterInfo:this.sourceRasterInfos[0],pixelBlock:n}),a=s.useGamma?s.gamma:null;return Object(en.g)(n,{...i,gamma:a,outputPixelType:this.outputPixelType})}};Object(s.a)([Object(i.b)({json:{write:!0,name:"rasterFunction"}})],nn.prototype,"functionName",void 0),Object(s.a)([Object(i.b)({type:tn,json:{write:!0,name:"rasterFunctionArguments"}})],nn.prototype,"functionArguments",void 0),Object(s.a)([Object(i.b)()],nn.prototype,"rasterArgumentNames",void 0),Object(s.a)([Object(i.b)({json:{write:!0}})],nn.prototype,"lookup",void 0),Object(s.a)([Object(i.b)({json:{write:!0}})],nn.prototype,"cutOffs",void 0),nn=Object(s.a)([Object(a.a)("esri.layers.support.rasterFunctions.StretchFunction")],nn);const rn=nn,sn=new Map;function on(t,e){if("rasterFunction"in t)return an(t,null!=e?e:{});throw new r.a("raster-function-helper","unsupported raster function json.")}function an(t,e){var n;const{rasterFunction:s,rasterFunctionArguments:o}=t,i=null==(n=t.outputPixelType)?void 0:n.toLowerCase();if(null==s||!sn.has(s))throw new r.a("raster-function-helper",`unsupported raster function: ${s}`);const a=sn.get(s),c=("function"==typeof a.ctor?a.ctor:a.ctor.default).fromJSON({...t,outputPixelType:i}),{rasterArgumentNames:l}=c,u=[],p=function(t,e){return"rasters"===e[0]&&Array.isArray(t.rasters)?t.rasters:e.map((e=>t[e]))}(o,l),f="rasters"===l[0],h=[];for(let r=0;r<p.length;r++){var m;const t=p[r];let n;null==t||"string"==typeof t&&t.startsWith("$")?u.push(null==e?void 0:e.raster):"string"==typeof t?e[t]&&u.push(e[t]):"number"!=typeof t&&"rasterFunction"in t&&(n=an(t,e),f||(c.functionArguments[l[r]]=n),u.push(n)),f&&h.push(null!=(m=n)?m:t)}if(f&&(c.functionArguments.rasters=h),e){var b;c.sourceRasters=u;const t=null==(b=e.raster)?void 0:b.url;t&&(c.mainPrimaryRasterId=t)}return c}sn.set("Aspect",{desc:"Aspect Function",ctor:j,rasterArgumentNames:["raster"]}),sn.set("BandArithmetic",{desc:"Band Arithmetic Function",ctor:D,rasterArgumentNames:["raster"]}),sn.set("Colormap",{desc:"Colormap Function",ctor:W,rasterArgumentNames:["raster"]}),sn.set("CompositeBand",{desc:"CompositeBand Function",ctor:$,rasterArgumentNames:["rasters"]}),sn.set("Convolution",{desc:"Convolution Function",ctor:lt,rasterArgumentNames:["raster"]}),sn.set("ExtractBand",{desc:"ExtractBand Function",ctor:mt,rasterArgumentNames:["raster"]}),sn.set("Local",{desc:"Local Function",ctor:Ae,rasterArgumentNames:["rasters"]}),sn.set("Mask",{desc:"Mask Function",ctor:Me,rasterArgumentNames:["raster"]}),sn.set("NDVI",{desc:"NDVI Function",ctor:Be,rasterArgumentNames:["raster"]}),sn.set("Remap",{desc:"Remap Function",ctor:Ge,rasterArgumentNames:["raster"]}),sn.set("Slope",{desc:"Slope Function",ctor:We,rasterArgumentNames:["raster"]}),sn.set("StatisticsHistograms",{desc:"Statistics Histograms Function",ctor:Ke,rasterArgumentNames:["raster"]}),sn.set("Stretch",{desc:"Stretch Function",ctor:rn,rasterArgumentNames:["raster"]})},1446:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(0),s=n(1),o=(n(17),n(12),n(54)),i=n(10),a=n(1341);let c=class extends a.a{constructor(){super(...arguments),this.type="gcs-shift",this.tolerance=1e-8}forwardTransform(t){return"point"===(t=t.clone()).type?(t.x>180+this.tolerance&&(t.x-=360),t):(t.xmin>=180-this.tolerance?(t.xmax-=360,t.xmin-=360):t.xmax>180+this.tolerance&&(t.xmin=-180,t.xmax=180),t)}inverseTransform(t){return"point"===(t=t.clone()).type?(t.x<-this.tolerance&&(t.x+=360),t):(t.xmin<-this.tolerance&&(t.xmin+=360,t.xmax+=360),t)}};Object(r.a)([Object(o.a)({GCSShiftXform:"gcs-shift"})],c.prototype,"type",void 0),Object(r.a)([Object(s.b)()],c.prototype,"tolerance",void 0),c=Object(r.a)([Object(i.a)("esri.layers.support.rasterTransforms.GCSShiftTransform")],c);const l=c},1494:function(t,e,n){"use strict";n.d(e,"a",(function(){return h})),n.d(e,"b",(function(){return m}));var r=n(1446),s=n(0),o=(n(22),n(12),n(17),n(16),n(32),n(54)),i=n(10),a=n(1341);let c=class extends a.a{constructor(){super(...arguments),this.type="identity"}};Object(s.a)([Object(o.a)({IdentityXform:"identity"})],c.prototype,"type",void 0),c=Object(s.a)([Object(i.a)("esri.layers.support.rasterTransforms.IdentityTransform")],c);const l=c;var u=n(1291);const p={GCSShiftXform:r.a,IdentityXform:l,PolynomialXform:u.a},f=Object.keys(p);function h(t){const e=null==t?void 0:t.type;return!t||f.includes(e)}function m(t){if(!(null==t?void 0:t.type))return null;const e=p[null==t?void 0:t.type];if(e){const n=new e;return n.read(t),n}return null}}}]);
//# sourceMappingURL=34.b78c785f.chunk.js.map