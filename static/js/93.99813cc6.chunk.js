(this["webpackJsonppopulation-arcgis"]=this["webpackJsonppopulation-arcgis"]||[]).push([[93],{1052:function(e,t,r){"use strict";r.r(t),r.d(t,"getFirstLayerOrTableId",(function(){return v})),r.d(t,"getNumLayersAndTables",(function(){return g})),r.d(t,"getSubtypeGroupLayerIds",(function(){return h})),r.d(t,"load",(function(){return d})),r.d(t,"preprocessFSItemData",(function(){return b}));var n=r(16),a=r(423),l=r(306),o=r(220),u=r(673),i=r(1160),s=r(1142),c=r(917),p=r(1190);async function d(e,t){const r=e.instance.portalItem;if(r&&r.id)return await r.load(t),function(e){const t=e.instance.portalItem;if(!e.supportedTypes.includes(t.type))throw new n.a("portal:invalid-layer-item-type","Invalid layer item type '${type}', expected '${expectedType}'",{type:t.type,expectedType:e.supportedTypes.join(", ")})}(e),async function(e,t){const r=e.instance,a=r.portalItem,{url:l,title:o}=a,u=Object(i.a)(a);if("group"===r.type)return r.read({title:o},u),function(e,t){var r;let a;const l=e.portalItem.type,o=t.layerModuleTypeMap,u=null!=(r=Object(s.d)(e.portalItem,"Oriented Imagery Layer"))&&r;switch(l){case"Feature Service":a=u?o.OrientedImageryLayer:o.FeatureLayer;break;case"Stream Service":a=o.StreamLayer;break;case"Scene Service":a=o.SceneLayer;break;case"Feature Collection":a=o.FeatureLayer;break;default:throw new n.a("portal:unsupported-item-type-as-group",`The item type '${l}' is not supported as a 'IGroupLayer'`)}let i;return a().then((e=>(i=e,m(t)))).then((async t=>{let r=()=>i;if("Feature Service"===l){if(h(t=await b(t,e.portalItem.url)).length){const e=o.SubtypeGroupLayer,t=await e();r=e=>"SubtypeGroupLayer"===e.layerType?t:i}return y(e,r,t)}return g(t)>0?y(e,r,t):function(e,t){return e.portalItem.url?Object(p.a)(e.portalItem.url).then((r=>{var n,a;function l(e){return{id:e.id,name:e.name}}r&&y(e,t,{layers:null==(n=r.layers)?void 0:n.map(l),tables:null==(a=r.tables)?void 0:a.map(l)})})):Promise.resolve()}(e,r)}))}(r,e);l&&r.read({url:l},u);const d=await m(e,t);return d&&r.read(d,u),r.resourceReferences={portalItem:a,paths:u.readResourcePaths},"subtype-group"!==r.type&&r.read({title:o},u),Object(c.a)(r,u)}(e,t)}function y(e,t,r){let o=r.layers||[];const i=r.tables||[];if("Feature Collection"===e.portalItem.type&&(o.forEach((e=>{var t;"Table"===(null==e||null==(t=e.layerDefinition)?void 0:t.type)&&i.push(e)})),o=o.filter((e=>{var t;return"Table"!==(null==e||null==(t=e.layerDefinition)?void 0:t.type)}))),"coverage"in r){const t=function(e){const{coverage:t}=e;if(!t)return null;const r=new URL(t);if(t.toLowerCase().includes("item.html")){const e=r.searchParams.get("id"),t=r.origin;return a.a.fromPortalItem({portalItem:new u.default({id:e,url:t})})}if(Object(l.b)(t))return a.a.fromArcGISServerUrl({url:t});throw new n.a("portal:oriented-imagery-layer-coverage","the provided coverage url couldn't be loaded as a layer")}(r);e.add(t)}o.reverse().forEach((n=>{const a=f(e,t(n),r,n);e.add(a)})),i.reverse().forEach((n=>{const a=f(e,t(n),r,n);e.tables.add(a)}))}function f(e,t,r,n){const a=new t({portalItem:e.portalItem.clone(),layerId:n.id});if("subtype-group"!==a.type&&(a.sublayerTitleMode="service-name"),"Feature Collection"===e.portalItem.type){const t={origin:"portal-item",portal:e.portalItem.portal||o.a.getDefault()};a.read(n,t);const l=r.showLegend;null!=l&&a.read({showLegend:l},t)}return a}function m(e,t){if(!1===e.supportsData)return Promise.resolve(void 0);const r=e.instance;return r.portalItem.fetchData("json",t).catch((()=>null)).then((e=>{if(function(e){return"stream"!==e.type&&"oriented-imagery"!==e.type&&"layerId"in e}(r)){let t,n=!0;if(e&&g(e)>0){if(null==r.layerId){const t=h(e);r.layerId="subtype-group"===r.type?null==t?void 0:t[0]:v(e)}t=function(e,t){var r,n;const{layerId:a}=t,l=(null==(r=e.layers)?void 0:r.find((e=>e.id===a)))||(null==(n=e.tables)?void 0:n.find((e=>e.id===a)));return l&&function(e,t){return!("feature"===t.type&&"layerType"in e&&"SubtypeGroupLayer"===e.layerType||"subtype-group"===t.type&&!("layerType"in e))}(l,t)?l:null}(e,r),t&&(1===g(e)&&(n=!1),null!=e.showLegend&&(t.showLegend=e.showLegend))}return n&&"service-name"!==r.sublayerTitleMode&&(r.sublayerTitleMode="item-title-and-service-name"),t}return e}))}async function b(e,t){var r,n;if(null==(null==(r=e)?void 0:r.layers)||null==(null==(n=e)?void 0:n.tables)){const r=await Object(p.a)(t);(e=e||{}).layers=e.layers||(null==r?void 0:r.layers),e.tables=e.tables||(null==r?void 0:r.tables)}return e}function v(e){const t=e.layers;if(t&&t.length)return t[0].id;const r=e.tables;return r&&r.length?r[0].id:null}function g(e){var t,r,n,a;return(null!=(t=null==e||null==(r=e.layers)?void 0:r.length)?t:0)+(null!=(n=null==e||null==(a=e.tables)?void 0:a.length)?n:0)}function h(e){var t;const r=[];return null!=e&&null!=(t=e.layers)&&t.forEach((e=>{"SubtypeGroupLayer"===e.layerType&&r.push(e.id)})),r}},1142:function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return s})),r.d(t,"d",(function(){return u})),r.d(t,"e",(function(){return i}));var n=r(40),a=r(57),l=r(96);function o(e,t){if(!u(e,t)){const r=e.typeKeywords;r?r.push(t):e.typeKeywords=[t]}}function u(e,t){var r;return!(null==(r=e.typeKeywords)||!r.includes(t))}function i(e,t){const r=e.typeKeywords;if(r){const e=r.indexOf(t);e>-1&&r.splice(e,1)}}async function s(e){const t=e.clone().normalize();let r;if(t.length>1)for(const n of t)r?n.width>r.width&&(r=n):r=n;else r=t[0];return async function(e){const t=e.spatialReference;if(t.isWGS84)return e.clone();if(t.isWebMercator)return Object(l.e)(e);const r=a.a.WGS84;return await Object(n.g)(t,r),Object(n.m)(e,r)}(r)}const c={DEVELOPER_BASEMAP:"DeveloperBasemap",JSAPI:"ArcGIS API for JavaScript",METADATA:"Metadata",MULTI_LAYER:"Multilayer",SINGLE_LAYER:"Singlelayer",TABLE:"Table"}},1160:function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return o}));var n=r(44),a=r(220);function l(e){return{origin:"portal-item",url:Object(n.N)(e.itemUrl),portal:e.portal||a.a.getDefault(),portalItem:e,readResourcePaths:[]}}function o(e){return{origin:"portal-item",messages:[],writtenProperties:[],url:e.itemUrl?Object(n.N)(e.itemUrl):null,portal:e.portal||a.a.getDefault(),portalItem:e}}},1190:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(134);async function a(e){const{data:t}=await Object(n.default)(e,{responseType:"json",query:{f:"json"}});return t}}}]);
//# sourceMappingURL=93.99813cc6.chunk.js.map