(this["webpackJsonppopulation-arcgis"]=this["webpackJsonppopulation-arcgis"]||[]).push([[8],{1108:function(t,e,i){"use strict";function a(t){return t&&"getAtOrigin"in t&&"originOf"in t}i.d(e,"a",(function(){return a}))},1114:function(t,e,i){"use strict";i.d(e,"a",(function(){return O}));var a=i(1108),n=i(44),r=i(901),o=i(356),s=i(103),c=i(1);function l(t){return h[function(t){return t instanceof Blob?t.type:function(t){const e=Object(n.p)(t);return u[e]||p}(t.url)}(t)]||d}const h={},p="text/plain",d=h[p],u={png:"image/png",jpeg:"image/jpeg",jpg:"image/jpg",bmp:"image/bmp",gif:"image/gif",json:"application/json",txt:"text/plain",xml:"application/xml",svg:"image/svg+xml",zip:"application/zip",pbf:"application/vnd.mapbox-vector-tile",gz:"application/gzip","bin.gz":"application/octet-stream"};for(const j in u)h[u[j]]=j;var b=i(199);function O(t){var e;const i=null!=(e=null==t?void 0:t.origins)?e:[void 0];return(e,r)=>{const h=function(t,e,i){var r;if("resource"===(null==t?void 0:t.type))return function(t,e,i){const r=Object(o.b)(e,i);return{type:String,read:(t,e,i)=>{const a=Object(b.g)(t,e,i);return r.type===String?a:"function"==typeof r.type?new r.type({url:a}):void 0},write:{writer(e,o,c,h){if(!h||!h.resources)return"string"==typeof e?void(o[c]=Object(b.h)(e,h)):void(o[c]=e.write({},h));const p=function(t){return null==t?null:"string"==typeof t?t:t.url}(e),d=Object(b.h)(p,{...h,verifyItemRelativeUrls:h&&h.verifyItemRelativeUrls?{writtenUrls:h.verifyItemRelativeUrls.writtenUrls,rootPath:void 0}:void 0},b.a.NO),u=r.type!==String&&(!Object(a.a)(this)||h&&h.origin&&this.originIdOf(i)>Object(s.e)(h.origin)),O={object:this,propertyName:i,value:e,targetUrl:d,dest:o,targetPropertyName:c,context:h,params:t};h&&h.portalItem&&d&&!Object(n.u)(d)?u?function(t){var e;const{context:i,targetUrl:a,params:r,value:o,dest:s,targetPropertyName:c}=t;if(!i.portalItem)return;const h=i.portalItem.resourceFromPath(a),p=m(o,a,i),d=l(p),u=Object(n.p)(h.path),b=null!=(e=null==r?void 0:r.compress)&&e;d===u?(i.resources&&_({...t,resource:h,content:p,compress:b,updates:i.resources.toUpdate}),s[c]=a):g(t)}(O):function({context:t,targetUrl:e,dest:i,targetPropertyName:a}){t.portalItem&&t.resources&&(t.resources.toKeep.push({resource:t.portalItem.resourceFromPath(e),compress:!1}),i[a]=e)}(O):h&&h.portalItem&&(null==d||null!=Object(b.e)(d)||Object(n.v)(d)||u)?g(O):o[c]=d}}}}(t,e,i);switch(null!=(r=null==t?void 0:t.type)?r:"other"){case"other":return{read:!0,write:!0};case"url":{const{read:t,write:e}=b.b;return{read:t,write:e}}}}(t,e,r);for(const t of i){const i=Object(c.c)(e,t,r);for(const t in h)i[t]=h[t]}}}function g(t){var e,a,o;const{targetUrl:s,params:c,value:h,context:p,dest:d,targetPropertyName:u}=t;if(!p.portalItem)return;const O=Object(b.f)(s),g=null!=(e=null==O?void 0:O.filename)?e:Object(r.a)(),j=null!=(a=null==c?void 0:c.prefix)?a:null==O?void 0:O.prefix,f=m(h,s,p),v=Object(n.B)(j,g),y=`${v}.${l(f)}`,M=p.portalItem.resourceFromPath(y);Object(n.v)(s)&&p.resources&&p.resources.pendingOperations.push(async function(t){const e=(await Promise.resolve().then(i.bind(null,134))).default,{data:a}=await e(t,{responseType:"blob"});return a}(s).then((t=>{M.path=`${v}.${l(t)}`,d[u]=M.itemRelativeUrl})).catch((()=>{})));const x=null!=(o=null==c?void 0:c.compress)&&o;p.resources&&_({...t,resource:M,content:f,compress:x,updates:p.resources.toAdd}),d[u]=M.itemRelativeUrl}function _({object:t,propertyName:e,updates:i,resource:a,content:n,compress:r}){i.push({resource:a,content:n,compress:r,finish:i=>{!function(t,e,i){"string"==typeof t[e]?t[e]=i.url:t[e].url=i.url}(t,e,i)}})}function m(t,e,i){return"string"==typeof t?{url:e}:new Blob([JSON.stringify(t.toJSON(i))],{type:"application/json"})}},1126:function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var a=i(78),n=i(510);class r extends n.a{constructor(t,e,i){super(e,i),this.point=t}equals(t){return t instanceof r&&Object(a.f)(this.point,t.point)}}},1135:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));class a{constructor(t){this.vertexHandle=null,this.excludeFeature=null,this.visualizer=null,this.selfSnappingZ=null,this.editGeometryOperations=t.editGeometryOperations,this.elevationInfo=t.elevationInfo,this.pointer=t.pointer,this.vertexHandle=t.vertexHandle,this.excludeFeature=t.excludeFeature,this.visualizer=t.visualizer,this.selfSnappingZ=t.selfSnappingZ}get coordinateHelper(){return this.editGeometryOperations.data.coordinateHelper}}},1146:function(t,e,i){"use strict";function a(t,e){return e?"xoffset"in e&&e.xoffset?Math.max(t,Math.abs(e.xoffset)):"yoffset"in e&&e.yoffset?Math.max(t,Math.abs(e.yoffset||0)):t:t}function n(t,e){return"number"==typeof t?t:t&&t.stops&&t.stops.length?function(t){let e=0,i=0;for(let a=0;a<t.length;a++){const n=t[a].size;"number"==typeof n&&(e+=n,i++)}return e/i}(t.stops):e}function r(t,e){if(!e)return t;const i=e.filter((t=>"size"===t.type)).map((e=>{const{maxSize:i,minSize:a}=e;return(n(i,t)+n(a,t))/2}));let a=0;const r=i.length;if(0===r)return t;for(let n=0;n<r;n++)a+=i[n];const o=Math.floor(a/r);return Math.max(o,t)}function o(t){const e=t&&t.renderer,i="touch"===(t&&t.event&&t.event.pointerType)?9:6;if(!e)return i;const n="visualVariables"in e?r(i,e.visualVariables):i;if("simple"===e.type)return a(n,e.symbol);if("unique-value"===e.type){var o;let t=n;return null!=(o=e.uniqueValueInfos)&&o.forEach((e=>{t=a(t,e.symbol)})),t}if("class-breaks"===e.type){let t=n;return e.classBreakInfos.forEach((e=>{t=a(t,e.symbol)})),t}return"dot-density"===e.type||e.type,n}i.d(e,"a",(function(){return o}))},1148:function(t,e,i){"use strict";i.d(e,"a",(function(){return E})),i.d(e,"b",(function(){return T})),i.d(e,"c",(function(){return A})),i.d(e,"d",(function(){return M})),i.d(e,"e",(function(){return w})),i.d(e,"f",(function(){return x})),i.d(e,"g",(function(){return f})),i.d(e,"h",(function(){return v})),i.d(e,"i",(function(){return S}));var a,n,r=i(2),o=i(31),s=i(5),c=i(9),l=i(40),h=i(45),p=i(110),d=i(267),u=i(55),b=i(127),O=i(325),g=i(200),_=i(114),m=i(222),j=i(1110);function f(t,e){return y(t,(()=>e))}function v(t){return y(t,(t=>t.plane))}function y(t,e){const i=Object(c.f)(),a=Object(c.f)();let n=!1;return s=>{const c=e(s);if("start"===s.action){const e=Object(o.j)(s.screenStart,Object(o.c)(u.c.get())),a=Object(O.c)(t.state.camera,e,I);Object(r.l)(a)&&(n=Object(h.n)(c,a,i))}if(!n)return null;const l=Object(o.j)(s.screenEnd,Object(o.c)(u.c.get())),p=Object(O.c)(t.state.camera,l,I);return Object(r.k)(p)?null:Object(h.n)(c,p,a)?{...s,renderStart:i,renderEnd:a,plane:c,ray:p}:null}}function M(t,e,i,a=null,n=null){return function(t,e,i,a=null,n=null){let s=null;return c=>{if("start"===c.action&&(s=t.sceneIntersectionHelper.intersectElevationFromScreen(Object(o.g)(c.screenStart.x,c.screenStart.y),e,i,n),Object(r.l)(s)&&Object(r.l)(a)&&!Object(l.u)(s,s,a)))return null;if(Object(r.k)(s))return null;const h=t.sceneIntersectionHelper.intersectElevationFromScreen(Object(o.g)(c.screenEnd.x,c.screenEnd.y),e,i,n);return Object(r.l)(h)?Object(r.l)(a)&&!Object(l.u)(h,h,a)?null:{...c,mapStart:s,mapEnd:h}:null}}(t,i,Object(b.l)(e,t,i),a,n)}function x(t,e,i,a=null,n=null){return M(t,i,Object(b.j)(e),a,n)}function w(t,e,i,a){const n=e.toMap(t.screenStart,{include:[i]});return Object(r.l)(n)?x(e,i,n,a):null}function S(t,e,i){let a=null;const n=new j.a;return n.next(f(t,function(t,e){const i=D,a=R,n=Object(h.d)();t.renderCoordsHelper.worldUpAtPosition(e,i);const r=Object(s.o)(n,i,Object(s.k)(a,e,t.state.camera.eye));return Object(s.o)(r,r,i),Object(h.h)(e,r,n)}(t,e))).next(function(t,e){const i=Object(c.f)(),a=Object(s.u)(e);t.renderCoordsHelper.worldUpAtPosition(e,i);const n=Object(c.f)(),r=Object(c.f)(),o=n=>(Object(s.k)(n,n,e),Object(d.c)(i,n,n),"global"===t.viewingMode&&Object(s.u)(n)*Math.sign(Object(s.n)(i,n))<.001-a&&Object(s.k)(n,Object(s.p)(n,i,.001),e),Object(s.j)(n,n,e),n);return t=>(t.renderStart=o(Object(s.l)(n,t.renderStart)),t.renderEnd=o(Object(s.l)(r,t.renderEnd)),t)}(t,e)).next(E(t,i)).next((t=>{t.mapEnd.x=t.mapStart.x,t.mapEnd.y=t.mapStart.y,a=t})),t=>(a=null,n.execute(t),a)}function E(t,e){const i=t.renderCoordsHelper;return t=>{const a=i.fromRenderCoords(t.renderStart,e),n=i.fromRenderCoords(t.renderEnd,e);return Object(r.l)(a)&&Object(r.l)(n)?{...t,mapStart:a,mapEnd:n}:null}}function T(t){let e=null;return i=>{switch(i.action){case"start":e=t.disableDisplay();break;case"end":case"cancel":Object(r.l)(e)&&(e.remove(),e=null)}return i}}function A(t,e=null){const i=Object(g.b)(t.state.viewingMode);i.options.selectionMode=!0,i.options.store=_.c.MIN,i.options.hud=!1;const n=Object(o.g)(),s={requiresGroundFeedback:!0,enableDraped:!0,exclude:new Set},l=Object(c.f)(),h=Object(r.u)(e,t.spatialReference),p=e=>{t.map.ground&&t.map.ground.opacity<1?s.exclude.add(m.b):s.exclude.delete(m.b),t.sceneIntersectionHelper.intersectIntersectorScreen(Object(o.j)(e,n),i,s);const r=i.results.min;let c;if(r.getIntersectionPoint(l))c=r.intersector===_.b.TERRAIN?a.GROUND:a.OTHER;else{if(!i.results.ground.getIntersectionPoint(l))return null;c=a.GROUND}return{location:t.renderCoordsHelper.fromRenderCoords(l,h),surfaceType:c}};let d;return t=>{if("start"===t.action){const e=p(t.screenStart);d=Object(r.l)(e)?e.location:null}if(Object(r.k)(d))return null;const e=p(t.screenEnd);return Object(r.l)(e)&&Object(r.l)(e.location)?{...t,mapStart:d,mapEnd:e.location,surfaceType:e.surfaceType}:null}}(n=a||(a={}))[n.GROUND=0]="GROUND",n[n.OTHER=1]="OTHER";const D=Object(c.f)(),R=Object(c.f)(),I=Object(p.c)()},1157:function(t,e,i){"use strict";i.d(e,"a",(function(){return l})),i.d(e,"b",(function(){return S}));var a=i(46),n=i(563),r=i(41),o=i(1183),s=i(102),c=i(734);const l={main:new a.a([255,127,0]),selected:new a.a([255,255,255]),staged:new a.a([12,207,255]),outline:new a.a([0,0,0,.5]),selectedOutline:new a.a([255,255,255])},h=.3;function p(t,e){const i=t.clone();return i.a*=e,i}function d(t,e){const i=t.clone(),a=Object(n.b)(i);a.s*=e;const r=Object(n.e)(a);return i.r=r.r,i.g=r.g,i.b=r.b,i}function u(t,e){if(e)for(const i in e)t[i]=e[i]}class b{constructor(t){this.color=l.main,this.height=90,this.coneHeight=40,this.coneWidth=23,this.width=3,this.renderOccluded=s.c.Opaque,u(this,t)}}class O{constructor(t){this.size=11,this.outlineSize=1,this.collisionPadding=9,this.color=l.main,this.outlineColor=l.outline,this.renderOccluded=s.c.Opaque,this.hoverOutlineColor=l.selectedOutline,u(this,t)}apply(t,e){const i=this[t];e.setParameters({color:w(i),transparent:"color"!==t||i.a<1,renderOccluded:this.renderOccluded})}}class g{constructor(t){this.size=40,this.height=.2,this.offset=.25,this.collisionPadding=2,this.color=p(l.main,.5),this.hoverColor=l.main,this.renderOccluded=s.c.Transparent,this.minSquaredEdgeLength=900,u(this,t)}apply(t,e){const i=this[t];e.setParameters({color:w(i),transparent:i.a<1,renderOccluded:this.renderOccluded})}}class _{constructor(t){this.vertex=new O({color:l.main,outlineColor:l.outline}),this.edge=new O({color:d(p(l.main,2/3),.5),outlineColor:p(l.outline,.5),size:8,collisionPadding:8}),this.selected=new O({color:l.selected,outlineColor:l.outline}),this.edgeOffset=new g,u(this,t)}}class m{constructor(t){this.color=l.selected,this.width=1.5,this.stipplePattern=Object(c.a)(5),this.stippleOffColor=l.outline,this.falloff=0,this.innerWidth=1.5,this.innerColor=l.selected,this.renderOccluded=s.c.OccludeAndTransparent,u(this,t)}apply(t){t.color=w(this.color),t.width=this.width,t.stipplePattern=this.stipplePattern,t.stippleOffColor=w(this.stippleOffColor),t.falloff=this.falloff,t.innerWidth=this.innerWidth,t.innerColor=w(this.innerColor),t.renderOccluded=this.renderOccluded}}class j{constructor(t){this.color=l.selected,this.size=4,this.outlineSize=1,this.outlineColor=l.outline,this.shape="square",u(this,t)}apply(t){t.color=w(this.color),t.size=this.size,t.outlineSize=this.outlineSize,t.outlineColor=w(this.outlineColor),t.primitive=this.shape}}class f{constructor(t){this.innerColor=l.selected,this.innerWidth=1,this.glowColor=l.main,this.glowWidth=8,this.glowFalloff=8,this.globalAlpha=h,this.globalAlphaContrastBoost=1.5,this.radius=3,this.heightFillColor=l.main,u(this,t)}apply(t,e=1){const i={glowColor:a.a.toUnitRGB(this.glowColor),glowFalloff:this.glowFalloff,glowWidth:this.glowWidth,innerColor:a.a.toUnitRGB(this.innerColor),innerWidth:this.innerWidth,globalAlpha:this.globalAlpha*e,globalAlphaContrastBoost:this.globalAlphaContrastBoost,intersectsLineRadius:this.radius};"style"in t?t.style=i:t.laserlineStyle=i}}class v{constructor(t){this.outline=new m({color:l.outline,renderOccluded:s.c.OccludeAndTransparentStencil,stippleOffColor:l.selected,stipplePattern:Object(c.a)(5),width:1.5,innerWidth:0}),this.staged=new m({color:l.selected,renderOccluded:s.c.OccludeAndTransparentStencil,innerColor:l.staged,stippleOffColor:l.outline,stipplePattern:Object(c.a)(5),width:1.5}),this.shadowStyle=new f({globalAlpha:h,glowColor:l.main,glowFalloff:8,glowWidth:8,innerColor:l.selected,innerWidth:1}),u(this,t)}}class y{constructor(t){this.outline=new j({color:l.selected,outlineColor:l.outline,outlineSize:1,shape:"circle",size:4}),this.shadowStyle=new f({globalAlpha:h,glowColor:l.main,glowFalloff:1.5,glowWidth:6,innerColor:l.selected,innerWidth:1,radius:2}),u(this,t)}}class M extends m{constructor(t){super(),this.extensionType=o.b.GROUND_RAY,u(this,t)}}class x{constructor(t){this.lineGraphics=new v,this.pointGraphics=new y,this.heightPlane=new f({globalAlpha:h,glowColor:l.main,glowFalloff:8,glowWidth:8,innerColor:l.selected,innerWidth:1}),this.heightBox=new f({globalAlpha:h,glowColor:l.main,glowFalloff:8,glowWidth:8,innerColor:l.selected,innerWidth:0,heightFillColor:l.main}),this.zVerticalLine=new M({color:p(l.main,.5),falloff:2,innerColor:p(l.selected,0),renderOccluded:s.c.OccludeAndTransparent,stipplePattern:null,width:5,extensionType:o.b.GROUND_RAY}),this.laserlineAlphaMultiplier=1.5,this.heightPlaneAngleCutoff=20,u(this,t)}}function w(t){return Object(r.d)(a.a.toUnitRGBA(t))}const S=new class{constructor(t){this.visualElements=new x,this.reshapeManipulators=new _,this.zManipulator=new b,u(this,t)}colorToVec4(t){return w(t)}}},1165:function(t,e,i){"use strict";i.d(e,"a",(function(){return s})),i.d(e,"b",(function(){return c}));i(167);var a=i(2),n=i(68),r=i(1146),o=i(86);function s(t,e,i,r=new o.a){let s;if("2d"===i.type)s=e*i.resolution;else if("3d"===i.type){const r=i.overlayPixelSizeInMapUnits(t),o=i.basemapSpatialReference;s=Object(a.l)(o)&&!o.equals(i.spatialReference)?Object(n.f)(o)/Object(n.f)(i.spatialReference):e*r}const c=t.x-s,l=t.y-s,h=t.x+s,p=t.y+s,{spatialReference:d}=i;return r.xmin=Math.min(c,h),r.ymin=Math.min(l,p),r.xmax=Math.max(c,h),r.ymax=Math.max(l,p),r.spatialReference=d,r}function c(t,e,i){const n=i.toMap(t);return!Object(a.k)(n)&&s(n,Object(r.a)(),i,l).intersects(e)}const l=new o.a},1183:function(t,e,i){"use strict";i.d(e,"a",(function(){return f})),i.d(e,"b",(function(){return w}));i(32);var a=i(64),n=i(2),r=i(13),o=i(5),s=i(9),c=i(60),l=i(401),h=i(763),p=i(67),d=i(189),u=i(110),b=i(1236),O=i(1117),g=i(285),_=i(102),m=i(11),j=i(475);class f extends O.a{constructor(t){super(t),this._ray=Object(u.c)(),this._externalResources=null,this._handles=new a.a,this._isWorldDown=!1,this._start=Object(s.f)(),this._end=Object(s.h)(1,0,0),this._width=1,this._color=Object(l.c)(1,0,1,1),this._polygonOffset=!1,this._writeDepthEnabled=!0,this._innerWidth=0,this._innerColor=Object(l.c)(1,1,1,1),this._stipplePattern=null,this._stippleOffColor=null,this._stipplePreferContinuous=!0,this._falloff=0,this._extensionType=w.LINE,this._laserlineStyle=null,this._laserlineEnabled=!1,this._renderOccluded=_.c.OccludeAndTransparent,this._fadedExtensions=T,this.applyProps(t)}createExternalResources(){const t=new j.a(this.materialParameters);this._handles.add(Object(r.f)((()=>this.view.state.camera),(()=>{this._updateGeometry()})));const e=new b.a({view:this.view,attached:this._laserlineEnabled});this._externalResources={material:t,laserline:e}}destroyExternalResources(){Object(n.l)(this._externalResources)&&this._externalResources.laserline.destroy(),this._externalResources=null,this._handles.removeAll()}forEachExternalMaterial(t){Object(n.l)(this._externalResources)&&t(this._externalResources.material)}createGeometries(t){const e=[Object(s.f)(),Object(s.f)()],i=this.extensionType===w.FADED;i&&e.push(Object(s.f)(),Object(s.f)());const a=i?new Float32Array([1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0]):null,r=Object(g.j)(e,null,a);t.addGeometry(r,Object(n.t)(this._externalResources).material),this._updateVertices(t)}updateVisibility(t){super.updateVisibility(t),Object(n.l)(this._externalResources)&&(this._externalResources.laserline.visible=t)}setStartEndFromWorldDownAtLocation(t){this._isWorldDown=!0,Object(o.l)(this._start,t),this.view.renderCoordsHelper.worldUpAtPosition(t,this._end),Object(o.k)(this._end,t,this._end),Object(u.f)(this._start,this._end,this._ray),this._updateGeometry()}get start(){return this._start}set start(t){this._isWorldDown=!1,Object(o.t)(this._start,t)||(Object(o.l)(this._start,t),Object(u.f)(this._start,this._end,this._ray),this._updateGeometry())}get end(){return this._end}set end(t){this._isWorldDown=!1,Object(o.t)(this._end,t)||(Object(o.l)(this._end,t),Object(u.f)(this._start,this._end,this._ray),this._updateGeometry())}get width(){return this._width}set width(t){t!==this._width&&(this._width=t,this._updateMaterial())}get color(){return this._color}set color(t){Object(c.g)(t,this._color)||(Object(c.c)(this._color,t),this._updateMaterial())}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){t!==this._polygonOffset&&(this._polygonOffset=t,this._updateMaterial())}get writeDepthEnabled(){return this._writeDepthEnabled}set writeDepthEnabled(t){this._writeDepthEnabled!==t&&(this._writeDepthEnabled=t,this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(t){t!==this._innerWidth&&(this._innerWidth=t,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(t){Object(c.g)(t,this._innerColor)||(Object(c.c)(this._innerColor,t),this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(t){const e=Object(n.l)(t)!==Object(n.l)(this._stipplePattern);this._stipplePattern=t,e?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(t){(Object(n.k)(t)||Object(n.k)(this._stippleOffColor)||!Object(c.g)(t,this._stippleOffColor))&&(this._stippleOffColor=Object(n.l)(t)?Object(l.a)(t):null,this._updateMaterial())}get stipplePreferContinuous(){return this._stipplePreferContinuous}set stipplePreferContinuous(t){t!==this._stipplePreferContinuous&&(this._stipplePreferContinuous=t,this._updateMaterial())}get falloff(){return this._falloff}set falloff(t){t!==this._falloff&&(this._falloff=t,this._updateMaterial())}get extensionType(){return this._extensionType}set extensionType(t){t!==this._extensionType&&(this._extensionType=t,this._updateGeometry())}get _laserlineAttached(){return this._laserlineEnabled&&Object(n.l)(this._laserlineStyle)}get laserlineStyle(){return this._laserlineStyle}set laserlineStyle(t){this._laserlineStyle=t,Object(n.l)(this._externalResources)&&(this._externalResources.laserline.attached=this._laserlineAttached,Object(n.l)(t)&&(this._externalResources.laserline.style=t))}get laserlineEnabled(){return this._laserlineEnabled}set laserlineEnabled(t){this._laserlineEnabled!==t&&(this._laserlineEnabled=t,Object(n.l)(this._externalResources)&&(this._externalResources.laserline.attached=this._laserlineAttached))}get renderOccluded(){return this._renderOccluded}set renderOccluded(t){t!==this._renderOccluded&&(this._renderOccluded=t,this._updateMaterial())}get fadedExtensions(){return this._fadedExtensions}set fadedExtensions(t){this._fadedExtensions=Object(n.u)(t,T),this.recreateGeometry()}_updateMaterial(){Object(n.k)(this._externalResources)||this._externalResources.material.setParameters(this.materialParameters)}get materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:this._stipplePreferContinuous,innerWidth:this._innerWidth,innerColor:this._innerColor,falloff:this._falloff,hasPolygonOffset:this._polygonOffset,renderOccluded:this._renderOccluded,writeDepth:this._writeDepthEnabled}}_updateGeometry(){Object(n.l)(this.object)&&this._updateVertices(this.object)}_updateVertices(t){const e=this._extensionType===w.FADED?this._updateLineSegmentFinite(x):this._updateLineSegmentInfinite(this._extensionType,x);this._updateVertexAttributes(t,e),Object(n.l)(this._externalResources)&&(this._externalResources.laserline.intersectsLine=e)}_updateLineSegmentFinite(t){return Object(d.f)(this._start,this._end,t)}_updateLineSegmentInfinite(t,e){const i=this.view.state.camera;switch(Object(h.c)(this._ray,v),t){case w.LINE:v.c0=-Number.MAX_VALUE;break;case w.RAY:case w.GROUND_RAY:{const t=this._ray.origin,e=Object(n.u)(this.view.elevationProvider.getElevation(t[0],t[1],t[2],this.view.renderCoordsHelper.spatialReference,"ground"),0),i=this.view.renderCoordsHelper.getAltitude(t);this._isWorldDown&&i<e&&Object(o.x)(v.ray.direction,v.ray.direction),this._extensionType===w.GROUND_RAY&&null!=e&&(v.c1=Math.abs(i-e));break}}if(!Object(p.i)(i.frustum,v))return Object(d.f)(this._start,this._end,e);const a=Object(h.e)(v,y),r=Object(h.d)(v,M);return Object(d.f)(a,r,e)}_updateVertexAttributes(t,e){const i=t.geometries[0].getMutableAttribute(m.a.POSITION).data;if(this.extensionType===w.FADED){const t=Object(d.h)(e,-this.fadedExtensions.start,y);i[0]=t[0],i[1]=t[1],i[2]=t[2];const a=Object(d.h)(e,0,y);i[3]=a[0],i[4]=a[1],i[5]=a[2];const n=Object(d.h)(e,1,y);i[6]=n[0],i[7]=n[1],i[8]=n[2];const r=Object(d.h)(e,1+this.fadedExtensions.end,y);i[9]=r[0],i[10]=r[1],i[11]=r[2]}else{const t=Object(d.h)(e,0,y);i[0]=t[0],i[1]=t[1],i[2]=t[2];const a=Object(d.h)(e,1,y);i[3]=a[0],i[4]=a[1],i[5]=a[2]}t.geometryVertexAttrsUpdated(t.geometryRecords[0])}}const v=Object(h.a)(),y=Object(s.f)(),M=Object(s.f)(),x=Object(d.d)();var w,S;(S=w||(w={}))[S.LINE=0]="LINE",S[S.RAY=1]="RAY",S[S.GROUND_RAY=2]="GROUND_RAY",S[S.FADED=3]="FADED";const E=1/3,T={start:E,end:E}},1184:function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var a=i(2),n=i(23),r=i(915),o=i(559),s=i(1110),c=i(1135),l=i(124);class h{constructor(){this.next=new s.a}createSnapDragEventPipelineStep({predicate:t=(()=>!0),cancel:e,snappingManager:i,snappingContext:r,updatingHandles:o,useZ:c=!0}){if(Object(a.k)(i))return t=>t;let l=null,h=null;const p=()=>{l=Object(a.a)(l),i.doneSnapping(),Object(a.l)(h)&&h.frameTask.remove(),h=null};e.next((t=>(p(),t))),this.next=new s.a;const d=this._createSnapFunction(i,c);let u=null,b=null,O=null;return e=>{if(!t(e))return e;if("start"===e.action){const t=this._createFrameTask(i.view);if(h=this._createSnappingInfo(r,e,t),h.context.selfSnappingZ=null,!c&&Object(a.l)(e.info)){const t=this._extractSelfSnappingZ(r.coordinateHelper,e.info.handle.component);Object(a.l)(t)&&(h.context.selfSnappingZ={value:t,elevationInfo:r.elevationInfo})}}if(Object(a.l)(h)){const{context:t,originalScenePos:r,originalPos:s}=h,{mapEnd:p,mapStart:g,action:_,scenePoints:m}=e,j=this._updatePosition(s,this._computeMapDelta(p,g)),f=this._computeMapDelta(g,s),v={...e,action:"update"},y=h.context,M=this._updateScenePosition(r,m),x=i.update({point:j,scenePoint:M,context:t});if(O=x,this._applySnappedUpdate(p,x,f,c),u=j,b=M,"end"!==_){const{frameTask:t}=h;Object(a.k)(l)&&(l=new AbortController),o.addPromise(Object(n.i)(d({frameTask:t,event:v,context:y,point:j,scenePoint:M,delta:f,lastPos:u,lastScenePos:b,lastUpdate:O},l.signal)))}}return"end"===e.action&&p(),e}}_createSnapFunction(t,e){return Object(n.f)((async({frameTask:i,point:n,scenePoint:o,context:s,event:c,delta:l,lastPos:h,lastScenePos:p,lastUpdate:d},u)=>{const b=await i.schedule((()=>t.snap({point:n,scenePoint:o,context:s,signal:u})),u);if(b.valid){let o=await i.schedule((()=>b.apply()),u);n!==h&&Object(a.l)(h)&&(o=t.update({point:h,scenePoint:p,context:s})),Object(r.b)(o,d)||(this._applySnappedUpdate(c.mapEnd,o,l,e),this.next.execute(c))}}))}_createFrameTask(t){return"3d"===t.type?t.resourceController.scheduler.registerTask(l.b.SNAPPING):l.a}_createSnappingInfo(t,e,i){return{context:new c.a({editGeometryOperations:t.editGeometryOperations,elevationInfo:t.elevationInfo,pointer:t.pointer,vertexHandle:Object(a.l)(e.info)?e.info.handle:null,excludeFeature:t.excludeFeature,visualizer:t.visualizer}),originalPos:Object(a.l)(e.snapOrigin)?t.coordinateHelper.vectorToDehydratedPoint(e.snapOrigin):e.mapStart,originalScenePos:Object(a.l)(e.scenePoints)?e.scenePoints.sceneStart:null,frameTask:i}}_updatePosition(t,[e,i,a]){const n=Object(o.a)(t);return n.x+=e,n.y+=i,n.hasZ&&(n.z+=a),n}_updateScenePosition(t,e){return Object(a.k)(t)||Object(a.k)(e)?null:this._updatePosition(t,this._computeMapDelta(e.sceneEnd,e.sceneStart))}_computeMapDelta(t,e){const i=t.hasZ&&e.hasZ?t.z-e.z:0;return[t.x-e.x,t.y-e.y,i]}_applySnappedUpdate(t,e,[i,a,n],r){t.x=e.x+i,t.y=e.y+a,r&&t.hasZ&&e.hasZ&&(t.z=e.z+n)}_extractSelfSnappingZ(t,e){if(!t.hasZ())return null;const i=e.vertices;let n=null;for(const r of i){const e=t.getZ(r.pos);if(Object(a.l)(n)&&Math.abs(e-n)>1e-6)return null;Object(a.k)(n)&&(n=e)}return n}}},1185:function(t,e,i){"use strict";i.d(e,"a",(function(){return c})),i.d(e,"b",(function(){return h})),i.d(e,"c",(function(){return l})),i.d(e,"d",(function(){return p})),i.d(e,"e",(function(){return u})),i.d(e,"f",(function(){return d}));var a=i(0),n=i(1102),r=i(1),o=i(10),s=i(1168);let c=class extends s.a{constructor(t){super(t),this.type="translate-graphic",this.distance=n.h}};Object(a.a)([Object(r.b)()],c.prototype,"type",void 0),Object(a.a)([Object(r.b)()],c.prototype,"distance",void 0),c=Object(a.a)([Object(o.a)("esri.views.interactive.tooltip.TranslateGraphicTooltipInfo")],c);let l=class extends s.a{constructor(t){super(t),this.type="translate-graphic-z",this.distance=n.h}};Object(a.a)([Object(r.b)()],l.prototype,"type",void 0),Object(a.a)([Object(r.b)()],l.prototype,"distance",void 0),l=Object(a.a)([Object(o.a)("esri.views.interactive.tooltip.TranslateGraphicZTooltipInfo")],l);let h=class extends s.a{constructor(t){super(t),this.type="translate-graphic-xy",this.distance=n.h}};Object(a.a)([Object(r.b)()],h.prototype,"type",void 0),Object(a.a)([Object(r.b)()],h.prototype,"distance",void 0),h=Object(a.a)([Object(o.a)("esri.views.interactive.tooltip.TranslateGraphicXYTooltipInfo")],h);let p=class extends s.a{constructor(t){super(t),this.type="translate-vertex",this.distance=n.h,this.elevation=null,this.area=null,this.totalLength=null}};Object(a.a)([Object(r.b)()],p.prototype,"type",void 0),Object(a.a)([Object(r.b)()],p.prototype,"distance",void 0),Object(a.a)([Object(r.b)()],p.prototype,"elevation",void 0),Object(a.a)([Object(r.b)()],p.prototype,"area",void 0),Object(a.a)([Object(r.b)()],p.prototype,"totalLength",void 0),p=Object(a.a)([Object(o.a)("esri.views.interactive.tooltip.TranslateVertexTooltipInfo")],p);let d=class extends s.a{constructor(t){super(t),this.type="translate-vertex-z",this.distance=n.h,this.elevation=null}};Object(a.a)([Object(r.b)()],d.prototype,"type",void 0),Object(a.a)([Object(r.b)()],d.prototype,"distance",void 0),Object(a.a)([Object(r.b)()],d.prototype,"elevation",void 0),d=Object(a.a)([Object(o.a)("esri.views.interactive.tooltip.TranslateVertexZTooltipInfo")],d);let u=class extends s.a{constructor(t){super(t),this.type="translate-vertex-xy",this.distance=n.h,this.elevation=null,this.area=null,this.totalLength=null}};Object(a.a)([Object(r.b)()],u.prototype,"type",void 0),Object(a.a)([Object(r.b)()],u.prototype,"distance",void 0),Object(a.a)([Object(r.b)()],u.prototype,"elevation",void 0),Object(a.a)([Object(r.b)()],u.prototype,"area",void 0),Object(a.a)([Object(r.b)()],u.prototype,"totalLength",void 0),u=Object(a.a)([Object(o.a)("esri.views.interactive.tooltip.TranslateVertexXYTooltipInfo")],u)},1209:function(t,e,i){"use strict";i.d(e,"a",(function(){return m})),i.d(e,"b",(function(){return b})),i.d(e,"c",(function(){return u})),i.d(e,"d",(function(){return j}));var a=i(2),n=i(1102),r=i(68),o=i(452),s=i(5),c=i(9),l=i(40),h=i(45),p=i(680),d=i(1210);function u(t,e={positionsWorldCoords:[]}){return O(t,e)}function b(t,e={positionsWorldCoords:[]}){return O(t,e,!1)}function O(t,e,i=t.hasZ){const o=Object(d.a)(t.spatialReference),u=Object(r.a)(o);if(Object(a.k)(u))return null;const b=(t,e)=>!(e.length<2)&&(Object(s.B)(t,e[0],e[1],i&&e[2]||0),!0);let O=0;for(const a of t.rings){const i=a.length;if(i<3)continue;const{positionsWorldCoords:n}=e;for(;n.length<i;)n.push(Object(c.f)());const r=g,d=Object(s.B)(_,0,0,0),u=1/i;for(let e=0;e<i;e++){if(!b(r,a[e]))return null;if(!Object(l.C)(r,t.spatialReference,n[e],o))return null;Object(s.I)(d,d,n[e],u)}const m=Object(h.g)(n[0],n[1],d,Object(h.w)());if(0===Object(s.y)(Object(h.q)(m)))continue;for(let t=0;t<i;t++)Object(h.s)(m,d,n[t],n[t]);const f=j(n);for(let t=0;t<f.length;t+=3)O+=Object(p.a)(n[f[t]],n[f[t+1]],n[f[t+2]])}return Object(n.b)(O,u)}const g=Object(c.f)(),_=Object(c.f)();function m(){return{positionsWorldCoords:[]}}function j(t){return Object(o.a)(function(t){const e=new Float64Array(2*t.length);for(let i=0;i<t.length;++i){const a=t[i],n=2*i;e[n+0]=a[0],e[n+1]=a[1]}return e}(t),[],2)}},1211:function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));let a=t=>({vnodeSelector:"",properties:void 0,children:void 0,text:t.toString(),domNode:null}),n=(t,e,i)=>{for(let r=0,o=e.length;r<o;r++){let o=e[r];Array.isArray(o)?n(t,o,i):null!=o&&!1!==o&&("string"==typeof o&&(o=a(o)),i.push(o))}};function r(t,e,i){if(Array.isArray(e))i=e,e=void 0;else if(e&&("string"==typeof e||e.hasOwnProperty("vnodeSelector"))||i&&("string"==typeof i||i.hasOwnProperty("vnodeSelector")))throw new Error("h called with invalid arguments");let a,r;return i&&1===i.length&&"string"==typeof i[0]?a=i[0]:i&&(r=[],n(t,i,r),0===r.length&&(r=void 0)),{vnodeSelector:t,properties:e,children:r,text:""===a?void 0:a,domNode:null}}},1214:function(t,e,i){"use strict";i.d(e,"a",(function(){return l}));var a=i(226),n=i(927),r=i(360),o=i(926),s=i(1126),c=i(743);class l{draw(t,e){const i=this._getUniqueHints(t),l=[];for(const a of i)a instanceof n.a&&l.push(this.visualizeIntersectionPoint(a,e)),a instanceof r.a&&l.push(this.visualizeLine(a,e)),a instanceof o.a&&l.push(this.visualizeParallelSign(a,e)),a instanceof c.a&&l.push(this.visualizeRightAngleQuad(a,e)),a instanceof s.a&&l.push(this.visualizePoint(a,e));return Object(a.b)(l)}_getUniqueHints(t){const e=[];for(const i of t){let t=!0;for(const a of e)if(i.equals(a)){t=!1;break}t&&e.push(i)}return e}}},1232:function(t,e,i){"use strict";i.d(e,"a",(function(){return r})),i.d(e,"b",(function(){return o}));var a=i(2),n=i(127);function r(t,e=Object(n.j)(t)){return"on-the-ground"!==e.mode&&!(Object(a.k)(t.geometry)||!t.geometry.hasZ)}function o(t,e){let i=null;const n=t.events.on("grab-changed",(n=>{Object(a.l)(i)&&(i.remove(),i=null),"start"===n.action?(i=t.disableDisplay(),e&&e(n)):e&&e(n)}));return{remove(){Object(a.l)(i)&&i.remove(),n.remove()}}}},1237:function(t,e,i){"use strict";i.d(e,"a",(function(){return Dt})),i.d(e,"b",(function(){return Gt})),i.d(e,"c",(function(){return Vt})),i.d(e,"d",(function(){return Rt})),i.d(e,"e",(function(){return It})),i.d(e,"f",(function(){return lt})),i.d(e,"g",(function(){return mt})),i.d(e,"h",(function(){return st})),i.d(e,"i",(function(){return Mt})),i.d(e,"j",(function(){return yt})),i.d(e,"k",(function(){return rt})),i.d(e,"l",(function(){return xt})),i.d(e,"m",(function(){return vt})),i.d(e,"n",(function(){return ht})),i.d(e,"o",(function(){return ft})),i.d(e,"p",(function(){return ct})),i.d(e,"q",(function(){return jt})),i.d(e,"r",(function(){return Lt})),i.d(e,"s",(function(){return St})),i.d(e,"t",(function(){return Tt})),i.d(e,"u",(function(){return At})),i.d(e,"v",(function(){return kt})),i.d(e,"w",(function(){return zt})),i.d(e,"x",(function(){return ot})),i.d(e,"y",(function(){return dt})),i.d(e,"z",(function(){return ut})),i.d(e,"A",(function(){return bt})),i.d(e,"B",(function(){return pt}));i(167);var a=i(1272),n=(i(32),i(22)),r=i(14),o=i(2),s=i(31),c=i(30),l=i(35),h=i(201),p=i(5),d=i(9),u=i(40),b=i(327),O=i(266),g=i(45),_=i(110),m=i(267),j=i(55),f=i(1273),v=i(1180),y=i(1125),M=i(1147),x=i(1181),w=i(60),S=i(41),E=i(1117),T=i(285),A=i(102),D=i(20),R=i(21),I=i(326),G=i(52),P=i(378),C=i(173),k=i(8),z=i(75),V=i(80),L=i(77),H=i(76),N=i(1274),U=i(7),F=i(36);class Z extends k.a{constructor(){super(...arguments),this.backgroundColor=Object(S.g)(1,0,0,.5),this.gridColor=Object(S.g)(0,1,0,.5),this.gridWidth=4}}class B extends V.a{initializeProgram(t){return new H.a(t.rctx,B.shader.get().build(this.configuration),L.a)}initializePipeline(){return Object(F.g)({blending:Object(F.h)(U.b.ONE,U.b.ONE,U.b.ONE_MINUS_SRC_ALPHA,U.b.ONE_MINUS_SRC_ALPHA),depthTest:{func:U.h.LESS},colorWrite:F.d})}}B.shader=new z.a(N.a,(()=>i.e(257).then(i.bind(null,1631))));class X extends A.a{constructor(t){super(t,new W),this._configuration=new R.a}intersect(t,e,i,a,n,r,o){return Object(C.h)(t,e,a,n,r,void 0,o)}createBufferWriter(){return new P.a(P.e)}requiresSlot(t,e){return e===D.a.Color&&t===G.a.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL}createGLMaterial(t){return new Y(t)}getConfiguration(){return this._configuration}}class Y extends I.a{constructor(t){super(t),this.ensureTechnique(B,null)}beginSlot(){return Object(o.t)(this.technique)}}class W extends Z{constructor(){super(...arguments),this.renderOccluded=A.c.Occlude}}class q extends E.a{constructor(t){super(t),this._material=null,this._renderOccluded=A.c.OccludeAndTransparent,this._gridWidth=1,this._gridColor=Object(S.g)(1,0,0,1),this._backgroundColor=Object(S.g)(1,0,0,1),this.applyProps(t)}get renderOccluded(){return this._renderOccluded}set renderOccluded(t){t!==this._renderOccluded&&(this._renderOccluded=t,this._updateMaterial())}get gridWidth(){return this._gridWidth}set gridWidth(t){this._gridWidth!==t&&(this._gridWidth=t,this._updateMaterial())}get gridColor(){return this._gridColor}set gridColor(t){Object(w.c)(this._gridColor,t),this._updateMaterial()}get backgroundColor(){return this._backgroundColor}set backgroundColor(t){Object(w.c)(this._backgroundColor,t),this._updateMaterial()}createExternalResources(){this._material=new X(this._materialParameters)}destroyExternalResources(){this._material=null}forEachExternalMaterial(t){Object(o.l)(this._material)&&t(this._material)}createGeometries(t){if(Object(o.l)(this._material)){const e=Object(T.l)();t.addGeometry(e,this._material)}}get _materialParameters(){return{backgroundColor:this._backgroundColor,gridWidth:this._gridWidth,gridColor:this._gridColor,renderOccluded:this._renderOccluded}}_updateMaterial(){Object(o.l)(this._material)&&this._material.setParameters(this._materialParameters)}}var Q,J,K=i(942),$=i(325),tt=i(34),et=i(871),it=i(880),at=i(475),nt=i(674);i(86);function rt(t,e,i,a,n,r,o,s){return function(t,e,i,a,n,r){const o=Object(p.n)(t,e),s=j.d.get(),c=j.d.get();switch(a===It.HORIZONTAL_OR_VERTICAL?Math.abs(o)>f.G?It.HORIZONTAL:It.VERTICAL:a){case It.VERTICAL:{const a=Math.abs(o)<=f.F?t:i.viewUp;Object(p.o)(s,a,e),Object(p.l)(c,e);break}case It.HORIZONTAL:Object(p.o)(s,i.viewUp,e),Object(p.o)(c,e,s);break;case It.TILTED:{const a=Math.abs(o)<=f.F?e:i.viewUp;Object(p.o)(s,a,t),Object(p.o)(c,t,s);break}}const l=Object(p.o)(j.d.get(),s,c);Object(p.n)(l,i.viewForward)>0&&Object(p.p)(c,c,-1),Object(p.w)(n,s),Object(p.w)(r,c)}(e,o.worldUpAtPosition(t,j.d.get()),n,r,s.basis1,s.basis2),Object(p.p)(s.basis1,s.basis1,i),Object(p.p)(s.basis2,s.basis2,a),Object(p.l)(s.origin,t),Object(g.j)(s.basis2,s.basis1,s.origin,s.plane),s}function ot(t,e,i,a,n,r){const o=Object(p.l)(j.d.get(),n.origin);Object(p.j)(o,o,Object(p.p)(j.d.get(),n.basis1,t.direction[0]<0?1:-1)),Object(p.j)(o,o,Object(p.p)(j.d.get(),n.basis2,t.direction[1]<0?1:-1));const s=Object(p.u)(n.basis1),c=Object(p.u)(n.basis2),l=Object(p.k)(j.d.get(),i,o),h=Object(p.k)(j.d.get(),e,o);let d=0,u=0;if(jt(t)){const e=mt(n),i=mt(r);d=s-.5*t.direction[0]*Object(p.n)(n.basis1,h)/s,u=c-.5*t.direction[1]*Object(p.n)(n.basis2,h)/c;const a=i/e;d*=a,u*=a}const b=d+.5*t.direction[0]*Object(p.n)(n.basis1,l)/s,g=u+.5*t.direction[1]*Object(p.n)(n.basis2,l)/c,_=Object(p.p)(j.d.get(),n.basis1,b/s),m=Object(p.p)(j.d.get(),n.basis2,g/c);(b<=0||gt(r.origin,_,a)<=f.f)&&Object(p.l)(_,r.basis1),(g<=0||gt(r.origin,m,a)<=f.f)&&Object(p.l)(m,r.basis2);const v=Object(p.l)(j.d.get(),o);return Object(p.j)(v,v,Object(p.p)(j.d.get(),_,t.direction[0]<0?-1:1)),Object(p.j)(v,v,Object(p.p)(j.d.get(),m,t.direction[1]<0?-1:1)),Object(O.g)(v,_,m,r)}function st(t,e){return f.d*Math.min(e.width,e.height)*e.computeRenderPixelSizeAt(t)}function ct(t,e,i,a){const n=Object(p.o)(j.d.get(),e,i);return Object(p.o)(n,n,e),Object(g.h)(t,n,a)}function lt(t,e){return Object(M.b)(t.basis1,t.basis2,t.origin,e)}function ht(t,e,i,a){const n=e.worldUpAtPosition(t.origin,j.d.get()),r=j.d.get();switch(i){case Rt.HEADING:Object(p.l)(r,n);break;case Rt.TILT:Object(p.l)(r,t.basis1)}return Object(g.h)(t.origin,r,a)}function pt(t,e,i,a){const n=Ot(i,Q.NEGATIVE_X),r=j.a.get();Object(c.r)(r,e,n.edge*Math.PI/2);const o=Object(p.w)(j.d.get(),n.basis);let l=Object(p.p)(j.d.get(),o,n.direction*a.computeScreenPixelSizeAt(n.position)*f.x);Object(p.j)(l,l,n.position);const h=a.projectToRenderScreen(l,Object(s.b)(j.d.get())),u=function(t,e){const[i,a,n,r]=t.viewport,o=Math.min(n,r)/16;let s=!0;return e[0]<i+o?(e[0]=i+o,s=!1):e[0]>i+n-o&&(e[0]=i+n-o,s=!1),e[1]<a+o?(e[1]=a+o,s=!1):e[1]>a+r-o&&(e[1]=a+r-o,s=!1),s}(a,h);Object($.a)(a,h,Pt),Object(p.w)(Pt.direction,Pt.direction);const b=j.d.get();!u&&Object(O.j)(i,Pt,b)&&(l=b),r[12]=0,r[13]=0,r[14]=0,t.modelTransform=r,t.renderLocation=Object(d.d)(l),u?t.state|=Gt:t.state&=~Gt}function dt(t,e,i,a){const n=Object(p.u)(a.basis1),r=Object(p.u)(a.basis2),o=_t(a),s=mt(a),l=Object(p.B)(j.d.get(),0,0,0);Object(p.j)(l,Object(p.p)(j.d.get(),a.basis1,e.direction[0]),Object(p.p)(j.d.get(),a.basis2,e.direction[1])),Object(p.j)(l,a.origin,l);let h=0,d=1;if(jt(e))1===e.direction[0]&&-1===e.direction[1]?h=Ct:1===e.direction[0]&&1===e.direction[1]?h=Math.PI:-1===e.direction[0]&&1===e.direction[1]&&(h=3*Math.PI/2),d=s;else{const t=0!==e.direction[0]?1:2;h=1===t?Ct:0,d=(1===t?r:n)-o}const u=Object(c.e)(j.a.get(),h);Object(c.n)(u,u,Object(p.B)(j.d.get(),d,d,d)),Object(c.p)(u,i,u),u[12]=0,u[13]=0,u[14]=0,t.modelTransform=u,t.renderLocation=l}function ut(t,e,i,a){const n=a.worldUpAtPosition(i.origin,j.d.get()),r=Ot(i,Q.POSITIVE_X),o=Object(c.e)(j.a.get(),r.edge*Math.PI/2);Object(c.u)(o,o,-Et(i,n)),Object(c.p)(o,e,o),o[12]=0,o[13]=0,o[14]=0,t.modelTransform=o,t.renderLocation=r.position}function bt(t,e,i){const a=Ot(i,Q.POSITIVE_Y),n=Object(c.e)(j.a.get(),a.edge*Math.PI/2);Object(c.u)(n,n,Ct),Object(c.p)(n,e,n),n[12]=0,n[13]=0,n[14]=0,t.modelTransform=n,t.renderLocation=a.position}function Ot(t,e){switch(e){case Q.POSITIVE_X:return{basis:t.basis1,direction:1,position:Object(p.j)(j.d.get(),t.origin,t.basis1),edge:e};case Q.POSITIVE_Y:return{basis:t.basis2,direction:1,position:Object(p.j)(j.d.get(),t.origin,t.basis2),edge:e};case Q.NEGATIVE_X:return{basis:t.basis1,direction:-1,position:Object(p.k)(j.d.get(),t.origin,t.basis1),edge:e};case Q.NEGATIVE_Y:return{basis:t.basis2,direction:-1,position:Object(p.k)(j.d.get(),t.origin,t.basis2),edge:e}}}function gt(t,e,i){const a=i.projectToRenderScreen(Object(p.j)(j.d.get(),t,e),Object(s.b)(j.d.get())),n=i.projectToRenderScreen(Object(p.k)(j.d.get(),t,e),Object(s.b)(j.d.get()));return Object(p.y)(Object(p.k)(a,a,n))}function _t(t){const e=Object(p.u)(t.basis1),i=Object(p.u)(t.basis2);return f.q*Math.min(e,i)}function mt(t){return _t(t)}function jt(t){return 0!==t.direction[0]&&0!==t.direction[1]}function ft(t,e=Vt.CENTER_ON_ARROW){const i=e===Vt.CENTER_ON_CALLOUT?f.x:0,a=[Object(d.h)(i,0,-f.t/2),Object(d.h)(i,0,f.t/2)],n=function(t,e){const i=Object(p.k)(Object(d.f)(),t[t.length-1],t[t.length-2]);if(Object(p.w)(i,i),Object(p.p)(i,i,f.A),Object(p.j)(i,i,t[t.length-1]),e){const e=Object(p.k)(Object(d.f)(),t[0],t[1]);return Object(p.w)(e,e),Object(p.p)(e,e,f.A),Object(p.j)(e,e,t[0]),[e,...t,i]}return[...t,i]}(a,!0),r=(t,e)=>function(t,e,i){const a=a=>{const n=(a?e:t).slice(0),r=Object(p.k)(j.d.get(),n[0],n[1]);Object(p.w)(r,r);const s=Object(p.k)(j.d.get(),n[n.length-1],n[n.length-2]);if(Object(p.w)(s,s),i.padding>0){const t=Object(p.p)(Object(d.f)(),s,-i.padding);if(n[n.length-1]=Object(p.j)(t,t,n[n.length-1]),i.bothEnds){const t=Object(p.p)(Object(d.f)(),r,-i.padding);n[0]=Object(p.j)(t,t,n[0])}}const u=a?i.tipFocusMultiplier:1,b=i.tipLength*(i.focusTipLength?u:1),O=i.tipRadius*u,g=Object(c.l)(j.a.get());if(i.padding>0){const t=b/4,e=Object(p.B)(j.d.get(),0,t,0),a=1+i.padding/t;Object(c.y)(g,g,e),Object(c.n)(g,g,Object(p.B)(j.d.get(),a,a,a)),Object(c.y)(g,g,Object(p.p)(e,e,-1/a))}const _=Object(c.l)(Object(l.d)()),m=Object(d.h)(0,1,0),f=Object(c.c)(Object(l.d)(),Object(h.h)(j.b.get(),m,s));f[12]=n[n.length-1][0],f[13]=n[n.length-1][1],f[14]=n[n.length-1][2],Object(c.p)(f,f,g);const v=[{part:"tube",geometry:wt(i.tubeRadius*(a?i.tubeFocusMultiplier:1)+i.padding,i.flat,n),transform:_}];let y,M;if(Object(o.l)(i.flat)?y=Object(T.f)(b,O,O,i.flat.thickness):(y=Object(T.c)(b,O,24,!1,!1,!0),M=Object(T.c)(b,O,24,!1,!0,!1)),v.push({part:"tip",geometry:y,transform:f}),M&&v.push({part:"cap",geometry:M,transform:f}),i.bothEnds){const t=Object(c.c)(Object(l.d)(),Object(h.h)(j.b.get(),m,r));t[12]=n[0][0],t[13]=n[0][1],t[14]=n[0][2],Object(c.p)(t,t,g),v.push({part:"tip",geometry:y,transform:t}),M&&v.push({part:"cap",geometry:M,transform:t})}return v};return{normal:a(!1),focused:a(!0)}}(a,a,{tubeRadius:f.E,tipRadius:f.B,tipLength:f.A,tubeFocusMultiplier:f.D,tipFocusMultiplier:f.z,padding:t,bothEnds:!0,flat:null,focusTipLength:!0,addCap:e}),s=r(0,!1),u=r(f.u,!0),b=new et.a({color:f.v,cullFace:tt.b.Back,renderOccluded:A.c.Opaque}),O=new et.a({color:f.s,cullFace:tt.b.Back,renderOccluded:A.c.Opaque}),g=new et.a({color:f.C,cullFace:tt.b.Back,renderOccluded:A.c.Opaque}),_=new et.a({color:f.y,transparent:!0,writeDepth:!1,cullFace:tt.b.Front,renderOccluded:A.c.Transparent}),m=Object(T.j)([[i,0,0],[i-f.x,0,0]]),v=Object(T.j)([[i,0,0],[i-f.x,0,0]]),M=new it.a({color:f.w,renderOccluded:A.c.OccludeAndTransparent});return new y.a({view:t,renderObjects:[...s.normal.map((({part:t,geometry:e,transform:i})=>({geometry:e,material:"tip"===t?b:"cap"===t?O:g,transform:i,stateMask:nt.c.Unfocused|Dt}))),...u.normal.map((({geometry:t,transform:e})=>({geometry:t,material:_,transform:e,stateMask:nt.c.Unfocused|Dt}))),{geometry:m,material:M,stateMask:nt.c.Unfocused|Dt|Gt},...s.focused.map((({part:t,geometry:e,transform:i})=>({geometry:e,material:"tip"===t?b:"cap"===t?O:g,transform:i,stateMask:nt.c.Focused|Dt}))),...u.focused.map((({geometry:t,transform:e})=>({geometry:t,material:_,transform:e,stateMask:nt.c.Focused|Dt}))),{geometry:v,material:M,stateMask:nt.c.Focused|Dt|Gt}],autoScaleRenderObjects:!1,collisionType:{type:"line",paths:[n]},collisionPriority:1,radius:f.B,state:Dt})}function vt(t,e){const i=Object(M.e)(t,{customStateMask:Dt,texture:e});return i.state=Dt,i}function yt(t){return new x.a({view:t,attached:!1,color:f.g,width:f.h,writeDepthEnabled:!1,renderOccluded:A.c.OccludeAndTransparent,geometry:[[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0],[-1,-1,0]]]})}function Mt(t){return new q({view:t,attached:!1,backgroundColor:[...f.e],gridColor:f.b,gridWidth:4,renderOccluded:A.c.OccludeAndTransparent})}function xt(t,e){const i=jt(e),a=i?[Object(d.h)(1,0,0),Object(d.h)(0,0,0),Object(d.h)(0,1,0)]:[Object(d.h)(1,0,0),Object(d.h)(-1,0,0)],n=Object(T.j)(a),r=f.m,o=i?f.o:f.r,s=o*f.a,c=f.r,l=t=>t>1?(t=>new at.a({color:r,width:t,renderOccluded:A.c.OccludeAndTransparent}))(t):new it.a({color:r,renderOccluded:A.c.OccludeAndTransparent}),h=[{geometry:n,material:l(o),stateMask:nt.c.Unfocused|kt},{geometry:n,material:l(s),stateMask:nt.c.Focused|kt},{geometry:n,material:l(c),stateMask:zt}],p=new y.a({view:t,renderObjects:h,collisionType:{type:"line",paths:[a]},radius:i?f.n:f.p,...M.j});return p.state=kt,p}function wt(t,e,i){const a=[];if(Object(o.l)(e))a.push([t,e.thickness/2],[-t,e.thickness/2],[-t,-e.thickness/2],[t,-e.thickness/2]);else{const e=12;for(let i=0;i<e;i++){const n=i/e*2*Math.PI;a.push([Math.cos(n)*t,Math.sin(n)*t])}}return Object(T.g)(a,i,[],[],!1)}function St(t,e,i,n=new a.a){if(Object(o.k)(t))return null;const{renderCoordsHelper:s}=e,c=s.fromRenderCoords(t.origin,e.spatialReference);if(Object(o.k)(c))return null;const l=Object(u.H)(c,i);if(Object(o.k)(l))return null;n.position=l;const h=2*Object(p.u)(t.basis1),d=2*Object(p.u)(t.basis2),b=K.a.renderUnitScaleFactor(e.spatialReference,i);n.width=h*b,n.height=d*b;const O=s.worldUpAtPosition(t.origin,j.d.get());return n.tilt=Object(r.q)(Et(t,O)),n.heading=s.headingAtPosition(t.origin,t.basis1)-90,n}function Et(t,e){return Object(m.b)(e,t.basis2,t.basis1)+Ct}function Tt(t,e){if(Object(o.k)(t)||Object(o.k)(t.position))return null;const i=Object(v.a)(t.position,e.spatialReference,e.elevationProvider);if(Object(o.k)(i))return null;const a=K.a.renderUnitScaleFactor(t.position.spatialReference,e.spatialReference),n=t.width*a,r=t.height*a;return{position:i,heading:t.heading,tilt:t.tilt,renderWidth:n,renderHeight:r}}function At(t,e,i,a=Object(O.b)()){if(Object(o.k)(t))return null;const s=function(t,e,i,a,o,s,c=Object(O.b)()){return s.toRenderCoords(t,c.origin)?(s.worldBasisAtPosition(c.origin,b.a.X,c.basis1),s.worldBasisAtPosition(c.origin,b.a.Y,c.basis2),Object(g.j)(c.basis2,c.basis1,c.origin,c.plane),Object(O.l)(c,-Object(r.h)(e),Object(O.k)(c),c),Object(O.l)(c,Object(r.h)(i),c.basis1,c),Object(p.p)(c.basis1,c.basis1,a/2),Object(p.p)(c.basis2,c.basis2,o/2),Object(O.n)(c),c):(n.a.getLogger("esri.views.3d.analysis.Slice.sliceToolUtils").error(`Failed to project slice plane position, projection from ${t.spatialReference.wkid} is not supported`),null)}(t.position,t.heading,t.tilt,t.renderWidth,t.renderHeight,e.renderCoordsHelper,a);return!i.tiltEnabled&&Object(o.l)(s)&&function(t,e,i){const a=e.worldUpAtPosition(t.origin,j.d.get()),n=t.basis1,r=Et(t,a),o=Math.round(r/Ct)*Ct;Object(O.l)(t,o-r,n,i)}(s,e.renderCoordsHelper,s),s}(J=Q||(Q={}))[J.POSITIVE_X=0]="POSITIVE_X",J[J.POSITIVE_Y=1]="POSITIVE_Y",J[J.NEGATIVE_X=2]="NEGATIVE_X",J[J.NEGATIVE_Y=3]="NEGATIVE_Y";const Dt=nt.b.Custom1;var Rt,It;!function(t){t[t.HEADING=1]="HEADING",t[t.TILT=2]="TILT"}(Rt||(Rt={})),function(t){t[t.HORIZONTAL_OR_VERTICAL=0]="HORIZONTAL_OR_VERTICAL",t[t.HORIZONTAL=1]="HORIZONTAL",t[t.VERTICAL=2]="VERTICAL",t[t.TILTED=3]="TILTED"}(It||(It={}));const Gt=nt.b.Custom2,Pt=Object(_.c)(),Ct=Math.PI/2,kt=nt.b.Custom1,zt=nt.b.Custom2;var Vt;function Lt(t){const e="building-scene-3d"===t.type?t:null;return Object(o.l)(e)}!function(t){t[t.CENTER_ON_CALLOUT=0]="CENTER_ON_CALLOUT",t[t.CENTER_ON_ARROW=1]="CENTER_ON_ARROW"}(Vt||(Vt={}))},1238:function(t,e,i){"use strict";i.d(e,"a",(function(){return O})),i.d(e,"b",(function(){return b}));var a=i(2),n=i(1209),r=(i(167),i(1102)),o=i(907),s=i(40),c=i(916),l=i(1302),h=i(57);function p(t){return Object(r.b)(Math.abs(Object(c.c)([t],"square-meters")[0]),"square-meters")}function d(t){try{return Object(r.b)(Math.abs(Object(o.geodesicArea)(t,"square-meters")),"square-meters")}catch(e){return null}}function u(t){const e=[];return Object(s.y)(t,e)?Object(r.b)(Math.abs(Object(c.c)([{type:"polygon",rings:e,spatialReference:h.a.WGS84}],"square-meters")[0]),"square-meters"):null}function b(t,e,i=Object(n.a)()){if("on-the-ground"===e){const e=function(t){const{spatialReference:e}=t;return Object(l.a)(e,p,d,u,t)}(t);return Object(a.l)(e)?e:Object(n.b)(t,i)}return Object(n.c)(t,i)}function O(t,e=Object(n.a)()){return b(t,"on-the-ground",e)}},1240:function(t,e,i){"use strict";i.d(e,"a",(function(){return C}));var a=i(46),n=(i(32),i(226)),r=i(2),o=i(5),s=i(9),c=i(62),l=i(1183),h=i(64),p=i(13),d=i(31),u=i(26),b=i(60),O=i(401),g=i(1117),_=i(285),m=i(102),j=i(11),f=i(475);class v extends g.a{constructor(t){super(t),this._handles=new h.a,this._location=Object(s.f)(),this._direction=Object(s.h)(1,0,0),this._width=1,this._offset=1,this._length=18,this._color=Object(O.c)(1,0,1,1),this._renderOccluded=m.c.OccludeAndTransparent,this.applyProps(t)}get location(){return this._location}set location(t){Object(o.t)(this._location,t)||(Object(o.l)(this._location,t),this._updateGeometry())}get direction(){return this._direction}set direction(t){Object(o.t)(this._direction,t)||(Object(o.l)(this._direction,t),this._updateGeometry())}setDirectionFromPoints(t,e){Object(o.w)(this._direction,Object(o.k)(this._direction,e,t)),this._updateGeometry()}get width(){return this._width}set width(t){t!==this._width&&(this._width=t,this._updateMaterial())}get offset(){return this._offset}set offset(t){t!==this._offset&&(this._offset=t,this._updateGeometry())}get length(){return this._length}set length(t){t!==this._length&&(this._length=t,this._updateGeometry())}get color(){return this._color}set color(t){Object(b.g)(t,this._color)||(Object(b.c)(this._color,t),this._updateMaterial())}get renderOccluded(){return this._renderOccluded}set renderOccluded(t){t!==this._renderOccluded&&(this._renderOccluded=t,this._updateMaterial())}createExternalResources(){const t=new f.a(this.materialParameters);this._handles.add(Object(p.f)((()=>this.view.state.camera),(()=>{this._updateGeometry()}))),this._externalResources={material:t}}destroyExternalResources(){this._handles.removeAll(),this._externalResources=null}createGeometries(t){const e=Object(_.j)([Object(s.f)(),Object(s.f)()]),i=Object(_.j)([Object(s.f)(),Object(s.f)()]),a=Object(r.t)(this._externalResources).material;t.addGeometry(e,a),t.addGeometry(i,a),this._updateVertices(t)}forEachExternalMaterial(t){Object(r.l)(this._externalResources)&&t(this._externalResources.material)}_updateMaterial(){Object(r.k)(this._externalResources)||this._externalResources.material.setParameters(this.materialParameters)}get materialParameters(){return{width:this._width,color:this._color,renderOccluded:this._renderOccluded}}_updateGeometry(){const t=this.object;Object(r.k)(t)||this._updateVertices(t)}_updateVertices(t){const e=this.view.state.camera;e.projectToScreen(this.location,M),Object(o.j)(y,this.location,this.direction),e.projectToScreen(y,x),Object(u.f)(x,Object(u.a)(x,x,M)),this._updateVertexAttributes(e,t,0,M,x,1),this._updateVertexAttributes(e,t,1,M,x,-1)}_updateVertexAttributes(t,e,i,a,n,r){const o=e.geometryRecords[i],s=o.geometry.getMutableAttribute(j.a.POSITION).data,c=Object(u.b)(w,Object(u.s)(w,n[1]*r,n[0]*-r),this.offset+this.width/2),l=Object(u.j)(S,Object(u.j)(S,Object(u.j)(S,a,Object(u.b)(S,n,this.length/2)),c),c),h=Object(u.j)(E,l,Object(u.b)(E,n,-this.length));t.unprojectFromScreen(l,y),s[0]=y[0],s[1]=y[1],s[2]=y[2],t.unprojectFromScreen(h,y),s[3]=y[0],s[4]=y[1],s[5]=y[2],e.geometryVertexAttrsUpdated(o)}}const y=Object(s.f)(),M=Object(d.g)(),x=Object(d.g)(),w=Object(d.g)(),S=Object(d.g)(),E=Object(d.g)();var T=i(1299),A=i(1268),D=i(362),R=i(205),I=i(78),G=i(1214),P=i(251);class C extends G.a{visualizeIntersectionPoint(t,e){const{coordinateHelper:i,view:o}=e;return Object(n.a)(new T.a({view:o,primitive:"circle",geometry:i.vectorToPoint(t.intersectionPoint),elevationInfo:Object(r.u)(t.elevationInfo,e.elevationInfo),size:20,outlineSize:2,color:[0,0,0,0],outlineColor:a.a.toUnitRGBA(D.a.orange),pixelSnappingEnabled:!1}))}visualizePoint(t,e){const{view:i,coordinateHelper:r}=e,o=this._alignPoint(t.point,t.domain,e);return Object(n.a)(new T.a({view:i,primitive:"circle",geometry:r.vectorToPoint(o),elevationInfo:this._hintElevationInfo(t,e),size:20,outlineSize:2,color:[0,0,0,0],outlineColor:a.a.toUnitRGBA(D.a.orange),pixelSnappingEnabled:!1}))}visualizeLine(t,e){const{view:i,coordinateHelper:a}=e,r=this._alignPoint(t.lineStart,t.domain,e),o=this._alignPoint(t.lineEnd,t.domain,e);return Object(n.a)(this._createLineSegmentHintFromMap(t.type,r,o,a,this._hintElevationInfo(t,e),i,t.fadeLeft,t.fadeRight))}visualizeParallelSign(t,e){const{view:i,coordinateHelper:r}=e,s=this._hintElevationInfo(t,e),c=this._alignPoint(t.lineStart,t.domain,e),l=this._alignPoint(t.lineEnd,t.domain,e),h=Object(P.a)(c,r,s,i),p=Object(P.a)(l,r,s,i),d=Object(o.q)(p,h,p,.5),u=new v({view:i,attached:!1,offset:D.a.parallelLineHintOffset,length:D.a.parallelLineHintLength,width:D.a.parallelLineHintWidth,color:a.a.toUnitRGBA(D.a.orange),location:d,renderOccluded:m.c.Opaque});return u.setDirectionFromPoints(h,d),u.attached=!0,Object(n.a)(u)}visualizeRightAngleQuad(t,e){const{view:i,coordinateHelper:r}=e,o=this._hintElevationInfo(t,e),s=this._alignPoint(t.previousVertex,t.domain,e),c=this._alignPoint(t.centerVertex,t.domain,e),l=this._alignPoint(t.nextVertex,t.domain,e);return Object(n.a)(new A.a({view:i,attached:!0,color:a.a.toUnitRGBA(D.a.orange),renderOccluded:m.c.Transparent,outlineRenderOccluded:m.c.Opaque,outlineColor:a.a.toUnitRGBA(D.a.orange),outlineSize:D.a.rightAngleHintOutlineSize,size:D.a.rightAngleHintSize,geometry:{previous:Object(P.a)(s,r,o,i),center:Object(P.a)(c,r,o,i),next:Object(P.a)(l,r,o,i)}}))}_createLineSegmentHintFromMap(t,e,i,a,n,r,o=!0,c=!0){const l=Object(s.f)(),h=Object(s.f)();return Object(P.c)(e,i,a,n,r,l,h),this._createLineSegmentHint(t,r,l,h,o,c)}_createLineSegmentHint(t,e,i,n,r=!0,o=!0){const s=new l.a({view:e,extensionType:l.b.FADED,start:i,end:n,color:a.a.toUnitRGBA(D.a.orange),renderOccluded:m.c.Opaque});switch(t){case I.a.TARGET:s.width=D.a.lineHintWidthTarget,s.fadedExtensions={start:0,end:D.a.lineHintFadedExtensions};break;case I.a.REFERENCE_EXTENSION:s.width=D.a.lineHintWidthReference,s.fadedExtensions={start:0,end:0};break;case I.a.REFERENCE:s.width=D.a.lineHintWidthReference,s.fadedExtensions={start:r?D.a.lineHintFadedExtensions:0,end:o?D.a.lineHintFadedExtensions:0}}return s.attached=!0,s}_alignPoint(t,e,i){const a=this._getSelfSnappingZ(e,i);if(Object(r.k)(a))return t;const n=i.coordinateHelper,o=n.vectorToPoint(t,k);return o.z=a,n.pointToVector(o)}_hintElevationInfo(t,e){return Object(r.l)(this._getSelfSnappingZ(t.domain,e))?Object(r.t)(e.selfSnappingZ).elevationInfo:Object(r.u)(t.elevationInfo,e.elevationInfo)}_getSelfSnappingZ(t,{selfSnappingZ:e}){return t===R.a.SELF&&Object(r.l)(e)?e.value:null}}const k=new c.a},1266:function(t,e,i){"use strict";i.d(e,"a",(function(){return u}));var a=i(0),n=i(46),r=i(28),o=i(1),s=(i(17),i(12),i(10)),c=(i(343),i(1211));i(513);const l={bottom:"esri-text-overlay-item-anchor-bottom","bottom-right":"esri-text-overlay-item-anchor-bottom-right","bottom-left":"esri-text-overlay-item-anchor-bottom-left",top:"esri-text-overlay-item-anchor-top","top-right":"esri-text-overlay-item-anchor-top-right","top-left":"esri-text-overlay-item-anchor-top-left",center:"esri-text-overlay-item-anchor-center",right:"esri-text-overlay-item-anchor-right",left:"esri-text-overlay-item-anchor-left"};let h=class extends r.a{constructor(t){super(t),this.x=0,this.y=0,this.text="-",this.fontSize=14,this.anchor="center",this.visible=!0,this.backgroundColor=new n.a([0,0,0,.6]),this.textColor=new n.a([255,255,255]),this._textShadowSize=1}get position(){return[this.x,this.y]}set position(t){this._set("x",t[0]),this._set("y",t[1])}get _textShadowColor(){return this.backgroundColor}get _textShadow(){const t=this._textShadowColor.toCss(!1);return`0 0 ${this._textShadowSize}px ${t}`}get _padding(){return.5*this.fontSize}get _borderRadius(){return this._padding}render(){return Object(c.a)("div",{classes:this._cssClasses(),styles:{left:Math.floor(this.x)+"px",top:Math.floor(this.y)+"px",visibility:this.visible?"visible":"hidden",fontSize:this.fontSize+"px",lineHeight:this.fontSize+"px",backgroundColor:this.backgroundColor.toCss(!0),color:this.textColor.toCss(!0),padding:this._padding+"px",borderRadius:this._borderRadius+"px",textShadow:this._textShadow}},[this.text])}renderCanvas(t){if(!this.visible)return;const e=t.font.replace(/^(.*?)px/,"");t.font=`${this.fontSize}px ${e}`;const i=this._padding,a=this._borderRadius,n=t.measureText(this.text).width,r=this.fontSize,o=p[this.anchor];t.textAlign="center",t.textBaseline="middle";const s=n+2*i,c=r+2*i,l=this.x+o.x*s,h=this.y+o.y*c;this._roundedRect(t,l,h,s,c,a),t.fillStyle=this.backgroundColor.toCss(!0),t.fill();const d=this.x+(o.x+.5)*s,u=this.y+(o.y+.5)*c;this._renderTextShadow(t,this.text,d,u),t.fillStyle=this.textColor.toCss(!0),t.fillText(this.text,d,u)}_renderTextShadow(t,e,i,a){t.lineJoin="miter",t.fillStyle=`rgba(${this._textShadowColor.r}, ${this._textShadowColor.g}, ${this._textShadowColor.b}, ${1/d.length})`;const n=this._textShadowSize;for(const[r,o]of d)t.fillText(e,i+n*r,a+n*o)}_roundedRect(t,e,i,a,n,r){t.beginPath(),t.moveTo(e,i+r),t.arcTo(e,i,e+r,i,r),t.lineTo(e+a-r,i),t.arcTo(e+a,i,e+a,i+r,r),t.lineTo(e+a,i+n-r),t.arcTo(e+a,i+n,e+a-r,i+n,r),t.lineTo(e+r,i+n),t.arcTo(e,i+n,e,i+n-r,r),t.closePath()}_cssClasses(){const t={"esri-text-overlay-item":!0};for(const e in l)t[l[e]]=this.anchor===e;return t}};Object(a.a)([Object(o.b)()],h.prototype,"x",void 0),Object(a.a)([Object(o.b)()],h.prototype,"y",void 0),Object(a.a)([Object(o.b)()],h.prototype,"position",null),Object(a.a)([Object(o.b)()],h.prototype,"text",void 0),Object(a.a)([Object(o.b)()],h.prototype,"fontSize",void 0),Object(a.a)([Object(o.b)()],h.prototype,"anchor",void 0),Object(a.a)([Object(o.b)()],h.prototype,"visible",void 0),Object(a.a)([Object(o.b)()],h.prototype,"backgroundColor",void 0),Object(a.a)([Object(o.b)()],h.prototype,"textColor",void 0),Object(a.a)([Object(o.b)()],h.prototype,"_textShadowSize",void 0),Object(a.a)([Object(o.b)()],h.prototype,"_textShadowColor",null),Object(a.a)([Object(o.b)()],h.prototype,"_textShadow",null),Object(a.a)([Object(o.b)()],h.prototype,"_padding",null),Object(a.a)([Object(o.b)()],h.prototype,"_borderRadius",null),h=Object(a.a)([Object(s.a)("esri.views.overlay.TextOverlayItem")],h);const p={bottom:{x:-.5,y:-1,textAlign:"center",textBaseline:"bottom"},"bottom-left":{x:0,y:-1,textAlign:"left",textBaseline:"bottom"},"bottom-right":{x:-1,y:-1,textAlign:"right",textBaseline:"bottom"},center:{x:-.5,y:-.5,textAlign:"center",textBaseline:"middle"},left:{x:0,y:-.5,textAlign:"left",textBaseline:"middle"},right:{x:-1,y:-.5,textAlign:"right",textBaseline:"middle"},top:{x:-.5,y:0,textAlign:"center",textBaseline:"top"},"top-left":{x:0,y:0,textAlign:"left",textBaseline:"top"},"top-right":{x:-1,y:0,textAlign:"right",textBaseline:"top"}},d=[];{const t=16;for(let e=0;e<360;e+=360/t)d.push([Math.cos(Math.PI*e/180),Math.sin(Math.PI*e/180)])}const u=h},1268:function(t,e,i){"use strict";i.d(e,"a",(function(){return f}));var a=i(64),n=i(2),r=i(13),o=i(30),s=i(35),c=i(5),l=i(9),h=i(60),p=i(401),d=i(55),u=i(1117),b=i(169),O=i(285),g=i(102),_=i(11),m=i(871),j=i(475);class f extends u.a{constructor(t){super(t),this._handles=new a.a,this._quadMaterial=null,this._outlineMaterial=null,this._maxSize=0,this._position=Object(l.f)(),this._up=Object(l.f)(),this._right=Object(l.f)(),this._renderOccluded=g.c.OccludeAndTransparent,this._color=Object(p.c)(1,0,0,1),this._outlineColor=Object(p.c)(0,0,0,1),this._outlineSize=0,this._size=32,this._outlineRenderOccluded=g.c.Opaque,this.applyProps(t)}get renderOccluded(){return this._renderOccluded}set renderOccluded(t){t!==this._renderOccluded&&(this._renderOccluded=t,this._updateQuadMaterial())}get color(){return this._color}set color(t){Object(h.c)(this._color,t),this._updateQuadMaterial()}get outlineColor(){return this._outlineColor}set outlineColor(t){Object(h.c)(this._outlineColor,t),this._updateOutlineMaterial()}get outlineSize(){return this._outlineSize}set outlineSize(t){const e=0===this._outlineSize!=(0===t);this._outlineSize=t,e?this.recreateGeometry():this._updateOutlineMaterial()}get size(){return this._size}set size(t){t!==this._size&&(this._size=t,this._updateTransform())}get outlineRenderOccluded(){return this._outlineRenderOccluded}set outlineRenderOccluded(t){this._outlineRenderOccluded=t,this._updateOutlineMaterial()}set geometry({previous:t,center:e,next:i}){this._maxSize=Math.min(Object(c.r)(e,t),Object(c.r)(e,i))/3,Object(c.w)(this._up,Object(c.k)(this._up,t,e)),Object(c.w)(this._right,Object(c.k)(this._right,i,e)),Object(c.l)(this._position,e),this.recreateGeometry()}createExternalResources(){this._quadMaterial=new m.a(this._quadMaterialParameters),this._outlineMaterial=new j.a(this._outlineMaterialParameters),this._handles.add(Object(r.f)((()=>this.view.state.camera),(()=>this._updateTransform())))}destroyExternalResources(){this._quadMaterial=null,this._outlineMaterial=null,this._handles.removeAll()}forEachExternalMaterial(t){t(this._quadMaterial),t(this._outlineMaterial)}createGeometries(t){Object(c.t)(this._up,l.c)&&Object(c.t)(this._right,l.c)||(this._createQuadGeometry(t),this._createOutlineGeometry(t),this._updateTransform(t))}_createQuadGeometry(t){const e=this._quadGeometryData(this._up,this._right);t.addGeometry(e,this._quadMaterial)}_createOutlineGeometry(t){if(0===this._outlineSize)return;const e=Object(c.j)(d.d.get(),this._up,this._right),i=Object(O.j)([this._up,e,this._right]);t.addGeometry(i,this._outlineMaterial)}_updateTransform(t=this.object){const e=this.view.state.camera,i=this._size*e.computeScreenPixelSizeAt(this._position),a=Math.min(this._maxSize,i);Object(o.i)(v,this._position),Object(o.n)(v,v,[a,a,a]),Object(n.l)(t)&&(t.transformation=v)}_quadGeometryData(t,e){const i=Object(c.j)(d.d.get(),t,e);return new b.a([[_.a.POSITION,{size:3,data:[0,0,0,...e,...t,...i],exclusive:!0}]],[[_.a.POSITION,[0,1,2,1,2,3]]])}get _quadMaterialParameters(){return{color:this._color,transparent:!0,writeDepth:!1,polygonOffset:!0,renderOccluded:this._renderOccluded}}_updateQuadMaterial(){this._quadMaterial&&this._quadMaterial.setParameters(this._quadMaterialParameters)}get _outlineMaterialParameters(){return{color:this._outlineColor,width:this._outlineSize,renderOccluded:this._outlineRenderOccluded}}_updateOutlineMaterial(){this._outlineMaterial&&this._outlineMaterial.setParameters(this._outlineMaterialParameters)}}const v=Object(s.d)()},1269:function(t,e,i){"use strict";i.d(e,"a",(function(){return h}));var a=i(0),n=i(28),r=i(2),o=i(23),s=i(1),c=(i(17),i(12),i(10)),l=i(124);let h=class extends n.a{constructor(t){super(t),this.constrainResult=t=>t,this._snapPoints=null,this._abortController=null,this._stagedPoint=null,this._snap=Object(o.f)((async(t,e,i,a)=>{const n=await this._frameTask.schedule((()=>e.snap({...t,context:i,signal:a})),a);n.valid&&await this._frameTask.schedule((()=>{this.stagedPoint=n.apply(),t!==this._snapPoints&&Object(r.l)(this._snapPoints)&&(this.stagedPoint=e.update({...this._snapPoints,context:i}))}),a)}))}get stagedPoint(){return this._stagedPoint}set stagedPoint(t){this._stagedPoint=this.constrainResult(t)}initialize(){var t,e;const i="3d"===this.view.type?null==(t=this.view)||null==(e=t.resourceController)?void 0:e.scheduler:null;this._frameTask=Object(r.l)(i)?i.registerTask(l.b.SNAPPING):l.a}destroy(){this._abortController=Object(r.a)(this._abortController),this._frameTask=Object(r.s)(this._frameTask)}async snap(t,e,i){const{point:a,scenePoint:n}=t;return this.stagedPoint=e.update({point:a,scenePoint:n,context:i}),this._snapPoints=t,Object(r.k)(this._abortController)&&(this._abortController=new AbortController),this._snap(t,e,i,this._abortController.signal)}abort(){this._abortController=Object(r.a)(this._abortController)}};Object(a.a)([Object(s.b)({constructOnly:!0})],h.prototype,"view",void 0),Object(a.a)([Object(s.b)()],h.prototype,"stagedPoint",null),Object(a.a)([Object(s.b)()],h.prototype,"constrainResult",void 0),Object(a.a)([Object(s.b)()],h.prototype,"_stagedPoint",void 0),h=Object(a.a)([Object(c.a)("esri.views.interactive.snapping.SnappingOperation")],h)},1272:function(t,e,i){"use strict";i.d(e,"a",(function(){return O}));var a=i(0),n=(i(167),i(137)),r=i(228),o=i(27),s=i(2),c=i(1),l=(i(17),i(72)),h=i(10),p=i(12),d=i(1114),u=i(62);let b=class extends(Object(n.b)(o.a)){constructor(t){super(t),this.type="plane",this.position=null,this.heading=0,this.tilt=0,this.width=10,this.height=10}equals(t){return this.heading===t.heading&&this.tilt===t.tilt&&Object(s.g)(this.position,t.position)&&this.width===t.width&&this.height===t.height}};Object(a.a)([Object(c.b)({readOnly:!0,json:{read:!1,write:!0}})],b.prototype,"type",void 0),Object(a.a)([Object(c.b)({type:u.a}),Object(d.a)()],b.prototype,"position",void 0),Object(a.a)([Object(c.b)({type:Number,nonNullable:!0,range:{min:0,max:360}}),Object(d.a)(),Object(l.a)((t=>r.c.normalize(Object(p.i)(t),0,!0)))],b.prototype,"heading",void 0),Object(a.a)([Object(c.b)({type:Number,nonNullable:!0,range:{min:0,max:360}}),Object(d.a)(),Object(l.a)((t=>r.c.normalize(Object(p.i)(t),0,!0)))],b.prototype,"tilt",void 0),Object(a.a)([Object(c.b)({type:Number,nonNullable:!0}),Object(d.a)()],b.prototype,"width",void 0),Object(a.a)([Object(c.b)({type:Number,nonNullable:!0}),Object(d.a)()],b.prototype,"height",void 0),b=Object(a.a)([Object(h.a)("esri.analysis.SlicePlane")],b);const O=b},1273:function(t,e,i){"use strict";i.d(e,"a",(function(){return l})),i.d(e,"b",(function(){return M})),i.d(e,"c",(function(){return u})),i.d(e,"d",(function(){return U})),i.d(e,"e",(function(){return y})),i.d(e,"f",(function(){return N})),i.d(e,"g",(function(){return v})),i.d(e,"h",(function(){return f})),i.d(e,"i",(function(){return j})),i.d(e,"j",(function(){return d})),i.d(e,"k",(function(){return g})),i.d(e,"l",(function(){return _})),i.d(e,"m",(function(){return C})),i.d(e,"n",(function(){return L})),i.d(e,"o",(function(){return k})),i.d(e,"p",(function(){return H})),i.d(e,"q",(function(){return V})),i.d(e,"r",(function(){return z})),i.d(e,"s",(function(){return w})),i.d(e,"t",(function(){return G})),i.d(e,"u",(function(){return P})),i.d(e,"v",(function(){return x})),i.d(e,"w",(function(){return E})),i.d(e,"x",(function(){return I})),i.d(e,"y",(function(){return T})),i.d(e,"z",(function(){return p})),i.d(e,"A",(function(){return R})),i.d(e,"B",(function(){return D})),i.d(e,"C",(function(){return S})),i.d(e,"D",(function(){return h})),i.d(e,"E",(function(){return A})),i.d(e,"F",(function(){return O})),i.d(e,"G",(function(){return b})),i.d(e,"H",(function(){return s})),i.d(e,"I",(function(){return c}));var a=i(32),n=i(14),r=i(9),o=i(41);const s=Object(a.a)("mac")?"Meta":"Control",c="Shift",l=2,h=1.15,p=1.15,d=2500,u=.02,b=Math.cos(Object(n.h)(45)),O=Math.cos(Object(n.h)(5)),g=.95,_=.3,m=Object(r.h)(1,.5,0),j=2,f=1,v=Object(o.d)([...m,.7]),y=[0,0,0,.04],M=Object(o.d)([...m,.5]),x=Object(o.g)(1,1,1,1),w=Object(o.g)(1,.8,.6,1),S=Object(o.g)(1,.93,.86,1),E=Object(o.d)([...m,1]),T=Object(o.d)([...m,1]),A=3,D=11,R=22.5,I=40,G=48,P=2.25,C=Object(o.d)([...m,1]),k=4,z=1,V=.3,L=6,H=4,N=1600,U=.4},1274:function(t,e,i){"use strict";i.d(e,"a",(function(){return h})),i.d(e,"b",(function(){return l}));var a=i(135),n=i(90),r=i(49),o=i(8),s=i(74),c=i(11);function l(t){const e=new s.a;e.extensions.add("GL_OES_standard_derivatives");const{vertex:i,fragment:l,attributes:h,varyings:p}=e;return Object(a.b)(i,t),h.add(c.a.POSITION,"vec3"),h.add(c.a.UV0,"vec2"),p.add("vUV","vec2"),i.code.add(o.b`void main(void) {
vUV = uv0;
gl_Position = proj * view * vec4(position, 1.0);
}`),l.uniforms.add([new n.a("backgroundColor",(t=>t.backgroundColor)),new n.a("gridColor",(t=>t.gridColor)),new r.a("gridWidth",(t=>t.gridWidth))]),l.code.add(o.b`void main() {
const float LINE_WIDTH = 1.0;
vec2 uvScaled = vUV * gridWidth;
vec2 gridUV = (fract(uvScaled + 0.5) - 0.5) / (LINE_WIDTH * fwidth(uvScaled));
vec2 grid = (1.0 - step(0.5, gridUV)) * step(-0.5, gridUV);
grid.x *= step(0.5, uvScaled.x) * step(uvScaled.x, gridWidth - 0.5);
grid.y *= step(0.5, uvScaled.y) * step(uvScaled.y, gridWidth - 0.5);
float gridFade = max(grid.x, grid.y);
float gridAlpha = gridColor.a * gridFade;
gl_FragColor =
vec4(backgroundColor.rgb * backgroundColor.a, backgroundColor.a) * (1.0 - gridAlpha) +
vec4(gridColor.rgb, 1.0) * gridAlpha;
}`),e}const h=Object.freeze(Object.defineProperty({__proto__:null,build:l},Symbol.toStringTag,{value:"Module"}))},1276:function(t,e,i){"use strict";i.d(e,"a",(function(){return s})),i.d(e,"b",(function(){return c}));const a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAnFBMVEUAAAD/gAD/gAD/cAD/gAD/eAD/gAD/eQD/gAD/egD/gAD/ewD/gAD/fAD/gAD/fAD/gAD/fAD/fQD/fQD/fQD/fQD/fQD/fgD/jR7/mjn/mjf/p1H/plH/smf/sWb/vHr/u3n/xYz/xIv/zZz/zJv/zJr/1Kv/1Kr/06r/06n/27n/27f/4cX/4cT/59D/7dr/8uX/9u7/+/f////u2EN0AAAAM3RSTlMACBAQICAoKDAwODhAQEhIUFBYYGhweICIkJCXmJ+gp6ivsLe4uL+/wMDHx8/P19/n7/cWvjXwAAACeUlEQVR42tWX3XqiMBCGY2pbtbrUnzhhdak/lHWliJD7v7fdJ+KG5AMhh30P8zCTmS+TycDaeBoHi5Wgf4jVYvbKmRfPgSAHMX9mPRnM1tSIGHM/c2QddLp4c8wxCvYIvqROBPfbHlm/sRYC6smMNTKn3sxZAyvyYNW1v38MM/IkcPQnZHPMLtciz9P9hhqwzoLD+cnfpTIUaYinyZlBkE2YKZcMXCyN/YhsPkuFlMfWJLiwo89VMxfpJDForMCwuG+Zx7ttGO2S/w4LJ42ZURDty5M0a4dqsZAQAihQfXqWdlhnpcmdEPAI0tv2EbnsbsKmdgi6/1GN7T1XJLx5sF0P9SWABMC+co5JBE4Ge/1NTM3EGIJgjFONXCdAbeQYwhN7pRrRV20LJNIhWOczdu+xPFzIBiQ62iIsyIOTvlZUY+HXySLQaMUEeSC1CPYxENIlwk+q8e0clFAIfiKG+qpaIvod4wfU8sqvkDLda+xCCqgDaAk7uyeNqD+feFlfGCcg3Hzsk+xS7Nz1Aq4CcauhhMc0uxaqIgcFsF0J+1WQyoCN7Y9ezeCVH5LhSxmyRvsihKbK1m7LafpSpkpj6yJgtsiVBh6AX5UyCVmMbrNpcwj5/h6DPN79JjAiQAhXVeN6SZI0q5bQnn4wBiHEqpUybp1ZJzWxStVCHhKhAhVLp/Emh6trHpGLaB6yZHk7wu3Z+ChOxhwUNEmYYjpUvqJDksSHraQmJm2DdqQK6sGUObybYtpSN+8Phm3pN2xjDH33R6b0CKxAZNLvl8foD3BBnSw5e8RI+G2P8GD9wHw6YN3wkfA0R4Zz8CGCIfOCv8zM738walXuLw6nXBvPr8wvAAAAAElFTkSuQmCC",n="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAACtVBMVEUAAAD/AAD/gAD/VQD/gAD/gAD/bQD/gAD/cQD/gAD/dAD/gAD/gAD/eAD/gAD/eQD/gAD/egD/gAD/ewD/fAD/gAD/gAD/fAD/gAD/fQD/fQD/gAD/fQD/egD/fQD/gAD/egD/fQD/gAD/ewD/gAD/ewD/gAD/ewD/fQD/fQD/gAD/ewD/fQD/gAD/fAD/gAD/fAD/fgD/gAD/fAD/fgD/fAD/fgD/gAD/fAD/fgD/fAD/fgD/fQD/fQD/fgD/fgD/fQD/fgD/fQD/fgD/fQD/fgD/fQD/fgD/fQD/fgD/fQD/fgD/fQD/fgD/fQD/fQD/fgD/fQD/fgD/fQD/fgD/fQD/fgD/fQD/fgD/fQD/fQD/fgD/gAL/fgD/gAb/gAT/gwr/hAz/hxH/hQ//iBX/iBP/ixn/iRf/jBr/jR7/jyP/jyL/kif/kCX/kyr/lS7/lCz/ljH/li//mTX/nDr/mjn/nTz/oEL/okf/o0r/pU3/pU7/qFL/plH/qFX/q1j/q1r/rl7/sGL/rmH/s2v/tW//tW7/t3L/uHL/unb/unf/vHv/vX3/v4D/vX7/v4D/wYT/v4L/wYX/x4//x5H/yZX/y5n/zZv/y5n/zJv/zZ3/zp//0aL/z6H/1Kr/1av/06r/1q//17H/2bT/2LP/2rb/27n/3bz/3r7/37//4MH/38D/4ML/4sX/4sb/4sf/48n/5cv/48r/5cz/5s7/6dT/6tb/69j/69n/7Nn/7dv/7dz/7t7/7t3/7+H/7+D/7+H/8eL/8uX/8uX/8ub/8+j/8+f/9On/9er/9Or/9ez/9e3/9ez/9u7/9e3/9+//9+7/+PD/+PH/+fT/+fL/+vb/+vX/+vb/+/f/+vb//Pn/+/j//Pr//Pn//fv//Pr//fv//v3//fz//////v7//v3///8ZYzD6AAAA5nRSTlMAAQIDBAYHCAkKCwwQERITGBkaGyUmKCkqKy0uLzAxMjIzNDQ2Njg4OTs+Pj9AQEJCQ0RERUZHUlJTVFVWWFlfYGFiY2RlZmdoaWprbG1ucHFyc3R1dnd4eXp8f4CAgYGCg4SEhYWGhoeIiYmKiouMjI2Nj5CQkZOUlZaXmJiZmpudnp6io6OkpaanqKmqqqusrK2xs7W2t7e4ubq7u7/AwMLExcXGyMrLzM3NztDR0tPU1NXW29zd3t/g4eLi5OTl5ufo6erq6+zs7e7u7+/w8PHy9PT29vf4+Pn5+vr7+/z9/f7+/pNrFTEAAAO8SURBVHjaldf5W1RVGAfwl4kGxa2yIDPbF82EJhkVUEOiUiDMcJa482XCijStNLLVpoWCbLHFaZUoMSkq2wgtW8mobFcryiiWkffv6J557jh3zj33zvD56f3h3vM873nP+z7nkJ3cPE9JxdX+OgSWX15aMG0CjcnUoiuRSls2byplyH1eDZSqZrkz+d0ThC1/QQ45c521Eo58p5GTSZcirbIpZGtGEBkI5pNaVhEyo3mzSCF7ITJW7CKLYxbDTsPG5qe33QezxdkkySqGndYY615CilI5Cy9sRVjYgVRzKcXJGmzdwsKHkEwnkylB2AsNse5zSIITKWkJnPzCut8gW5IsxRlw9CnrRuohO5MM43xw9D4Lt0JWm2jOOXD2Ogv3w6LQaGA/nL3AwuOwCLpJmIU0nmDheVidQ0IV0niAhQ5YVcfnH2zcCMNtLLwHheOJaB5s7OxuQlx4hHV7oeAhokrYaOeBjkYIv7LuJyhUEU3QYONFZj4YrQfwGeuGQrDSxtM0KK2N7h5koa8V+ICFdVA4SX2Kbt5xmA2j7SHsZGETFOZQqarwhzjhUAuAl1nYDIUFdAVkoe0s/LiLmT9eD91TLDwHhXJaDtmbrPvyEWzg4dfCEB5kYTsUrqIgJK8w8/C2MHDDgWYgromFXVDwkQbDRsRFhpkHWyHcBMO1oyzSgcI1VGdEd8V6o6uA8D7m2BZIDrJuPxTqKGBEnczc33nHFmZ+A7IvWDegTmEF4lb1s3Dk+wH+oxGyj1hYC6saqkDcVk74u6cJsk4W7oXVZVSCuK84aXTP5pBcGeFRWM2nQmMPOw+zyQ9t62DyLAtRWM2mPBgao1+zyVD3wyEkPMTCq7DKo/Gmdo50DbDJd22JbbudhXdgoeUSVcNkTfRbNvnv3U0QGmKs2w2LpUR0MVI1d4+wSW/0egC/i7APFkXKobq+7Wc2+avrHvSK4B/1UKUaWNQ/1nOEk2Kf7GdhNSTLSDgfKhvaDrDsbkhmkuAOQKnhmb2cqkVuBDfFeWDnzo4/2WQrUl2QuB7XwtZ1T+7ho9qRYmUOGc6Gk8hb/xoLvI0Up1KCqxyOVkf3sdADs0soaVIQaUS6Bpm/gUlgMplMR1pron39SNLyKcVcpBduCQMJXpLMx5gsdJEkexHGYJGLLFzFyFhJNilkeTVkxkM28oPIQOAUsjW5DGmVTSQnM3xwVHt6FjnLudAPW4GLMnq7zqyEUvW5x1KGTvAulSqiVRYeR2OSmz+7uKLGpwX8K8oXFJw4zu67/wFaspwc84wT2QAAAABJRU5ErkJggg==";var r=i(355);const o={mipmap:!0,preMultiplyAlpha:!0,width:64,height:64};function s(t){return t.fromData(a,(()=>new r.a(a,o)))}function c(t){return t.fromData(n,(()=>new r.a(n,o)))}},1378:function(t,e,i){"use strict";i.d(e,"a",(function(){return c})),i.d(e,"b",(function(){return h})),i.d(e,"c",(function(){return l}));var a=i(2),n=i(31),r=i(305),o=i(559),s=i(127);class c{constructor(t,e,i,a=null){this._elevationInfo=t,this.defaultZ=e,this._view=i,this._excludeGraphics=a}screenToMap(t){if(Object(a.l)(this.defaultZ))return this._view.sceneIntersectionHelper.intersectElevationFromScreen(Object(n.g)(t.x,t.y),this._elevationInfo,this.defaultZ,this._excludeGraphics);const e=this._view.sceneIntersectionHelper.intersectElevationFromScreen(Object(n.g)(t.x,t.y),this._elevationInfo,0,this._excludeGraphics);return Object(a.l)(e)&&(e.z=void 0),e}mapToScreen(t){const e=Object(r.j)(t.x,t.y,Object(s.d)(this._view,t,this._elevationInfo),t.spatialReference);return this._view.toScreen(e)}constrainZ(t){const{defaultZ:e}=this;return Object(a.l)(e)&&t.z!==e&&((t=Object(o.a)(t)).z=e),t}}class l{constructor(t,e,i=[]){this.view=t,this.elevationInfo=e,this.exclude=i}screenToMap(t){const e=this.view.toMap(t,{exclude:this.exclude});return Object(a.l)(e)&&(e.z=Object(s.l)(e,this.view,this.elevationInfo)),e}mapToScreen(t){let e=t;return Object(a.l)(this.elevationInfo)&&(e=Object(r.j)(t.x,t.y,Object(s.d)(this.view,t,this.elevationInfo),t.spatialReference)),this.view.toScreen(e)}constrainZ(t){return t}}class h{constructor(t,e=!1,i=0){this.view=t,this.hasZ=e,this.defaultZ=i,this.mapToScreen=e=>t.toScreen(e),this.screenToMap=e?e=>{const a=t.toMap(e);return a.z=i,a}:e=>t.toMap(e)}constrainZ(t){const{defaultZ:e}=this;return this.hasZ&&t.z!==e&&((t=Object(o.a)(t)).z=e),t}}},1379:function(t,e,i){"use strict";i.d(e,"a",(function(){return j}));var a=i(0),n=i(28),r=i(108),o=i(2),s=i(13),c=i(31),l=i(1),h=(i(17),i(12),i(10)),p=i(26),d=i(5),u=i(9),b=i(40),O=i(127),g=i(923),_=i(727),m=i(1165);let j=class extends n.a{constructor(t){super(t),this.layer=null,this.interactive=!0,this.selectable=!1,this.grabbable=!0,this.dragging=!1,this.cursor=null,this.events=new r.a.EventEmitter,this._circleCollisionCache=null,this._graphicSymbolChangedHandle=null,this._originalSymbol=null}set graphic(t){this._circleCollisionCache=null,this._originalSymbol=t.symbol,this._set("graphic",t),this.attachSymbolChanged()}get elevationInfo(){const t="elevationInfo"in this.graphic.layer&&this.graphic.layer.elevationInfo,e=Object(O.k)(this.graphic),i=t?t.offset:0;return new _.a({mode:e,offset:i})}set focusedSymbol(t){t!==this._get("focusedSymbol")&&(this._set("focusedSymbol",t),this._updateGraphicSymbol(),this._circleCollisionCache=null)}grabbableForEvent(){return!0}set grabbing(t){t!==this._get("grabbing")&&(this._set("grabbing",t),this._updateGraphicSymbol())}set hovering(t){t!==this._get("hovering")&&(this._set("hovering",t),this._updateGraphicSymbol())}set selected(t){t!==this._get("selected")&&(this._set("selected",t),this._updateGraphicSymbol(),this.events.emit("select-changed",{action:t?"select":"deselect"}))}get _focused(){return this._get("hovering")||this._get("grabbing")}destroy(){this.detachSymbolChanged(),this._resetGraphicSymbol(),this._set("view",null)}intersectionDistance(t){const e=this.graphic;if(!1===e.visible)return null;const i=e.geometry;if(Object(o.k)(i))return null;const a=this._get("focusedSymbol"),n=Object(o.l)(a)?a:e.symbol;return"2d"===this.view.type?this._intersectDistance2D(this.view,t,i,n):this._intersectDistance3D(this.view,t,e)}attach(){this.attachSymbolChanged(),Object(o.l)(this.layer)&&this.layer.add(this.graphic)}detach(){this.detachSymbolChanged(),this._resetGraphicSymbol(),Object(o.l)(this.layer)&&this.layer.remove(this.graphic)}attachSymbolChanged(){this.detachSymbolChanged(),this._graphicSymbolChangedHandle=Object(s.f)((()=>{var t;return null==(t=this.graphic)?void 0:t.symbol}),(t=>{Object(o.l)(t)&&t!==this.focusedSymbol&&t!==this._originalSymbol&&(this._originalSymbol=t,this._focused&&Object(o.l)(this.focusedSymbol)&&(this.graphic.symbol=this.focusedSymbol))}),s.d)}detachSymbolChanged(){Object(o.l)(this._graphicSymbolChangedHandle)&&(this._graphicSymbolChangedHandle.remove(),this._graphicSymbolChangedHandle=null)}_updateGraphicSymbol(){this.graphic.symbol=this._focused&&Object(o.l)(this.focusedSymbol)?this.focusedSymbol:this._originalSymbol}_resetGraphicSymbol(){this.graphic.symbol=this._originalSymbol}_intersectDistance2D(t,e,i,a){if(a=a||Object(g.e)(i),Object(o.k)(a))return null;let n=this._circleCollisionCache;if("point"!==i.type||"simple-marker"!==a.type)return Object(m.b)(e,i,t)?1:null;if(Object(o.k)(n)||!n.originalPoint.equals(i)){const e=i,r=t.spatialReference;if(Object(b.b)(e.spatialReference,r)){const t=Object(b.m)(e,r);n={originalPoint:e.clone(),mapPoint:t,radiusPx:Object(c.h)(a.size)},this._circleCollisionCache=n}}if(Object(o.l)(n)){const i=Object(c.j)(e,v),r=t.toScreen(n.mapPoint),o=n.radiusPx,s=r.x+Object(c.h)(a.xoffset),l=r.y-Object(c.h)(a.yoffset);return Object(p.k)(i,[s,l])<o*o?1:null}return null}_intersectDistance3D(t,e,i){const a=t.toMap(e,{include:[i]});return a&&Object(b.v)(a,f,t.renderSpatialReference)?Object(d.r)(f,t.state.camera.eye):null}};Object(a.a)([Object(l.b)({constructOnly:!0,nonNullable:!0})],j.prototype,"graphic",null),Object(a.a)([Object(l.b)()],j.prototype,"elevationInfo",null),Object(a.a)([Object(l.b)({constructOnly:!0,nonNullable:!0})],j.prototype,"view",void 0),Object(a.a)([Object(l.b)({value:null})],j.prototype,"focusedSymbol",null),Object(a.a)([Object(l.b)({constructOnly:!0})],j.prototype,"layer",void 0),Object(a.a)([Object(l.b)()],j.prototype,"interactive",void 0),Object(a.a)([Object(l.b)()],j.prototype,"selectable",void 0),Object(a.a)([Object(l.b)()],j.prototype,"grabbable",void 0),Object(a.a)([Object(l.b)({value:!1})],j.prototype,"grabbing",null),Object(a.a)([Object(l.b)()],j.prototype,"dragging",void 0),Object(a.a)([Object(l.b)()],j.prototype,"hovering",null),Object(a.a)([Object(l.b)({value:!1})],j.prototype,"selected",null),Object(a.a)([Object(l.b)()],j.prototype,"cursor",void 0),j=Object(a.a)([Object(h.a)("esri.views.interactive.GraphicManipulator")],j);const f=Object(u.f)(),v=Object(c.g)()},1380:function(t,e,i){"use strict";i.d(e,"a",(function(){return c})),i.d(e,"b",(function(){return l}));var a=i(0),n=i(1102),r=i(1),o=i(10),s=i(1168);let c=class extends s.a{constructor(t){super(t),this.type="extent-rotate",this.angle=0}};Object(a.a)([Object(r.b)()],c.prototype,"type",void 0),Object(a.a)([Object(r.b)()],c.prototype,"angle",void 0),c=Object(a.a)([Object(o.a)("esri.views.interactive.tooltip.ExtentRotateTooltipInfo")],c);let l=class extends s.a{constructor(t){super(t),this.type="extent-scale",this.xScale=0,this.yScale=0,this.xSize=n.h,this.ySize=n.h}};Object(a.a)([Object(r.b)()],l.prototype,"type",void 0),Object(a.a)([Object(r.b)()],l.prototype,"xScale",void 0),Object(a.a)([Object(r.b)()],l.prototype,"yScale",void 0),Object(a.a)([Object(r.b)()],l.prototype,"xSize",void 0),Object(a.a)([Object(r.b)()],l.prototype,"ySize",void 0),l=Object(a.a)([Object(o.a)("esri.views.interactive.tooltip.ExtentScaleTooltipInfo")],l)},1410:function(t,e,i){"use strict";i.d(e,"a",(function(){return st})),i.d(e,"b",(function(){return ht}));var a=i(0),n=i(171),r=(i(32),i(108)),o=i(243),s=i(226),c=i(2),l=i(1102),h=i(13),p=i(68),d=i(1),u=i(17),b=(i(12),i(10)),O=i(681),g=i(127),_=(i(167),i(25)),m=i(5),j=i(9),f=i(971),v=i(907),y=i(296),M=i(47),x=i(209),w=i(495),S=i(201),E=i(264),T=i(327),A=i(62);function D(t,e,i=null){return Object(c.l)(i)?[t,e,i]:[t,e]}function R(t,e,i=null){return Object(c.l)(i)?{x:t,y:e,z:i}:{x:t,y:e}}class I{constructor(t){this.spatialReference=t}mapToLocalMultiple(t){return Object(c.h)(t.map((t=>this.mapToLocal(t))))}get doUnnormalization(){return!1}}class G extends I{constructor(t,e,i=null){super(e),this._defaultZ=i,this.transform=Object(w.b)(),this.transformInv=Object(w.b)(),this.transform=Object(w.a)(t),Object(x.c)(this.transformInv,this.transform)}makeMapPoint(t,e){return D(t,e,this._defaultZ)}mapToLocal(t){return R(this.transform[0]*t[0]+this.transform[2]*t[1]+this.transform[4],this.transform[1]*t[0]+this.transform[3]*t[1]+this.transform[5])}localToMap(t){return D(this.transformInv[0]*t.x+this.transformInv[2]*t.y+this.transformInv[4],this.transformInv[1]*t.x+this.transformInv[3]*t.y+this.transformInv[5],this._defaultZ)}}class P extends I{constructor(t,e){super(t.spatialReference),this.view=t,this.defaultZ=null,this.pWS=Object(j.f)(),this.tangentFrameUpWS=Object(j.f)(),this.tangentFrameRightWS=Object(j.f)(),this.tangentFrameForwardWS=Object(j.f)(),this.localFrameRightWS=Object(j.f)(),this.localFrameUpWS=Object(j.f)(),this.worldToLocalTransform=Object(E.b)(),this.localToWorldTransform=Object(E.b)(),this.scale=1,this.scale=t.resolution,this.referenceMapPoint=e,this.defaultZ=e.hasZ?e.z:null;const i=t.state.camera.viewRight;this.view.renderCoordsHelper.toRenderCoords(this.referenceMapPoint,this.pWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,T.a.X,this.tangentFrameRightWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,T.a.Y,this.tangentFrameUpWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,T.a.Z,this.tangentFrameForwardWS);const a=Object(j.f)();Object(m.p)(a,this.tangentFrameForwardWS,Object(m.n)(i,this.tangentFrameForwardWS)),Object(m.k)(this.localFrameRightWS,i,a),Object(m.w)(this.localFrameRightWS,this.localFrameRightWS),Object(m.o)(this.localFrameUpWS,this.tangentFrameForwardWS,this.localFrameRightWS),Object(S.h)(this.worldToLocalTransform,this.localFrameRightWS,this.tangentFrameRightWS),Object(S.d)(this.localToWorldTransform,this.worldToLocalTransform)}get doUnnormalization(){return"global"===this.view.viewingMode}makeMapPoint(t,e){return D(t,e,this.defaultZ)}mapToLocal(t){const e=Object(j.f)();this.view.renderCoordsHelper.toRenderCoords(new A.a({x:t[0],y:t[1],spatialReference:this.spatialReference}),e),Object(m.z)(e,e,this.worldToLocalTransform);const i=this.view.renderCoordsHelper.fromRenderCoords(e,this.view.spatialReference);return Object(c.l)(i)?R(i.x/this.scale,i.y/this.scale):null}localToMap(t){const e=Object(j.f)();this.view.renderCoordsHelper.toRenderCoords(new A.a({x:t.x*this.scale,y:t.y*this.scale,spatialReference:this.spatialReference}),e),Object(m.z)(e,e,this.localToWorldTransform);const i=this.view.renderCoordsHelper.fromRenderCoords(e,this.view.spatialReference);return Object(c.l)(i)?D(i.x,i.y,this.defaultZ):null}}function C(t,e){if("2d"===t.type)return new G(t.state.transform,t.spatialReference,e.length>2?e[2]:null);if("3d"===t.type){const i=e.length>2?new A.a({x:e[0],y:e[1],z:e[2],spatialReference:t.spatialReference}):new A.a({x:e[0],y:e[1],spatialReference:t.spatialReference});return new P(t,i)}return null}var k=i(354),z=i(250),V=i(180);function L(t,e){const i=new A.a({x:t[0],y:t[1],spatialReference:e});return t.length>2&&(i.z=t[2]),i}function H(t,e,i){const a=new z.a({paths:t,spatialReference:e});return i&&Object(y.l)(a),a}function N(t,e,i,a=!0){const n=Object(_.a)(t);n.forEach((t=>{const e=t[0],i=t[t.length-1];Object(u.e)(e,i)&&1!==t.length||t.push(t[0])}));let r=new V.a({rings:n,spatialReference:e});return r.rings.forEach((t=>{Object(y.j)(t,!1,!1)||t.reverse()})),i&&Object(y.l)(r),a&&r.isSelfIntersecting&&Object(M.l)(e)&&(r=Object(v.simplify)(r)),r}function U(t,e,i){const a=e.mapToLocalMultiple(t),n=[],r={x:a[0].x,y:a[0].y},o=a[1].x,s=a[1].y,l=Math.round(o-r.x),h=Math.round(s-r.y),p=Math.max(Math.abs(l),Math.abs(h));if(i){const t={x:r.x+p,y:r.y+p},e={x:r.x-p,y:r.y-p};n.push(R(t.x,e.y),R(e.x,e.y),R(e.x,t.y),R(t.x,t.y))}else{const t={x:l>0?r.x+p:r.x-p,y:h>0?r.y+p:r.y-p};n.push(R(r.x,r.y),R(t.x,r.y),R(t.x,t.y),R(r.x,t.y))}return F(N([Object(c.h)(n.map((t=>e.localToMap(t))))],e.spatialReference,e.doUnnormalization,!0),n,e)}function F(t,e,i){const a=Z(e[3],e[2],i),n=Z(e[1],e[2],i),r=Z(e[0],e[1],i),o=Z(e[0],e[3],i);return{geometry:t,midpoints:Object(c.l)(a)&&Object(c.l)(n)&&Object(c.l)(r)&&Object(c.l)(o)?{top:a,right:n,bottom:r,left:o}:null}}function Z(t,e,i){X[0]=t.x,X[1]=t.y,X[2]=0,Y[0]=e.x,Y[1]=e.y,Y[2]=0,Object(m.q)(X,X,Y,.5),B.x=X[0],B.y=Y[1],B.z=Y[2];const a=i.localToMap(B);return Object(c.l)(a)?L(a,i.spatialReference):null}const B=R(0,0,0),X=Object(j.f)(),Y=Object(j.f)();function W(t,e,i,a){const n=e.mapToLocalMultiple(t);let r=null,o=null;if(i)r=n[0],o=n[1];else{const t=n[0],e=n[1],i=Math.round(e.x-t.x),a=Math.round(e.y-t.y),s=Math.max(Math.abs(i),Math.abs(a));r=R(i>0?t.x+s/2:t.x-s/2,a>0?t.y+s/2:t.y-s/2),o=R(Math.abs(i)>Math.abs(a)?r.x-s/2:r.x,Math.abs(i)>Math.abs(a)?r.y:r.y-s/2)}const s=e.localToMap(r),l=e.localToMap(o);if(Object(c.k)(s)||Object(c.k)(l))return null;e.doUnnormalization&&Object(y.m)([[s,l]],e.spatialReference);const h=L(s,e.spatialReference),d=L(l,e.spatialReference),u=Object(p.f)(e.spatialReference);let b=0;if(Object(M.l)(e.spatialReference))b=u*Object(v.distance)(h,d,null);else{const t=r.x-o.x,e=r.y-o.y;b=u*Math.sqrt(t*t+e*e)*(a||1)}const O=new f.a({center:h,radius:b,radiusUnit:"meters",spatialReference:e.spatialReference});return{geometry:N(O.rings,O.spatialReference,!1),center:h,edge:d}}var q=i(1159),Q=i(875),J=i(870),K=i(1168);let $=class extends K.a{constructor(t){super(t),this.type="draw-point"}};Object(a.a)([Object(d.b)()],$.prototype,"type",void 0),Object(a.a)([Object(d.b)()],$.prototype,"elevation",void 0),$=Object(a.a)([Object(b.a)("esri.views.interactive.tooltip.DrawPointTooltipInfo")],$);let tt=class extends K.a{constructor(t){super(t),this.type="draw-polyline"}};Object(a.a)([Object(d.b)()],tt.prototype,"type",void 0),Object(a.a)([Object(d.b)()],tt.prototype,"elevation",void 0),Object(a.a)([Object(d.b)()],tt.prototype,"totalLength",void 0),Object(a.a)([Object(d.b)()],tt.prototype,"viewType",void 0),tt=Object(a.a)([Object(b.a)("esri.views.interactive.tooltip.DrawPolylineTooltipInfo")],tt);let et=class extends K.a{constructor(t){super(t),this.type="draw-polygon"}};Object(a.a)([Object(d.b)()],et.prototype,"type",void 0),Object(a.a)([Object(d.b)()],et.prototype,"elevation",void 0),Object(a.a)([Object(d.b)()],et.prototype,"area",void 0),Object(a.a)([Object(d.b)()],et.prototype,"viewType",void 0),et=Object(a.a)([Object(b.a)("esri.views.interactive.tooltip.DrawPolygonTooltipInfo")],et);let it=class extends K.a{constructor(t){super(t),this.type="draw-rectangle",this.xSize=l.h,this.ySize=l.h,this.area=l.i}};Object(a.a)([Object(d.b)()],it.prototype,"type",void 0),Object(a.a)([Object(d.b)()],it.prototype,"xSize",void 0),Object(a.a)([Object(d.b)()],it.prototype,"ySize",void 0),Object(a.a)([Object(d.b)()],it.prototype,"area",void 0),it=Object(a.a)([Object(b.a)("esri.views.interactive.tooltip.DrawRectangleTooltipInfo")],it);let at=class extends K.a{constructor(t){super(t),this.type="draw-circle",this.radius=null,this.xSize=null,this.ySize=null,this.area=l.i}};Object(a.a)([Object(d.b)()],at.prototype,"type",void 0),Object(a.a)([Object(d.b)()],at.prototype,"radius",void 0),Object(a.a)([Object(d.b)()],at.prototype,"xSize",void 0),Object(a.a)([Object(d.b)()],at.prototype,"ySize",void 0),Object(a.a)([Object(d.b)()],at.prototype,"area",void 0),at=Object(a.a)([Object(b.a)("esri.views.interactive.tooltip.DrawCircleTooltipInfo")],at);var nt=i(1169),rt=i(1238),ot=i(1158);let st=class extends(Object(o.b)(r.a.EventedMixin(q.a))){constructor(t){super(t),this._graphic=null,this._createOperationGeometry=null,this.defaultZ=0,this.geometryType=null,this.hasZ=!0,this.labelOptions=new Q.a,this.mode=null,this.snappingManager=null,this.snapToScene=!1,this.tooltip=null,this.tooltipOptions=new J.a}initialize(){this.internalGraphicsLayer=new O.a({listMode:"hide",internal:!0}),this.view.map.layers.add(this.internalGraphicsLayer),this.drawOperation=this.makeDrawOperation(),this.handles.add([this.drawOperation.on("vertex-add",(t=>this.onVertexAdd(t))),this.drawOperation.on("vertex-remove",(t=>this.onVertexRemove(t))),this.drawOperation.on("vertex-update",(t=>this.onVertexUpdate(t))),this.drawOperation.on("cursor-update",(t=>this.onCursorUpdate(t))),this.drawOperation.on("complete",(t=>this.onComplete(t))),Object(h.f)((()=>this.tooltipOptions.enabled),(t=>{this.tooltip=t?new nt.a({view:this.view,info:this._tooltipInfo}):Object(c.e)(this.tooltip)}),h.e),Object(h.f)((()=>this._tooltipInfo),(t=>{Object(c.l)(this.tooltip)&&(this.tooltip.info=t)}),h.e)]),this.finishToolCreation()}destroy(){this.drawOperation=Object(c.e)(this.drawOperation),this.tooltip=Object(c.e)(this.tooltip),this._destroyAllVisualisations(),this.view.map.remove(this.internalGraphicsLayer),this.internalGraphicsLayer=Object(c.e)(this.internalGraphicsLayer),this._set("view",null)}get _defaultElevation(){return Object(l.c)(this.defaultZ,"meters")}get canRedo(){return this.drawOperation.canRedo}get canUndo(){return this.drawOperation.canUndo}set centered(t){this._set("centered",t),this._updateGraphic()}set enabled(t){this.drawOperation.interactive=t,this._set("enabled",t)}set forceUniformSize(t){this._set("forceUniformSize",t),this._updateGraphic()}get graphic(){return this._graphic}set graphicSymbol(t){this._set("graphicSymbol",t),Object(c.l)(this._graphic)&&(this._graphic.symbol=t)}get updating(){var t,e;return null!=(t=null==(e=this.drawOperation)?void 0:e.updating)&&t}completeCreateOperation(){this.drawOperation.complete()}onInputEvent(t){this.drawOperation.onInputEvent(t)}redo(){this.drawOperation.redo()}reset(){}undo(){this.drawOperation.undo()}_createGraphic(t){this._graphic=new n.a({...this.graphicProperties,geometry:t,symbol:this.graphicSymbol}),this.internalGraphicsLayer.add(this._graphic),this.handles.add(this.initializeGraphic(this._graphic)),this.notifyChange("graphic"),this.handles.add(Object(s.c)((()=>{Object(c.l)(this._graphic)&&(this.internalGraphicsLayer.remove(this._graphic),this._graphic=Object(c.e)(this._graphic))})),ct)}_destroyAllVisualisations(){this.handles.remove(lt.outline),this.handles.remove(lt.regularVertices),this.handles.remove(lt.activeVertex),this.handles.remove(ct)}_getCreateOperationGeometry(t={operationComplete:!1}){if(null==this.drawOperation||0===this.drawOperation.numVertices)return null;const e=this.drawOperation.stagedVertex,i=this.drawOperation.committedVertices,a=i.slice();Object(c.l)(e)&&a.push(this.drawOperation.coordinateHelper.pointToArray(e));const n=Object(c.l)(e)?this.drawOperation.coordinateHelper.pointToArray(e):i.splice(-1)[0],r={regularVertices:null,activeVertex:null,full:null,outline:null,circle:null,rectangle:null},o=a.length,s=this.view.spatialReference,l="3d"===this.view.type&&"global"===this.view.viewingMode;switch(this.geometryType){case"point":r.regularVertices=i,r.activeVertex=n,r.full=this.drawOperation.coordinateHelper.arrayToPoint(a[0]);break;case"multipoint":r.regularVertices=i,r.activeVertex=n,o>0&&(r.full=function(t,e){return new k.a({points:t,spatialReference:e})}(a,s));break;case"polyline":r.regularVertices=i,r.activeVertex=n,o>0&&(r.full=H([a],s,l));break;case"polygon":r.regularVertices=i,r.activeVertex=n,o>0&&(r.full=N([a],s,l,!0));break;case"circle":if(o>0){const e=C(this.view,a[0]);if(1===o&&t.operationComplete){const t=a[0],i=e.makeMapPoint(t[0]+pt*this.view.resolution,t[1]);r.circle=W([t,i],e,!0),r.full=Object(c.l)(r.circle)?r.circle.geometry:null}else 2===o&&(this.forceUniformSize?(r.circle=W(a,e,this.centered),r.full=Object(c.l)(r.circle)?r.circle.geometry:null):(r.rectangle=function(t,e,i){const a=e.mapToLocalMultiple(t),n=a[0],r=a[1],o=Math.round(r.x-n.x),s=Math.round(r.y-n.y),l=R(i?n.x:n.x+o/2,i?n.y:n.y+s/2),h=i?o:o/2,p=i?s:s/2,d=[],u=2*Math.PI/60;function b(t){const e=Math.cos(t),i=Math.sin(t);return R(h*e+l.x,p*i+l.y)}for(let c=0;c<60;c++)d.push(b(c*u));d.push(d[0]);const{spatialReference:O,doUnnormalization:g}=e,_=N([Object(c.h)(d.map((t=>e.localToMap(t))))],O,g,!1),m=e.localToMap(b(Math.PI/2)),j=e.localToMap(b(0)),f=e.localToMap(b(-Math.PI/2)),v=e.localToMap(b(Math.PI));return{geometry:_,midpoints:Object(c.l)(m)&&Object(c.l)(j)&&Object(c.l)(f)&&Object(c.l)(v)?{top:L(m,O),right:L(j,O),bottom:L(f,O),left:L(v,O)}:null}}(a,e,this.centered),r.full=r.rectangle.geometry))}break;case"rectangle":if(o>0){const e=C(this.view,a[0]);if(1===o&&t.operationComplete){const t=a[0],i=e.makeMapPoint(t[0]+pt*this.view.resolution,t[1]);r.rectangle=U([t,i],e,!0),r.full=r.rectangle.geometry}else 2===o&&(r.rectangle=this.forceUniformSize?U(a,e,this.centered):function(t,e,i){let a=e.mapToLocalMultiple(t);if(1===a.length){const t=48,e=a[0];a=[R(e.x-t,e.y+t),R(e.x+t,e.y-t),R(e.x+t,e.y-t),R(e.x-t,e.y+t)]}const n=[],r={x:a[0].x,y:a[0].y},o={x:a[1].x,y:a[1].y};if(i){const t=Math.round(o.x-r.x),e=Math.round(o.y-r.y);n.push(R(r.x-t,r.y-e),R(o.x,r.y-e),R(o.x,o.y),R(r.x-t,o.y))}else n.push(R(r.x,r.y),R(o.x,r.y),R(o.x,o.y),R(r.x,o.y));return F(N([Object(c.h)(n.map((t=>e.localToMap(t))))],e.spatialReference,e.doUnnormalization,!0),n,e)}(a,e,this.centered),r.full=r.rectangle.geometry)}break;default:return null}switch(this.geometryType){case"point":case"multipoint":break;case"polyline":case"polygon":o>1&&(r.outline=H([a],s,l));break;case"circle":case"rectangle":Object(c.l)(r.full)&&"polygon"===r.full.type&&(r.outline=N(r.full.rings,s,l))}return r}initializeGraphic(t){return null}onComplete(t){this._updateGraphic();let e=null;if(this.drawOperation.isCompleted){const t=this._getCreateOperationGeometry({operationComplete:!0});Object(c.l)(t)&&(Object(c.k)(this._graphic)?this._createGraphic(t.full):this._graphic.geometry=t.full,e=Object(c.t)(this._graphic).clone())}this._createOperationGeometry=null,this.emit("complete",{graphic:e,...t})}onCursorUpdate(t){this._updateGraphic(),this.emit("cursor-update",t)}onDeactivate(){this.drawOperation.isCompleted||this.drawOperation.cancel()}onVertexAdd(t){this._updateGraphic(),this.emit("vertex-add",t)}onVertexRemove(t){this._updateGraphic(),this.emit("vertex-remove",t)}onVertexUpdate(t){this._updateGraphic(),this.emit("vertex-update",t)}_updateGraphic(){const t=this._getCreateOperationGeometry();this._createOperationGeometry=t,Object(c.k)(t)?this._destroyAllVisualisations():(Object(c.l)(t.outline)?this.handles.add(this.onOutlineChanged(t.outline),lt.outline):this.handles.remove(lt.outline),Object(c.l)(t.regularVertices)?this.handles.add(this.onRegularVerticesChanged(t.regularVertices),lt.regularVertices):this.handles.remove(lt.regularVertices),Object(c.l)(t.activeVertex)?this.handles.add(this.onActiveVertexChanged(t.activeVertex),lt.activeVertex):this.handles.remove(lt.activeVertex),Object(c.l)(t.full)?Object(c.k)(this._graphic)?this._createGraphic(t.full):this._graphic.geometry=t.full:this.handles.remove(ct))}get _tooltipInfo(){const{drawOperation:t}=this;if(!t)return null;switch(this.geometryType){case"point":return this._drawPointTooltipInfo;case"polyline":return this._drawPolylineTooltipInfo;case"polygon":return this._drawPolygonTooltipInfo;case"rectangle":return this._drawRectangleTooltipInfo;case"circle":return this._drawCircleTooltipInfo;default:return null}}get _drawPointTooltipInfo(){const t=Object(c.b)(this.graphic,(t=>t.geometry));return Object(c.k)(t)||"point"!==t.type||"2d"===this.view.type&&0===this.defaultZ?null:new $({tooltipOptions:this.tooltipOptions,elevation:this._elevationTooltipDetail})}get _drawPolylineTooltipInfo(){const t=this._createOperationGeometry,e=Object(c.l)(t)?t.full:null;if(Object(c.k)(e)||"polyline"!==e.type)return null;const i=Object(ot.f)(e,this._elevationMode);return new tt({tooltipOptions:this.tooltipOptions,elevation:this._elevationTooltipDetail,totalLength:Object(c.u)(i,l.h),viewType:this.view.type})}get _drawPolygonTooltipInfo(){const t=this._createOperationGeometry,e=Object(c.l)(t)?t.full:null;if(Object(c.k)(e)||"polygon"!==e.type)return null;const i=Object(rt.b)(e,this._elevationMode);return new et({tooltipOptions:this.tooltipOptions,elevation:this._elevationTooltipDetail,area:Object(c.u)(i,l.i),viewType:this.view.type})}get _drawRectangleTooltipInfo(){return Object(c.k)(this.drawOperation)?null:new it({tooltipOptions:this.tooltipOptions,xSize:Object(c.u)(this._xSize,l.h),ySize:Object(c.u)(this._ySize,l.h),area:Object(c.u)(this._fullGeometryArea,l.i)})}get _drawCircleTooltipInfo(){if(Object(c.k)(this.drawOperation))return null;const t=this.forceUniformSize;return new at({tooltipOptions:this.tooltipOptions,radius:t?Object(c.u)(this._circleRadius,l.h):null,xSize:t?null:Object(c.u)(this._xSize,l.h),ySize:t?null:Object(c.u)(this._ySize,l.h),area:Object(c.u)(this._fullGeometryArea,l.i)})}get _circleRadius(){const t=this._createOperationGeometry;return Object(c.l)(t)&&Object(c.l)(t.circle)&&Object(c.l)(t.circle.center)&&Object(c.l)(t.circle.edge)?Object(ot.d)(t.circle.center,t.circle.edge,this._elevationMode):null}get _xSize(){const t=this._createOperationGeometry;if(Object(c.k)(t)||Object(c.k)(t.rectangle))return null;const{midpoints:e}=t.rectangle;return Object(c.l)(e)?Object(ot.d)(e.left,e.right,this._elevationMode):null}get _ySize(){const t=this._createOperationGeometry;if(Object(c.k)(t)||Object(c.k)(t.rectangle))return null;const{midpoints:e}=t.rectangle;return Object(c.l)(e)?Object(ot.d)(e.top,e.bottom,this._elevationMode):null}get _fullGeometryArea(){const t=this._createOperationGeometry,e=Object(c.l)(t)?t.full:null;return Object(c.k)(e)||"polygon"!==e.type?null:Object(rt.b)(e,this._elevationMode)}get _elevationTooltipDetail(){return{mode:this.drawOperation.elevationInfo.mode,...this._vertexTooltipElevation}}get _vertexTooltipElevation(){var t;const{tooltipOptions:e,view:i,drawOperation:a}=this;if(Object(c.k)(a))return this._defaultElevation;const n=null!=(t=a.stagedVertex)?t:a.lastVertex;if(Object(c.k)(n)||"2d"===i.type)return this._defaultElevation;const r={mode:e.elevation.mode,offset:0},o=Object(g.d)(i,n,a.elevationInfo,r)*Object(p.g)(n.spatialReference);return Object(l.c)(o,"meters")}get _elevationMode(){return this.drawOperation.isDraped?"on-the-ground":"absolute-height"}};Object(a.a)([Object(d.b)()],st.prototype,"_createOperationGeometry",void 0),Object(a.a)([Object(d.b)()],st.prototype,"_defaultElevation",null),Object(a.a)([Object(d.b)({value:!0})],st.prototype,"centered",null),Object(a.a)([Object(d.b)({nonNullable:!0})],st.prototype,"defaultZ",void 0),Object(a.a)([Object(d.b)()],st.prototype,"drawOperation",void 0),Object(a.a)([Object(d.b)({value:!0})],st.prototype,"enabled",null),Object(a.a)([Object(d.b)({value:!0})],st.prototype,"forceUniformSize",null),Object(a.a)([Object(d.b)({constructOnly:!0})],st.prototype,"geometryType",void 0),Object(a.a)([Object(d.b)()],st.prototype,"graphic",null),Object(a.a)([Object(d.b)({constructOnly:!0})],st.prototype,"graphicProperties",void 0),Object(a.a)([Object(d.b)()],st.prototype,"graphicSymbol",null),Object(a.a)([Object(d.b)({constructOnly:!0})],st.prototype,"hasZ",void 0),Object(a.a)([Object(d.b)({constructOnly:!0,type:Q.a})],st.prototype,"labelOptions",void 0),Object(a.a)([Object(d.b)({constructOnly:!0})],st.prototype,"mode",void 0),Object(a.a)([Object(d.b)()],st.prototype,"snappingManager",void 0),Object(a.a)([Object(d.b)()],st.prototype,"snapToScene",void 0),Object(a.a)([Object(d.b)()],st.prototype,"tooltip",void 0),Object(a.a)([Object(d.b)({constructOnly:!0,type:J.a})],st.prototype,"tooltipOptions",void 0),Object(a.a)([Object(d.b)({readOnly:!0})],st.prototype,"type",void 0),Object(a.a)([Object(d.b)({readOnly:!0})],st.prototype,"updating",null),Object(a.a)([Object(d.b)({constructOnly:!0,nonNullable:!0})],st.prototype,"view",void 0),Object(a.a)([Object(d.b)()],st.prototype,"_tooltipInfo",null),Object(a.a)([Object(d.b)()],st.prototype,"_drawPointTooltipInfo",null),Object(a.a)([Object(d.b)()],st.prototype,"_drawPolylineTooltipInfo",null),Object(a.a)([Object(d.b)()],st.prototype,"_drawPolygonTooltipInfo",null),Object(a.a)([Object(d.b)()],st.prototype,"_drawRectangleTooltipInfo",null),Object(a.a)([Object(d.b)()],st.prototype,"_drawCircleTooltipInfo",null),Object(a.a)([Object(d.b)()],st.prototype,"_circleRadius",null),Object(a.a)([Object(d.b)()],st.prototype,"_xSize",null),Object(a.a)([Object(d.b)()],st.prototype,"_ySize",null),Object(a.a)([Object(d.b)()],st.prototype,"_fullGeometryArea",null),Object(a.a)([Object(d.b)()],st.prototype,"_elevationTooltipDetail",null),Object(a.a)([Object(d.b)()],st.prototype,"_vertexTooltipElevation",null),Object(a.a)([Object(d.b)()],st.prototype,"_elevationMode",null),st=Object(a.a)([Object(b.a)("esri.views.draw.DrawGraphicTool")],st);const ct="create-operation-graphic",lt={outline:"outline-visual",regularVertices:"regular-vertices-visual",activeVertex:"active-vertex-visual"};function ht(t){switch(t){case"point":case"polyline":case"polygon":case"multipoint":return t;case"circle":case"rectangle":return"segment";default:return null}}const pt=48},1412:function(t,e,i){"use strict";i.d(e,"a",(function(){return E}));var a=i(0),n=i(108),r=i(243),o=i(25),s=i(2),c=i(23),l=i(13),h=i(31),p=i(1),d=(i(12),i(10)),u=i(915),b=i(127),O=i(53);const g="click";class _{constructor({grabbableForEvent:t}){this.events=new n.a,this.interactive=!0,this.selectable=!1,this.cursor=null,this.grabbable=!0,this.grabbableForEvent=t}intersectionDistance(t,e){return 0}attach(){}detach(){}}var m=i(1264),j=i(1110),f=i(1172),v=i(1170),y=i(875),M=i(870),x=i(1135),w=i(1184),S=i(1269);let E=class extends(n.a.EventedMixin(r.a)){constructor(t){super(t),this._createOperationCompleted=!1,this._pointerDownStates=new Set,this._snappingPipeline=new w.a,this.isDraped=!0,this.labelOptions=new y.a,this.tooltipOptions=new M.a,this.snapToSceneEnabled=null,this.lastVertex=null,Object(s.k)(t.elevationInfo)&&(this.elevationInfo=Object(b.f)(t.hasZ))}initialize(){const{geometryType:t,view:e}=this,{spatialReference:i}=e,a="viewingMode"in e.state?e.state.viewingMode:O.a.Local,n="segment"===t||"multipoint"===t?"polyline":t;this.coordinateHelper=Object(m.a)(this.hasZ,this.hasM,i),this._editGeometryOperations=new v.a(new f.c(n,this.coordinateHelper)),this._snappingOperation=new S.a({view:e,constrainResult:t=>Object(s.k)(t)?t:this._getEffectiveDrawSurface().constrainZ(t)}),this.handles.add(Object(l.f)((()=>this.stagedVertex),(t=>{Object(s.k)(t)||this.emit("cursor-update",{updated:null,vertices:[{componentIndex:0,vertexIndex:this._activeComponent.vertices.length,coordinates:this.coordinateHelper.pointToArray(t)}],operation:"apply",type:"vertex-update"})}),{sync:!0,equals:(t,e)=>Object(s.g)(t,e,u.b)})),this._activeComponent=new f.a(i,a),this._editGeometryOperations.data.components.push(this._activeComponent);const r=this.segmentLabels;Object(s.l)(r)&&(r.context={view:e,editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,labelOptions:this.labelOptions},this.handles.add([Object(l.f)((()=>this.labelOptions.enabled),(t=>{r.visible=t}),l.e),this.on("cursor-update",(()=>{const t=this.stagedVertex;r.stagedVertex=Object(s.l)(t)?this.coordinateHelper.pointToVector(t):null}))])),this.handles.add(this._editGeometryOperations.on(["vertex-add","vertex-update","vertex-remove"],(t=>{const e=t.vertices.map((t=>({componentIndex:0,vertexIndex:t.index,coordinates:this.coordinateHelper.vectorToArray(t.pos)}))),i=e.map((t=>t.coordinates));switch(t.type){case"vertex-add":this.emit(t.type,{...t,added:i,vertices:e});break;case"vertex-update":this.emit(t.type,{...t,updated:i,vertices:e});break;case"vertex-remove":this.emit(t.type,{...t,removed:i,vertices:e})}const a=this._activeComponent.getLastVertex(),n=Object(s.l)(a)?this.coordinateHelper.vectorToDehydratedPoint(a.pos):null;(Object(s.k)(n)||Object(s.k)(this.lastVertex)||!Object(u.b)(this.lastVertex,n))&&(this.lastVertex=n)}))),this._manipulator=new _({grabbableForEvent:t=>"click"!==this.drawingMode||"touch"===t.pointerType&&this._snappingEnabled&&1===this._pointerDownStates.size}),this.manipulators.add(this._manipulator),this._manipulator.grabbable="point"!==t,this.handles.add([this._createManipulatorDragPipeline(this._manipulator),this._manipulator.events.on("immediate-click",(t=>this._onImmediateClick(t))),this._manipulator.events.on("immediate-double-click",(t=>this._onImmediateDoubleClick(t)))])}destroy(){Object(s.e)(this.segmentLabels),Object(s.e)(this._snappingOperation),this._editGeometryOperations=Object(s.e)(this._editGeometryOperations)}get _snappingEnabled(){return Object(s.l)(this.snappingManager)&&this.snappingManager.options.effectiveEnabled}get _requiresScenePoint(){const t=this._getEffectiveDrawSurface();return"3d"===this.view.type&&this.drawSurface!==t}get canRedo(){return this._editGeometryOperations.canRedo}get canUndo(){return this._editGeometryOperations.canUndo}get committedVertices(){return this._activeComponent.vertices.map((t=>this.coordinateHelper.vectorToArray(t.pos)))}set drawingMode(t){this._set("drawingMode",null!=t?t:g)}get interactive(){return this._manipulator.interactive}set interactive(t){this._manipulator.interactive=t}get isCompleted(){return this._createOperationCompleted}get numCommittedVertices(){return this._activeComponent.vertices.length}get numVertices(){return Object(s.l)(this.stagedVertex)?this._activeComponent.vertices.length+1:this._activeComponent.vertices.length}get stagedVertex(){return this._snappingOperation.stagedPoint}set stagedVertex(t){this._snappingOperation.stagedPoint=Object(o.a)(t)}get updating(){return this.updatingHandles.updating}get vertices(){const t=this.committedVertices;return Object(s.l)(this.stagedVertex)&&t.push(this.coordinateHelper.pointToArray(this.stagedVertex)),t}cancel(){this.complete({aborted:!0})}commitStagedVertex(){if(this._snappingOperation.abort(),Object(s.l)(this.stagedVertex)){const{stagedVertex:t}=this;this.stagedVertex=null,this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(t))}}complete(t){const e=t&&t.aborted||!1;this._snappingOperation.abort(),Object(s.l)(this.snappingManager)&&this.snappingManager.doneSnapping(),"segment"===this.geometryType||"point"===this.geometryType?this.commitStagedVertex():this.stagedVertex=null;const i="multipoint"===this.geometryType&&0===this.numVertices||"polyline"===this.geometryType&&this.numVertices<2||"polygon"===this.geometryType&&this.numVertices<3;this._createOperationCompleted=!i,(this.isCompleted||e)&&this.emit("complete",{vertices:this.vertices.map(((t,e)=>({componentIndex:0,vertexIndex:e,coordinates:t}))),aborted:e,type:"complete"})}onInputEvent(t){switch(t.type){case"pointer-down":this._pointerDownStates.add(t.pointerId);break;case"pointer-up":this._pointerDownStates.delete(t.pointerId)}switch(t.type){case"pointer-move":return this._onPointerMove(t);case"hold":return this._onHold(t)}}redo(){this._editGeometryOperations.redo()}undo(){Object(s.l)(this.snappingManager)&&this.snappingManager.doneSnapping(),this._editGeometryOperations.undo()}_closeOnClickVertexIndex(t){const e=this._activeComponent;if("polygon"===this.geometryType&&e.vertices.length>2){if(this._vertexWithinPointerDistance(e.vertices[0].pos,t))return 0;if(this._vertexWithinPointerDistance(e.vertices[e.vertices.length-1].pos,t))return e.vertices.length-1}return null}_createManipulatorDragPipeline(t){switch(Object(s.t)(this.drawingMode)){case"click":return this._createManipulatorDragPipelineClick(t);case"freehand":return this._createManipulatorDragPipelineFreehand(t);case"hybrid":return this._createManipulatorDragPipelineHybrid(t)}}_createManipulatorDragPipelineClick(t){return Object(j.e)(t,((t,e,i,a)=>{const n="touch"===a&&this._snappingEnabled;!this.isCompleted&&n&&(i=i.next((t=>(n&&Object(s.l)(this.snappingManager)&&this.snappingManager.doneSnapping(),t))),e.next(this._screenToMapDragEventStep()).next((t=>("start"===t.action&&(this.stagedVertex=t.mapStart,("segment"===this.geometryType||n&&0===this.numVertices)&&this.commitStagedVertex()),t))).next(Object(j.l)(this.view,this.elevationInfo)).next(this._snappingPipeline.createSnapDragEventPipelineStep({predicate:()=>n,cancel:i,snappingManager:this.snappingManager,snappingContext:new x.a({editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,pointer:a,visualizer:this.snappingVisualizer}),updatingHandles:this.updatingHandles,useZ:!this._requiresScenePoint}),this._snappingPipeline.next).next((t=>(n&&(this.stagedVertex=t.mapEnd,"end"===t.action&&this.commitStagedVertex()),t))).next((t=>("end"===t.action&&("segment"!==this.geometryType&&"point"!==this.geometryType||this.complete()),t))))}))}_createManipulatorDragPipelineFreehand(t){return Object(j.e)(t,((t,e)=>{this.isCompleted||e.next(this._screenToMapDragEventStep()).next((t=>("start"===t.action&&(Object(s.k)(this.stagedVertex)&&(this.stagedVertex=t.mapStart),"segment"===this.geometryType&&this.commitStagedVertex()),t))).next((t=>{switch(t.action){case"start":case"update":this.stagedVertex=t.mapEnd,"polygon"!==this.geometryType&&"polyline"!==this.geometryType||this.commitStagedVertex();break;case"end":this.complete()}return t}))}))}_createManipulatorDragPipelineHybrid(t){return Object(j.e)(t,((t,e)=>{this.isCompleted||e.next(this._screenToMapDragEventStep()).next((t=>("start"===t.action&&(Object(s.k)(this.stagedVertex)&&(this.stagedVertex=t.mapStart),this.commitStagedVertex()),t))).next((t=>{switch(t.action){case"start":case"update":this.stagedVertex=t.mapEnd,"polygon"!==this.geometryType&&"polyline"!==this.geometryType||this.commitStagedVertex();break;case"end":"segment"!==this.geometryType&&"point"!==this.geometryType||this.complete()}return t}))}))}get _drawAtFixedElevation(){return("segment"===this.geometryType||"polygon"===this.geometryType)&&this.numCommittedVertices>0}_getEffectiveDrawSurface(){if(Object(s.k)(this.elevationDrawSurface))return this.drawSurface;if(!this.coordinateHelper.hasZ())return this.elevationDrawSurface.defaultZ=null,this.elevationDrawSurface;let t=this.defaultZ,e=!1;return Object(s.l)(this.elevationInfo)&&"absolute-height"===this.elevationInfo.mode&&(e=!0),Object(s.l)(this.snapToSceneEnabled)&&(e=this.snapToSceneEnabled),Object(s.l)(this.elevationInfo)&&"on-the-ground"===this.elevationInfo.mode&&(e=!1),this._drawAtFixedElevation&&(t=this.coordinateHelper.getZ(this._activeComponent.vertices[0].pos),e=!1),e?this.drawSurface:(this.elevationDrawSurface.defaultZ=t,this.elevationDrawSurface)}_mapToScreen(t){return this._getEffectiveDrawSurface().mapToScreen(t)}_onHold(t){this._snappingOperation.abort(),"click"===this.drawingMode&&"touch"===t.pointerType&&this._snappingEnabled&&(this.stagedVertex=t.mapPoint),t.stopPropagation()}_onImmediateClick(t){if("mouse"===t.pointerType&&2===t.button||this._manipulator.dragging)return;const e=this._activeComponent,i=this._closeOnClickVertexIndex(t.screenPoint);if(Object(s.l)(i))return t.stopPropagation(),void this.complete();const a=this._screenToMap(t.screenPoint);if(Object(s.l)(a))switch(this.drawingMode){case"freehand":"point"===this.geometryType&&(Object(s.l)(this.stagedVertex)?this.commitStagedVertex():this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(a)),this.complete());break;case"click":case"hybrid":this._snappingOperation.abort(),Object(s.l)(this.stagedVertex)?this.commitStagedVertex():this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(a)),("point"===this.geometryType||"segment"===this.geometryType&&2===e.vertices.length||"segment"===this.geometryType&&"hybrid"===this.drawingMode&&1===e.vertices.length)&&this.complete()}t.stopPropagation()}_onImmediateDoubleClick(t){this._manipulator.dragging||"point"===this.geometryType||(this.complete(),t.stopPropagation())}_onPointerMove(t){const e=Object(h.f)(t.x,t.y),i=this._snappingOperation;if(this._manipulator.dragging||this._pointerDownStates.has(t.pointerId)||this._manipulator.grabbing||!this._manipulator.interactive)return void i.abort();t.stopPropagation();const a=this._closeOnClickVertexIndex(e);if(Object(s.l)(a))return this._closeOnVertex(a),void i.abort();const n=this._screenToMap(e),r=this._requiresScenePoint?this.drawSurface.screenToMap(e):null;if(this._manipulator.cursor=Object(s.l)(n)?"crosshair":null,Object(s.k)(n))return void i.abort();const o=this.snappingManager;if(Object(s.k)(o))return this.stagedVertex=n,void i.abort();const l=this._drawAtFixedElevation?Object(s.b)(this.elevationDrawSurface,(({defaultZ:t})=>t)):null,p=new x.a({editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,pointer:t.pointerType,visualizer:this.snappingVisualizer,selfSnappingZ:Object(s.l)(l)?{value:l,elevationInfo:this.elevationInfo}:null});this.updatingHandles.addPromise(Object(c.i)(i.snap({point:n,scenePoint:r},o,p)))}_closeOnVertex(t){this.stagedVertex=null;const e={componentIndex:0,vertexIndex:t,coordinates:this.coordinateHelper.vectorToArray(this._activeComponent.vertices[t].pos)};this.emit("cursor-update",{updated:null,vertices:[e],operation:"apply",type:"vertex-update"})}_screenToMap(t){return this._getEffectiveDrawSurface().screenToMap(t)}_screenToMapDragEventStep(){let t=null;return e=>{if("start"===e.action&&(t=this._screenToMap(e.screenStart)),Object(s.k)(t))return null;const i=this._screenToMap(e.screenEnd);return Object(s.l)(i)?{...e,mapStart:t,mapEnd:i}:null}}_vertexWithinPointerDistance(t,e){const i=this._mapToScreen(this.coordinateHelper.vectorToDehydratedPoint(t));return!!Object(s.l)(i)&&function(t,e,i){const a=t.x-e.x,n=t.y-e.y;return a*a+n*n<=i}(i,e,25)}};Object(a.a)([Object(p.b)()],E.prototype,"_snappingEnabled",null),Object(a.a)([Object(p.b)()],E.prototype,"defaultZ",void 0),Object(a.a)([Object(p.b)()],E.prototype,"isDraped",void 0),Object(a.a)([Object(p.b)({value:g})],E.prototype,"drawingMode",null),Object(a.a)([Object(p.b)({constructOnly:!0})],E.prototype,"elevationDrawSurface",void 0),Object(a.a)([Object(p.b)({constructOnly:!0})],E.prototype,"elevationInfo",void 0),Object(a.a)([Object(p.b)({constructOnly:!0,type:y.a})],E.prototype,"labelOptions",void 0),Object(a.a)([Object(p.b)({constructOnly:!0,type:M.a})],E.prototype,"tooltipOptions",void 0),Object(a.a)([Object(p.b)({constructOnly:!0})],E.prototype,"geometryType",void 0),Object(a.a)([Object(p.b)({constructOnly:!0})],E.prototype,"hasM",void 0),Object(a.a)([Object(p.b)({constructOnly:!0})],E.prototype,"hasZ",void 0),Object(a.a)([Object(p.b)({constructOnly:!0})],E.prototype,"manipulators",void 0),Object(a.a)([Object(p.b)({constructOnly:!0})],E.prototype,"drawSurface",void 0),Object(a.a)([Object(p.b)({constructOnly:!0})],E.prototype,"segmentLabels",void 0),Object(a.a)([Object(p.b)({constructOnly:!0})],E.prototype,"snappingManager",void 0),Object(a.a)([Object(p.b)({constructOnly:!0})],E.prototype,"snappingVisualizer",void 0),Object(a.a)([Object(p.b)()],E.prototype,"snapToSceneEnabled",void 0),Object(a.a)([Object(p.b)()],E.prototype,"_snappingOperation",void 0),Object(a.a)([Object(p.b)()],E.prototype,"stagedVertex",null),Object(a.a)([Object(p.b)()],E.prototype,"lastVertex",void 0),Object(a.a)([Object(p.b)()],E.prototype,"updating",null),Object(a.a)([Object(p.b)({constructOnly:!0})],E.prototype,"view",void 0),E=Object(a.a)([Object(d.a)("esri.views.draw.DrawOperation")],E)},1419:function(t,e,i){"use strict";i.d(e,"a",(function(){return O}));var a=i(2),n=i(5),r=i(9),o=i(60),s=i(1157),c=i(1117),l=i(255),h=i(82);var p=i(34),d=i(285),u=i(102),b=i(1420);class O extends c.a{constructor(t){super(t),this.view=null,this._renderOccluded=u.c.OccludeAndTransparent,this._vertices=null,this._spatialReference=null,this._color=s.b.colorToVec4(s.b.reshapeManipulators.vertex.color),this._size=s.b.reshapeManipulators.vertex.size,this._outlineColor=s.b.colorToVec4(s.b.reshapeManipulators.vertex.outlineColor),this._outlineSize=s.b.reshapeManipulators.vertex.outlineSize,this._elevationInfo=null,this.applyProps(t)}get renderOccluded(){return this._renderOccluded}set renderOccluded(t){t!==this._renderOccluded&&(this._renderOccluded=t,this._updateMaterial(),this._updateOutlineMaterial())}get vertices(){return this._vertices}set vertices(t){this._vertices=t,this.recreateGeometry()}get spatialReference(){return this._spatialReference}set spatialReference(t){this._spatialReference=t,this.recreateGeometry()}get color(){return this._color}set color(t){Object(o.g)(t,this._color)||(Object(o.c)(this._color,t),this._updateMaterial())}get size(){return this._size}set size(t){t!==this._size&&(this._size=t,this._updateMaterial())}get outlineColor(){return this._outlineColor}set outlineColor(t){Object(o.g)(t,this._outlineColor)||(Object(o.c)(this._outlineColor,t),this._updateOutlineMaterial())}get outlineSize(){return this._outlineSize}set outlineSize(t){t!==this._outlineSize&&(this._outlineSize=t,this._updateOutlineMaterial())}get elevationInfo(){return this._elevationInfo}set elevationInfo(t){this._elevationInfo=t,this.recreateGeometry()}get _vertexMaterialParameters(){return{color:this._color,transparent:this._color[3]<1,screenSizeScale:this.size,renderOccluded:this._renderOccluded}}get _vertexOutlineMaterialParameters(){return{color:this._outlineColor,transparent:this._outlineColor[3]<1,screenSizeScale:this.size+2*this.outlineSize,renderOccluded:this._renderOccluded}}_updateMaterial(){this.attached&&this._vertexMaterial.setParameters(this._vertexMaterialParameters)}_updateOutlineMaterial(){this.attached&&this._vertexOutlineMaterial.setParameters(this._vertexOutlineMaterialParameters)}_createRenderGeometries(){const t=this.vertices;if(Object(a.k)(t)||0===t.length)return[];const e=function(t,e,i,a,n){const r=new Float64Array(3*t.length),o=new Float64Array(r.length);t.forEach(((t,e)=>{r[3*e+0]=t[0],r[3*e+1]=t[1],r[3*e+2]=t.length>2?t[2]:0}));const s=Object(h.d)(r,e,0,o,0,r,0,r.length/3,i,a,n),c=null!=s;return{numVertices:t.length,position:r,mapPosition:o,projectionSuccess:c,sampledElevation:s}}(t,this.spatialReference,this.view.elevationProvider,this.view.renderCoordsHelper,l.a.fromElevationInfo(this.elevationInfo)),i=[],r=e.numVertices,o=e.position;for(let a=0;a<r;++a){const t=Object(n.B)(g,o[3*a+0],o[3*a+1],o[3*a+2]),e=_(.5,t),r=_(.5,t);i.push({vertexGeometry:e,vertexOutlineGeometry:r})}return i}createGeometries(t){const e=this._createRenderGeometries();for(const{vertexGeometry:i,vertexOutlineGeometry:a}of e)t.addGeometry(i,this._vertexMaterial),t.addGeometry(a,this._vertexOutlineMaterial)}createExternalResources(){this._vertexMaterial=new b.a({...this._vertexMaterialParameters,writeDepth:!0,cullFace:p.b.Back,screenSizeEnabled:!0}),this._vertexOutlineMaterial=new b.a({...this._vertexOutlineMaterialParameters,transparent:!0,writeDepth:!0,cullFace:p.b.Front,screenSizeEnabled:!0,shadingEnabled:!1})}destroyExternalResources(){this._vertexMaterial=null,this._vertexOutlineMaterial=null}forEachExternalMaterial(t){t(this._vertexMaterial),t(this._vertexOutlineMaterial)}}const g=Object(r.f)();function _(t,e){return Object(d.k)(t,16,16,{offset:e})}},1635:function(t,e,i){"use strict";i.r(e),i.d(e,"DrawGraphicTool3D",(function(){return _t})),i.d(e,"GraphicMoveTool",(function(){return Ce})),i.d(e,"GraphicReshapeTool",(function(){return si})),i.d(e,"GraphicTransformTool",(function(){return Ii})),i.d(e,"ExtentTransformTool",(function(){return Yi}));var a=i(0),n=i(226),r=i(2),o=i(13),s=i(1),c=i(17),l=(i(12),i(10)),h=i(5),p=i(9),d=i(127),u=i(727),b=i(31),O=(i(22),i(16),i(32)),g=i(28),_=i(157),m=i(23),j=i(1167),f=i(68),v=i(26),y=i(33),M=i(296),x=i(404),w=i(1266),S=i(1158);const E={default:15,far:25};let T=class extends g.a{constructor(t){super(t),this.context=null,this.stagedVertex=null,this.visible=!0,this.edgeDistance="default",this._messagesUnits=null,this._labelInfos=[],this._nextLabelIndex=0}initialize(){const t=Object(_.b)((async t=>{const e=await Object(x.a)("esri/core/t9n/Units");Object(m.q)(t),this._messagesUnits=e})),e=()=>Object(r.b)(this.context,(t=>t.editGeometryOperations));this.addHandles([Object(o.f)((()=>[Object(r.l)(this.context)&&this.getCameraOrExtent(this.context),this.visible,this._edgeDistancePixels,this.stagedVertex,this._messagesUnits]),(()=>this._update())),...["vertex-add","vertex-update","vertex-remove"].map((t=>Object(o.b)(e,t,(()=>this._update())))),Object(n.c)((()=>t.abort()))])}destroy(){for(this._nextLabelIndex=0;this._labelInfos.length;)this._destroyLabel(this._labelInfos.pop())}get updating(){return Object(r.k)(this._messagesUnits)}get test(){return{labelContents:this._labelInfos.slice(0,this._nextLabelIndex).map((t=>t.label.text))}}get _edgeDistancePixels(){return E[this.edgeDistance]}_update(){this._nextLabelIndex=0;const t=this.context;if(Object(r.k)(t))return void this._destroyUnusedLabels();const{components:e,geometry:i,coordinateHelper:a}=t.editGeometryOperations.data;if(!i)return void this._destroyUnusedLabels();const n=e.length;for(let o=0;o<n;++o){const s=[];if(e[o].iterateVertices((t=>{s.push(a.toXYZ(t.pos))})),0===o&&Object(r.l)(this.stagedVertex)&&s.push(a.toXYZ(this.stagedVertex)),s.length<2)continue;const c=s[0],l=s[s.length-1];"polygon"===i.type&&s.length>2&&!Object(h.f)(c,l)&&s.push(c);const p=1===n&&!Object(M.j)(s,!1,!1);let d=R,u=I;this.toScreenPointArray(t,c,d);for(let e=1;e<s.length;++e){const i=s[e-1],a=s[e];this.toScreenPointArray(t,a,u),this._addLabel(t,i,d,a,u,p),[d,u]=[u,d]}}this._destroyUnusedLabels()}_addLabel(t,e,i,a,n,o){const{label:s}=this._getOrCreateLabel(t);if(!this.visible||Object(v.k)(i,n)<3025)return void(s.visible=!1);const c=Object(r.l)(t.graphicState)?t.graphicState.isDraped?"on-the-ground":"absolute-height":Object(d.i)(t.editGeometryOperations.data.geometry,t.elevationInfo),{spatialReference:l}=t.editGeometryOperations.data,h=Object(S.a)(e,a,l,c),p=this._messagesUnits,u=Object(f.e)(t.view);s.text=Object(r.l)(p)&&Object(r.l)(h)?Object(j.f)(p,h,u):"",s.visible=!0;const b=n[0]-i[0],O=n[1]-i[1];o?Object(v.s)(A,-O,b):Object(v.s)(A,O,-b),Object(v.f)(A,A),Object(v.b)(A,A,this._edgeDistancePixels),Object(v.l)(D,i,n,.5),Object(v.j)(D,D,A),s.position=[D[0],D[1]],Math.abs(A[0])>Math.abs(A[1])?s.anchor=A[0]>0?"left":"right":s.anchor=-A[1]<0?"top":"bottom"}_getOrCreateLabel(t){if(this._labelInfos.length>this._nextLabelIndex)return this._labelInfos[this._nextLabelIndex++];const e=new w.a({fontSize:10,anchor:"center"});t.view.overlay.items.add(e);const i={label:e};return this._labelInfos.push(i),this._nextLabelIndex=this._labelInfos.length,i}_destroyUnusedLabels(){for(;this._labelInfos.length>this._nextLabelIndex;)this._destroyLabel(this._labelInfos.pop())}_destroyLabel({label:t}){Object(r.b)(this.context,(e=>e.view.overlay.items.remove(t))),t.destroy()}};Object(a.a)([Object(s.b)()],T.prototype,"context",void 0),Object(a.a)([Object(s.b)()],T.prototype,"stagedVertex",void 0),Object(a.a)([Object(s.b)()],T.prototype,"visible",void 0),Object(a.a)([Object(s.b)()],T.prototype,"edgeDistance",void 0),Object(a.a)([Object(s.b)()],T.prototype,"updating",null),Object(a.a)([Object(s.b)()],T.prototype,"_messagesUnits",void 0),Object(a.a)([Object(s.b)()],T.prototype,"_edgeDistancePixels",null),T=Object(a.a)([Object(l.a)("esri.views.interactive")],T);const A=Object(y.c)(),D=Object(y.c)(),R=Object(b.g)(),I=Object(b.g)();var G=i(251);let P=class extends T{getCameraOrExtent({view:t}){return t.state.camera}toScreenPointArray({view:t,elevationInfo:e,editGeometryOperations:i},a,n=Object(b.g)()){const{spatialReference:r}=i.data.coordinateHelper;return Object(G.e)(a,r,e,t,C),t.state.camera.projectToScreen(C,n),n}};P=Object(a.a)([Object(l.a)("esri.views.3d.interactive.SegmentLabels3D")],P);const C=Object(p.f)();var k=i(1240),z=i(1157),V=i(1183),L=i(108),H=i(60),N=i(401),U=i(40),F=i(39),Z=i(305),B=i(509),X=i(678),Y=i(34),W=i(130);class q{constructor(t){this._resourceFactory=t,this._resources=null,this._visible=!0,this._attached=!1}destroy(){this._destroyResources()}get resources(){return Object(r.l)(this._resources)?this._resources.external:null}get visible(){return this._visible}set visible(t){t!==this._visible&&(this._visible=t,this._syncGeometriesToRenderer())}get attached(){return this._attached}set attached(t){t!==this._attached&&(this._attached=t,this._createOrDestroyResources())}recreate(){this.attached&&this._createResources()}recreateGeometry(){this._resourceFactory.recreateGeometry?Object(r.k)(this._resources)||(this._ensureRenderGeometriesRemoved(),this._resourceFactory.recreateGeometry(this._resources.external),this._syncGeometriesToRenderer()):this.recreate()}_createOrDestroyResources(){this._attached?Object(r.k)(this._resources)&&this._createResources():this._destroyResources()}_createResources(){var t;this._destroyResources();const e=this._resourceFactory.createResources(),i=new Q({view:this._resourceFactory.view}),a=null==(t=this._resourceFactory.view.basemapTerrain)?void 0:t.overlayManager;this._resources={layerView:new Q({view:this._resourceFactory.view}),external:e,geometriesAdded:!1},a&&(this._resources.drapeSourceRenderer=a.registerGeometryDrapeSource(i)),this._syncGeometriesToRenderer()}_destroyResources(){var t;if(Object(r.k)(this._resources))return;this._ensureRenderGeometriesRemoved();const e=null==(t=this._resourceFactory.view.basemapTerrain)?void 0:t.overlayManager;e&&e.unregisterDrapeSource(this._resources.layerView),this._resources=null}_syncGeometriesToRenderer(){this._visible?this._ensureRenderGeometriesAdded():this._ensureRenderGeometriesRemoved()}_ensureRenderGeometriesRemoved(){Object(r.k)(this._resources)||Object(r.k)(this._resources.drapeSourceRenderer)||this._resources.geometriesAdded&&(this._resources.drapeSourceRenderer.removeGeometries(this._resources.external.geometries,W.a.UPDATE),this._resources.geometriesAdded=!1)}_ensureRenderGeometriesAdded(){Object(r.k)(this._resources)||Object(r.k)(this._resources.drapeSourceRenderer)||this._resources.geometriesAdded||(this._resources.drapeSourceRenderer.addGeometries(this._resources.external.geometries,W.a.UPDATE),this._resources.geometriesAdded=!0)}}let Q=class extends(Object(B.b)(g.a)){constructor(t){super(t),this.drapeSourceType=X.a.Features,this.updatePolicy=Y.k.SYNC}};Object(a.a)([Object(s.b)({constructOnly:!0})],Q.prototype,"view",void 0),Object(a.a)([Object(s.b)({readOnly:!0})],Q.prototype,"drapeSourceType",void 0),Q=Object(a.a)([Object(l.a)("DrapedVisualElementLayerView")],Q);var J=i(1236),K=i(1469),$=i(255),tt=i(685),et=i(888),it=i(384),at=i(102),nt=i(427),rt=i(11),ot=i(475);class st{constructor(t){this.view=null,this._attachmentOrigin=Object(Z.j)(0,0,0,null),this._attachmentOriginDirty=!0,this.events=new L.a,this._isDraped=!1,this._geometry=null,this._width=1,this._color=Object(N.c)(1,0,1,1),this._innerWidth=0,this._innerColor=Object(N.c)(1,1,1,1),this._stipplePattern=null,this._stippleOffColor=null,this._falloff=0,this._elevationInfo=null,this._laserlineStyle=null,this._laserlineEnabled=!1,this._renderOccluded=at.c.OccludeAndTransparentStencil,this._resources=new K.a({view:t.view,createResources:t=>this._createResources(t),recreateGeometry:(t,e)=>(t.geometries.length=0,this._recreateGeometry(e,t.material,t.geometries),t.geometries)}),this._attachmentOrigin.spatialReference=t.view.spatialReference,this._drapedResources=new q({view:t.view,createResources:()=>this._createDrapedResources(),recreateGeometry:t=>{t.geometries=this._createRenderGeometriesDraped(t.material),this._attachmentOriginChanged()}});let e=!0;this._laserline=new J.a({view:t.view});for(const i in t)i in this?"attached"===i?e=t[i]:this[i]=t[i]:console.error("Cannot set unknown property",i);this.attached=e}destroy(){this._resources.destroy(),this._drapedResources.destroy(),this._laserline.destroy()}get isDraped(){return this._isDraped}set isDraped(t){t!==this._isDraped&&(this._isDraped=t,this._updateAttached(this.attached),this._laserline.attached=this._laserlineAttached)}get _laserlineAttached(){return this.attached&&this.visible&&Object(r.l)(this._laserlineStyle)&&!this.isDraped&&this.laserlineEnabled}get visible(){return this._resources.visible}set visible(t){this._resources.visible=t,this._drapedResources.visible=t,this._laserline.attached=this._laserlineAttached}get attached(){return this._resources.attached||this._drapedResources.attached}set attached(t){this._updateAttached(t)}_updateAttached(t){this._resources.attached=!this.isDraped&&t,this._drapedResources.attached=this.isDraped&&t,this._laserline.attached=this._laserlineAttached,this.attached&&this._attachmentOriginChanged()}get geometry(){return this._geometry}set geometry(t){this._geometry=t,this._resources.recreateGeometry(),this._drapedResources.recreateGeometry()}get width(){return this._width}set width(t){t!==this._width&&(this._width=t,this._updateMaterial())}get color(){return this._color}set color(t){Object(H.g)(t,this._color)||(Object(H.c)(this._color,t),this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(t){t!==this._innerWidth&&(this._innerWidth=t,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(t){Object(H.g)(t,this._innerColor)||(Object(H.c)(this._innerColor,t),this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(t){const e=Object(r.l)(t)!==Object(r.l)(this._stipplePattern);this._stipplePattern=t,e?this._resources.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(t){t&&this._stippleOffColor&&Object(H.g)(t,this._stippleOffColor)||(this._stippleOffColor=t?Object(N.a)(t):null,this._updateMaterial())}get falloff(){return this._falloff}set falloff(t){t!==this._falloff&&(this._falloff=t,this._updateMaterial())}get elevationInfo(){return this._elevationInfo}set elevationInfo(t){this._elevationInfo=t,this._resources.recreateGeometry()}get laserlineStyle(){return this._laserlineStyle}set laserlineStyle(t){this._laserlineStyle=t,this._laserline.attached=this._laserlineAttached,Object(r.l)(t)&&(this._laserline.style=t)}get laserlineEnabled(){return this._laserlineEnabled}set laserlineEnabled(t){this._laserlineEnabled!==t&&(this._laserlineEnabled=t,this._laserline.attached=this._laserlineAttached)}get renderOccluded(){return this._renderOccluded}set renderOccluded(t){t!==this._renderOccluded&&(this._renderOccluded=t,this._updateMaterial())}get attachmentOrigin(){if(!this._attachmentOriginDirty)return this._attachmentOrigin;const t=Object(r.l)(this._resources.resources)?this._resources.resources.geometries:null;if(!t||0===t.length)return null;Object(h.B)(ht,0,0,0);let e=0;for(const i of t){const t=i.vertexAttributes.get(rt.a.POSITION),a=i.indices.get(rt.a.POSITION),n=Object(r.t)(this._resources.resources).material.isClosed(t.data,a);Object(it.a)(t,a,n,lt)&&(Object(h.j)(ht,ht,lt),e++)}return 0===e?null:(Object(h.p)(ht,ht,1/e),this.view.renderCoordsHelper.fromRenderCoords(ht,this._attachmentOrigin),this._attachmentOriginDirty=!1,this._attachmentOrigin)}_updateMaterial(){Object(r.l)(this._resources.resources)&&this._resources.resources.material.setParameters(this._materialParameters),Object(r.l)(this._drapedResources.resources)&&this._drapedResources.resources.material.setParameters(this._materialParameters)}get _isClosed(){return Object(r.l)(this.geometry)&&"polygon"===this.geometry.type}get _materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:!1,isClosed:this._isClosed,falloff:this._falloff,innerColor:this._innerColor,innerWidth:this._innerWidth,join:"round",hasPolygonOffset:!0,renderOccluded:this._normalizedRenderOccluded}}get _normalizedRenderOccluded(){return this.isDraped&&this._renderOccluded===at.c.OccludeAndTransparentStencil?at.c.OccludeAndTransparent:this._renderOccluded}_recreateGeometry(t,e,i){const a=this._createRenderGeometries();for(const n of a)t.addGeometry(n,e),i.push(n);this._attachmentOriginChanged()}_attachmentOriginChanged(){this._attachmentOriginDirty=!0,this.events.emit("attachment-origin-changed")}_createResources(t){const e=new ot.a(this._materialParameters),i=[];return this._recreateGeometry(t,e,i),{material:e,geometries:i,forEach:t=>{t(e),i.forEach(t)}}}_createDrapedResources(){const t=new ot.a(this._materialParameters);return{material:t,geometries:this._createRenderGeometriesDraped(t)}}_createRenderGeometriesDraped(t){const e=this.geometry;if(Object(r.k)(e)||Object(r.k)(this.view.basemapTerrain.spatialReference))return[];const i=Object(et.b)(e,this.view.basemapTerrain.spatialReference),a=[];for(const{position:n}of i.lines){const e={overlayInfo:{spatialReference:this.view.basemapTerrain.spatialReference,renderCoordsHelper:this.view.renderCoordsHelper},attributeData:{position:n},removeDuplicateStartEnd:this._isClosed},i=new nt.a(Object(tt.a)(e),t),r=Object(F.k)(ct);Object(F.n)(r,n),Object(H.l)(i.boundingSphere,.5*(r[0]+r[3]),.5*(r[1]+r[4]),0,.5*Math.sqrt((r[3]-r[0])*(r[3]-r[0])+(r[4]-r[1])*(r[4]-r[1]))),a.push(i)}return a}calculateMapBounds(t){if(Object(r.k)(this._resources.resources))return!1;const e=this.view.renderCoordsHelper;for(const i of this._resources.resources.geometries){const a=i.vertexAttributes.get(rt.a.POSITION),n=new Float64Array(a.data.length);Object(U.p)(a.data,e.spatialReference,0,n,this.view.spatialReference,0,a.data.length/3),Object(F.n)(t,n)}return!0}_createRenderGeometries(){var t;const e=this.geometry;if(Object(r.k)(e))return[];const i=Object(et.a)(e,this.view.elevationProvider,this.view.renderCoordsHelper,$.a.fromElevationInfo(null!=(t=this.elevationInfo)?t:new u.a({mode:Object(d.i)(e,null)}))),a=[],n=[];for(const{position:r,mapPosition:o}of i.lines){const t={attributeData:{position:r,mapPosition:o},removeDuplicateStartEnd:this._isClosed};a.push(Object(tt.a)(t)),n.push(r)}return this._laserline.pathVerticalPlane=n,a}}const ct=Object(F.h)(),lt=Object(p.f)(),ht=Object(p.f)();var pt=i(1419),dt=i(82);let ut=class extends L.a.EventedAccessor{constructor(t){super(t),this.tracking=!1,this.displaying=!1,this.isDraped=!1}};Object(a.a)([Object(s.b)({constructOnly:!0})],ut.prototype,"graphic",void 0),Object(a.a)([Object(s.b)()],ut.prototype,"tracking",void 0),Object(a.a)([Object(s.b)()],ut.prototype,"displaying",void 0),Object(a.a)([Object(s.b)()],ut.prototype,"isDraped",void 0),ut=Object(a.a)([Object(l.a)("esri.views.3d.layers.graphics.GraphicState")],ut);var bt=i(1410),Ot=i(1412),gt=i(1378);let _t=class extends bt.a{constructor(t){super(t),this._activeVertexVisualElement=null,this._createGraphicState=null,this._outlineVisualElement=null,this._verticesVisualElement=null,this._verticalLineVisualElement=null,this.geometryType=null,this.type="draw-3d"}initialize(){const{mode:t,offset:e}=this.elevationInfo;this.internalGraphicsLayer.elevationInfo=new u.a({mode:t,offset:e})}normalizeCtorArgs(t){if(!t.elevationInfo){var e;const i=null==(e=t.hasZ)||e;return{...t,elevationInfo:Object(d.f)(i)}}return t}initializeGraphic(t){const e=this._createGraphicState=new ut({graphic:t});return Object(n.b)([this.view.maskOccludee(t),this.view.trackGraphicState(e),Object(o.f)((()=>({element:this._outlineVisualElement,isDraped:e.isDraped})),(({element:t,isDraped:e})=>{Object(r.b)(t,(t=>t.isDraped=e))}),o.a)])}makeDrawOperation(){const{geometryType:t}=this,e="circle"!==t&&"rectangle"!==t;return new Ot.a({view:this.view,manipulators:this.manipulators,geometryType:Object(bt.b)(t),drawingMode:this.mode,hasZ:this.hasZ,defaultZ:this.defaultZ,snapToSceneEnabled:this.snapToScene,drawSurface:new gt.c(this.view,this.elevationInfo,[this.internalGraphicsLayer]),elevationDrawSurface:new gt.a(this.elevationInfo,this.defaultZ,this.view,this.internalGraphicsLayer),hasM:!1,elevationInfo:this.elevationInfo,snappingManager:this.snappingManager,snappingVisualizer:new k.a,segmentLabels:e?new P:null,labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions,isDraped:Object(r.l)(this._createGraphicState)?this._createGraphicState.isDraped:"on-the-ground"===Object(d.g)(this.hasZ,this.elevationInfo)})}onActiveVertexChanged(t){const{view:e}=this;return Object(r.l)(this._activeVertexVisualElement)?(this._activeVertexVisualElement.vertices=[t],this._updateVerticalLineVisualElement(t),null):(this._activeVertexVisualElement=new pt.a({view:e,spatialReference:e.spatialReference,vertices:[t],elevationInfo:this.internalGraphicsLayer.elevationInfo,renderOccluded:z.b.reshapeManipulators.vertex.renderOccluded,attached:!1}),this._activeVertexVisualElement.color=z.b.colorToVec4(z.b.reshapeManipulators.selected.color),this._activeVertexVisualElement.attached=!0,this._verticalLineVisualElement=new V.a({view:e,extensionType:z.b.visualElements.zVerticalLine.extensionType,innerWidth:1,attached:!1,writeDepthEnabled:!1,renderOccluded:at.c.OccludeAndTransparent}),z.b.visualElements.zVerticalLine.apply(this._verticalLineVisualElement),Object(n.c)((()=>{this._activeVertexVisualElement=Object(r.e)(this._activeVertexVisualElement),this._verticalLineVisualElement=Object(r.e)(this._verticalLineVisualElement)})))}_updateVerticalLineVisualElement(t){const e=this._verticalLineVisualElement;if(Object(r.k)(e))return;const{renderCoordsHelper:i,spatialReference:a,elevationProvider:n}=this.view;Object(h.B)(jt,t[0],t[1],t[2]),mt.setFromElevationInfo(this.elevationInfo),jt[2]=Object(dt.f)(jt,n,mt,i),i.toRenderCoords(jt,a,jt)?(e.setStartEndFromWorldDownAtLocation(jt),e.attached=!0):e.attached=!1}onOutlineChanged(t){if(Object(r.l)(this._outlineVisualElement))return this._outlineVisualElement.geometry=t,null;const e=this.internalGraphicsLayer.elevationInfo;return this._outlineVisualElement=new st({view:this.view,geometry:t,elevationInfo:e,isDraped:Object(r.l)(this._createGraphicState)?this._createGraphicState.isDraped:"on-the-ground"===Object(d.g)(this.hasZ,e),attached:!1}),z.b.visualElements.lineGraphics.outline.apply(this._outlineVisualElement),z.b.visualElements.lineGraphics.shadowStyle.apply(this._outlineVisualElement),this._outlineVisualElement.attached=!0,this._outlineVisualElement.laserlineEnabled=!0,Object(n.c)((()=>{this._outlineVisualElement=Object(r.e)(this._outlineVisualElement)}))}onRegularVerticesChanged(t){return Object(r.l)(this._verticesVisualElement)?(this._verticesVisualElement.vertices=t,null):(this._verticesVisualElement=new pt.a({view:this.view,spatialReference:this.view.spatialReference,vertices:t,elevationInfo:this.internalGraphicsLayer.elevationInfo,renderOccluded:z.b.reshapeManipulators.vertex.renderOccluded,attached:!1}),this._verticesVisualElement.attached=!0,Object(n.c)((()=>{this._verticesVisualElement=Object(r.e)(this._verticesVisualElement)})))}};Object(a.a)([Object(s.b)({constructOnly:!0})],_t.prototype,"elevationInfo",void 0),Object(a.a)([Object(s.b)({constructOnly:!0})],_t.prototype,"geometryType",void 0),Object(a.a)([Object(s.b)()],_t.prototype,"type",void 0),Object(a.a)([Object(s.b)({constructOnly:!0})],_t.prototype,"view",void 0),_t=Object(a.a)([Object(l.a)("esri.views.3d.interactive.editingTools.draw.DrawGraphicTool3D")],_t);const mt=new $.a,jt=Object(p.f)();var ft,vt,yt,Mt=i(59),xt=i(243),wt=i(1102),St=i(1147),Et=i(202),Tt=i(1232),At=i(14),Dt=i(1125);!function(t){t[t.NONE=0]="NONE",t[t.ANY=1]="ANY",t[t.Z=2]="Z",t[t.XY=4]="XY"}(ft||(ft={})),(yt=vt||(vt={}))[yt.TRANSLATE_Z=0]="TRANSLATE_Z",yt[yt.TRANSLATE_XY=1]="TRANSLATE_XY",yt[yt.SCALE=2]="SCALE",yt[yt.ROTATE=3]="ROTATE",yt[yt.SCALE_ROTATE=4]="SCALE_ROTATE";class Rt{constructor(){this.grabbingState=ft.NONE,this.zManipulator=null,this.firstSelected=null,this.numSelected=0,this.firstGrabbedXY=null}update(t){this.grabbingState=ft.NONE,this.zManipulator=null,this.numSelected=0,this.firstSelected=null,this.firstGrabbedXY=null,t.forEachManipulator(((t,e)=>{if(e===vt.TRANSLATE_Z&&(this.zManipulator=t),t instanceof Dt.a&&(t.selected&&(0===this.numSelected&&(this.firstSelected=t),this.numSelected++),Object(r.k)(this.firstGrabbedXY)&&t.grabbing&&e===vt.TRANSLATE_XY&&(this.firstGrabbedXY=t)),t.grabbing)switch(this.grabbingState|=ft.ANY,e){case vt.TRANSLATE_Z:this.grabbingState|=ft.Z;break;case vt.TRANSLATE_XY:this.grabbingState|=ft.XY}}))}}function It(t){const{view:e,graphic:i}=t,a=new ut({graphic:i}),r=function(t,e){const{view:i,graphic:a}=t,r=new st({view:i,geometry:Pt(a)?a.geometry:null,elevationInfo:Object(d.j)(a),attached:!1});z.b.visualElements.lineGraphics.shadowStyle.apply(r);const s=()=>{r.attached=e.displaying};z.b.visualElements.lineGraphics.outline.apply(r);const c=[Object(o.f)((()=>e.displaying),s),Object(o.f)((()=>e.isDraped),(t=>{r.isDraped=t})),e.on("changed",(()=>r.geometry=Pt(a)?a.geometry:null)),Object(n.a)(r)];return s(),{visualElement:r,remove:()=>Object(n.b)(c).remove()}}(t,a),s=[r,Gt(t,r.visualElement,a),e.maskOccludee(i),e.trackGraphicState(a)];return{visualElement:r.visualElement,remove:()=>Object(n.b)(s).remove()}}function Gt(t,e,i){const{graphic:a,view:s}=t,c=[],l=Object(d.j)(a),p="on-the-ground"===l.mode||!l.offset&&"absolute-height"!==l.mode,u=new Rt,b=new V.a({view:s,extensionType:z.b.visualElements.zVerticalLine.extensionType,innerWidth:1,attached:!1,writeDepthEnabled:!1,renderOccluded:at.c.OccludeAndTransparent});z.b.visualElements.pointGraphics.shadowStyle.apply(b);const O=Object(At.h)(z.b.visualElements.heightPlaneAngleCutoff),g=new J.a({view:s,attached:!1,angleCutoff:O});z.b.visualElements.heightPlane.apply(g);let _=1,m=1;const j=()=>{if(u.update(t),!i.displaying||p&&(i.isDraped||!Pt(a)||!a.geometry.hasZ))return e.laserlineEnabled=!1,b.attached=!1,void(g.attached=!1);e.laserlineEnabled=!0;{const t=u.grabbingState&ft.XY?z.b.visualElements.laserlineAlphaMultiplier:1;t!==_&&(_=t,z.b.visualElements.lineGraphics.shadowStyle.apply(e,t),z.b.visualElements.pointGraphics.shadowStyle.apply(b,t))}{const t=u.grabbingState&ft.Z?z.b.visualElements.laserlineAlphaMultiplier:1;t!==m&&(m=t,z.b.visualElements.heightPlane.apply(g,t))}(function(t,e){const i=1===e.numSelected?e.firstSelected:e.numSelected>1&&Object(r.l)(e.firstGrabbedXY)?e.firstGrabbedXY:null;Object(r.l)(i)?(t.setStartEndFromWorldDownAtLocation(i.renderLocation),t.attached=!0):t.attached=!1})(b,u),function(t,e,i,a){if(a.numSelected>0){Object(h.B)(Ct,0,0,0);let e=0;t.forEachManipulator(((t,i)=>{i===vt.TRANSLATE_XY&&t.selected&&t instanceof Dt.a&&(Object(h.j)(Ct,Ct,t.renderLocation),e++)})),e>0?(i.heightManifoldTarget=Object(h.p)(Ct,Ct,1/e),i.attached=!0):i.attached=!1}else{const a=e.attachmentOrigin;Object(r.l)(a)&&t.view.renderCoordsHelper.toRenderCoords(a,Ct)?(i.heightManifoldTarget=Ct,i.attached=!0):i.attached=!1}}(t,e,g,u)};z.b.visualElements.zVerticalLine.apply(b),c.push(i.on("changed",j),Object(o.f)((()=>i.displaying),j),e.events.on("attachment-origin-changed",j),Object(n.a)(b),Object(n.a)(g));const f=[],v=()=>{Object(n.b)(f).remove(),f.length=0,t.forEachManipulator((t=>f.push(t.events.on("grab-changed",j)))),t.forEachManipulator((t=>f.push(t.events.on("select-changed",j)))),j()};return v(),c.push(t.onManipulatorsChanged(v),Object(n.d)((()=>Object(n.b)(f)))),Object(n.b)(c)}function Pt(t){return Object(r.l)(t.geometry)&&("polygon"===t.geometry.type||"polyline"===t.geometry.type)}const Ct=Object(p.f)();var kt=i(37),zt=i(1299);function Vt(t){const{view:e,graphic:i}=t,a=new ut({graphic:i}),s=[],c=function(t,e,i){const{view:a,graphic:s}=t,c=new zt.a({view:a,geometry:Lt(s),elevationInfo:Object(d.j)(s),attached:!1});return function(t,e,i,a){const s=()=>e.attached=i.displaying;(function(t,e,i,a){const{view:o,graphic:s}=t;let c=null;const l=t=>{Object(r.l)(c)&&(c.remove(),c=null),i.isDraped&&Object(r.l)(t)&&(c=function(t,e,i){const a=t.elevationProvider.spatialReference;Object(U.v)(e,Ht,a);const n=Ht[0],r=Ht[1];return t.elevationProvider.on("elevation-change",(t=>{Object(kt.k)(t.extent,n,r)&&i()}))}(o,t,(()=>{e.geometry=t})))},h=()=>{const t=Lt(s);l(t),e.geometry=t};a.push(i.on("changed",h),Object(n.d)((()=>c))),h()})(t,e,i,a),z.b.visualElements.pointGraphics.outline.apply(e),a.push(Object(o.f)((()=>i.displaying),s,o.a))}(t,c,e,i),i.push(Object(n.a)(c)),c}(t,a,s);return function(t,e,i,a){const{view:s,graphic:c}=t,l=new V.a({view:s,extensionType:z.b.visualElements.zVerticalLine.extensionType,innerWidth:1,attached:!1,writeDepthEnabled:!1,renderOccluded:at.c.OccludeAndTransparent});z.b.visualElements.zVerticalLine.apply(l);const p=new J.a({view:s,intersectsLineInfinite:!0,attached:!1});z.b.visualElements.pointGraphics.shadowStyle.apply(p);const u=Object(At.h)(z.b.visualElements.heightPlaneAngleCutoff),b=new J.a({view:s,attached:!1,angleCutoff:u});z.b.visualElements.heightPlane.apply(b);const O=Object(d.j)(t.graphic),g=$.a.fromElevationInfo(O),_="on-the-ground"===O.mode||!O.offset&&"absolute-height"!==O.mode,m=new Rt;let j=1,f=1;const v=()=>{m.update(t);const i=Lt(c),n=_&&(e.isDraped||Object(r.k)(i)||!i.hasZ);let o=!0;if(!n&&Object(r.l)(i)){const t=Object(dt.f)(i,s.elevationProvider,g,s.renderCoordsHelper);Object(h.B)(Ht,i.x,i.y,t),Object(U.C)(Ht,i.spatialReference,Ht,s.renderCoordsHelper.spatialReference),l.setStartEndFromWorldDownAtLocation(Ht),p.intersectsWorldUpAtLocation=Ht}else o=!1;const d=m.grabbingState&ft.Z?z.b.visualElements.laserlineAlphaMultiplier:1;d!==j&&(j=d,z.b.visualElements.heightPlane.apply(b,d));const u=Object(F.k)(Nt);!n&&e.displaying&&a.calculateMapBounds(u)&&Object(U.C)(Object(F.t)(u,Ht),s.spatialReference,Ht,s.renderCoordsHelper.spatialReference)?(b.heightManifoldTarget=Ht,b.attached=!0):b.attached=!1;const O=m.grabbingState&ft.XY?z.b.visualElements.laserlineAlphaMultiplier:1;O!==f&&(f=O,z.b.visualElements.pointGraphics.shadowStyle.apply(p,O));const v=o&&e.displaying&&!n;p.attached=v,l.attached=v};i.push(Object(o.f)((()=>[e.displaying,e.isDraped]),v),e.on("changed",v)),t.forEachManipulator((t=>{i.push(t.events.on("grab-changed",v))})),i.push(Object(n.a)(p)),i.push(Object(n.a)(l)),i.push(Object(n.a)(b)),v()}(t,a,s,c),s.push(e.trackGraphicState(a)),{visualElement:c,remove(){Object(n.b)(s).remove()}}}function Lt(t){const e=t.geometry;return Object(r.k)(e)?null:"point"===e.type?e:"mesh"===e.type?e.anchor.clone():null}const Ht=Object(p.f)(),Nt=Object(F.h)();function Ut(t){switch(Object(r.t)(t.graphic.geometry).type){case"point":case"mesh":return Vt(t);case"polygon":case"polyline":return It(t);default:return null}}const Ft=[1,.5,0],Zt=70,Bt=Math.ceil(Zt/3*2),Xt=160,Yt=5*Math.PI/12,Wt=1*Math.PI/3;var qt=i(64);class Qt{constructor(){this._available=!0}set location(t){this._forEachManipulator3D((e=>e.location=t))}set elevationAlignedLocation(t){this._forEachManipulator3D((e=>e.elevationAlignedLocation=t))}set elevationInfo(t){this._forEachManipulator3D((e=>e.elevationInfo=t))}get renderLocation(){let t;return this._forEachManipulator3D((e=>{t||(t=e.renderLocation)})),t}get available(){return this._available}set available(t){this._available=t,this._forEachManipulator3D((e=>e.available=t))}get hovering(){return this.someManipulator((t=>t.hovering))}get grabbing(){return this.someManipulator((t=>t.grabbing))}get dragging(){return this.someManipulator((t=>t.dragging))}hasManipulator(t){return this.someManipulator((e=>e===t))}someManipulator(t){let e=!1;return this.forEachManipulator((i=>{!e&&t(i)&&(e=!0)})),e}_forEachManipulator3D(t){this.forEachManipulator(((e,i)=>{e instanceof Dt.a&&t(e,i)}))}}var Jt=i(46),Kt=i(30),$t=i(35),te=i(55),ee=i(1148),ie=i(1110);function ae(t,e,i,a){const n=t.graphic,r=(t,i)=>e({action:t,graphic:n,dxScreen:i.screenDeltaX,dyScreen:i.screenDeltaY});return i(((t,e,i)=>{const o=e.next((t=>("start"===t.action&&r("start",t),t))).next(Object(ie.g)(n,a)).next((t=>{switch(t.action){case"start":case"update":(t.translationX||t.translationY||t.translationZ)&&r("update",t);break;case"end":r("end",t)}return t}));return i.next(Object(ie.i)(n)).next((()=>{r("end",{screenDeltaX:0,screenDeltaY:0})})),o}))}function ne(t){if(Object(r.k)(t)||"polyline"!==t.type&&"polygon"!==t.type)return 0;const e=("polyline"===t.type?t.paths:t.rings)[0];if(!e||e.length<2)return 0;const i=e[0],a=e[1];return Math.atan2(a[1]-i[1],a[0]-i[0])}function re(t){if(Object(r.k)(t)||Object(r.k)(t.axis))return 1;const{mapStart:e,mapEnd:i,axis:a}=t,n=[i.x-e.x,i.y-e.y];return n[0]*a[0]+n[1]*a[1]>0?1:-1}var oe=i(285),se=i(871),ce=i(674);class le extends Qt{constructor(t){super(),this._handles=new qt.a,this._arrowManipulatorInfos=new Array,this._opaqueMaterial=this._createMaterial(),this._transparentMaterial=this._createMaterial(.5),this._angle=0,this._scale=1,this._radius=Zt,this._updateAfterDrag=!1,this.events=new L.a,this._tool=t.tool,this._view=t.view,null!=t.radius&&(this._radius=t.radius),this._createManipulators(),this.forEachManipulator((t=>this._tool.manipulators.add(t)))}set orthogonalAvailable(t){this._arrowManipulatorInfos[1].manipulator.available=t,this._arrowManipulatorInfos[3].manipulator.available=t}destroy(){this.forEachManipulator((t=>{this._tool.manipulators.remove(t),t.destroy()})),this._handles=Object(r.e)(this._handles),this._tool=null,this._view=null,this._arrowManipulatorInfos.length=0}forEachManipulator(t){for(const{manipulator:e}of this._arrowManipulatorInfos)t(e,vt.TRANSLATE_XY)}createGraphicDragPipeline(t,e,i){const a=e.graphic,n=Object(d.j)(a),o=Object(r.t)(a.geometry).spatialReference;return ae(e,i,(e=>this.createDragPipeline(((i,a,n,r,o)=>e(i,t(i,a,n,r,o),n)),n,o,a)),this._view.state.viewingMode)}createDragPipeline(t,e,i,a){return Object(n.b)(this._arrowManipulatorInfos.map((({manipulator:n},r)=>Object(ie.e)(n,((n,o,s,c,l)=>{const h=o.next((t=>({...t,manipulatorType:vt.TRANSLATE_XY}))).next(Object(ie.f)(this._view,n.elevationAlignedLocation)).next(Object(ee.d)(this._view,n.elevationAlignedLocation,e,i,a)).next(Object(ie.d)(n.location,this.angle+(r+1)*Math.PI*.5)).next(Object(ie.c)());t(n,h,s,c,l)})))))}get angle(){return this._angle}set angle(t){this._angle=t,this.dragging?this._updateAfterDrag=!0:this._updateManipulatorTransform()}get displayScale(){return this._scale}set displayScale(t){this._scale=t,this._updateManipulatorTransform()}get radius(){return this._radius}set radius(t){this._radius!==t&&(this._radius=t,this._updateManipulators())}_updateManipulators(){for(let t=0;t<this._arrowManipulatorInfos.length;t++)this._updateArrowManipulator(this._arrowManipulatorInfos[t],t);this._updateManipulatorTransform()}_updateArrowManipulator({manipulator:t,transform:e},i){const a=this._radius/Zt,n=54*a,r=n*Math.sqrt(3)/2,o=Object(oe.f)(r,n/2,n/2,.02);Object(oe.p)(o,Object(Kt.i)(te.a.get(),Object(h.B)(te.d.get(),0,-r/3,0))),t.renderObjects=[{geometry:o,material:this._opaqueMaterial,stateMask:ce.c.Focused},{geometry:o,material:this._transparentMaterial,stateMask:ce.c.Unfocused}],t.radius=r/3*2*1.2;const s=Object(Kt.e)(te.a.get(),i*Math.PI/2),c=Object(Kt.i)(te.a.get(),Object(h.B)(te.d.get(),0,100*a,0));Object(Kt.p)(e,s,c)}_createManipulators(){for(let t=0;t<4;t++){const e=this._createArrowManipulator(t);this._arrowManipulatorInfos.push(e)}this._updateManipulatorTransform()}_updateManipulatorTransform(){const t=this.angle,e=Object(Kt.g)(te.a.get(),t,Object(p.h)(0,0,1));if(Object(r.k)(e))return;const i=Object(Kt.b)(te.a.get(),Object(h.B)(te.d.get(),this.displayScale,this.displayScale,this.displayScale)),a=Object(Kt.p)(te.a.get(),i,e);for(const n of this._arrowManipulatorInfos){const t=Object(Kt.p)(te.a.get(),a,n.transform);n.manipulator.modelTransform=t}}_createArrowManipulator(t){const e=new Dt.a({view:this._view,autoScaleRenderObjects:!1,worldOriented:!0,focusMultiplier:1,touchMultiplier:1,collisionType:{type:"disc",direction:Object(p.h)(0,0,1)}}),i={manipulator:e,transform:Object($t.d)()};return this._updateArrowManipulator(i,t),this._handles.add(e.events.on("drag",(t=>{this._updateAfterDrag&&"end"===t.action&&!this.dragging&&(this._updateManipulatorTransform(),this._updateAfterDrag=!1)}))),i}_createMaterial(t=1){const e=Jt.a.toUnitRGBA(z.a.main);return e[3]*=t,new se.a({color:e,transparent:1!==t,cullFace:Y.b.Back,renderOccluded:at.c.Transparent})}get test(){return{arrowManipulators:this._arrowManipulatorInfos.map((({manipulator:t})=>t))}}}class he{constructor(){this._view=null,this._elevationInfo=null,this._lastDragEvent=null,this.next=new ie.a,this._enabled=!1}get enabled(){return this._enabled}set enabled(t){if(this._enabled!==t&&Object(r.l)(this._lastDragEvent)){const e=this._lastDragEvent.mapEnd,i=this._snap(this._lastDragEvent.screenEnd);if(Object(r.l)(i)){const a={action:"update",mapStart:this._lastDragEvent.mapStart,mapEnd:!0===t?i:e,screenStart:this._lastDragEvent.screenEnd,screenEnd:this._lastDragEvent.screenEnd};this.next.execute(a)}}this._enabled=t}_snap(t){const e=Object(r.l)(this._view)?this._view.toMap(t,{exclude:[]}):null;return Object(r.l)(e)&&Object(r.l)(this._view)&&(e.z=Object(d.l)(e,this._view,this._elevationInfo)),e}createDragEventPipelineStep(t,e){return this._view=t,this._elevationInfo=e,this._lastDragEvent=null,t=>{if(this._lastDragEvent="end"!==t.action?{...t}:null,this._enabled){const e=this._snap(t.screenEnd);return Object(r.l)(e)?{action:t.action,mapStart:t.mapStart,mapEnd:e,screenStart:t.screenStart,screenEnd:t.screenEnd}:null}return{action:t.action,mapStart:t.mapStart,mapEnd:t.mapEnd,screenStart:t.screenStart,screenEnd:t.screenEnd}}}}class pe extends Qt{constructor(t){super(),this._snapToScene=new he,this._discMaterial=this._createMaterial(),this._discMaterialTransparent=this._createMaterial(.5),this._scale=1,this._radius=Zt,this._view=t.view,this._tool=t.tool,null!=t.snapToScene&&(this.snapToScene=t.snapToScene),null!=t.radius&&(this._radius=t.radius),this._createManipulator(),this.forEachManipulator((t=>this._tool.manipulators.add(t)))}destroy(){this.forEachManipulator((t=>{this._tool.manipulators.remove(t),t.destroy()})),this._tool=null,this._view=null,this._manipulator=null}forEachManipulator(t){t(this._manipulator,vt.TRANSLATE_XY)}get displayScale(){return this._scale}set displayScale(t){this._scale=t,this._updateManipulatorTransform()}get snapToScene(){return this._snapToScene.enabled}set snapToScene(t){this._snapToScene.enabled=t}get radius(){return this._radius}set radius(t){t!==this._radius&&(this._radius=t,this._updateManipulator())}createGraphicDragPipeline(t,e,i){const a=e.graphic,n=Object(d.j)(a),o=Object(r.t)(a.geometry).spatialReference;return ae(e,i,(e=>this.createDragPipeline(((i,a,n,r,o)=>e(i,t(i,a,n,r,o),n)),n,o,a)),this._view.state.viewingMode)}createDragPipeline(t,e,i,a){const n=this._view;return Object(ie.e)(this._manipulator,((r,o,s,c,l)=>{const h=o.next(Object(ie.f)(n,r.elevationAlignedLocation)).next(Object(ee.d)(n,r.elevationAlignedLocation,e,i,a)).next(this._snapToScene.createDragEventPipelineStep(n,e),this._snapToScene.next).next((t=>({...t,manipulatorType:vt.TRANSLATE_XY}))).next(Object(ie.c)());t(r,h,s,c,l)}))}_updateManipulatorTransform(){const t=Object(Kt.b)(te.a.get(),Object(h.B)(te.d.get(),this.displayScale,this.displayScale,this.displayScale));this._manipulator.modelTransform=t}_createManipulator(){const t=this._view;this._manipulator=new Dt.a({view:t,worldSized:!1,autoScaleRenderObjects:!1,focusMultiplier:1,touchMultiplier:1,collisionType:{type:"disc",direction:Object(p.h)(0,0,1)},worldOriented:!0}),this._updateManipulator()}_updateManipulator(){const t=Object(oe.d)(.02,1,128,Object(p.h)(0,0,1),Object(p.h)(0,0,0)),e=Object(Kt.b)(Object($t.d)(),Object(p.h)(this._radius,this._radius,this._radius));this._manipulator.renderObjects=[{geometry:t,material:this._discMaterial,transform:e,stateMask:ce.c.Focused},{geometry:t,material:this._discMaterialTransparent,transform:e,stateMask:ce.c.Unfocused}],this._manipulator.radius=this._radius/Zt*80}_createMaterial(t=1){const e=Jt.a.toUnitRGBA(z.a.main);return e[3]*=t,new se.a({color:e,transparent:1!==t,cullFace:Y.b.Back,renderOccluded:at.c.Transparent})}get test(){return{discManipulator:this._manipulator}}}var de=i(563);class ue extends Qt{constructor(t){super(),this._radius=Zt,this.events=new L.a,this._tool=t.tool,this._view=t.view,null!=t.radius&&(this._radius=t.radius),this._createManipulator(),this.forEachManipulator((t=>this._tool.manipulators.add(t)))}destroy(){this.forEachManipulator((t=>{this._tool.manipulators.remove(t),t.destroy()}))}forEachManipulator(t){t(this._manipulator,vt.TRANSLATE_Z)}createGraphicDragPipeline(t,e,i){const a=Object(r.t)(e.graphic.geometry).spatialReference;return ae(e,i,(e=>this.createDragPipeline(((i,a,n,r,o)=>e(i,t(i,a,n,r,o),n)),a)),this._view.state.viewingMode)}createDragPipeline(t,e){const i=this._view;return Object(ie.e)(this._manipulator,((a,n,r,o,s)=>{const c=n.next((t=>({...t,manipulatorType:vt.TRANSLATE_Z}))).next(Object(ee.i)(i,a.renderLocation,e)).next(Object(ie.c)());t(a,c,r,o,s)}))}get radius(){return this._radius}set radius(t){t!==this._radius&&(this._radius=t,this._updateManipulator())}_updateManipulator(){const t=this._radius/Zt,e=z.b.zManipulator.height*t,i=z.b.zManipulator.coneHeight*t,a=z.b.zManipulator.coneWidth*t,n=z.b.zManipulator.width*t,r=[Object(p.h)(0,0,0),Object(p.h)(0,0,e)],o=Object(oe.n)(r,n/2,16,!1),s=Object(oe.c)(i,a/2,16,!1),c=[Object(p.h)(0,0,0),Object(p.h)(0,0,e+i)],l=(t=>{const i=Object($t.d)();if(Object(Kt.y)(i,i,[0,0,e]),Object(Kt.u)(i,i,Math.PI/2),t){const e=1+2*t/a;Object(Kt.n)(i,i,[e,e,e])}return i})(0),h=(t,e)=>{const i=Object(de.a)(z.b.zManipulator.color,e);return[i.r/255,i.g/255,i.b/255,z.b.zManipulator.color.a*t]},d=Object(St.c)(h(1,.25),at.c.Occlude),u=Object(St.c)(h(1,0),at.c.Occlude),b=Object(St.c)(h(.7,0),z.b.zManipulator.renderOccluded),O=Object(St.c)(h(.85,0),z.b.zManipulator.renderOccluded);this._manipulator.renderObjects=[{geometry:s,transform:l,material:d,stateMask:ce.c.Unfocused},{geometry:o,material:d,stateMask:ce.c.Unfocused},{geometry:s,transform:l,material:u,stateMask:ce.c.Focused},{geometry:o,material:u,stateMask:ce.c.Focused},{geometry:s,transform:l,material:b,stateMask:ce.c.Unfocused},{geometry:o,material:b,stateMask:ce.c.Unfocused},{geometry:s,transform:l,material:O,stateMask:ce.c.Focused},{geometry:o,material:O,stateMask:ce.c.Focused}],this._manipulator.radius=n/2+2,this._manipulator.collisionType={type:"line",paths:[c]}}_createManipulator(){const t=new Dt.a({view:this._view,autoScaleRenderObjects:!1,worldSized:!1,selectable:!1,cursor:"ns-resize",elevationInfo:this.elevationInfo,worldOriented:!0,collisionPriority:1.6});t.applyObjectTransform=t=>{const e=this._view.state.camera,i=be;this._view.renderCoordsHelper.toRenderCoords(this._manipulator.elevationAlignedLocation,i);const a=Object(h.s)(e.eye,i),n=e.computeRenderPixelSizeAtDist(a),r=Object(h.k)(Oe,i,e.eye);Object(h.w)(r,r);const o=ge;this._view.renderCoordsHelper.worldUpAtPosition(be,o);const s=Math.abs(Object(h.n)(r,o)),c=Object(h.o)(Oe,r,o),l=Object(h.o)(Oe,c,o),p=Object(At.f)(s,.01,1),d=1-Math.sqrt(1-p*p)/p/e.fullWidth,u=this._radius/Zt,b=z.b.zManipulator.width*u;Object(h.p)(l,Object(h.w)(l,l),(1/d-1)*a+n*b),t[12]-=Oe[0],t[13]-=Oe[1],t[14]-=Oe[2]},this._manipulator=t,this._updateManipulator()}get test(){return{manipulator:this._manipulator}}}const be=Object(p.f)(),Oe=Object(p.f)(),ge=Object(p.f)();class _e extends Qt{constructor(t){super(),this._handles=new qt.a,this._interactive=!0;const{tool:e,view:i,snapToScene:a,radius:n}=t;this._view=i,this.xyManipulation=new pe({tool:e,view:i,snapToScene:a,radius:n}),this.xyAxisManipulation=new le({tool:e,view:i,radius:n}),this.zManipulation=new ue({tool:e,view:i,radius:n}),this.xyManipulation.available=t.xyAvailable,this.xyAxisManipulation.available=t.xyAxisAvailable,this.zManipulation.available=t.zAvailable,this._autoHideXYAxis(),this.forEachManipulator((t=>{this._handles.add(t.events.on("grab-changed",(()=>this._updateManipulatorInteractivity())))}))}destroy(){this._handles.destroy(),this.xyManipulation.destroy(),this.xyAxisManipulation.destroy(),this.zManipulation.destroy()}createGraphicDragPipeline(t,e,i){return Object(n.b)([this.xyManipulation.createGraphicDragPipeline(((e,i,a,n,r)=>t(je.XY,e,i,a,n,r)),e,i),this.xyAxisManipulation.createGraphicDragPipeline(((e,i,a,n,r)=>t(je.XY_AXIS,e,i,a,n,r)),e,i),this.zManipulation.createGraphicDragPipeline(((e,i,a,n,r)=>t(je.Z,e,i,a,n,r)),e,i)])}createDragPipeline(t,e,i,a){return Object(n.b)([this.xyManipulation.createDragPipeline(((e,i,a,n,r)=>t(je.XY,e,i,a,n,r)),e,i,a),this.xyAxisManipulation.createDragPipeline(((e,i,a,n,r)=>t(je.XY_AXIS,e,i,a,n,r)),e,i,a),this.zManipulation.createDragPipeline(((e,i,a,n,r)=>t(je.Z,e,i,a,n,r)),i)])}set snapToScene(t){this.xyManipulation.snapToScene=t}set angle(t){this.xyAxisManipulation.angle=t}set interactive(t){this._interactive!==t&&(this._interactive=t,this._updateManipulatorInteractivity())}set radius(t){this.xyAxisManipulation.radius=t,this.xyManipulation.radius=t,this.zManipulation.radius=t}set displayScale(t){this.xyManipulation.displayScale=t,this.xyAxisManipulation.displayScale=t}forEachManipulator(t){this.xyManipulation.forEachManipulator((e=>t(e,vt.TRANSLATE_XY))),this.xyAxisManipulation.forEachManipulator((e=>t(e,vt.TRANSLATE_XY))),this.zManipulation.forEachManipulator((e=>t(e,vt.TRANSLATE_Z)))}get _xyAxisVisible(){const t=this.xyManipulation.someManipulator((t=>t.focused))||this.xyAxisManipulation.someManipulator((t=>t.focused));return this._view.inputManager&&"touch"===this._view.inputManager.latestPointerType||t}_autoHideXYAxis(){const t=this.xyAxisManipulation,e=this.xyManipulation;if(Object(O.a)("esri-mobile"))return;const i=[];e.forEachManipulator((t=>i.push(t))),t.forEachManipulator((t=>i.push(t)));const a=()=>{const e=[];this._xyAxisVisible||t.forEachManipulator((t=>e.push(t.disableDisplay()))),this._handles.remove(me),this._handles.add(e,me)};for(const n of i)this._handles.add(n.events.on("focus-changed",a));this._view.inputManager&&this._handles.add(Object(o.g)((()=>{var t;return null==(t=this._view.inputManager)?void 0:t.latestPointerType}),a)),a()}_updateManipulatorInteractivity(){const t=this.grabbing;this.forEachManipulator((e=>{e.interactive=!t&&this._interactive||e.grabbing}))}static radiusForSymbol(t){const e=Object(r.l)(t)&&"point-3d"===t.type&&t.symbolLayers;return e&&e.length>0&&e.some((t=>"icon"===t.type))?Bt:Zt}}const me="disable-xy-axis-display";var je,fe;(fe=je||(je={}))[fe.XY=0]="XY",fe[fe.XY_AXIS=1]="XY_AXIS",fe[fe.Z=2]="Z";var ve=i(1379);class ye extends Qt{constructor(t){super(),this._view=t.view,this._tool=t.tool,this._graphicState=t.graphicState,this._createManipulator(),this.forEachManipulator((t=>this._tool.manipulators.add(t)))}destroy(){this.forEachManipulator((t=>{this._tool.manipulators.remove(t),t.destroy()})),this._tool=null,this._view=null,this._manipulator=null,this._graphicState=null}forEachManipulator(t){t(this._manipulator,vt.TRANSLATE_XY)}createGraphicDragPipeline(t){return ae(this._graphicState,t,(t=>this.createDragPipeline(t)),this._view.state.viewingMode)}createDragPipeline(t){const e=this._view,i=this._graphicState.graphic,a=Object(r.l)(i.geometry)?i.geometry.spatialReference:null;return Object(ie.e)(this._manipulator,((n,r,o,s,c)=>{const l=r.next(Object(ee.e)(c,e,i,a)).next(Object(ie.b)()).next(Object(ie.c)());t(n,l,o,s,c)}))}_createManipulator(){const t=this._view,e=this._graphicState.graphic;this._manipulator=new ve.a({graphic:e,view:t,selectable:!0,cursor:"move"})}}var Me=i(1006),xe=i(1159),we=i(1170),Se=i(870),Ee=i(1135),Te=i(1184),Ae=i(1169),De=i(1185),Re=i(1212);class Ie{constructor(t){this.allGraphics=t,this.type="graphic-move-start"}}class Ge{constructor(t,e,i){this.dx=t,this.dy=e,this.allGraphics=i,this.type="graphic-move"}}class Pe{constructor(t){this.allGraphics=t,this.type="graphic-move-stop"}}let Ce=class extends(Object(xt.b)(L.a.EventedMixin(xe.a))){constructor(t){super(t),this.graphics=new Mt.a,this.enableZ=!0,this.tooltipOptions=new Se.a,this.type="move-3d",this._snappingPipeline=new Te.a,this._tooltip=null}initialize(){const{graphics:t,view:e}=this;this.addHandles([t.on("change",(()=>this._refreshManipulators())),Object(o.f)((()=>this.tooltipOptions.enabled),(t=>{this._tooltip=t?new Ae.a({view:e}):Object(r.e)(this._tooltip)}),o.e)]),this._refreshManipulators(),this.finishToolCreation()}destroy(){this._tooltip=Object(r.e)(this._tooltip),this._moveManipulation=Object(r.e)(this._moveManipulation),this.graphics.removeAll(),this._set("view",null)}get updating(){return this.updatingHandles.updating}reset(){}_refreshManipulators(){this.handles.removeAll(),this._moveManipulation&&this._moveManipulation.destroy(),this.manipulators.removeAll();const t=this.graphics.toArray().filter((t=>Object(Me.a)(t)===Et.a.SUPPORTED)).map((t=>new ke(t)));t.length&&(this._createManipulators(t),this._createVisualElements(t),this.handles.add(t.map((t=>this.view.trackGraphicState(t.state)))),this._updateMoveManipulation(t))}_createManipulators(t){for(const e of t){const i=e.state;e.manipulationXY=new ye({tool:this,view:this.view,graphicState:i}),e.manipulationXY.forEachManipulator((t=>this.handles.add([t.events.on("immediate-click",(t=>{this.emit("immediate-click",{...t,graphic:i.graphic}),t.stopPropagation()})),t.events.on("grab-changed",(({action:t})=>{const{tooltipOptions:e,_tooltip:i}=this;Object(r.k)(i)||("start"===t?i.info=new De.a({tooltipOptions:e}):i.clear())}))]))),this.handles.add(e.manipulationXY.createDragPipeline(((e,i,a,n)=>this._buildDragEventPipeline(t,je.XY,e,i,a,n))))}this._createMoveManipulation(t)}_createMoveManipulation(t){const e=new _e({tool:this,view:this.view,snapToScene:!1,xyAvailable:!0,xyAxisAvailable:!0,zAvailable:!0,radius:1===t.length?_e.radiusForSymbol(t[0].graphic.symbol):Zt});this._moveManipulation=e,e.elevationInfo={mode:"absolute-height",offset:0},e.forEachManipulator((t=>{this.handles.add(t.events.on("immediate-click",(i=>{e.zManipulation.hasManipulator(t)||1!==this.graphics.length||this.emit("immediate-click",{...i,graphic:this.graphics.getItemAt(0)}),i.stopPropagation()})))}));const i=e=>i=>{this.handles.add(i.events.on("focus-changed",(({action:i})=>{const a=this._tooltip;Object(r.k)(a)||("focus"===i?this._updateMoveTooltip(t,e):a.clear())})))};this._moveManipulation.xyManipulation.forEachManipulator(i(je.XY)),this._moveManipulation.xyAxisManipulation.forEachManipulator(i(je.XY_AXIS)),this._moveManipulation.zManipulation.forEachManipulator(i(je.Z));const a=()=>this._updateMoveManipulation(t);for(const r of t)this.handles.add([r.state.on("changed",a),Object(o.f)((()=>r.state.displaying),a)]);const n=t[t.length-1];this.handles.add(n.state.on("changed",(()=>this._updateMoveManipulationAngle(n)))),this.handles.add(e.createDragPipeline(((e,i,a,n,r)=>this._buildDragEventPipeline(t,e,i,a,n,r)),Object(d.j)(n.graphic),Object(r.t)(n.graphic.geometry).spatialReference,n.graphic)),this._updateMoveManipulationAngle(n)}_createVisualElements(t){for(const e of t){const i=e.graphic,a=Ut({view:this.view,graphic:i,forEachManipulator:t=>{e.manipulationXY.forEachManipulator(t),this._moveManipulation.forEachManipulator(t)},onManipulatorsChanged:()=>Object(n.c)()});Object(r.k)(a)||(e.geometryRepresentation=a.visualElement,e.geometryRepresentation instanceof st&&this.handles.add([e.geometryRepresentation.events.on("attachment-origin-changed",(()=>{e.state.isDraped||this._updateMoveManipulation(t)})),Object(o.f)((()=>e.state.isDraped),(()=>this._updateMoveManipulation(t)))]),this.handles.add(a))}}_updateMoveManipulationAngle(t){this._moveManipulation.angle=ne(t.graphic.geometry)}_updateMoveManipulation(t){const e=Object(Z.j)(0,0,0,this.view.spatialReference);let i=0,a=!1;const n=this._moveManipulation;for(const o of t){if(!o.state.displaying)continue;const t=o.state.graphic;this.enableZ&&Object(Tt.a)(t)&&(a=!0);const n=o.geometryRepresentation instanceof st&&!o.state.isDraped?o.geometryRepresentation.attachmentOrigin:Object(St.g)(this.view,t);Object(r.l)(n)&&(e.x+=n.x,e.y+=n.y,e.z+=n.z,i++)}i>0?(e.x/=i,e.y/=i,e.z/=i,n.location=e,n.xyManipulation.available=!0,n.xyAxisManipulation.available=!0,n.zManipulation.available=a):n.available=!1}_buildDragEventPipeline(t,e,i,a,n,r){const o=[],s=[];let c=null,l=null;const h=()=>{for(const t of o)t.dragging=!1;o.length=0,s.length=0,c=null,l=null,this._moveManipulation.interactive=!0};if(n=n.next((t=>l(t))).next((()=>{if(this.emit("graphic-move-stop",new Pe(s)),this.destroyed)return null;h()})),1===t.length&&e===je.XY){const e=t[0].graphic;a=this._buildSnappingPipelineSteps(e,Object(d.j)(e),a,n,r)}return a.next((e=>{if("start"===e.action){o.length=0,s.length=0;for(const e of t)e.dragging||!e.manipulationXY.hasManipulator(i)&&e.manipulationXY.grabbing||(o.push(e),s.push(e.graphic),e.dragging=!0);if(0!==s.length&&(this._moveManipulation.interactive=!1,c=Object(ie.h)(s,this.view.state.viewingMode),l=Object(ie.j)(s),this.emit("graphic-move-start",new Ie(s)),this.destroyed))return null}return 0!==s.length?e:null})).next((t=>c(t))).next((i=>(this._updateMoveTooltip(t,e,i),i))).next((t=>{switch(t.action){case"start":case"update":if(t.translationX||t.translationY||t.translationZ){const e=this.view.toScreen(t.mapStart),i=this.view.toScreen(t.mapEnd),a=i.x-e.x,n=i.y-e.y;if(this.emit("graphic-move",new Ge(a,n,s)),this.destroyed)return null}break;case"end":if(this.emit("graphic-move-stop",new Pe(s)),this.destroyed)return null;h()}}))}_updateMoveTooltip(t,e,i){const{tooltipOptions:a,_tooltip:n}=this;if(Object(r.k)(n))return;n.clear();const o=0===t.length?"absolute-height":t[0].state.isDraped?"on-the-ground":"absolute-height";switch(e){case je.XY:n.info=new De.a({tooltipOptions:a}),this._updateMoveTooltipDistance(n.info,i,((t,e)=>Object(S.d)(t,e,o)));break;case je.XY_AXIS:n.info=new De.b({tooltipOptions:a}),this._updateMoveTooltipDistance(n.info,i,((t,e)=>{const a=Object(S.d)(t,e,o);return Object(wt.f)(a,re(i))}));break;case je.Z:n.info=new De.c({tooltipOptions:a}),this._updateMoveTooltipDistance(n.info,i,Re.i)}}_updateMoveTooltipDistance(t,e,i){if(Object(r.l)(e)&&"end"!==e.action){const{mapStart:a,mapEnd:n}=e,o=i(a,n);t.distance=Object(r.l)(o)?o:wt.h}}_buildSnappingPipelineSteps(t,e,i,a,n){const o=t.geometry;if(Object(r.k)(o)||"point"!==o.type&&"mesh"!==o.type)return i;const s=("point"===o.type?o:o.anchor).clone(),c=new Ee.a({elevationInfo:e,pointer:n,editGeometryOperations:we.a.fromGeometry(s,this.view.state.viewingMode),visualizer:new k.a,excludeFeature:t}),l=this.snappingManager;return i.next((e=>(s.z=Object(d.d)(this.view,s,Object(d.j)(t),{mode:"absolute-height",offset:0}),{...e,snapOrigin:c.coordinateHelper.pointToVector(s)}))).next(this._snappingPipeline.createSnapDragEventPipelineStep({snappingContext:c,snappingManager:l,cancel:a,updatingHandles:this.updatingHandles}),this._snappingPipeline.next)}get test(){return{tooltip:this._tooltip}}};Object(a.a)([Object(s.b)({constructOnly:!0,nonNullable:!0})],Ce.prototype,"view",void 0),Object(a.a)([Object(s.b)()],Ce.prototype,"graphics",void 0),Object(a.a)([Object(s.b)({constructOnly:!0,nonNullable:!0})],Ce.prototype,"enableZ",void 0),Object(a.a)([Object(s.b)({constructOnly:!0,type:Se.a})],Ce.prototype,"tooltipOptions",void 0),Object(a.a)([Object(s.b)({constructOnly:!0})],Ce.prototype,"snappingManager",void 0),Object(a.a)([Object(s.b)()],Ce.prototype,"type",void 0),Object(a.a)([Object(s.b)()],Ce.prototype,"updating",null),Ce=Object(a.a)([Object(l.a)("esri.views.3d.interactive.editingTools.graphicMove3D.GraphicMoveTool")],Ce);class ke{constructor(t){this.state=null,this.geometryRepresentation=null,this.manipulationXY=null,this.dragging=!1,this.state=new ut({graphic:t})}get graphic(){return this.state.graphic}}var ze=i(716),Ve=i(250),Le=i(45),He=i(176),Ne=i(1465);function Ue(t,e,i){const a="on-the-ground"===i.mode?Ne.b.XY:Ne.b.XYZ;return new Ne.a(t,a,e,0)}function Fe(t,e,i){const a=Object(p.f)();if(!t.renderCoordsHelper.toRenderCoords(e,a))return null;const n=Ze(t,e,Object(Le.q)(i.plane)),o=Ze(t,e,i.edgeDirection);if(Object(r.k)(n)||Object(r.k)(o))return null;const s=Object(h.o)(Object(p.f)(),n,o);return Object(Le.h)(a,s,Object(Le.d)())}function Ze(t,e,i){const a=Object(Z.j)(e.x+i[0],e.y+i[1],e.z+i[2],e.spatialReference),n=Object(p.f)(),r=Object(p.f)();return t.renderCoordsHelper.toRenderCoords(e,n)&&t.renderCoordsHelper.toRenderCoords(a,r)?Object(h.A)(r,n,r):null}var Be=i(932),Xe=i(1371),Ye=i(1168);let We=class extends Ye.a{constructor(t){super(t),this.type="reshape-edge-offset",this.distance=wt.h,this.area=null,this.totalLength=null}};Object(a.a)([Object(s.b)()],We.prototype,"type",void 0),Object(a.a)([Object(s.b)()],We.prototype,"distance",void 0),Object(a.a)([Object(s.b)()],We.prototype,"area",void 0),Object(a.a)([Object(s.b)()],We.prototype,"totalLength",void 0),We=Object(a.a)([Object(l.a)("esri.views.interactive.tooltip.ReshapeEdgeOffsetTooltipInfo")],We);var qe=i(1238),Qe=i(1470);let Je=class extends(L.a.EventedMixin(xt.a)){constructor(t){super(t),this._vertexManipulatorMaterial=Object(St.c)(z.b.colorToVec4(z.b.reshapeManipulators.vertex.color),z.b.reshapeManipulators.vertex.renderOccluded),this._vertexManipulatorOutlineMaterial=Object(St.d)(z.b.colorToVec4(z.b.reshapeManipulators.vertex.outlineColor),z.b.reshapeManipulators.vertex.renderOccluded),this._vertexManipulatorHoverOutlineMaterial=Object(St.d)(z.b.colorToVec4(z.b.reshapeManipulators.vertex.hoverOutlineColor),z.b.reshapeManipulators.vertex.renderOccluded),this._edgeManipulatorMaterial=Object(St.c)(z.b.colorToVec4(z.b.reshapeManipulators.edge.color),z.b.reshapeManipulators.edge.renderOccluded),this._edgeManipulatorOutlineMaterial=Object(St.d)(z.b.colorToVec4(z.b.reshapeManipulators.edge.outlineColor),z.b.reshapeManipulators.edge.renderOccluded),this._edgeOffsetManipulatorMaterial=Object(St.c)(z.b.colorToVec4(z.b.reshapeManipulators.edgeOffset.color),z.b.reshapeManipulators.edgeOffset.renderOccluded,!1),this._edgeOffsetManipulatorHoverMaterial=Object(St.c)(z.b.colorToVec4(z.b.reshapeManipulators.edgeOffset.hoverColor),z.b.reshapeManipulators.edgeOffset.renderOccluded,!1),this._selectedManipulatorMaterial=Object(St.c)(z.b.colorToVec4(z.b.reshapeManipulators.selected.color),z.b.reshapeManipulators.selected.renderOccluded),this._selectedManipulatorOutlineMaterial=Object(St.d)(z.b.colorToVec4(z.b.reshapeManipulators.selected.outlineColor),z.b.reshapeManipulators.selected.renderOccluded),this._selectedManipulatorHoverOutlineMaterial=Object(St.d)(z.b.colorToVec4(z.b.reshapeManipulators.selected.hoverOutlineColor),z.b.reshapeManipulators.selected.renderOccluded),this._selectedIndex=0,this._vertexManipulatorGeometry=null,this._vertexManipulatorOutlineGeometry=null,this._edgeManipulatorGeometry=null,this._edgeManipulatorOutlineGeometry=null,this._edgeOffsetManipulatorGeometryInside=null,this._edgeOffsetManipulatorGeometryOutside=null,this._manipulatorHandles=new qt.a,this._manipulatorInfos=[],this._editGeometryOperations=null,this._numGrabbing=0,this._numDragging=0,this._reshapeEventState=ai.NONE,this._outlineVisualElement=null,this._segmentLabels=null,this.outputGeometry=null,this._snappingPipeline=new Te.a,this._snappingPipelineHandle=new Te.a,this._vertexLaserLineVisualElement=null}initialize(){const{graphic:t,view:e}=this,i=this._graphicState=new ut({graphic:t});this._tooltip=new Ae.a({view:e}),this.addHandles([Object(o.f)((()=>i.displaying),(t=>{for(const e of this._manipulatorInfos)e.manipulator.available=t})),Object(o.f)((()=>({labels:this._segmentLabels,enabled:this._labelOptions.enabled,edgeOffsetEnabled:this.enableEdgeOffset})),(({labels:t,enabled:e,edgeOffsetEnabled:i})=>{Object(r.l)(t)&&(t.visible=e,t.edgeDistance=i?"far":"default")}),o.a),Object(o.g)((()=>!this._tooltipOptions.enabled),(()=>this._tooltip.clear()),o.a),this.view.trackGraphicState(i)])}destroy(){this._segmentLabels=Object(r.e)(this._segmentLabels),this._tooltip=Object(r.e)(this._tooltip),this._removeManipulators()}get inputGeometry(){return Object(r.l)(this._editGeometryOperations)?this._editGeometryOperations.data.geometry:null}set inputGeometry(t){this._recreateEditGeometryAndManipulators(t)}get updating(){return this.updatingHandles.updating}get manipulators(){return this.tool.manipulators}get view(){return this.tool.view}get graphic(){return this.tool.graphic}get enableZShape(){return this.tool.enableZShape}get enableZVertex(){return this.tool.enableZVertex}get enableMoveGraphic(){return this.tool.enableMoveGraphic}get enableMidpoints(){return this.tool.enableMidpoints}get enableEdgeOffset(){return this.tool.enableEdgeOffset}get _labelOptions(){return this.tool.labelOptions}get _tooltipOptions(){return this.tool.tooltipOptions}removeSelectedVertices(){const t=this._manipulatorInfos.filter((t=>t.manipulator.selected&&"vertex"===t.type));this._removeVertices(t)}onManipulatorSelectionChanged(){this.emit("manipulators-changed")}_removeManipulators(){this._manipulatorHandles.removeAll(),this._moveManipulation=Object(r.e)(this._moveManipulation),this._graphicMoveManipulation=Object(r.e)(this._graphicMoveManipulation),this.manipulators.removeAll(),this._manipulatorInfos=[],this._numGrabbing=0,this._numDragging=0}_createManipulators(){if(Object(r.k)(this._editGeometryOperations))return;const t=Object(d.j)(this.graphic);for(const e of this._editGeometryOperations.data.components){for(const i of e.vertices)this._createVertexOrEdgeManipulator(i,t);for(const i of e.edges)this._createVertexOrEdgeManipulator(i,t)}this._createGraphicMoveManipulation(),this._createMoveManipulation(t),this._createVisualElements()}get canRedo(){return Object(r.l)(this._editGeometryOperations)&&this._editGeometryOperations.canRedo}get canUndo(){return Object(r.l)(this._editGeometryOperations)&&this._editGeometryOperations.canUndo}redo(){if(Object(r.k)(this._editGeometryOperations))return null;const t=this._editGeometryOperations.redo();return Object(r.l)(t)&&(this.outputGeometry=this._editGeometryOperations.data.geometry,this._recreateManipulators()),t}undo(){if(Object(r.k)(this._editGeometryOperations))return null;this.emit("undo");const t=this._editGeometryOperations.undo();return Object(r.l)(t)&&(this.outputGeometry=this._editGeometryOperations.data.geometry,this._recreateManipulators()),t}_recreateManipulators(){this._removeManipulators(),this._tooltip.clear(),this._createManipulators()}_recreateEditGeometryAndManipulators(t=this.inputGeometry){this._removeManipulators(),this._tooltip.clear(),Object(r.k)(t)||(Object(r.e)(this._editGeometryOperations),this._editGeometryOperations=we.a.fromGeometry(t,this.view.state.viewingMode),this._createManipulators(),Object(r.e)(this._segmentLabels),this._segmentLabels=new P({context:{view:this.view,editGeometryOperations:this._editGeometryOperations,elevationInfo:Object(d.j)(this.graphic),labelOptions:this._labelOptions,graphic:this.graphic,graphicState:this._graphicState},visible:this._labelOptions.enabled}))}_perGraphicManipulatorDragAction(t,e){if("end"===e.action)return e;let i=0;const a=[],n=this._manipulatorInfos.some((t=>"vertex"===t.type&&t.manipulator.selected)),r=t===ni.SELECTED_OR_ALL&&n;for(const o of this._manipulatorInfos)"vertex"===o.type&&(o.manipulator.grabbing||r&&!o.manipulator.selected||a.push(o),i++);if(0===a.length)return e;if(this._moveVertices(a,e),a.length===i){if(this._updateEventState(ai.MOVING),this.destroyed)return e;this.emit("move",{type:"move",dx:e.screenDeltaX,dy:e.screenDeltaY,mover:this.graphic})}else{if(this._updateEventState(ai.RESHAPING),this.destroyed)return e;this.emit("reshape",{type:"reshape",mover:this.graphic})}return e}_isMultiVertexSelection(){let t=0;for(const e of this._manipulatorInfos)"vertex"===e.type&&e.manipulator.selected&&t++;return t>1}_perVertexManipulatorDragAction(t){if(this._updateEventState(ai.RESHAPING),this.destroyed)return;const{mapDeltaX:e,mapDeltaY:i,mapDeltaZ:a}=t;if(!e&&!i&&!a)return;const n=[];for(const r of this._manipulatorInfos)"vertex"===r.type&&(r.manipulator.selected&&!r.manipulator.grabbing||r===t.info)&&n.push(r);this._moveVertices(n,t,Xe.a.ACCUMULATE_STEPS),this.emit("reshape",{type:"reshape",mover:this.graphic})}_updateEventState(t){if(t===this._reshapeEventState)return!1;switch(t){case ai.NONE:if(0!==this._numGrabbing||0!==this._numDragging)return!1;switch(this._reshapeEventState){case ai.MOVING:this.emit("move",{type:"move-stop",dx:0,dy:0,mover:this.graphic});break;case ai.RESHAPING:this.emit("reshape",{type:"reshape-stop",mover:this.graphic})}break;case ai.MOVING:switch(this._reshapeEventState){case ai.NONE:this.emit("move",{type:"move-start",dx:0,dy:0,mover:this.graphic});break;case ai.RESHAPING:this.emit("reshape",{type:"reshape-stop",mover:this.graphic}),this.destroyed||this.emit("move",{type:"move-start",dx:0,dy:0,mover:this.graphic})}break;case ai.RESHAPING:switch(this._reshapeEventState){case ai.NONE:this.emit("reshape",{type:"reshape-start",mover:this.graphic});break;case ai.MOVING:this.emit("move",{type:"move-stop",dx:0,dy:0,mover:this.graphic}),this.destroyed||this.emit("reshape",{type:"reshape-start",mover:this.graphic})}}if(this.destroyed)return!1;const e=this._reshapeEventState!==t;return this._reshapeEventState=t,e}_createGraphicMoveManipulation(){const{tool:t,view:e}=this,i=this._graphicState;if(this._graphicMoveManipulation=new ye({tool:t,view:e,graphicState:i}),this.enableMoveGraphic){let t=null;this._manipulatorHandles.add(this._graphicMoveManipulation.createDragPipeline(((e,i,a)=>{i.next((t=>this._trackNumDragging(t))).next((e=>("start"===e.action&&(t=Object(r.t)(this._editGeometryOperations).createUndoGroup()),e))).next((t=>this._perGraphicManipulatorDragAction(ni.ALL,t))).next((t=>(this._updateTranslateGraphicTooltip(je.XY,t),t))).next((e=>{"end"===e.action&&(this._tooltip.clear(),t=Object(r.s)(t))})),a.next((()=>this._onDragCancel(!0,(()=>t=Object(r.s)(t)))))}))),this._graphicMoveManipulation.forEachManipulator((t=>this._manipulatorHandles.add(this._watchAndUpdateGrabState(t,!1))))}else this._graphicMoveManipulation.forEachManipulator((t=>{t.grabbable=!1,t.cursor=null}));this._graphicMoveManipulation.forEachManipulator((t=>this._manipulatorHandles.add(t.events.on("immediate-click",(t=>{this._manipulatorInfos.some((t=>t.manipulator.selected))?this._clearSelection():this.emit("immediate-click",{...t,graphic:this.graphic}),t.stopPropagation()})))))}_createMoveManipulation(t){const{graphic:e,handles:i,tool:a,view:n}=this,s=this._graphicState;this._moveManipulation=new _e({tool:a,view:n,xyAvailable:!0,xyAxisAvailable:!0,zAvailable:this.enableZShape&&Object(Tt.a)(e),snapToScene:!1,radius:_e.radiusForSymbol(e.symbol)}),this._moveManipulation.forEachManipulator((t=>i.add([t.events.on("immediate-click",(i=>{this._moveManipulation.zManipulation.hasManipulator(t)||this._manipulatorInfos.some((t=>t.manipulator.selected))||this.emit("immediate-click",{...i,graphic:e}),i.stopPropagation()})),this._watchAndUpdateGrabState(t,!1)])));const c=t=>e=>{i.add(e.events.on("focus-changed",(({action:e})=>{"focus"===e&&this._tooltipOptions.enabled?this._updateTranslateTooltip(t):this._tooltip.clear()})))};this._moveManipulation.xyManipulation.forEachManipulator(c(je.XY)),this._moveManipulation.xyAxisManipulation.forEachManipulator(c(je.XY_AXIS)),this._moveManipulation.zManipulation.forEachManipulator(c(je.Z)),this._moveManipulation.elevationInfo={mode:"absolute-height",offset:0};const l=Object(r.t)(e.geometry).spatialReference;i.add([this._moveManipulation.createDragPipeline(((i,n,o,s,c)=>(s=s.next((t=>(this._onDragCancel(),t))),o.next((t=>this._trackNumDragging(t))).next((t=>{const e=this._manipulatorInfos.filter((t=>"vertex"===t.type&&t.manipulator.selected));return t.manipulatorType===vt.TRANSLATE_XY&&1===e.length?{...t,info:e[0],snapOrigin:e[0].handle.pos}:t})).next(Object(ie.l)(this.view,t,e)).next(this._snappingPipelineHandle.createSnapDragEventPipelineStep({predicate:t=>!!t.info,cancel:s,snappingManager:a.snappingManager,snappingContext:new Ee.a({editGeometryOperations:Object(r.t)(this._editGeometryOperations),elevationInfo:t,pointer:c,excludeFeature:e,visualizer:new k.a}),updatingHandles:this.updatingHandles,useZ:!1}),this._snappingPipelineHandle.next).next(Object(ie.b)()).next((t=>this._perGraphicManipulatorDragAction(ni.SELECTED_OR_ALL,t))).next((t=>(this._updateTranslateTooltip(i,t),t))))),t,l,e),Object(o.f)((()=>s.displaying),(()=>{this._updateMoveManipulationPosition()}),o.a),s.on("changed",(()=>this._updateMoveManipulationPosition())),Object(o.f)((()=>s.isDraped),(t=>{this._updateMoveManipulationPosition();const e="align-move-manipulation";t?i.add(this.view.elevationProvider.on("elevation-change",(()=>this._updateMoveManipulationPosition())),e):i.remove(e)}),o.a)])}_createVisualElements(){const{graphic:t,view:e}=this,i=Ut({view:e,graphic:t,forEachManipulator:t=>{if(!this.destroyed){this._graphicMoveManipulation.forEachManipulator(t),this._moveManipulation.forEachManipulator(t);for(const e of this._manipulatorInfos)t(e.manipulator,vt.TRANSLATE_XY)}},onManipulatorsChanged:t=>this.on("manipulators-changed",t)});Object(r.l)(i)&&(this._outlineVisualElement=i.visualElement instanceof st?i.visualElement:null),Object(r.l)(this._outlineVisualElement)&&this._manipulatorHandles.add(this._outlineVisualElement.events.on("attachment-origin-changed",(()=>{this._graphicState.isDraped||this._updateMoveManipulationPosition()}))),this._manipulatorHandles.add(i)}_createEdgeOffsetManipulator(t,e=Object(d.j)(this.graphic)){const i=z.b.reshapeManipulators.edgeOffset,a=i.size/2,o=a+i.collisionPadding;if(Object(r.k)(this._edgeOffsetManipulatorGeometryInside)||Object(r.k)(this._edgeOffsetManipulatorGeometryOutside)){const t=a/o,e=t*Math.sqrt(3)/2;this._edgeOffsetManipulatorGeometryInside=Object(oe.f)(e,t/2,t/2,i.height,i.offset),this._edgeOffsetManipulatorGeometryOutside=Object(oe.f)(-e,t/2,t/2,i.height,-i.offset)}const s=[{geometry:this._edgeOffsetManipulatorGeometryInside,material:this._edgeOffsetManipulatorMaterial,stateMask:ce.c.Unfocused},{geometry:this._edgeOffsetManipulatorGeometryInside,material:this._edgeOffsetManipulatorHoverMaterial,stateMask:ce.c.Focused},{geometry:this._edgeOffsetManipulatorGeometryOutside,material:this._edgeOffsetManipulatorMaterial,stateMask:ce.c.Unfocused},{geometry:this._edgeOffsetManipulatorGeometryOutside,material:this._edgeOffsetManipulatorHoverMaterial,stateMask:ce.c.Focused}],c=new Dt.a({view:this.view,renderObjects:s,elevationInfo:"on-the-ground"!==e.mode||Object(He.i)(this.graphic.symbol)?{mode:"absolute-height",offset:0}:e,worldOriented:!1,focusMultiplier:1,radius:o,available:!(!this.graphic.visible||!this.graphic.layer.visible),collisionType:{type:"disc",direction:Object(p.h)(0,0,1)},collisionPriority:1,metadata:{deleting:!1}}),l=new Dt.a({view:this.view,renderObjects:[],worldSized:!0,worldOriented:!1,available:!(!this.graphic.visible||!this.graphic.layer.visible),collisionPriority:-10,cursor:this.enableMoveGraphic?"move":"default",metadata:{deleting:!1}}),h={manipulator:c,handle:t,locationUpdateHandle:null,type:"edge",selectedIndex:0,edgeManipulator:l,elevationInfo:e,visibilityHandle:null};this._autoHideEdgeOffsetManipulator(h,i.minSquaredEdgeLength),this._updateEdgeOffsetManipulator(h);const u=[];for(const n of[h.handle.leftVertex,h.handle.rightVertex]){const t=this._getManipulatorInfoFromHandle(n);Object(r.l)(t)&&u.push(t.manipulator.events.on("location-update",(()=>this._updateEdgeOffsetManipulator(h))))}h.locationUpdateHandle=Object(n.b)(u),this._manipulatorHandles.add(h.locationUpdateHandle,c),this._manipulatorHandles.add([this._watchAndUpdateGrabState(c,!0),this._watchAndUpdateGrabState(l,!0)],c),this._manipulatorHandles.add(Object(ie.e)(c,this._createEdgeOffsetPipeline(h,e)),c),this._manipulatorHandles.add(Object(ie.e)(l,((t,i,a,n)=>{if("touch"===n)this._createEdgeOffsetPipeline(h,e)(t,i,a);else if(this.enableMoveGraphic){const n=this.graphic,o=Object(r.l)(n.geometry)?n.geometry.spatialReference:null;i.next((t=>this._trackNumDragging(t))).next(Object(ie.f)(this.view,t.elevationAlignedLocation)).next(Object(ee.d)(this.view,t.elevationAlignedLocation,e,o,n)).next(Object(ie.c)()).next(Object(ie.b)()).next((t=>this._perGraphicManipulatorDragAction(ni.ALL,t))).next((t=>(this._updateTranslateGraphicTooltip(je.XY,t),t))).next((t=>{"end"===t.action&&this._tooltip.clear()})),a.next((()=>this._onDragCancel(!t.metadata.deleting)))}})),c);const b=t=>{this._manipulatorInfos.some((t=>t.manipulator.selected))?this._clearSelection():this.emit("immediate-click",{...t,graphic:this.graphic}),t.stopPropagation()};return this._manipulatorHandles.add([c.events.on("immediate-click",b),l.events.on("immediate-click",b),c.events.on("focus-changed",(({action:t})=>{const e=this._tooltipOptions;if("focus"===t&&e.enabled){const t=this._tooltip.info=new We({tooltipOptions:e});this._updateTooltipAreaOrTotalLength(t)}else this._tooltip.clear()}))],c),this._manipulatorInfos.push(h),this.manipulators.add(c),this.manipulators.add(l),this.emit("manipulators-changed"),h}_autoHideEdgeOffsetManipulator(t,e){const i=t.manipulator,a=t.edgeManipulator,o=()=>{t.visibilityHandle=Object(r.s)(t.visibilityHandle);const o=this._getManipulatorInfoFromHandle(t.handle.leftVertex),s=this._getManipulatorInfoFromHandle(t.handle.rightVertex),c=Object(r.l)(o)&&Object(r.l)(s)&&function(t,e,i){const a=i.projectToRenderScreen(t,Object(b.e)()),n=i.projectToRenderScreen(e,Object(b.e)());return Object(r.l)(a)&&Object(r.l)(n)?Object(h.y)(Object(h.k)(a,a,n)):0}(o.manipulator.renderLocation,s.manipulator.renderLocation,this.view.state.camera)<e;(!i.focused&&!a.focused||c)&&(i.grabbable=!c,a.grabbable=!c,t.visibilityHandle=Object(n.b)([i.disableDisplay(),{remove:()=>{i.grabbable=!0,a.grabbable=this.enableMoveGraphic}}]))};this._manipulatorHandles.add([i.events.on("focus-changed",o),a.events.on("focus-changed",o),{remove:()=>{Object(r.s)(t.visibilityHandle),a.metadata.deleting=!0,this.manipulators.remove(a)}}],i),o()}_updateEdgeOffsetManipulator(t){this._updateManipulatorPosition(t);const{coordinateHelper:e}=Object(r.t)(this._editGeometryOperations).data,i=Fe(this.view,t.manipulator.elevationAlignedLocation,Ue(e,t.handle,Object(r.t)(t.manipulator.elevationInfo))),a=this._getManipulatorInfoFromHandle(t.handle.leftVertex),n=this._getManipulatorInfoFromHandle(t.handle.rightVertex);if(Object(r.k)(a)||Object(r.k)(n))return;const o=a.manipulator.renderLocation,s=n.manipulator.renderLocation,c=Object(r.l)(i)?function(t,e,i){const a=Object(Le.q)(t),n=Object(h.A)(Object(p.f)(),e,i),r=Object(h.o)(Object(p.f)(),n,a),o=Object(h.o)(Object(p.f)(),n,r);return Object($t.e)(n[0],n[1],n[2],0,r[0],r[1],r[2],0,o[0],o[1],o[2],0,0,0,0,1)}(i,o,s):$t.a;t.manipulator.modelTransform=c,t.edgeManipulator.elevationAlignedLocation=t.manipulator.elevationAlignedLocation,t.edgeManipulator.modelTransform=c;const l=Object(h.u)(Object(h.k)(ti,o,s))/2;t.edgeManipulator.collisionType={type:"line",paths:[[[-l,0,0],[l,0,0]]]}}_createEdgeOffsetPipeline(t,e){return(i,a,n)=>{this._clearSelection();const{step:o,cleanup:s}=this._initializeEdgeOffset(t,e);a.next((t=>this._trackNumDragging(t))).next(Object(ie.f)(this.view,i.elevationAlignedLocation)).next(o).next(Object(ee.h)(this.view)).next(Object(ee.a)(this.view,Object(r.t)(this._editGeometryOperations).data.spatialReference)).next(Object(ie.b)()).next(this._applyComputeEdgeOffsetDistanceStep()).next(this._applyEdgeOffsetStep(t)).next(this._showEdgeOffsetTooltip()).next((t=>{"end"===t.action&&s()})),n.next((()=>{i.metadata.deleting||(s(),this._onDragCancel())}))}}_initializeEdgeOffset(t,e){const i=Object(r.t)(this._editGeometryOperations),a=Ue(i.data.coordinateHelper,t.handle,e),s=i.createUndoGroup(),c=Fe(this.view,t.manipulator.elevationAlignedLocation,a);if(a.requiresSplitEdgeLeft){const e=this._getManipulatorInfoFromHandle(t.handle.leftVertex.leftEdge);Object(r.l)(e)&&this._splitEdgeManipulator(e,1)}if(a.requiresSplitEdgeRight){const e=this._getManipulatorInfoFromHandle(t.handle.rightVertex.rightEdge);Object(r.l)(e)&&this._splitEdgeManipulator(e,0)}const l=()=>new Ve.a({paths:[[t.handle.leftVertex.pos,t.handle.rightVertex.pos]],spatialReference:i.data.spatialReference}),h=new st({view:this.view,isDraped:this._graphicState.isDraped,geometry:l(),elevationInfo:t.elevationInfo,width:z.b.visualElements.lineGraphics.outline.width,color:z.b.colorToVec4(z.a.main),attached:!0});let p;const d=()=>{this._cleanEdgeOffsetCollapsedEdges(t),p=Object(r.s)(p)},u=this.on("undo",d);return p=Object(n.b)([Object(n.a)(h),Object(o.f)((()=>this._graphicState.isDraped),(t=>h.isDraped=t)),this._graphicState.on("changed",(()=>h.geometry=l())),s,u]),{step:t=>Object(r.k)(a)||Object(r.k)(c)?(d(),null):{...t,operation:a,plane:c},cleanup:d}}_applyEdgeOffsetStep(t){return e=>{if(this.destroyed||Object(r.k)(e.operation))return e;this._updateEventState(ai.RESHAPING);const{mapDeltaX:i,mapDeltaY:a,mapDeltaZ:n}=e;return(i||a||n)&&(this._offsetEdge(t,e),this.emit("reshape",{type:"reshape",mover:this.graphic})),e}}_applyComputeEdgeOffsetDistanceStep(){return t=>{const{operation:e,mapEnd:i}=t;return Object(r.k)(e)||Object(r.k)(i)?t:("start"===t.action&&e.selectArrowFromStartPoint(i),{...t,signedDistance:e.signedDistanceToPoint(i)})}}_showEdgeOffsetTooltip(){return t=>{const{mapEnd:e,signedDistance:i,operation:a}=t,n=this._tooltip,o=this._tooltipOptions;if(!o.enabled||Object(r.k)(i))return n.clear(),t;let s=n.info;(Object(r.k)(s)||"reshape-edge-offset"!==s.type)&&(s=n.info=new We({tooltipOptions:o}));const{coordinateHelper:c}=Object(r.t)(this._editGeometryOperations).data;return s.distance="end"===t.action?wt.h:function(t,e,i,a,n){if(t){const t=n.toXYZ(n.pointToVector(i)),o=Object(Le.r)(a,t,te.d.get()),s=Object(Qe.a)(o,t,n.spatialReference);if(Object(r.l)(s))return Object(wt.c)(s.value*Math.sign(e),s.unit)}return Object(wt.c)(e*Object(f.f)(i.spatialReference),"meters")}(this._graphicState.isDraped,i*a.selectedArrow,e,a.plane,c),this._updateTooltipAreaOrTotalLength(s),t}}_cleanEdgeOffsetCollapsedEdges(t){var e,i;const a=null==(e=t.handle.leftVertex.leftEdge)?void 0:e.leftVertex,n=t.handle.leftVertex,o=null==(i=t.handle.rightVertex.rightEdge)?void 0:i.rightVertex,s=t.handle.rightVertex,c=Object(r.t)(this._editGeometryOperations).data.coordinateHelper,l=[];if(a&&c.distance(a.pos,n.pos)<ei){const t=this._getManipulatorInfoFromHandle(n);Object(r.l)(t)&&l.push(t)}if(c.distance(n.pos,s.pos)<ei||o&&c.distance(o.pos,s.pos)<ei){const t=this._getManipulatorInfoFromHandle(s);Object(r.l)(t)&&l.push(t)}l.length&&this._removeVertices(l)}_computeVertexManipulatorSizeAndOutline(t){const e=t.size/2,i=e+t.collisionPadding;return{size:e/i,outlineSize:(e+t.outlineSize)/i}}_createVertexOrEdgeManipulator(t,e=Object(d.j)(this.graphic)){if("edge"===t.type){if(this.enableEdgeOffset)return this._createEdgeOffsetManipulator(t,e);if(!this.enableMidpoints)return null}if(Object(r.k)(this._vertexManipulatorGeometry)||Object(r.k)(this._vertexManipulatorOutlineGeometry)){const{size:t,outlineSize:e}=this._computeVertexManipulatorSizeAndOutline(z.b.reshapeManipulators.vertex);this._vertexManipulatorGeometry=Object(oe.k)(t,16,16),this._vertexManipulatorOutlineGeometry=Object(oe.k)(e,16,16)}if(Object(r.k)(this._edgeManipulatorGeometry)||Object(r.k)(this._edgeManipulatorOutlineGeometry)){const{size:t,outlineSize:e}=this._computeVertexManipulatorSizeAndOutline(z.b.reshapeManipulators.edge);this._edgeManipulatorGeometry=Object(oe.k)(t,16,16),this._edgeManipulatorOutlineGeometry=Object(oe.k)(e,16,16)}const i=Object(r.l)(this.graphic.geometry)&&"point"===this.graphic.geometry.type?[]:[{geometry:this._vertexManipulatorGeometry,material:this._vertexManipulatorMaterial,stateMask:ii.Vertex|ce.c.Unselected},{geometry:this._vertexManipulatorOutlineGeometry,material:this._vertexManipulatorOutlineMaterial,stateMask:ii.Vertex|ce.c.Unfocused|ce.c.Unselected},{geometry:this._vertexManipulatorOutlineGeometry,material:this._vertexManipulatorHoverOutlineMaterial,stateMask:ii.Vertex|ce.c.Focused|ce.c.Unselected},{geometry:this._vertexManipulatorGeometry,material:this._selectedManipulatorMaterial,stateMask:ce.c.Selected},{geometry:this._vertexManipulatorOutlineGeometry,material:this._selectedManipulatorOutlineMaterial,stateMask:ce.c.Selected|ce.c.Unfocused},{geometry:this._vertexManipulatorOutlineGeometry,material:this._selectedManipulatorHoverOutlineMaterial,stateMask:ce.c.Selected|ce.c.Focused}];this.enableMidpoints&&i.push({geometry:this._edgeManipulatorGeometry,material:this._vertexManipulatorMaterial,stateMask:ii.Edge|ce.c.Focused|ce.c.Unselected},{geometry:this._edgeManipulatorOutlineGeometry,material:this._vertexManipulatorHoverOutlineMaterial,stateMask:ii.Edge|ce.c.Focused|ce.c.Unselected},{geometry:this._edgeManipulatorGeometry,material:this._edgeManipulatorMaterial,stateMask:ii.Edge|ce.c.Unfocused|ce.c.Unselected},{geometry:this._edgeManipulatorOutlineGeometry,material:this._edgeManipulatorOutlineMaterial,stateMask:ii.Edge|ce.c.Unfocused|ce.c.Unselected});const a=new Dt.a({view:this.view,renderObjects:i,elevationInfo:e,focusMultiplier:1,touchMultiplier:1,available:!(!this.graphic.visible||!this.graphic.layer.visible),metadata:{deleting:!1}});this._setTypeSpecificManipulatorSettings(a,t,e);const o="edge"===t.type?{manipulator:a,handle:t,locationUpdateHandle:null,type:"edge",selectedIndex:0}:{manipulator:a,handle:t,type:"vertex",selectedIndex:0};if(this._manipulatorInfos.push(o),this.manipulators.add(a),this._updateManipulatorPosition(o),"edge"===o.type){const t=[];for(const e of[o.handle.leftVertex,o.handle.rightVertex]){const i=this._getManipulatorInfoFromHandle(e);Object(r.l)(i)&&t.push(i.manipulator.events.on("location-update",(()=>this._updateManipulatorPosition(o))))}o.locationUpdateHandle=Object(n.b)(t),this._manipulatorHandles.add(o.locationUpdateHandle,a)}this._manipulatorHandles.add(this._watchAndUpdateGrabState(a,!0),a);const s=Object(ie.e)(a,((t,i,a,n)=>{let s=null;a=a.next((e=>(this._onDragCancel(!t.metadata.deleting,(()=>s=Object(r.s)(s))),e))),i.next((t=>this._trackNumDragging(t))).next((t=>{if("start"===t.action&&(s=Object(r.t)(this._editGeometryOperations).createUndoGroup()),"edge"===o.type){const e=this._splitEdgeManipulator(o);return{...t,info:e,snapOrigin:e.handle.pos}}return{...t,info:o,snapOrigin:o.handle.pos}})).next(Object(ie.f)(this.view,t.elevationAlignedLocation)).next(Object(ee.f)(this.view,this.graphic,t.elevationAlignedLocation,t.location.spatialReference,this.graphic)).next(Object(ie.l)(this.view,e,this.graphic)).next(this._snappingPipeline.createSnapDragEventPipelineStep({predicate:()=>!this._isMultiVertexSelection(),cancel:a,snappingManager:this.tool.snappingManager,snappingContext:new Ee.a({editGeometryOperations:Object(r.t)(this._editGeometryOperations),elevationInfo:e,pointer:n,excludeFeature:this.graphic,visualizer:new k.a}),updatingHandles:this.updatingHandles,useZ:!1}),this._snappingPipeline.next).next(Object(ie.b)()).next((e=>{this._perVertexManipulatorDragAction(e),"end"===e.action&&(s=Object(r.s)(s)),this._updateTranslateVertexTooltip(t,je.XY,e)}))}));return this._manipulatorHandles.add([s,a.events.on("immediate-click",(t=>this._manipulatorClickCallback(t,o))),a.events.on("select-changed",(()=>{o.selectedIndex=++this._selectedIndex,this._updateMoveManipulationPosition()})),a.events.on("focus-changed",(({action:t})=>{"focus"===t&&"edge"!==o.type?this._updateTranslateVertexTooltip(a,je.XY):this._tooltip.clear()}))],a),this.emit("manipulators-changed"),o}_trackNumDragging(t){switch(t.action){case"start":this._numDragging++;break;case"end":this._numDragging--}return t}_onDragCancel(t=!0,e){switch(this._numDragging--,t&&(this.undo(),this.outputGeometry=Object(r.l)(this._editGeometryOperations)?this._editGeometryOperations.data.geometry:null),Object(r.l)(this.tool.snappingManager)&&this.tool.snappingManager.doneSnapping(),this._tooltip.clear(),this._reshapeEventState){case ai.NONE:break;case ai.MOVING:this.emit("move",{type:"move",dx:0,dy:0,mover:this.graphic});break;case ai.RESHAPING:this.emit("reshape",{type:"reshape",mover:this.graphic})}e&&e(),this.destroyed||this._updateEventState(ai.NONE)}_setTypeSpecificManipulatorSettings(t,e,i){switch(e.type){case"vertex":t.state=ii.Vertex,t.selectable=!0,t.cursor="move",t.collisionPriority=2,t.radius=z.b.reshapeManipulators.vertex.size/2+z.b.reshapeManipulators.vertex.collisionPadding,t.elevationInfo=i,t.interactive=Object(r.l)(this.graphic.geometry)&&"point"!==this.graphic.geometry.type;break;case"edge":t.state=ii.Edge,t.selectable=!1,t.cursor="copy",t.collisionPriority=-1,t.radius=z.b.reshapeManipulators.edge.size/2+z.b.reshapeManipulators.edge.collisionPadding,t.elevationInfo="on-the-ground"!==i.mode||Object(He.i)(this.graphic.symbol)?{mode:"absolute-height",offset:0}:i}}_watchAndUpdateGrabState(t,e){return t.events.on("grab-changed",(i=>this._onGrabStateChanged(t,e,i.action,i.pointerType)))}_onGrabStateChanged(t,e,i,a="mouse"){if("start"===i)e&&this._updateSelection(t),this._numGrabbing++;else if(this._numGrabbing--,this._updateEventState(ai.NONE),this.destroyed)return;this._moveManipulation.interactive=!this._numGrabbing,("touch"!==a||this.enableEdgeOffset)&&(this._manipulatorInfos.forEach((t=>{t.manipulator.interactive=t.manipulator.grabbing||!this._numGrabbing&&Object(r.l)(this.graphic.geometry)&&"point"!==this.graphic.geometry.type,"edgeManipulator"in t&&(t.edgeManipulator.interactive=t.edgeManipulator.grabbing||!this._numGrabbing)})),this._graphicMoveManipulation.forEachManipulator((t=>{t.interactive=t.grabbing||!this._numGrabbing})))}_clearSelection(){for(const t of this._manipulatorInfos)t.manipulator.grabbing||(t.manipulator.selected=!1)}_updateSelection(t){t.grabbing&&!t.selected&&t.selectable&&(this._clearSelection(),t.selected=!0,this.emit("manipulators-changed"))}_removeManipulator(t){Object(r.k)(t)||(t.manipulator.metadata.deleting=!0,this.manipulators.remove(t.manipulator),this._manipulatorHandles.remove(t.manipulator),Object(c.k)(this._manipulatorInfos,t),this.emit("manipulators-changed"))}_getManipulatorInfoFromHandle(t){if(t)for(const e of this._manipulatorInfos)if(t===e.handle)return e;return null}_updateManipulatorPosition(t){if(Object(r.k)(t))return;const e=Object(r.t)(this._editGeometryOperations);if("vertex"===t.type)t.manipulator.location=e.data.coordinateHelper.vectorToDehydratedPoint(t.handle.pos,$e),t.manipulator.grabbing&&Object(r.l)(this._vertexLaserLineVisualElement)&&(this._vertexLaserLineVisualElement.visualElement.intersectsWorldUpAtLocation=t.manipulator.renderLocation);else if("edge"===t.type){const i=this._getManipulatorInfoFromHandle(t.handle.leftVertex),a=this._getManipulatorInfoFromHandle(t.handle.rightVertex);if(Object(r.k)(i)||Object(r.k)(a))return;const n=i.manipulator,o=a.manipulator;if(Object(r.l)(t.manipulator.elevationInfo)&&"on-the-ground"===t.manipulator.elevationInfo.mode){const i=n.location,a=o.location,r=.5,s=i.x+r*(a.x-i.x),c=i.y+r*(a.y-i.y),l=i.hasZ&&a.hasZ?0:void 0;t.manipulator.location=Object(Z.j)(s,c,l,e.data.spatialReference)}else Object(h.q)(ti,n.renderLocation,o.renderLocation,.5),t.manipulator.renderLocation=ti}}_splitEdgeManipulator(t,e=.5){const i=Object(r.t)(this._editGeometryOperations),a=Object(r.t)(i.splitEdge(t.handle,e).createdVertex);t.locationUpdateHandle.remove(),t.locationUpdateHandle=void 0;const n=Object(d.j)(this.graphic);let o;this.enableEdgeOffset?(this._removeManipulator(t),o=this._createVertexOrEdgeManipulator(a)):(o=t,o.handle=a,o.type="vertex",this._setTypeSpecificManipulatorSettings(t.manipulator,t.handle,n)),a.leftEdge&&this._createVertexOrEdgeManipulator(a.leftEdge),a.rightEdge&&this._createVertexOrEdgeManipulator(a.rightEdge),this.outputGeometry=i.data.geometry,this._updateManipulatorPosition(o),this.enableEdgeOffset||this._updateTranslateVertexTooltip(o.manipulator,je.XY),this._updateSelection(t.manipulator);const s=this._updateEventState(ai.RESHAPING),c=i.data.coordinateHelper.vectorToArray(o.handle.pos),l=i.data.components.indexOf(a.component);return this.emit("vertex-add",{type:"vertex-add",vertices:[{coordinates:c,componentIndex:l,vertexIndex:Object(r.t)(a.index)}],added:c}),s&&this._updateEventState(ai.NONE),o}_updateMoveManipulationPosition(){const t=Object(h.B)(ti,0,0,0);let e=0,i=!1,a=null,n=null;for(const o of this._manipulatorInfos)"vertex"===o.type&&(o.manipulator.selected?(e++,Object(h.j)(t,t,o.manipulator.renderLocation),Object(r.k)(a)||o.selectedIndex>a.selectedIndex?(n=a,a=o):(Object(r.k)(n)||o.selectedIndex>n.selectedIndex)&&(n=o)):i=!0);if(0!==e){const t=this._graphicState.displaying;this._moveManipulation.xyManipulation.available=t,this._moveManipulation.xyAxisManipulation.available=t,this._moveManipulation.zManipulation.available=t&&this.enableZVertex&&Object(Tt.a)(this.graphic),this._moveManipulation.xyAxisManipulation.orthogonalAvailable=t&&1!==e}else{const t=this._graphicState.displaying&&this.enableMoveGraphic;this._moveManipulation.xyManipulation.available=t,this._moveManipulation.xyAxisManipulation.available=t,this._moveManipulation.xyAxisManipulation.orthogonalAvailable=t,this._moveManipulation.zManipulation.available=t&&this.enableZShape&&Object(Tt.a)(this.graphic)}if(0!==e){let t=0;if(Object(r.l)(a)){const e=a.handle.pos,i=Object(r.l)(n)?n.handle.pos:a.handle.leftEdge&&a.handle.leftEdge.leftVertex?a.handle.leftEdge.leftVertex.pos:null,o=Object(r.k)(n)&&a.handle.rightEdge&&a.handle.rightEdge.rightVertex?a.handle.rightEdge.rightVertex.pos:null;i&&o?this._moveManipulation.xyAxisManipulation.available=!1:i?t=Ke(i,e):o&&(t=Ke(e,o))}this._moveManipulation.angle=t,this._moveManipulation.radius=Bt}else this._moveManipulation.angle=ne(Object(r.t)(this.graphic.geometry)),this._moveManipulation.radius=_e.radiusForSymbol(this.graphic.symbol);0!==e&&i?(Object(h.p)(t,t,1/e),$e.spatialReference=Object(r.t)(this._editGeometryOperations).data.spatialReference,$e.hasZ=!0,this.view.renderCoordsHelper.fromRenderCoords(t,$e),this._moveManipulation.elevationAlignedLocation=$e):Object(r.l)(this._outlineVisualElement)&&!this._graphicState.isDraped&&Object(r.l)(this._outlineVisualElement.attachmentOrigin)?this._moveManipulation.elevationAlignedLocation=this._outlineVisualElement.attachmentOrigin:Object(St.h)(this.view,this._moveManipulation,this.graphic)}_removeVertices(t){const e=[],i=Object(r.t)(this._editGeometryOperations);for(const a of t)if("vertex"===a.type&&i.canRemoveVertex()){e.push(a.handle),this._removeManipulator(a),this._removeManipulator(this._getManipulatorInfoFromHandle(a.handle.leftEdge)),this._removeManipulator(this._getManipulatorInfoFromHandle(a.handle.rightEdge));const t=Object(r.t)(i.removeVertices([a.handle]).removedVertices[0].createdEdge);t&&this._createVertexOrEdgeManipulator(t)}if(e.length>0){const t=e.map((t=>{const e=i.data.components.indexOf(t.component);return{coordinates:i.data.coordinateHelper.vectorToArray(t.pos),componentIndex:e,vertexIndex:Object(r.t)(t.index)}}));this.outputGeometry=i.data.geometry;const a=this._updateEventState(ai.RESHAPING);if(this.destroyed)return;if(this.emit("vertex-remove",{type:"vertex-remove",removed:t.map((t=>t.coordinates)),vertices:t}),this.destroyed)return;if(a&&(this._updateEventState(ai.NONE),this.destroyed))return;this._updateMoveManipulationPosition()}}_moveVertices(t,e,i=("start"===e.action?Xe.a.NEW_STEP:Xe.a.ACCUMULATE_STEPS)){const a=Object(r.t)(this._editGeometryOperations);a.moveVertices(t.map((t=>t.handle)),e.mapDeltaX,e.mapDeltaY,e.mapDeltaZ,i),this.outputGeometry=a.data.geometry;for(const n of t)this._updateManipulatorPosition(n)}_offsetEdge(t,e){if(Object(r.k)(e.operation)||Object(r.k)(e.signedDistance))return;const i=Object(r.t)(this._editGeometryOperations),a=e.operation.clone();a.distance=e.signedDistance,i.updateVertices([t.handle.leftVertex,t.handle.rightVertex],a),this.outputGeometry=i.data.geometry,this._updateManipulatorPosition(this._getManipulatorInfoFromHandle(t.handle.leftVertex)),this._updateManipulatorPosition(this._getManipulatorInfoFromHandle(t.handle.rightVertex))}_manipulatorClickCallback(t,e){t.shiftKey||this._clearSelection(),"vertex"===e.type&&(e.manipulator.selected=!e.manipulator.selected,t.button===Be.a.Right&&this._removeVertices([e])),"edge"===e.type&&t.button===Be.a.Left&&this._splitEdgeManipulator(e),t.stopPropagation()}_updateTranslateTooltip(t,e){const i=this._manipulatorInfos.filter((t=>"vertex"===t.type&&t.manipulator.selected));1===i.length?this._updateTranslateVertexTooltip(i[0].manipulator,t,e):this._updateTranslateGraphicTooltip(t,e)}_updateTranslateGraphicTooltip(t,e){const i=this._tooltipOptions;if(!i.enabled)return;const a=this._graphicState.isDraped?"on-the-ground":"absolute-height";switch(t){case je.XY:this._tooltip.info=new De.a({tooltipOptions:i}),this._updateTranslateTooltipDistance(this._tooltip.info,e,((t,e)=>Object(S.d)(t,e,a)));break;case je.XY_AXIS:this._tooltip.info=new De.b({tooltipOptions:i}),this._updateTranslateTooltipDistance(this._tooltip.info,e,((t,i)=>{const n=Object(S.d)(t,i,a);return Object(wt.f)(n,re(e))}));break;case je.Z:this._tooltip.info=new De.c({tooltipOptions:i}),this._updateTranslateTooltipDistance(this._tooltip.info,e,Re.i)}}_updateTranslateVertexTooltip(t,e,i){const a=this._tooltipOptions;if(!a.enabled)return;let n;const o=this._graphicState.isDraped?"on-the-ground":"absolute-height";switch(e){case je.XY:n=new De.d({tooltipOptions:a}),this._updateTranslateTooltipDistance(n,i,((t,e)=>Object(S.d)(t,e,o))),this._updateTooltipAreaOrTotalLength(n);break;case je.XY_AXIS:n=new De.e({tooltipOptions:a}),this._updateTranslateTooltipDistance(n,i,((t,e)=>{const a=Object(S.d)(t,e,o);return Object(wt.f)(a,re(i))})),this._updateTooltipAreaOrTotalLength(n);break;case je.Z:n=new De.f({tooltipOptions:a}),this._updateTranslateTooltipDistance(n,i,Re.i)}const s=Object(Re.a)(t.elevationAlignedLocation);Object(r.l)(s)&&(n.elevation={mode:"absolute-height",...s}),this._tooltip.info=n}_updateTranslateTooltipDistance(t,e,i){if(Object(r.l)(e)&&"end"!==e.action){const{mapStart:a,mapEnd:n}=e,o=i(a,n);t.distance=Object(r.l)(o)?o:wt.h}}_updateTooltipAreaOrTotalLength(t){const{geometry:e}=this.graphic;if(Object(r.k)(e))return;const i=this._graphicState.isDraped?"on-the-ground":"absolute-height";t.area="polygon"===e.type?Object(qe.b)(e,i):null,t.totalLength="polyline"===e.type?Object(S.f)(e,i):null}get test(){return{segmentLabels:this._segmentLabels,tooltip:this._tooltip}}};function Ke(t,e){return Math.atan2(e[1]-t[1],e[0]-t[0])+Math.PI/2}Object(a.a)([Object(s.b)()],Je.prototype,"_segmentLabels",void 0),Object(a.a)([Object(s.b)({constructOnly:!0})],Je.prototype,"tool",void 0),Object(a.a)([Object(s.b)()],Je.prototype,"_tooltip",void 0),Object(a.a)([Object(s.b)()],Je.prototype,"inputGeometry",null),Object(a.a)([Object(s.b)()],Je.prototype,"outputGeometry",void 0),Object(a.a)([Object(s.b)({readOnly:!0})],Je.prototype,"updating",null),Object(a.a)([Object(s.b)()],Je.prototype,"manipulators",null),Object(a.a)([Object(s.b)()],Je.prototype,"view",null),Object(a.a)([Object(s.b)()],Je.prototype,"graphic",null),Object(a.a)([Object(s.b)()],Je.prototype,"enableZShape",null),Object(a.a)([Object(s.b)()],Je.prototype,"enableZVertex",null),Object(a.a)([Object(s.b)()],Je.prototype,"enableMoveGraphic",null),Object(a.a)([Object(s.b)()],Je.prototype,"enableMidpoints",null),Object(a.a)([Object(s.b)()],Je.prototype,"enableEdgeOffset",null),Object(a.a)([Object(s.b)()],Je.prototype,"_labelOptions",null),Object(a.a)([Object(s.b)()],Je.prototype,"_tooltipOptions",null),Je=Object(a.a)([Object(l.a)("esri.views.3d.interactive.editingTools.reshapeGraphic.ReshapeOperation")],Je);const $e=Object(Z.j)(0,0,null,null),ti=Object(p.f)(),ei=1e-6;var ii,ai,ni,ri;(ri=ii||(ii={})).Vertex=ce.b.Custom1,ri.Edge=ce.b.Custom2,function(t){t[t.NONE=0]="NONE",t[t.MOVING=1]="MOVING",t[t.RESHAPING=2]="RESHAPING"}(ai||(ai={})),function(t){t[t.ALL=0]="ALL",t[t.SELECTED_OR_ALL=1]="SELECTED_OR_ALL"}(ni||(ni={}));var oi=i(875);let si=class extends(L.a.EventedMixin(xe.a)){constructor(t){super(t),this._handles=new qt.a,this._internalGeometryUpdate=!1,this.enableZShape=!0,this.enableZVertex=!0,this.enableMoveGraphic=!0,this.enableMidpoints=!0,this.enableEdgeOffset=!1,this.type="reshape-3d",this.labelOptions=new oi.a,this.tooltipOptions=new Se.a,this.snappingManager=null,this.automaticManipulatorSelection=!1}initialize(){const t=this._reshapeOperation=new Je({tool:this});this.addHandles([t.on("reshape",(t=>{"reshape"===t.type&&this._onReshapeGeometryChanged(),this.emit("reshape",t)})),t.on("move",(t=>{"move"===t.type&&this._onReshapeGeometryChanged(),this.emit("move",t)})),t.on("vertex-add",(t=>{this._onReshapeGeometryChanged(),this.emit("vertex-add",t)})),t.on("vertex-remove",(t=>{this._onReshapeGeometryChanged(),this.emit("vertex-remove",t)})),t.on("immediate-click",(t=>this.emit("immediate-click",t))),this.view.on("pointer-down",["Shift"],(t=>{t.stopPropagation()})),Object(o.f)((()=>this.graphic),(()=>this._updateGraphic()),o.e)]),this.finishToolCreation()}destroy(){this._handles=Object(r.e)(this._handles),this._reshapeOperation=Object(r.e)(this._reshapeOperation)}get updating(){var t,e;return null!=(t=null==(e=this._reshapeOperation)?void 0:e.updating)&&t}_updateGeometry(){const t=Object(ze.a)(this.graphic);this._reshapeOperation.inputGeometry=Object(r.l)(t)?t.clone():null}_updateGraphic(){if(this._handles.remove("onGraphicGeometryChange"),this._updateGeometry(),Object(ze.b)(this.graphic)!==Et.a.SUPPORTED)return;const t=Object(o.f)((()=>{var t;return null==(t=this.graphic)?void 0:t.geometry}),(()=>{!1===this._internalGeometryUpdate&&this._updateGeometry()}),o.d);this._handles.add(t,"onGraphicGeometryChange")}onManipulatorSelectionChanged(){this._reshapeOperation&&this._reshapeOperation.onManipulatorSelectionChanged()}_updateGeometryInternally(t){this._internalGeometryUpdate=!0,this.graphic.geometry=t,this._internalGeometryUpdate=!1}_onReshapeGeometryChanged(){Object(r.k)(this.graphic)||this._updateGeometryInternally(this._reshapeOperation.outputGeometry.clone())}get canUndo(){var t;return null!=(t=this._reshapeOperation.canUndo)&&t}undo(){Object(r.l)(this.snappingManager)&&this.snappingManager.doneSnapping(),Object(r.l)(this._reshapeOperation.undo())&&this._updateGeometryInternally(this._reshapeOperation.outputGeometry.clone())}get canRedo(){var t;return null!=(t=this._reshapeOperation.canRedo)&&t}redo(){Object(r.l)(this.snappingManager)&&this.snappingManager.doneSnapping(),Object(r.l)(this._reshapeOperation.redo())&&this._updateGeometryInternally(this._reshapeOperation.outputGeometry.clone())}onInputEvent(t){"key-down"!==t.type||"Delete"!==t.key&&"Backspace"!==t.key||this._reshapeOperation.removeSelectedVertices()}reset(){}get test(){return{snappingManager:this.snappingManager,reshapeOperation:this._reshapeOperation}}};Object(a.a)([Object(s.b)()],si.prototype,"_reshapeOperation",void 0),Object(a.a)([Object(s.b)({constructOnly:!0,nonNullable:!0})],si.prototype,"view",void 0),Object(a.a)([Object(s.b)({constructOnly:!0})],si.prototype,"graphic",void 0),Object(a.a)([Object(s.b)({constructOnly:!0,nonNullable:!0})],si.prototype,"enableZShape",void 0),Object(a.a)([Object(s.b)({constructOnly:!0,nonNullable:!0})],si.prototype,"enableZVertex",void 0),Object(a.a)([Object(s.b)({constructOnly:!0,nonNullable:!0})],si.prototype,"enableMoveGraphic",void 0),Object(a.a)([Object(s.b)({constructOnly:!0,nonNullable:!0})],si.prototype,"enableMidpoints",void 0),Object(a.a)([Object(s.b)({constructOnly:!0,nonNullable:!0})],si.prototype,"enableEdgeOffset",void 0),Object(a.a)([Object(s.b)()],si.prototype,"type",void 0),Object(a.a)([Object(s.b)({constructOnly:!0,type:oi.a})],si.prototype,"labelOptions",void 0),Object(a.a)([Object(s.b)({constructOnly:!0,type:Se.a})],si.prototype,"tooltipOptions",void 0),Object(a.a)([Object(s.b)({constructOnly:!0})],si.prototype,"snappingManager",void 0),Object(a.a)([Object(s.b)()],si.prototype,"updating",null),Object(a.a)([Object(s.b)()],si.prototype,"automaticManipulatorSelection",void 0),si=Object(a.a)([Object(l.a)("esri.views.3d.interactive.editingTools.graphicReshape3D.GraphicReshapeTool")],si);var ci=i(62),li=i(53),hi=i(228),pi=i(231),di=i(41),ui=i(110);let bi=class extends Ye.a{constructor(t){super(t),this.type="transform-rotate",this.rotationType="geographic"}};Object(a.a)([Object(s.b)()],bi.prototype,"type",void 0),Object(a.a)([Object(s.b)()],bi.prototype,"rotation",void 0),Object(a.a)([Object(s.b)()],bi.prototype,"rotationPrecision",void 0),Object(a.a)([Object(s.b)()],bi.prototype,"orientation",void 0),Object(a.a)([Object(s.b)()],bi.prototype,"orientationPrecision",void 0),Object(a.a)([Object(s.b)()],bi.prototype,"rotationType",void 0),bi=Object(a.a)([Object(l.a)("esri.views.interactive.tooltip.TransformRotateTooltipInfo")],bi);let Oi=class extends Ye.a{constructor(t){super(t),this.type="transform-scale",this.sizeUnit=null,this.sizePrecision=null}};Object(a.a)([Object(s.b)()],Oi.prototype,"type",void 0),Object(a.a)([Object(s.b)()],Oi.prototype,"scale",void 0),Object(a.a)([Object(s.b)()],Oi.prototype,"size",void 0),Object(a.a)([Object(s.b)()],Oi.prototype,"sizeUnit",void 0),Object(a.a)([Object(s.b)()],Oi.prototype,"sizePrecision",void 0),Oi=Object(a.a)([Object(l.a)("esri.views.interactive.tooltip.TransformScaleTooltipInfo")],Oi);let gi=class extends Ye.a{constructor(t){super(t),this.type="transform-absolute",this.orientationEnabled=!0,this.orientationPrecision=null,this.rotationType="geographic",this.sizeUnit=null,this.sizeEnabled=!0,this.sizePrecision=null}};var _i,mi,ji;Object(a.a)([Object(s.b)()],gi.prototype,"type",void 0),Object(a.a)([Object(s.b)()],gi.prototype,"orientation",void 0),Object(a.a)([Object(s.b)()],gi.prototype,"orientationEnabled",void 0),Object(a.a)([Object(s.b)()],gi.prototype,"orientationPrecision",void 0),Object(a.a)([Object(s.b)()],gi.prototype,"rotationType",void 0),Object(a.a)([Object(s.b)()],gi.prototype,"size",void 0),Object(a.a)([Object(s.b)()],gi.prototype,"sizeUnit",void 0),Object(a.a)([Object(s.b)()],gi.prototype,"sizeEnabled",void 0),Object(a.a)([Object(s.b)()],gi.prototype,"sizePrecision",void 0),gi=Object(a.a)([Object(l.a)("esri.views.interactive.tooltip.TransformAbsoluteTooltipInfo")],gi),(ji=_i||(_i={})).ScaleIn=ce.b.Custom2,ji.ScaleOut=ce.b.Custom3,ji.RotateLeft=ce.b.Custom4,ji.RotateRight=ce.b.Custom5,ji.Unlocked=ce.b.Custom7,ji.DelayedFocused=ce.b.Custom8,ji.TouchInput=ce.b.Custom12;class fi{constructor({adapter:t,tooltipOptions:e,mode:i,tool:a}){this._mode=null,this._handles=new qt.a,this._scaleRotateDragData=null,this._activeAnimation=null,this.events=new L.a,this.getFocused=()=>this._ringManipulator.focused,this.getScale=()=>Object(r.l)(this._scaleRotateDragData)&&"scale"===this._scaleRotateDragData.mode?this._adapter.scale:1,this.tool=a,this._mode=i,this._adapter=t,this._tooltipOptions=e,this._tooltip=new Ae.a({view:a.view}),this._createManipulator(),this._updateDragState(),this._updateManipulatorTransform(),this._handles.add(Object(o.g)((()=>!this._tooltipOptions.enabled),(()=>this._tooltip.clear()),o.a))}get angle(){return this._adapter.angle}get scale(){return this._adapter.scale}set location(t){this._ringManipulator.location=t}set elevationAlignedLocation(t){this._ringManipulator.elevationAlignedLocation=t}get grabbing(){return this._ringManipulator.grabbing}set interactive(t){this._ringManipulator.interactive=t}destroy(){Object(r.l)(this._activeAnimation)&&(this._activeAnimation.frameTask.remove(),this._activeAnimation=null),this._handles=Object(r.e)(this._handles),this.tool.manipulators.remove(this._ringManipulator),this._ringManipulator=null,this._tooltip=Object(r.e)(this._tooltip)}startAnimation(t){this.cancelActiveAnimation(),t.start();const e=Object(pi.a)({update:({deltaTime:e})=>{t.update(e)&&this.cancelActiveAnimation()}});this._activeAnimation={...t,frameTask:e}}cancelActiveAnimation(){Object(r.l)(this._activeAnimation)&&(this._activeAnimation.frameTask.remove(),this._activeAnimation=Object(r.e)(this._activeAnimation))}forEachManipulator(t){t(this._ringManipulator,vt.SCALE_ROTATE)}_createManipulator(){const t=this._createRingManipulator();this._ringManipulator=t,this.tool.manipulators.add(t);const e=this.tool.graphicState.graphic,i=Object(ie.e)(t,((t,i,a)=>{this._scaleRotateDragData=null;const n=this._adapter.startInteraction(),o={mode:"none",origin:Object(p.d)(t.renderLocation),initialAngle:this._adapter.angle,angle:0,angleDir:0,scaleDir:0};this._scaleRotateDragData=o,this._updateDragState();const s=te.d.get();this.tool.view.renderCoordsHelper.worldUpAtPosition(t.renderLocation,s),i.next(Object(ee.g)(this.tool.view,Object(Le.h)(t.renderLocation,s,Object(Le.d)()))).next((t=>{const i=Object(Le.q)(t.plane),a=Object(St.a)(t.renderStart,t.renderEnd,o.origin,i),s=hi.d.shortestSignedDiff(o.angle,a);o.angleDir=Object(At.f)(o.angleDir+s,-.3,.3),o.angle=a;const c=function(t,e){const i=Object(h.k)(te.d.get(),e.renderStart,t.origin),a=Object(h.k)(te.d.get(),e.renderEnd,t.origin),n=Object(h.u)(i),r=Object(h.u)(a);return 0===n?0:r/n}(o,t),l=c-this._adapter.scale;if(o.scaleDir=Object(At.f)(o.scaleDir+l,-.2,.2),this._onScaleChanged(),"none"===o.mode){const i=this._mode||function(t,e,i,a){const{renderStart:n,renderEnd:r}=t,o=vi(n,a,te.d.get()),s=vi(r,a,te.d.get());if(Object(h.m)(o,s)<100)return null;const c=Object(h.k)(te.d.get(),n,i),l=Object(h.o)(te.d.get(),c,Object(Le.q)(e)),p=n,d=Object(h.j)(te.d.get(),p,l),u=vi(i,a,te.d.get()),b=o,O=vi(d,a,te.d.get()),g=Object(h.k)(te.d.get(),O,b),_=Object(h.k)(te.d.get(),o,u),m=Object(ui.h)(b,g),j=Object(ui.h)(u,_);return Object(ui.d)(m,s)<Object(ui.d)(j,s)?"rotate":"scale"}(t,t.plane,o.origin,this.tool.view.state.camera);if(Object(r.l)(i)){switch(i){case"rotate":this.tool.emit("graphic-rotate-start",{graphic:e,angle:0}),this.tool.emit("record-undo",{record:this._adapter.createUndoRecord()});break;case"scale":this.tool.emit("graphic-scale-start",{graphic:e,xScale:1,yScale:1}),this.tool.emit("record-undo",{record:this._adapter.createUndoRecord()})}o.mode=i}}switch(o.mode){case"rotate":n.state.angle=o.initialAngle+a;break;case"scale":n.state.scale=c,this._onScaleChanged()}switch(this._updateDragState(),this._updateManipulatorTransform(),t.action){case"start":case"update":switch(o.mode){case"rotate":this.tool.emit("graphic-rotate",{graphic:e,angle:Object(At.q)(o.angle)});break;case"scale":this.tool.emit("graphic-scale",{graphic:e,xScale:c,yScale:c})}break;case"end":switch(o.mode){case"rotate":this.tool.emit("graphic-rotate-stop",{graphic:e,angle:Object(At.q)(o.angle)});break;case"scale":this.tool.emit("graphic-scale-stop",{graphic:e,xScale:c,yScale:c})}}return"end"===t.action&&(this.startAnimation(yi(this,(()=>this._onScaleChanged()))),this._scaleRotateDragData=null,this._updateDragState(),n.done()),t})).next(this._updateTooltipPipelineStep(o)),a.next((()=>{if(n.cancel(),Object(r.l)(this._scaleRotateDragData)){switch(this._scaleRotateDragData.mode){case"none":break;case"rotate":this.tool.emit("graphic-rotate-stop",{graphic:e,angle:0});break;case"scale":this.tool.emit("graphic-scale-stop",{graphic:e,xScale:1,yScale:1})}this.startAnimation(yi(this,(()=>this._onScaleChanged()))),this._scaleRotateDragData=null,this._updateDragState()}this._updateFocusTooltip()}))}));this._handles.add([i,t.events.on("focus-changed",(t=>{"focus"===t.action?this.startAnimation(function(t,e){let i=0,a=null;const n=()=>!1;return{start:()=>{a=t.getFocused,t.getFocused=n,i=0,e()},update:t=>(i+=t,!a()||i>200?mi.STOP:mi.CONTINUE),destroy:()=>{t.getFocused=a,e()}}}(this,(()=>this._updateDelayedFocusedState()))):this._updateDelayedFocusedState()})),t.events.on("immediate-click",(t=>{t.stopPropagation()})),Object(o.f)((()=>{var t;return null==(t=this.tool.graphicState)?void 0:t.displaying}),(t=>this._ringManipulator.available=t),o.a)])}_updateTooltipPipelineStep(t){return e=>{const i=this._tooltipOptions;if(!i.enabled)return e;if("end"===e.action)return this._updateFocusTooltip(),e;const a=this._tooltip,n=this._tooltipOptions.visualVariables,o=Object(r.l)(n)?n.size:null,s=Object(r.l)(n)?n.rotation:null;switch(t.mode){case"scale":a.info=new Oi({tooltipOptions:i,scale:{value:this._adapter.scale},size:Object(wt.c)(Object(r.u)(this._adapter.size,-1),"meters"),sizeUnit:Object(r.l)(o)?o.unit:null,sizePrecision:Object(r.l)(o)?Mi(o.valueType):null});break;case"rotate":{const t=Object(r.l)(s)?Mi(s.valueType):null,e=Object(r.l)(s)?s.rotationType:"geographic";a.info=new bi({tooltipOptions:i,rotation:Object(wt.a)(Object(r.u)(-this._adapter.relativeAngle,0),"radians","geographic"),rotationPrecision:t,orientation:Object(wt.a)(-this._adapter.angle,"radians","geographic"),orientationPrecision:t,rotationType:e})}}return e}}_updateFocusTooltip(){if(this._tooltipOptions.enabled)if(this.getFocused()){const t=this._tooltipOptions.visualVariables,e=Object(r.l)(t)?t.rotation:null,i=Object(r.l)(t)?t.size:null;this._tooltip.info=new gi({tooltipOptions:this._tooltipOptions,orientation:Object(wt.a)(-this._adapter.angle,"radians","geographic"),orientationEnabled:null==this._mode||"rotate"===this._mode,orientationPrecision:Object(r.l)(e)?Mi(e.valueType):null,rotationType:Object(r.l)(e)?e.rotationType:"geographic",size:Object(wt.c)(Object(r.u)(this._adapter.size,-1),"meters"),sizeUnit:Object(r.l)(i)?i.unit:null,sizeEnabled:null==this._mode||"scale"===this._mode,sizePrecision:Object(r.l)(i)?Mi(i.valueType):null})}else this._tooltip.clear()}_onScaleChanged(){this.events.emit("scale-changed"),this._updateManipulatorTransform()}_updateDelayedFocusedState(){this._ringManipulator.updateStateEnabled(_i.DelayedFocused,this.getFocused()),this._updateFocusTooltip()}_updateDragState(){if(this._ringManipulator.updateStateEnabled(_i.Unlocked,!(Object(r.l)(this._scaleRotateDragData)&&"none"!==this._scaleRotateDragData.mode)),Object(r.l)(this._scaleRotateDragData))switch(this._scaleRotateDragData.mode){case"rotate":this._ringManipulator.updateStateEnabled(_i.ScaleIn|_i.ScaleOut,!1),this._ringManipulator.updateStateEnabled(_i.RotateLeft,this._scaleRotateDragData.angleDir<0),this._ringManipulator.updateStateEnabled(_i.RotateRight,this._scaleRotateDragData.angleDir>=0);break;case"scale":this._ringManipulator.updateStateEnabled(_i.RotateLeft|_i.RotateRight,!1),this._ringManipulator.updateStateEnabled(_i.ScaleIn,this._scaleRotateDragData.scaleDir<0),this._ringManipulator.updateStateEnabled(_i.ScaleOut,this._scaleRotateDragData.scaleDir>=0)}else this._ringManipulator.updateStateEnabled(_i.ScaleIn|_i.ScaleOut|_i.RotateLeft|_i.RotateRight,!1)}_updateManipulatorTransform(){const t=Object(Kt.g)(te.a.get(),this._adapter.angle,Object(p.h)(0,0,1));if(Object(r.k)(t))return;const e=this.getScale(),i=Object(Kt.b)(te.a.get(),Object(h.B)(te.d.get(),e,e,e));this._ringManipulator.modelTransform=Object(Kt.p)(te.a.get(),i,t)}_createRingManipulator(){const t=(t,e,i)=>{const a=[],n=Math.ceil(128*(e-t)/(2*Math.PI));for(let r=0;r<n+1;r++){const o=t+r*(e-t)/n;a.push(Object(p.h)(i*Math.cos(o),i*Math.sin(o),0))}return a},e=e=>t(0,2*Math.PI,e),i=(t,e)=>Object(oe.g)((t=>[[-t/2,0],[t/2,0],[t/2,.25],[-t/2,.25]])(e),t,[],[],!1),a=e(Xt),n=i(a,24),r={left:[],right:[]},o=[];for(let p=0;p<2;p++){const e=p*Math.PI-Math.PI/4,a=Math.PI/2-Yt,n=e+a,s=e+Math.PI/2-a,c=t(n,s,190),l=i(c,9);o.push(c),o.push(t(n,s,201)),r.left.push(l),r.right.push(l);for(let t=0;t<2;t++){const e=0===t,i=Object($t.d)();if(e){Object(Kt.n)(i,i,[1,-1,1]),Object(Kt.h)(i,i,-n,[0,0,1]);const t=Math.round(.2*(c.length-1));i[12]=c[t][0],i[13]=c[t][1],i[14]=c[t][2]}else{Object(Kt.h)(i,i,s,[0,0,1]);const t=Math.round(.8*(c.length-1));i[12]=c[t][0],i[13]=c[t][1],i[14]=c[t][2]}const a=Object(oe.f)(60,0,23,.5);Object(oe.p)(a,i),(e?r.left:r.right).push(a)}}const s=[];for(let p=0;p<2;p++){const e=p*Math.PI-Math.PI/4,a=Math.PI/2-Wt,n=e+a,r=e+Math.PI/2-a,o=t(n,r,213);s.push(i(o,9))}const c=e(190),l=e(213),h=i(c,9),u=i(l,9),b=e(130),O=e(107),g=i(b,9),_=i(O,9),m=this._createMaterial(),j=this._createMaterial(.66),f=this._createMaterial(.5),v=this._createMaterial(.33);let y=[{geometry:n,material:m,stateMask:_i.DelayedFocused},{geometry:n,material:f,stateMask:ce.c.None}];this._mode&&"scale"!==this._mode||(y=y.concat([{geometry:s,material:m,stateMask:_i.DelayedFocused|_i.Unlocked},{geometry:h,material:j,stateMask:_i.DelayedFocused|_i.ScaleIn},{geometry:u,material:v,stateMask:_i.DelayedFocused|_i.ScaleIn},{geometry:g,material:j,stateMask:_i.DelayedFocused|_i.ScaleOut},{geometry:_,material:v,stateMask:_i.DelayedFocused|_i.ScaleOut}])),this._mode&&"rotate"!==this._mode||(y=y.concat([{geometry:r.right,material:m,stateMask:_i.DelayedFocused|_i.Unlocked},{geometry:r.left,material:m,stateMask:_i.DelayedFocused|_i.RotateLeft},{geometry:r.right,material:m,stateMask:_i.DelayedFocused|_i.RotateRight}]));const M=[a,...o];return new Dt.a({view:this.tool.view,renderObjects:y,autoScaleRenderObjects:!1,worldOriented:!0,radius:24,focusMultiplier:1,touchMultiplier:1.5,elevationInfo:Object(d.j)(this.tool.graphicState.graphic),collisionType:{type:"ribbon",paths:M,direction:Object(p.h)(0,0,1)}})}_createMaterial(t=1){const e=Object(di.d)([...Ft,t]);return new se.a({color:e,transparent:1!==t,cullFace:Y.b.Back,renderOccluded:at.c.Transparent})}get test(){return{ringManipulator:this._ringManipulator,tooltip:this._tooltip}}}function vi(t,e,i){return e.projectToScreen(t,xi),Object(h.B)(i,xi[0],xi[1],0)}function yi(t,e){let i=null,a=1;const n=()=>a;return{start:()=>{a=t.getScale(),i=t.getScale,t.getScale=n,e()},update:t=>(a+=((a+1)/2-a)*Math.min(3*t,1),e(),Math.abs(a-1)<.01?mi.STOP:mi.CONTINUE),destroy:()=>{t.getScale=i,e()}}}function Mi(t){switch(t){case"integer":case"long":return 0;default:return null}}!function(t){t[t.CONTINUE=0]="CONTINUE",t[t.STOP=1]="STOP"}(mi||(mi={}));const xi=Object(b.g)();var wi=i(601);function Si(t){return Object(r.l)(t.geometry)&&"mesh"===t.geometry.type?function(t){return Object(r.l)(t.transform)?function(t,e){let i=e.clone(),a=null;return{undo:e=>{a=Object(r.l)(t.transform)?t.transform.clone():null,t.transform=i,e.notifyGeometryChanged()},redo:e=>{i=Object(r.l)(t.transform)?t.transform.clone():null,t.transform=a,e.notifyGeometryChanged()}}}(t,t.transform):function(t){let e,i=t.vertexAttributes.clonePositional();return{undo:a=>{e=t.vertexAttributes.clonePositional(),t.vertexAttributes=i,a.notifyGeometryChanged()},redo:a=>{i=t.vertexAttributes.clonePositional(),t.vertexAttributes=e,a.notifyGeometryChanged()}}}(t)}(t.geometry):function(t){let e=t.geometry,i=r.p;return{undo(t){i=t.geometry,t.geometry=e},redo(t){e=t.geometry,t.geometry=i}}}(t)}let Ei=class extends xt.a{constructor(t){super(t),this._interactionState=null}initialize(){this.addHandles([Object(o.g)((()=>Object(r.l)(this._interactionState)&&this._interactionState.angle!==this._interactionState.previousAngle?{interactionState:this._interactionState,angle:this._interactionState.state.angle}:null),(({interactionState:t})=>{this._updateMeshRotation(t)}),o.d),Object(o.g)((()=>Object(r.l)(this._interactionState)&&this._interactionState.scale!==this._interactionState.previousScale?{interactionState:this._interactionState,scale:this._interactionState.state.scale}:null),(({interactionState:t})=>{this._updateMeshSize(t)}),o.d)])}get angle(){const t=this.geometry.transform;if(Object(r.k)(t))return 0;const e=Object(wi.c)(t.rotation)[2];return Math.abs(e)>.999999?Object(At.h)(Object(wi.a)(t.rotation))*Math.sign(e):0}get scale(){return Object(r.l)(this._interactionState)?this._interactionState.scale:1}startInteraction(){const t=new Ti({angle:this.angle});this._interactionState=t;const e=()=>this._interactionState=null;return{state:t,done:e,cancel:()=>{t.cancel(),e()}}}createUndoRecord(){return Si(this.graphic)}_updateMeshRotation(t){const e=this.geometry.anchor,i=this.viewingMode===li.a.Global,{angle:a,previousAngle:n}=t;this.geometry.rotate(0,0,Object(At.q)(a-n),{origin:e,geographic:i}),t.previousAngle=a,Object(r.l)(this.geometry.transform)&&this.graphic.notifyMeshTransformChanged(),this.graphic.notifyGeometryChanged()}_updateMeshSize(t){const e=this.geometry.anchor,i=this.viewingMode===li.a.Global,{scale:a,previousScale:n}=t;this.geometry.scale(a/n,{origin:e,geographic:i}),t.previousScale=a,Object(r.l)(this.geometry.transform)&&this.graphic.notifyMeshTransformChanged(),this.graphic.notifyGeometryChanged()}};Object(a.a)([Object(s.b)({constructOnly:!0})],Ei.prototype,"graphic",void 0),Object(a.a)([Object(s.b)({constructOnly:!0})],Ei.prototype,"geometry",void 0),Object(a.a)([Object(s.b)({constructOnly:!0})],Ei.prototype,"viewingMode",void 0),Object(a.a)([Object(s.b)()],Ei.prototype,"angle",null),Object(a.a)([Object(s.b)()],Ei.prototype,"scale",null),Object(a.a)([Object(s.b)()],Ei.prototype,"_interactionState",void 0),Ei=Object(a.a)([Object(l.a)("esri.views.3d.interactive.editingTools.transformGraphic.ScaleRotateMeshAdapter")],Ei);let Ti=class extends g.a{constructor(t){super(t),this.angle=0,this.initialAngle=0,this.previousAngle=0,this.previousScale=1,this.scale=1,this.initialAngle=t.angle,this.previousAngle=t.angle}get state(){const{angle:t,scale:e}=this;return{angle:t,scale:e}}cancel(){this.angle=this.initialAngle,this.scale=1}};Object(a.a)([Object(s.b)()],Ti.prototype,"angle",void 0),Object(a.a)([Object(s.b)()],Ti.prototype,"initialAngle",void 0),Object(a.a)([Object(s.b)()],Ti.prototype,"previousAngle",void 0),Object(a.a)([Object(s.b)()],Ti.prototype,"previousScale",void 0),Object(a.a)([Object(s.b)()],Ti.prototype,"scale",void 0),Object(a.a)([Object(s.b)()],Ti.prototype,"state",null),Ti=Object(a.a)([Object(l.a)("InteractionState")],Ti);let Ai=class extends xt.a{constructor(t){super(t),this.sizeAxis=null,this._interactionState=null}initialize(){this.addHandles(Object(o.g)((()=>Object(r.l)(this._interactionState)?this._interactionState.state:null),(t=>{this._updateSymbol(t)}),o.d))}get angle(){return Object(r.l)(this._interactionState)?this._interactionState.angle:Object(r.l)(this._orientationReferenceSymbolLayer)?function(t){return-Object(At.h)(t)}(this._orientationReferenceSymbolLayer.heading):0}get scale(){return Object(r.l)(this._interactionState)?this._interactionState.scale:1}get relativeAngle(){return this.angle-this.initialAngle}get initialAngle(){return Object(r.l)(this._interactionState)?this._interactionState.initialAngle:0}get size(){const t=this._sizeReferenceSymbolLayer;if(Object(r.k)(t))return null;const e=this.findLayerView(),i=this._graphicSymbol;if(Object(r.k)(e)||Object(r.k)(i)||"point-3d"!==i.type)return null;const a=e.getSymbolLayerSize(i,t);if("size"in a&&Object(r.l)(a.size))return a.size;const n=this.sizeAxis;return"width"in a&&Object(r.l)(a.width)&&(Object(r.k)(n)||"width"===n||"all"===n||"width-and-depth"===n)?a.width:"depth"in a&&Object(r.l)(t.depth)&&(Object(r.k)(n)||"depth"===n||"all"===n||"width-and-depth"===n)?a.depth:"height"in a&&Object(r.l)(t.height)&&(Object(r.k)(n)||"height"===n||"all"===n)?a.height:null}get _sizeReferenceSymbolLayer(){const t=this._graphicSymbol;return Object(r.k)(t)||0===t.symbolLayers.length?null:t.symbolLayers.find((t=>"object"===t.type))}get _orientationReferenceSymbolLayer(){const t=this._graphicSymbol;return Object(r.k)(t)||0===t.symbolLayers.length?null:t.symbolLayers.find((t=>"object"===t.type&&Object(r.l)(t.heading)))}get _graphicSymbol(){return Object(r.l)(this.graphic)&&Object(r.l)(this.graphic.symbol)&&"point-3d"===this.graphic.symbol.type?this.graphic.symbol:null}set _graphicSymbol(t){this.graphic.symbol=t}startInteraction(){const t=this._graphicSymbol,e=this.findLayerView();if(Object(r.l)(this._interactionState)||Object(r.k)(t)||Object(r.k)(e))return Di;const i=t.symbolLayers.map((i=>"object"===i.type?e.getSymbolLayerSize(t,i):null)).toArray(),a=t.clone(),n=this.angle,o=new Ri({originalSymbol:a,angle:n,initialSizes:i});this._interactionState=o;const s=()=>this._interactionState=null;return{state:o,done:s,cancel:()=>{this._graphicSymbol=a,s()}}}createUndoRecord(){let t=this.graphic.symbol,e=null;return{undo:i=>{e=i.symbol,i.symbol=t},redo:i=>{t=i.symbol,i.symbol=e}}}_updateSymbol({scale:t,angle:e,originalSymbol:i,initialSizes:a}){const n=this._graphicSymbol;if(Object(r.k)(n)||"point-3d"!==n.type)return;const o=n.clone(),s=-Object(At.q)(e-this.initialAngle);let c=!1;this._forEachObjectSymbolLayerPair(i,o,((e,i,n)=>{const o=Object(r.u)(e.heading,0)+s;i.heading!==o&&(i.heading=o,c=!0);const l=a[n];if(Object(r.l)(l)&&"width"in l){l.width=this.sizeFilter(l.width),l.height=this.sizeFilter(l.height),l.depth=this.sizeFilter(l.depth);const e=l.width*t;i.width!==e&&(i.width=e,c=!0);const a=l.depth*t;i.depth!==a&&(i.depth=a,c=!0);const n=l.height*t;i.height!==n&&(i.height=n,c=!0)}})),c&&(this._graphicSymbol=o)}_forEachObjectSymbolLayerPair(t,e,i){t.symbolLayers.forEach(((t,a)=>{const n=e.symbolLayers.getItemAt(a);"object"===t.type&&"object"===n.type&&i(t,n,a)}))}};Object(a.a)([Object(s.b)()],Ai.prototype,"angle",null),Object(a.a)([Object(s.b)()],Ai.prototype,"scale",null),Object(a.a)([Object(s.b)()],Ai.prototype,"relativeAngle",null),Object(a.a)([Object(s.b)()],Ai.prototype,"initialAngle",null),Object(a.a)([Object(s.b)()],Ai.prototype,"size",null),Object(a.a)([Object(s.b)()],Ai.prototype,"sizeAxis",void 0),Object(a.a)([Object(s.b)({constructOnly:!0})],Ai.prototype,"graphic",void 0),Object(a.a)([Object(s.b)()],Ai.prototype,"_interactionState",void 0),Object(a.a)([Object(s.b)({constructOnly:!0})],Ai.prototype,"findLayerView",void 0),Object(a.a)([Object(s.b)({constructOnly:!0})],Ai.prototype,"sizeFilter",void 0),Object(a.a)([Object(s.b)()],Ai.prototype,"_sizeReferenceSymbolLayer",null),Object(a.a)([Object(s.b)()],Ai.prototype,"_orientationReferenceSymbolLayer",null),Object(a.a)([Object(s.b)()],Ai.prototype,"_graphicSymbol",null),Ai=Object(a.a)([Object(l.a)("esri.views.3d.interactive.editingTools.transformGraphic.ScaleRotateObjectSymbol3DAdapter")],Ai);const Di={state:{angle:0,scale:0},done:()=>{},cancel:()=>{}};let Ri=class extends g.a{constructor(t){super(t),this.angle=0,this.initialAngle=0,this.scale=1,this.initialAngle=t.angle}get state(){const{originalSymbol:t,angle:e,initialAngle:i,scale:a,initialSizes:n}=this;return{originalSymbol:t,angle:e,initialAngle:i,scale:a,initialSizes:n}}};Object(a.a)([Object(s.b)()],Ri.prototype,"originalSymbol",void 0),Object(a.a)([Object(s.b)()],Ri.prototype,"angle",void 0),Object(a.a)([Object(s.b)()],Ri.prototype,"initialAngle",void 0),Object(a.a)([Object(s.b)()],Ri.prototype,"initialSizes",void 0),Object(a.a)([Object(s.b)()],Ri.prototype,"scale",void 0),Object(a.a)([Object(s.b)()],Ri.prototype,"state",null),Ri=Object(a.a)([Object(l.a)("InteractionState")],Ri);let Ii=class extends(Object(xt.b)(L.a.EventedMixin(xe.a))){constructor(t){super(t),this.enableZ=!0,this.enableRotation=!0,this.enableScaling=!0,this.tooltipOptions=new Se.a,this.type="transform-3d",this._scaleRotate=null,this._snappingPipeline=new Te.a,this._tooltip=null}initialize(){const{graphic:t,view:e}=this;this.graphicState=new ut({graphic:t}),this.addHandles(Object(o.f)((()=>this.tooltipOptions.enabled),(t=>{this._tooltip=t?new Ae.a({view:e}):Object(r.e)(this._tooltip)}),o.e)),this._moveManipulation=new _e({tool:this,view:e,snapToScene:this.snapToScene,xyAvailable:!0,xyAxisAvailable:!0,zAvailable:this.enableZ&&Object(Tt.a)(t),radius:_e.radiusForSymbol(t.symbol)}),this._moveManipulation.forEachManipulator((e=>this.handles.add(e.events.on("immediate-click",(e=>{this.emit("immediate-click",{...e,graphic:t}),e.stopPropagation()})))));const i=t=>e=>{this.handles.add(e.events.on("focus-changed",(({action:e})=>{const i=this._tooltip;Object(r.k)(i)||("focus"===e?this._updateMoveTooltip(t):i.clear())})))};this._moveManipulation.xyManipulation.forEachManipulator(i(je.XY)),this._moveManipulation.xyAxisManipulation.forEachManipulator(i(je.XY_AXIS)),this._moveManipulation.zManipulation.forEachManipulator(i(je.Z)),this._moveManipulation.elevationInfo=Object(d.j)(t);const a=t.geometry;if(this._moveManipulation.createGraphicDragPipeline(((i,n,o,s,c)=>(Object(r.l)(a)&&i===je.XY&&(o=o.next(this._snappingPipeline.createSnapDragEventPipelineStep({snappingContext:new Ee.a({elevationInfo:Object(d.j)(t),pointer:c,editGeometryOperations:we.a.fromGeometry(new ci.a({spatialReference:a.spatialReference}),e.state.viewingMode),visualizer:new k.a,excludeFeature:t}),snappingManager:this.snappingManager,updatingHandles:this.updatingHandles,cancel:s,useZ:!1}),this._snappingPipeline.next)),o.next((t=>(this._updateMoveTooltip(i,t),t))))),this.graphicState,(t=>{const{action:e,graphic:i,dxScreen:a,dyScreen:n}=t,r={graphic:i,dxScreen:a,dyScreen:n};switch(e){case"start":this.emit("graphic-translate-start",r),this.emit("record-undo",{record:this._createGeometryUndoRecord()});break;case"update":this.emit("graphic-translate",r);break;case"end":this.emit("graphic-translate-stop",r)}})),this._moveManipulation.angle=Object(r.l)(this._scaleRotate)?this._scaleRotate.angle:0,this._scaleRotateAdapter=this._createScaleRotateAdapter(),this.handles.add(Object(o.f)((()=>this._scaleRotateAdapter.angle),(()=>this._updateMoveAngle()))),this.enableScaling||this.enableRotation){const t=this.enableScaling&&this.enableRotation?null:this.enableScaling?"scale":"rotate";this._scaleRotate=new fi({tool:this,mode:t,adapter:this._scaleRotateAdapter,tooltipOptions:this.tooltipOptions}),this.handles.add(this._scaleRotate.events.on("scale-changed",(()=>this._onScaleChanged())))}this.handles.add([Ut({view:this.view,graphic:this.graphic,forEachManipulator:t=>this._forEachManipulator(t),onManipulatorsChanged:()=>Object(n.c)()}),this.graphicState.on("changed",(()=>this._onGeometryChanged())),this._hideManipulatorsForGraphicState(),Object(o.f)((()=>e.scale),(()=>this._updateMoveAngle()))]),this.handles.add(this.view.trackGraphicState(this.graphicState)),this._onGeometryChanged(),this._updateMoveAngle(),this._forEachManipulator((t=>{t instanceof Dt.a&&this.handles.add(t.events.on("grab-changed",(()=>this._updateManipulatorsInteractive())))})),this.finishToolCreation()}destroy(){this._tooltip=Object(r.e)(this._tooltip),this._moveManipulation.destroy(),this._scaleRotate=Object(r.e)(this._scaleRotate),this._scaleRotateAdapter=Object(r.e)(this._scaleRotateAdapter),this._set("view",null),this._set("graphic",null)}_updateManipulatorsInteractive(){Object(r.k)(this._scaleRotate)||(this._scaleRotate.interactive=!this._moveManipulation.grabbing,this._moveManipulation.interactive=!this._scaleRotate.grabbing)}_createScaleRotateAdapter(){return Object(r.l)(this.graphic.geometry)&&"mesh"===this.graphic.geometry.type?new Ei({graphic:this.graphic,geometry:this.graphic.geometry,viewingMode:this.view.state.viewingMode}):new Ai({graphic:this.graphic,sizeFilter:t=>this._enforceNonZeroSize(t),findLayerView:()=>this.view.allLayerViews.find((t=>t.layer===this.graphic.layer)),sizeAxis:Object(r.l)(this.tooltipOptions.visualVariables)&&Object(r.l)(this.tooltipOptions.visualVariables.size)?this.tooltipOptions.visualVariables.size.axis:null})}_forEachManipulator(t){this._moveManipulation.forEachManipulator(t),Object(r.l)(this._scaleRotate)&&this._scaleRotate.forEachManipulator(t)}_hideManipulatorsForGraphicState(){return Object(o.f)((()=>this.graphicState.displaying),(t=>{this._forEachManipulator((e=>e.available=t)),this._moveManipulation.zManipulation.available=t&&this.enableZ&&Object(Tt.a)(this.graphic)}))}_createGeometryUndoRecord(){return Si(this.graphic)}set snapToScene(t){this._moveManipulation&&(this._moveManipulation.snapToScene=t),this._set("snapToScene",t)}get updating(){return this.updatingHandles.updating}set location(t){this._moveManipulation.location=t,Object(r.l)(this._scaleRotate)&&(this._scaleRotate.location=t)}set elevationAlignedLocation(t){this._moveManipulation.elevationAlignedLocation=t,Object(r.l)(this._scaleRotate)&&(this._scaleRotate.elevationAlignedLocation=t)}reset(){}onHide(){Object(r.l)(this._scaleRotate)&&this._scaleRotate.cancelActiveAnimation()}_onScaleChanged(){if(Object(r.k)(this._scaleRotate))return;const t=this._scaleRotate.getScale();this._moveManipulation.displayScale=t}_updateMoveAngle(){this.view.state.viewingMode===li.a.Local||this.view.scale<1e6?this._moveManipulation.angle=this._scaleRotateAdapter.angle:this._moveManipulation.angle=0}_onGeometryChanged(){Object(St.h)(this.view,this,this.graphic)}_enforceNonZeroSize(t){return t||this.view.state.camera.computeRenderPixelSizeAt(this._moveManipulation.renderLocation)}_updateMoveTooltip(t,e){const{tooltipOptions:i,_tooltip:a}=this;if(Object(r.k)(a))return;a.clear();const n=this.graphicState.isDraped?"on-the-ground":"absolute-height";switch(t){case je.XY:a.info=new De.a({tooltipOptions:i}),this._updateMoveTooltipDistance(a.info,e,((t,e)=>Object(S.d)(t,e,n)));break;case je.XY_AXIS:a.info=new De.b({tooltipOptions:i}),this._updateMoveTooltipDistance(a.info,e,((t,i)=>{const a=Object(S.d)(t,i,n);return Object(wt.f)(a,re(e))}));break;case je.Z:a.info=new De.c({tooltipOptions:i}),this._updateMoveTooltipDistance(a.info,e,Re.i)}}_updateMoveTooltipDistance(t,e,i){if(Object(r.l)(e)&&"end"!==e.action){const{mapStart:a,mapEnd:n}=e,o=i(a,n);t.distance=Object(r.l)(o)?o:wt.h}}get test(){return{discManipulator:this._moveManipulation.xyManipulation.test.discManipulator,zManipulator:this._moveManipulation.zManipulation.test.manipulator,ringManipulator:Object(r.l)(this._scaleRotate)?this._scaleRotate.test.ringManipulator:null,arrowManipulators:this._moveManipulation.xyAxisManipulation.test.arrowManipulators,scaleRotateAdapter:this._scaleRotateAdapter,scaleRotateTransform:this._scaleRotate,tooltip:this._tooltip}}};Object(a.a)([Object(s.b)({constructOnly:!0,nonNullable:!0})],Ii.prototype,"view",void 0),Object(a.a)([Object(s.b)({constructOnly:!0,nonNullable:!0})],Ii.prototype,"graphic",void 0),Object(a.a)([Object(s.b)({constructOnly:!0,nonNullable:!0})],Ii.prototype,"enableZ",void 0),Object(a.a)([Object(s.b)()],Ii.prototype,"enableRotation",void 0),Object(a.a)([Object(s.b)()],Ii.prototype,"enableScaling",void 0),Object(a.a)([Object(s.b)({constructOnly:!0,type:Se.a})],Ii.prototype,"tooltipOptions",void 0),Object(a.a)([Object(s.b)()],Ii.prototype,"graphicState",void 0),Object(a.a)([Object(s.b)({value:!1})],Ii.prototype,"snapToScene",null),Object(a.a)([Object(s.b)({constructOnly:!0})],Ii.prototype,"snappingManager",void 0),Object(a.a)([Object(s.b)({readOnly:!0})],Ii.prototype,"type",void 0),Object(a.a)([Object(s.b)({readOnly:!0})],Ii.prototype,"updating",null),Ii=Object(a.a)([Object(l.a)("esri.views.3d.interactive.editingTools.graphicTransform3D.GraphicTransformTool")],Ii);var Gi=i(266),Pi=i(1237),Ci=i(1276);class ki{constructor(){this._lastDragEvent=null,this.next=new ie.a,this._enabled=!1}get enabled(){return this._enabled}set enabled(t){if(this._enabled!==t&&Object(r.l)(this._lastDragEvent)){const e={...this._lastDragEvent,action:"update"};t&&this._adjustScaleFactors(e),this.next.execute(e)}this._enabled=t}createDragEventPipelineStep(){return this._lastDragEvent=null,t=>(this._lastDragEvent="end"!==t.action?{...t}:null,this._enabled&&this._adjustScaleFactors(t),t)}_adjustScaleFactors(t){const e=Object(Pi.q)(t.handle)?Math.max(Math.abs(t.factor1),Math.abs(t.factor2)):0===t.handle.direction[0]?Math.abs(t.factor2):Math.abs(t.factor1);t.factor1=t.factor1<0?-e:e,t.factor2=t.factor2<0?-e:e}get test(){return{_adjustScaleFactors:t=>this._adjustScaleFactors(t)}}}var zi=i(325),Vi=i(1265),Li=i(1464),Hi=i(1466),Ni=i(1467);function Ui(t,e){return Zi(t,e,!1)}function Fi(t,e){return Zi(t,e,!0)}function Zi(t,e,i){if(t instanceof Vi.b){if(t.operation instanceof Li.a)return function(t,e,i=!1){const a=i?-1:1,n=Object(p.h)(a*t.dx,a*t.dy,a*t.dz);Object(h.j)(e.origin,e.origin,n)}(t.operation,e,i),!0;if(t.operation instanceof Hi.a)return function(t,e,i=!1){const a=i?-t.angle:t.angle;Object(h.i)(e.basis1,e.basis1,p.c,a),Object(h.i)(e.basis2,e.basis2,p.c,a)}(t.operation,e,i),!0;if(t.operation instanceof Ni.a)return function(t,e,i=!1){const a=i?1/t.factor1:t.factor1,n=i?1/t.factor2:t.factor2;Object(h.p)(e.basis1,e.basis1,a),Object(h.p)(e.basis2,e.basis2,n),Object(v.u)(e.origin,e.origin,t.origin,t.axis1,a),Object(v.u)(e.origin,e.origin,t.origin,t.axis2,n)}(t.operation,e,i),!0}return!1}function Bi(t,e,i,a){const n=te.d.get();Object(h.k)(n,Object(h.k)(n,t.origin,t.basis1),t.basis2);const o=te.d.get();Object(h.I)(o,n,t.basis1,2);const s=te.d.get();Object(h.I)(s,o,t.basis2,2);const c=te.d.get();Object(h.I)(c,n,t.basis2,2),n[2]=o[2]=s[2]=c[2]=e;const l=a?"on-the-ground":"absolute-height",p=Object(wt.e)(Object(S.c)(n,o,i,l),Object(S.c)(c,s,i,l)),d=Object(wt.e)(Object(S.c)(o,s,i,l),Object(S.c)(n,c,i,l));return Object(r.k)(d)||Object(r.k)(p)?null:[p,d]}var Xi=i(1380);let Yi=class extends(L.a.EventedMixin(xe.a)){constructor(t){super(t),this.enableZ=!0,this.enableRotation=!0,this.enableScaling=!0,this.tooltipOptions=new Se.a,this._preserveAspectRatio=new ki,this.grabbing=!1,this.inputState=null,this.type="transform-3d",this._handles=new qt.a,this._moveZManipulator=null,this._resizeManipulators=null,this._rotateManipulator=null,this._attachmentOrigin=null,this._outlineVisualElement=null,this._mapBounds=Object(Gi.b)(),this._mapBoundsStart=Object(Gi.b)(),this._zmax=0,this._sizeStart=null,this._displayBounds=Object(Gi.b)(),this._displayBoundsStart=Object(Gi.b)(),this._displayBoundsMarginStart=0,this._resizeHandles=[{direction:[1,0]},{direction:[1,1]},{direction:[0,1]},{direction:[-1,1]},{direction:[-1,0]},{direction:[-1,-1]},{direction:[0,-1]},{direction:[1,-1]}],this._moveXYTooltipInfo=null,this._moveZTooltipInfo=null,this._rotateTooltipInfo=null,this._scaleTooltipInfo=null,this._startAngle=0,this._endAngle=0,this._startScale=Object(y.c)(),this._endScale=Object(y.c)()}initialize(){const{view:t,graphic:e,manipulators:i,_handles:a}=this,s=this._graphicState=new ut({graphic:e}),c=e.geometry;this._editGeometryOperations=we.a.fromGeometry(c,t.state.viewingMode),this._graphicMoveManipulation=new ye({tool:this,view:t,graphicState:s}),this._moveZManipulator=Object(Pi.o)(t,Pi.c.CENTER_ON_CALLOUT),this._moveZManipulator.state|=Pi.b,a.add([this._createMoveXYGraphicDragPipeline(),Object(o.f)((()=>this.enableZ),(()=>this._updateManipulatorAvailability(this._moveZManipulator,vt.TRANSLATE_Z))),this._createMoveZDragPipeline()]),i.add(this._moveZManipulator),this._resizeManipulators=this._resizeHandles.map((e=>{const i=Object(Pi.l)(t,e);return a.add([Object(o.f)((()=>this.enableScaling),(()=>this._updateManipulatorAvailability(i,vt.SCALE))),i.events.on("grab-changed",(t=>this._onResizeGrab(t))),this._createResizeDragPipeline(i,e)]),i})),i.addMany(this._resizeManipulators),this._rotateManipulatorTexture=Object(Ci.a)(t.toolViewManager.textures),this._rotateManipulator=Object(St.e)(t,{texture:this._rotateManipulatorTexture.texture}),a.add([Object(o.f)((()=>this.enableRotation),(()=>this._updateManipulatorAvailability(this._rotateManipulator,vt.ROTATE))),this._rotateManipulator.events.on("grab-changed",(t=>{this._onRotateGrab(t)})),this._createRotateDragPipeline(this._rotateManipulator)]),i.add(this._rotateManipulator),this._calculateMapBounds(),this._updateDisplayBounds();const l=Ut({view:t,graphic:e,forEachManipulator:t=>this._forEachManipulator(t),onManipulatorsChanged:()=>Object(n.c)()});Object(r.l)(l)&&(this._outlineVisualElement=l.visualElement instanceof st?l.visualElement:null),Object(r.l)(this._outlineVisualElement)&&a.add(this._outlineVisualElement.events.on("attachment-origin-changed",(()=>this._updateDisplayBounds()))),a.add(l),a.add([s.on("changed",(()=>this._onGeometryChanged())),Object(o.f)((()=>s.displaying),(()=>this._updateAllManipulatorAvailability())),Object(o.f)((()=>s.isDraped),(()=>this._graphicDrapedChanged()),o.a),t.trackGraphicState(s)]);const h=t.pointsOfInterest;h&&a.add(Object(o.f)((()=>h.centerOnSurfaceFrequent.location),(()=>this._updateDisplayBounds())));this._forEachManipulator((t=>{a.add(t.events.on("grab-changed",(()=>{this.grabbing=t.grabbing,this._updateAllManipulatorAvailability()})))}));this._forEachManipulator(((t,i)=>{a.add(t.events.on("immediate-click",(t=>{i===vt.TRANSLATE_XY&&this.emit("immediate-click",{...t,graphic:e}),t.stopPropagation()})))})),this._onGeometryChanged(),this._updateAllManipulatorAvailability(),this._initializeTooltip(),this.finishToolCreation()}destroy(){this._mapBounds=null,this._displayBounds=null,this._rotateManipulatorTexture.release(),this._handles.destroy(),this._graphicMoveManipulation.destroy(),this._editGeometryOperations.destroy(),this._tooltip.destroy(),this._set("view",null),this._set("graphic",null)}_initializeTooltip(){const{_handles:t,view:e}=this,i=this._tooltip=new Ae.a({view:e}),a=()=>{i.info=this._getUpdatedTooltipInfo()};t.add([this.on("graphic-translate-start",a),this.on("graphic-translate",a),this.on("graphic-translate-stop",(()=>{this._moveXYTooltipInfo=null,this._moveZTooltipInfo=null,this._tooltip.clear()})),this.on("graphic-rotate-start",(t=>{this._startAngle=t.angle,a()})),this.on("graphic-rotate",(t=>{this._endAngle=t.angle,a()})),this.on("graphic-rotate-stop",(()=>{this._startAngle=0,this._endAngle=0,a()})),this.on("graphic-scale-start",(t=>{Object(v.s)(this._startScale,t.xScale,t.yScale),Object(v.s)(this._endScale,t.xScale,t.yScale),a()})),this.on("graphic-scale",(t=>{Object(v.s)(this._endScale,t.xScale,t.yScale),a()})),this.on("graphic-scale-stop",(()=>{Object(v.s)(this._startScale,0,0),Object(v.s)(this._endScale,0,0),a()}))]),this._forEachManipulator((e=>{t.add([e.events.on("focus-changed",a),e.events.on("grab-changed",a),e.events.on("drag",(t=>{"cancel"===t.action?this._tooltip.clear():a()}))])}))}_getUpdatedTooltipInfo(){return this.tooltipOptions.enabled?this._graphicMoveManipulation.grabbing||this._graphicMoveManipulation.dragging?this._computeMoveXYTooltipInfo():this._moveZManipulator.focused?this._computeMoveZTooltipInfo():this._rotateManipulator.focused?this._computeRotateTooltipInfo():this._resizeManipulators.some((t=>t.focused))?this._computeScaleTooltipInfo():null:null}_computeMoveXYTooltipInfo(){return this._moveXYTooltipInfo=Object(r.u)(this._moveXYTooltipInfo,(()=>new De.a({tooltipOptions:this.tooltipOptions})))}_computeMoveZTooltipInfo(){const t=this._moveZTooltipInfo=Object(r.u)(this._moveZTooltipInfo,(()=>new De.c({tooltipOptions:this.tooltipOptions}))),e=this._moveUnit;if(this._moveZManipulator.dragging){const e=this._mapBoundsStart.origin,i=this._mapBounds.origin,a=Object(Re.h)(e,i,this.view.spatialReference);if(Object(r.k)(a))return null;t.distance=a}else t.distance=Object(wt.c)(0,e);return t}_computeRotateTooltipInfo(){const t=this._rotateTooltipInfo=Object(r.u)(this._rotateTooltipInfo,(()=>new Xi.a({tooltipOptions:this.tooltipOptions})));return t.angle=this._startAngle-this._endAngle,t}_computeScaleTooltipInfo(){const t=this.graphic.geometry;if(Object(r.k)(t))return null;const e=this._scaleTooltipInfo=Object(r.u)(this._scaleTooltipInfo,(()=>new Xi.b({tooltipOptions:this.tooltipOptions}))),i=Bi(this._mapBounds,this._zmax,t.spatialReference,this._graphicState.isDraped);return Object(r.k)(i)?null:(e.xSize=i[0],e.ySize=i[1],Object(r.l)(this._sizeStart)&&this._resizeManipulators.some((t=>t.dragging))?(e.xScale=i[0].value/this._sizeStart[0].value,e.yScale=i[1].value/this._sizeStart[1].value):(e.xScale=1,e.yScale=1),e)}_graphicDrapedChanged(){this._handles.remove(Wi),this._updateDisplayBounds(),this._graphicState.isDraped&&this._handles.add(this.view.elevationProvider.on("elevation-change",(t=>{Object(r.l)(this._attachmentOrigin)&&Object(kt.k)(t.extent,this._attachmentOrigin.x,this._attachmentOrigin.y)&&this._updateDisplayBounds()})),Wi)}_updateAllManipulatorAvailability(){this._forEachManipulator(((t,e)=>this._updateManipulatorAvailability(t,e)))}_updateManipulatorAvailability(t,e){const i=this.grabbing&&!t.grabbing;if(t.interactive=!i,t instanceof Dt.a){const a=this._graphicState.displaying,n=this.enableZ&&Object(Tt.a)(this.graphic);switch(e){case vt.ROTATE:t.available=a&&this.enableRotation;break;case vt.SCALE:t.available=a&&(this.enableScaling||this.enableRotation||n),t.interactive=!i&&this.enableScaling,t.state=this.enableScaling?Pi.v:Pi.w;break;case vt.TRANSLATE_Z:t.available=a&&n;break;default:t.available=a}}}_forEachManipulator(t){this._graphicMoveManipulation.forEachManipulator(t),this._resizeManipulators.forEach((e=>t(e,vt.SCALE))),t(this._rotateManipulator,vt.ROTATE),t(this._moveZManipulator,vt.TRANSLATE_Z)}get preserveAspectRatio(){return this._preserveAspectRatio.enabled}set preserveAspectRatio(t){this._preserveAspectRatio.enabled=t,this._set("preserveAspectRatio",t)}get _moveUnit(){return Object(r.u)(Object(f.m)(this.view.spatialReference),"meters")}reset(){}_onGeometryChanged(){this._updateDisplayBounds()}_calculateMapBounds(){const t=this.graphic.geometry,e=this._editGeometryOperations.data,i=e.components[0].edges[0],a=Object(v.a)(te.c.get(),i.leftVertex.pos,i.rightVertex.pos);Object(v.f)(a,a);const n=Object(r.u)(Object(St.g)(this.view,this.graphic),(()=>t.extent.center));let o=Qi*this.view.pixelSizeAt(n);const s=this.view.spatialReference,c=t.spatialReference;s.equals(c)||(o*=Object(f.f)(s)/Object(f.f)(c)),function(t,e,i,a){a||(a=Object(Gi.b)());const n=Object(v.s)(te.c.get(),t[1],-t[0]),r=Object(v.s)(te.c.get(),Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),o=Object(v.s)(te.c.get(),Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),s=te.c.get();e.components.forEach((e=>e.vertices.forEach((e=>{const i=e.pos;Object(v.s)(s,Object(v.h)(t,i),Object(v.h)(n,i)),Object(v.x)(r,r,s),Object(v.y)(o,o,s)}))));const c=1e-6,l=Object(v.s)(te.c.get(),o[0]-r[0]<c?i/2:0,o[1]-r[1]<c?i/2:0);Object(v.a)(r,r,l),Object(v.j)(o,o,l),Object(v.b)(a.basis1,t,(o[0]-r[0])/2),Object(v.b)(a.basis2,n,(o[1]-r[1])/2),Object(v.s)(a.origin,r[0]*t[0]+r[1]*n[0],r[0]*t[1]+r[1]*n[1]),Object(v.j)(a.origin,a.origin,a.basis1),Object(v.j)(a.origin,a.origin,a.basis2)}(a,e,o,this._mapBounds),this._updateZMax()}_updateZMax(){const t=this._editGeometryOperations.data;if(!t.geometry.hasZ)return void(this._zmax=0);const e=t.coordinateHelper;let i=Number.NEGATIVE_INFINITY;for(const a of t.components)for(const t of a.vertices){const a=e.getZ(t.pos);i=Math.max(a,i)}this._zmax=i}_updateDisplayBounds(){const t=this.graphic.geometry;if(Object(r.k)(t))return;const e=Object(r.l)(this._outlineVisualElement)&&!this._graphicState.isDraped&&Object(r.l)(this._outlineVisualElement.attachmentOrigin)?this._outlineVisualElement.attachmentOrigin:Object(St.g)(this.view,this.graphic);this._attachmentOrigin=Object(r.u)(e,t.extent.center);const i=Object(r.l)(e)?e.z:Object(dt.f)(this._mapBounds.origin,this.view.elevationProvider,$.a.fromElevationInfo(Object(d.j)(this.graphic)),this.view.renderCoordsHelper),a=Object(Gi.d)(this._mapBounds);a.origin[2]=i,function(t,e,i,a=0,n){n||(n=Object(Gi.b)()),e.toRenderCoords(t.origin,i,n.origin);const r=te.d.get();Object(h.j)(r,t.origin,t.basis1),Object(h.j)(r,r,t.basis2),e.toRenderCoords(r,i,r);const o=te.d.get();Object(h.j)(o,t.origin,t.basis1),Object(h.k)(o,o,t.basis2),e.toRenderCoords(o,i,o);const s=te.d.get();Object(h.k)(s,t.origin,t.basis1),Object(h.k)(s,s,t.basis2),e.toRenderCoords(s,i,s);const c=te.d.get();Object(h.k)(c,t.origin,t.basis1),Object(h.j)(c,c,t.basis2),e.toRenderCoords(c,i,c);const l=Object(h.q)(te.d.get(),r,o,.5);Object(h.k)(l,l,n.origin);const p=Object(h.q)(te.d.get(),s,c,.5);Object(h.k)(p,n.origin,p),Object(h.q)(n.basis1,l,p,.5);const d=Object(h.q)(te.d.get(),c,r,.5);Object(h.k)(d,d,n.origin);const u=Object(h.q)(te.d.get(),o,s,.5);Object(h.k)(u,n.origin,u),Object(h.q)(n.basis2,d,u,.5);const b=Object(h.o)(te.d.get(),n.basis1,n.basis2),O=Object(h.o)(b,b,n.basis1);Object(h.w)(O,O),Object(h.p)(n.basis2,O,Object(h.n)(n.basis2,O)),Object(h.p)(n.basis1,n.basis1,1+a/Object(h.u)(n.basis1)),Object(h.p)(n.basis2,n.basis2,1+a/Object(h.u)(n.basis2)),Object(Gi.n)(n)}(a,this.view.renderCoordsHelper,t.spatialReference,this._displayBoundsMargin,this._displayBounds),this._updateManipulators()}get _displayBoundsMargin(){const t=this.view.pointsOfInterest,e=t?t.centerOnSurfaceFrequent.location:this._editGeometryOperations.data.geometry.extent.center;return qi*this.view.pixelSizeAt(e)}_createMoveXYGraphicDragPipeline(){return this._graphicMoveManipulation.createDragPipeline(((t,e,i)=>this._applyGraphicMoveSteps(e,i,je.XY)))}_createMoveZDragPipeline(){const t=this.view,e=this._editGeometryOperations.data.spatialReference;return Object(ie.e)(this._moveZManipulator,((i,a,n)=>{const r=Object(p.d)(i.renderLocation),o=a.next(Object(ee.i)(t,r,e)).next(Object(ie.c)());this._applyGraphicMoveSteps(o,n,je.Z)}))}_applyGraphicMoveSteps(t,e,i){const a=t.next((t=>("start"===t.action&&(this.inputState={type:"move"},this._updateOperationStartProperties(),this.emit("graphic-translate-start",{graphic:this.graphic,dxScreen:t.screenDeltaX,dyScreen:t.screenDeltaY})),t))).next(Object(ie.b)()).next(this._moveDragUpdateGeometry()).next((t=>{const e={graphic:this.graphic,dxScreen:t.screenDeltaX,dyScreen:t.screenDeltaY};switch(t.action){case"start":case"update":(t.mapEnd.x-t.mapStart.x||t.mapEnd.y-t.mapStart.y||t.mapEnd.z-t.mapStart.z)&&this.emit("graphic-translate",e);break;case"end":this.inputState=null,this.emit("graphic-translate-stop",e)}return t})).next((t=>this._updateMoveTooltip(t,i)));return e.next((()=>{Object(r.l)(this.inputState)&&this.emit("graphic-translate-stop",{graphic:this.graphic,dxScreen:0,dyScreen:0}),this._cancel()})),a}_updateOperationStartProperties(){Object(Gi.d)(this._displayBounds,this._displayBoundsStart),Object(Gi.d)(this._mapBounds,this._mapBoundsStart),Object(r.k)(this.graphic.geometry)?this._sizeStart=null:this._sizeStart=Bi(this._mapBoundsStart,this._zmax,this.graphic.geometry.spatialReference,this._graphicState.isDraped)}_moveDragUpdateGeometry(){return t=>{if(Object(r.k)(this.inputState)||"move"!==this.inputState.type)return t;const e=[];for(const a of this._editGeometryOperations.data.components)e.push(...a.vertices);const i="start"===t.action?Xe.a.NEW_STEP:Xe.a.ACCUMULATE_STEPS;return Ui(this._editGeometryOperations.moveVertices(e,t.mapDeltaX,t.mapDeltaY,t.mapDeltaZ,i),this._mapBounds),this.graphic.geometry=this._editGeometryOperations.data.geometry,t}}_updateMoveTooltip(t,e){if(e===je.XY||e===je.XY_AXIS){const e=Object(S.d)(t.mapStart,t.mapEnd,this._graphicState.isDraped?"on-the-ground":"absolute-height");Object(r.l)(e)&&Object(r.l)(this._moveXYTooltipInfo)&&(this._moveXYTooltipInfo.distance=e)}return t}_onResizeGrab(t){if("start"!==t.action)return;const e=this._calculatePickRay(t.screenPoint);Object(Le.n)(this._displayBounds.plane,e,te.d.get())&&(this._updateOperationStartProperties(),this._displayBoundsMarginStart=this._displayBoundsMargin,this.inputState={type:"resize"})}_createResizeDragPipeline(t,e){return Object(ie.e)(t,((t,i,a)=>{Object(r.k)(this.inputState)||(i.next((t=>("start"===t.action&&this.emit("graphic-scale-start",{graphic:this.graphic,xScale:1,yScale:1}),t))).next(Object(ee.g)(this.view,this._displayBoundsStart.plane)).next((t=>({...t,handle:e}))).next(this._resizeDragRenderPlaneToFactors()).next(this._preserveAspectRatio.createDragEventPipelineStep(),this._preserveAspectRatio.next).next(this._resizeDragUpdateGeometry()).next((t=>{const e={graphic:this.graphic,xScale:t.factor1,yScale:t.factor2};switch(t.action){case"start":case"update":this.emit("graphic-scale",e);break;case"end":this.inputState=null,this.emit("graphic-scale-stop",e)}return t})),a.next((()=>{Object(r.l)(this.inputState)&&this.emit("graphic-scale-stop",{graphic:this.graphic,xScale:1,yScale:1}),this._cancel()})))}))}_resizeDragRenderPlaneToFactors(){return t=>{const e=this._displayBoundsStart,i=t.handle.direction,a=this._displayBoundsMargin,n=this._displayBoundsMarginStart,r=Object(h.l)(te.d.get(),e.origin);Object(h.I)(r,r,e.basis1,-i[0]),Object(h.I)(r,r,e.basis2,-i[1]);const o=Object(h.k)(te.d.get(),t.renderEnd,r),s=Object(h.k)(te.d.get(),t.renderStart,r),c=Object(Pi.q)(t.handle),l=Object(Pi.g)(e),p=Object(Pi.g)(this._displayBounds)/l,d=(t,e)=>{if(0===t)return 1;let i=Object(h.u)(e),r=.5*t*Object(h.n)(e,o)/i;const l=r<0?-1:1;c&&(r+=(i-.5*t*Object(h.n)(e,s)/i)*l*p);const d=i<1.5*n?1:Ji;return i=Math.max(i-n,Ji),l>0&&(r-=a),l*Math.max(l*(r/i),d)};return{...t,factor1:d(i[0],e.basis1),factor2:d(i[1],e.basis2)}}}_resizeDragUpdateGeometry(){return t=>{const e=Object(h.l)(Object(p.f)(),this._mapBoundsStart.origin);Object(h.I)(e,e,this._mapBoundsStart.basis1,-t.handle.direction[0]),Object(h.I)(e,e,this._mapBoundsStart.basis2,-t.handle.direction[1]);const i=Object(v.s)(Object(y.c)(),this._mapBoundsStart.basis1[0],this._mapBoundsStart.basis1[1]);Object(v.f)(i,i);const a=[];for(const o of this._editGeometryOperations.data.components)a.push(...o.vertices);const n="start"===t.action?Xe.a.NEW_STEP:Xe.a.ACCUMULATE_STEPS,r=this._editGeometryOperations.scaleVertices(a,e,i,t.factor1,t.factor2,n,Vi.a.REPLACE);return Object(Gi.d)(this._mapBoundsStart,this._mapBounds),Ui(r,this._mapBounds),this.graphic.geometry=this._editGeometryOperations.data.geometry,t}}_onRotateGrab(t){if("start"!==t.action)return;const e=Object(Pi.n)(this._displayBounds,this.view.renderCoordsHelper,Pi.d.HEADING,Object(Le.d)()),i=this._calculatePickRay(t.screenPoint);Object(Le.n)(e,i,te.d.get())&&(this._updateOperationStartProperties(),this.inputState={type:"rotate",rotatePlane:e})}_createRotateDragPipeline(t){return Object(ie.e)(t,((t,e,i)=>{const a=this.inputState;Object(r.k)(a)||(e.next((t=>("start"===t.action&&this.emit("graphic-rotate-start",{graphic:this.graphic,angle:0}),t))).next(Object(ee.g)(this.view,a.rotatePlane)).next(this._rotateDragRenderPlaneToRotate(a)).next(this._rotateDragUpdateGeometry()).next((t=>{const e={graphic:this.graphic,angle:Object(At.q)(t.rotateAngle)};switch(t.action){case"start":case"update":this.emit("graphic-rotate",e);break;case"end":this.inputState=null,this.emit("graphic-rotate-stop",e)}return t})),i.next((()=>{Object(r.l)(this.inputState)&&this.emit("graphic-rotate-stop",{graphic:this.graphic,angle:0}),this._cancel()})))}))}_rotateDragRenderPlaneToRotate(t){return e=>{const i=Object(Le.q)(t.rotatePlane),a=Object(St.a)(e.renderStart,e.renderEnd,this._displayBounds.origin,i);return{...e,rotateAxis:i,rotateAngle:a}}}_rotateDragUpdateGeometry(){return t=>{const e=Object(h.l)(Object(p.f)(),this._mapBoundsStart.origin),i=[];for(const r of this._editGeometryOperations.data.components)i.push(...r.vertices);const a="start"===t.action?Xe.a.NEW_STEP:Xe.a.ACCUMULATE_STEPS,n=this._editGeometryOperations.rotateVertices(i,e,t.rotateAngle,a,Vi.a.REPLACE);return Object(Gi.d)(this._mapBoundsStart,this._mapBounds),Ui(n,this._mapBounds),this.graphic.geometry=this._editGeometryOperations.data.geometry,t}}_calculatePickRay(t){const e=Object(ui.c)(),i=Object(b.j)(t);return Object(zi.c)(this.view.state.camera,i,e),Object(h.w)(e.direction,e.direction),e}_updateManipulators(){if(!this.visible)return;const t=Object(Pi.f)(this._displayBounds,te.a.get());Object(Pi.z)(this._rotateManipulator,t,this._displayBounds,this.view.renderCoordsHelper),this._updateZMoveHandle(this._moveZManipulator,t),this._resizeManipulators.forEach(((e,i)=>{Object(Pi.y)(e,this._resizeHandles[i],t,this._displayBounds)}))}_updateZMoveHandle(t,e){const i=this._displayBounds,a={basis:i.basis1,direction:-1,position:Object(h.k)(te.d.get(),i.origin,i.basis1),edge:2},n=te.a.get();Object(Kt.r)(n,e,a.edge*Math.PI/2),n[12]=0,n[13]=0,n[14]=0,t.modelTransform=n,t.renderLocation=a.position}_cancel(){const t=this._editGeometryOperations.lastOperation;Object(r.k)(t)||(this._editGeometryOperations.undo(),this.graphic.geometry=this._editGeometryOperations.data.geometry,Fi(t,this._mapBounds),this._updateDisplayBounds(),this.inputState=null)}get canUndo(){return this._editGeometryOperations.canUndo}undo(){if(Object(r.l)(this.inputState))this.view.activeTool=null;else if(this.canUndo){const t=this._editGeometryOperations.undo();this.graphic.geometry=this._editGeometryOperations.data.geometry,Fi(Object(r.t)(t),this._mapBounds),this._updateDisplayBounds()}}get canRedo(){return this._editGeometryOperations.canRedo}redo(){if(this.canRedo){const t=this._editGeometryOperations.redo();this.graphic.geometry=this._editGeometryOperations.data.geometry,Ui(Object(r.t)(t),this._mapBounds),this._updateDisplayBounds()}}get test(){return{resizeManipulators:this._resizeManipulators,rotateManipulator:this._rotateManipulator,moveZManipulator:this._moveZManipulator,tooltip:this._tooltip}}};Object(a.a)([Object(s.b)({constructOnly:!0,nonNullable:!0})],Yi.prototype,"view",void 0),Object(a.a)([Object(s.b)({constructOnly:!0,nonNullable:!0})],Yi.prototype,"graphic",void 0),Object(a.a)([Object(s.b)({constructOnly:!0,nonNullable:!0})],Yi.prototype,"enableZ",void 0),Object(a.a)([Object(s.b)()],Yi.prototype,"enableRotation",void 0),Object(a.a)([Object(s.b)()],Yi.prototype,"enableScaling",void 0),Object(a.a)([Object(s.b)({constructOnly:!0,type:Se.a})],Yi.prototype,"tooltipOptions",void 0),Object(a.a)([Object(s.b)()],Yi.prototype,"preserveAspectRatio",null),Object(a.a)([Object(s.b)()],Yi.prototype,"grabbing",void 0),Object(a.a)([Object(s.b)()],Yi.prototype,"inputState",void 0),Object(a.a)([Object(s.b)({readOnly:!0})],Yi.prototype,"type",void 0),Object(a.a)([Object(s.b)()],Yi.prototype,"_moveUnit",null),Yi=Object(a.a)([Object(l.a)("esri.views.3d.interactive.editingTools.graphicTransform3D.ExtentTransformTool")],Yi);const Wi="draped-elevation-changes",qi=10,Qi=80,Ji=1e-6}}]);
//# sourceMappingURL=8.343a5576.chunk.js.map