{"version":3,"sources":["../node_modules/@arcgis/core/views/layers/support/popupUtils.js","../node_modules/@arcgis/core/renderers/support/clickToleranceUtils.js","../node_modules/@arcgis/core/views/support/drapedUtils.js","../node_modules/@arcgis/core/rest/operations/identify.js","../node_modules/@arcgis/core/rest/support/IdentifyParameters.js","../node_modules/@arcgis/core/rest/support/IdentifyResult.js","../node_modules/@arcgis/core/rest/identify.js","../node_modules/@arcgis/core/views/layers/MapImageLayerView.js","../node_modules/@arcgis/core/views/3d/layers/MapImageLayerView3D.js"],"names":["async","d","l","popupTemplate","e","s","getRequiredFields","fieldsIndex","lastEditInfoEnabled","i","objectIdField","n","typeIdField","u","globalIdField","a","relationships","o","includes","r","p","f","t","push","has","forEach","keyField","defaultPopupTemplateEnabled","defaultPopupTemplate","xoffset","Math","max","abs","yoffset","stops","length","size","filter","type","map","maxSize","minSize","floor","renderer","event","pointerType","visualVariables","symbol","uniqueValueInfos","classBreakInfos","resolution","overlayPixelSizeInMapUnits","basemapSpatialReference","equals","spatialReference","m","x","y","c","xmin","min","ymin","xmax","ymax","toMap","intersects","wkid","JSON","stringify","dpi","gdbVersion","geometry","geometryPrecision","height","layerOption","mapExtent","maxAllowableOffset","returnFieldName","returnGeometry","returnUnformattedValues","g","returnZ","b","timeExtent","h","tolerance","E","width","O","toJSON","dynamicLayers","S","layerDefs","j","layerIds","N","floors","sublayers","find","layer","serviceSublayers","extent","minScale","maxScale","visible","id","popupEnabled","unshift","toExportImageJSON","definitionExpression","floorInfo","Object","keys","J","R","$","imageDisplay","geometryType","sr","time","start","end","join","layers","constructor","super","this","returnM","static","Number","json","write","prototype","String","types","read","Boolean","displayFieldName","feature","layerId","layerName","readFeature","fromJSON","attributes","writeFeature","from","path","then","query","Map","set","results","sourceLayer","get","data","exceededTransferLimit","_","F","I","arguments","_featuresResolutions","WeakMap","highlightGraphics","updateHighlightedFeatures","destroyed","updatingHandles","addPromise","_updateHighlightedFeaturesGeometries","catch","initialize","exportImageParameters","handles","add","_updateHighlightedFeaturesSymbols","added","_highlightGeometriesResolution","destroy","exportImageVersion","commitProperty","_get","capabilities","operations","supportsQuery","supportsIdentify","version","_fetchPopupFeaturesUsingQueries","_fetchPopupFeaturesUsingIdentify","canResume","isEmpty","getSymbolAsync","getSize","view","scale","shape","style","highlightGraphicUpdated","_getTargetResolution","getObjectId","Array","createQuery","objectIds","outFields","outSpatialReference","queryFeatures","Promise","all","features","_createIdentifyParameters","parsedUrl","_collectPopupProviders","sublayer","load","allSublayers","reduce","createFetchPopupFeaturesQueryGeometry","round","center","w","v","clone","where","_loadArcadeModules","arcadeUtils","hasGeometryOperations","reverse","value","P","toArray","expressionInfos","isArray","content","some","readOnly","refreshDebounced","highlight","remove","getFetchOptions"],"mappings":"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","file":"static/js/94.91205564.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{isNone as e,isSome as l}from\"../../../core/maybe.js\";import{getFeatureEditFields as p,fixFields as t}from\"../../../layers/support/fieldUtils.js\";async function d(l,d=l.popupTemplate){if(e(d))return[];const s=await d.getRequiredFields(l.fieldsIndex),{lastEditInfoEnabled:i}=d,{objectIdField:n,typeIdField:u,globalIdField:a,relationships:o}=l;if(s.includes(\"*\"))return[\"*\"];const r=i?await p(l):[],f=t(l.fieldsIndex,[...s,...r]);return u&&f.push(u),f&&n&&l.fieldsIndex.has(n)&&!f.includes(n)&&f.push(n),f&&a&&l.fieldsIndex.has(a)&&!f.includes(a)&&f.push(a),o&&o.forEach((e=>{const{keyField:p}=e;f&&p&&l.fieldsIndex.has(p)&&!f.includes(p)&&f.push(p)})),f}function s(e,p){return e.popupTemplate?e.popupTemplate:l(p)&&p.defaultPopupTemplateEnabled&&l(e.defaultPopupTemplate)?e.defaultPopupTemplate:null}export{s as getFetchPopupTemplate,d as getRequiredFields};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nfunction t(t,e){return e?\"xoffset\"in e&&e.xoffset?Math.max(t,Math.abs(e.xoffset)):\"yoffset\"in e&&e.yoffset?Math.max(t,Math.abs(e.yoffset||0)):t:t}function e(t){let e=0,n=0;for(let r=0;r<t.length;r++){const s=t[r].size;\"number\"==typeof s&&(e+=s,n++)}return e/n}function n(t,n){return\"number\"==typeof t?t:t&&t.stops&&t.stops.length?e(t.stops):n}function r(t,e){if(!e)return t;const r=e.filter((t=>\"size\"===t.type)).map((e=>{const{maxSize:r,minSize:s}=e;return(n(r,t)+n(s,t))/2}));let s=0;const o=r.length;if(0===o)return t;for(let n=0;n<o;n++)s+=r[n];const f=Math.floor(s/o);return Math.max(f,t)}function s(e){const n=e&&e.renderer,s=\"touch\"===(e&&e.event&&e.event.pointerType)?9:6;if(!n)return s;const o=\"visualVariables\"in n?r(s,n.visualVariables):s;if(\"simple\"===n.type)return t(o,n.symbol);if(\"unique-value\"===n.type){let e=o;return n.uniqueValueInfos?.forEach((n=>{e=t(e,n.symbol)})),e}if(\"class-breaks\"===n.type){let e=o;return n.classBreakInfos.forEach((n=>{e=t(e,n.symbol)})),e}return\"dot-density\"===n.type||n.type,o}export{s as calculateTolerance};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport\"../../geometry.js\";import{isSome as e,isNone as t}from\"../../core/maybe.js\";import{getMetersPerUnitForSR as r}from\"../../core/unitUtils.js\";import{calculateTolerance as n}from\"../../renderers/support/clickToleranceUtils.js\";import i from\"../../geometry/Extent.js\";function a(t,n,a,o=new i){let s;if(\"2d\"===a.type)s=n*a.resolution;else if(\"3d\"===a.type){const i=a.overlayPixelSizeInMapUnits(t),o=a.basemapSpatialReference;s=e(o)&&!o.equals(a.spatialReference)?r(o)/r(a.spatialReference):n*i}const m=t.x-s,p=t.y-s,c=t.x+s,l=t.y+s,{spatialReference:f}=a;return o.xmin=Math.min(m,c),o.ymin=Math.min(p,l),o.xmax=Math.max(m,c),o.ymax=Math.max(p,l),o.spatialReference=f,o}function o(e,r,i){const o=i.toMap(e);if(t(o))return!1;return a(o,n(),i,s).intersects(r)}const s=new i;export{a as createQueryGeometry,o as intersectsDrapedGeometry};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../core/maybe.js\";import{sqlAnd as r}from\"../../core/sql.js\";import{getJsonType as t}from\"../../geometry/support/jsonUtils.js\";import{getScale as i}from\"../../geometry/support/scaleUtils.js\";import{getLayerFloorFilterClause as n}from\"../../layers/support/floorFilterUtils.js\";import{isExportDynamic as s}from\"../../layers/support/sublayerUtils.js\";const o=e=>e.spatialReference.wkid||JSON.stringify(e.spatialReference);function l(r,i){const{dpi:n,gdbVersion:s,geometry:l,geometryPrecision:f,height:p,layerOption:m,mapExtent:y,maxAllowableOffset:c,returnFieldName:u,returnGeometry:d,returnUnformattedValues:g,returnZ:x,spatialReference:b,timeExtent:h,tolerance:E,width:O}=r.toJSON(),{dynamicLayers:S,layerDefs:j,layerIds:N}=a(r),J=i&&e(i.geometry)?i.geometry:null,R={geometryPrecision:f,maxAllowableOffset:c,returnFieldName:u,returnGeometry:d,returnUnformattedValues:g,returnZ:x,tolerance:E},$=J&&J.toJSON()||l;if(R.imageDisplay=`${O},${p},${n}`,s&&(R.gdbVersion=s),$&&(delete $.spatialReference,R.geometry=JSON.stringify($),R.geometryType=t($)),b?R.sr=b.wkid||JSON.stringify(b):$&&$.spatialReference?R.sr=o($):y&&y.spatialReference&&(R.sr=o(y)),R.time=h?[h.start,h.end].join(\",\"):null,y){const{xmin:e,ymin:r,xmax:t,ymax:i}=y;R.mapExtent=`${e},${r},${t},${i}`}return j&&(R.layerDefs=j),S&&!j&&(R.dynamicLayers=S),R.layers=\"popup\"===m?\"visible\":m,N&&!S&&(R.layers+=`:${N.join(\",\")}`),R}function a(r){const{mapExtent:t,floors:o,width:l,sublayers:a,layerIds:p,layerOption:m,gdbVersion:y}=r,c=a?.find((e=>null!=e.layer))?.layer?.serviceSublayers,u=\"popup\"===m,d={},g=i({extent:t,width:l,spatialReference:t?.spatialReference}),x=[],b=e=>{const r=0===g,t=0===e.minScale||g<=e.minScale,i=0===e.maxScale||g>=e.maxScale;if(e.visible&&(r||t&&i))if(e.sublayers)e.sublayers.forEach(b);else{if(!1===p?.includes(e.id)||u&&(!e.popupTemplate||!e.popupEnabled))return;x.unshift(e)}};if(a?.forEach(b),a&&!x.length)d.layerIds=[];else{const r=s(x,c,y),t=x.map((e=>{const r=n(o,e);return e.toExportImageJSON(r)}));if(r)d.dynamicLayers=JSON.stringify(t);else{if(a){let e=x.map((({id:e})=>e));p&&(e=e.filter((e=>p.includes(e)))),d.layerIds=e}else p?.length&&(d.layerIds=p);const r=f(o,x);if(e(r)&&r.length){const e={};for(const t of r)t.definitionExpression&&(e[t.id]=t.definitionExpression);Object.keys(e).length&&(d.layerDefs=JSON.stringify(e))}}}return d}function f(e,t){const i=!!e?.length,s=t.filter((e=>null!=e.definitionExpression||i&&null!=e.floorInfo));return s.length?s.map((t=>{const i=n(e,t),s=r(i,t.definitionExpression);return{id:t.id,definitionExpression:s}})):null}export{l as identifyToIdentifyRESTParameters,a as toDynamicLayersJSON};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../chunks/tslib.es6.js\";import{geometryTypes as e}from\"../../geometry.js\";import o from\"../../TimeExtent.js\";import{JSONSupport as r}from\"../../core/JSONSupport.js\";import{property as s}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import{ensureClass as i}from\"../../core/accessorSupport/ensureType.js\";import{subclass as p}from\"../../core/accessorSupport/decorators/subclass.js\";import{fromJSON as n}from\"../../geometry/support/jsonUtils.js\";import l from\"../../geometry/Extent.js\";import y from\"../../geometry/SpatialReference.js\";var m;let a=m=class extends r{constructor(t){super(t),this.dpi=96,this.floors=null,this.gdbVersion=null,this.geometry=null,this.geometryPrecision=null,this.height=400,this.layerIds=null,this.layerOption=\"top\",this.mapExtent=null,this.maxAllowableOffset=null,this.returnFieldName=!0,this.returnGeometry=!1,this.returnM=!1,this.returnUnformattedValues=!0,this.returnZ=!1,this.spatialReference=null,this.sublayers=null,this.timeExtent=null,this.tolerance=null,this.width=400}static from(t){return i(m,t)}};t([s({type:Number,json:{write:!0}})],a.prototype,\"dpi\",void 0),t([s()],a.prototype,\"floors\",void 0),t([s({type:String,json:{write:!0}})],a.prototype,\"gdbVersion\",void 0),t([s({types:e,json:{read:n,write:!0}})],a.prototype,\"geometry\",void 0),t([s({type:Number,json:{write:!0}})],a.prototype,\"geometryPrecision\",void 0),t([s({type:Number,json:{write:!0}})],a.prototype,\"height\",void 0),t([s({type:[Number],json:{write:!0}})],a.prototype,\"layerIds\",void 0),t([s({type:[\"top\",\"visible\",\"all\",\"popup\"],json:{write:!0}})],a.prototype,\"layerOption\",void 0),t([s({type:l,json:{write:!0}})],a.prototype,\"mapExtent\",void 0),t([s({type:Number,json:{write:!0}})],a.prototype,\"maxAllowableOffset\",void 0),t([s({type:Boolean,json:{write:!0}})],a.prototype,\"returnFieldName\",void 0),t([s({type:Boolean,json:{write:!0}})],a.prototype,\"returnGeometry\",void 0),t([s({type:Boolean,json:{write:!0}})],a.prototype,\"returnM\",void 0),t([s({type:Boolean,json:{write:!0}})],a.prototype,\"returnUnformattedValues\",void 0),t([s({type:Boolean,json:{write:!0}})],a.prototype,\"returnZ\",void 0),t([s({type:y,json:{write:!0}})],a.prototype,\"spatialReference\",void 0),t([s()],a.prototype,\"sublayers\",void 0),t([s({type:o,json:{write:!0}})],a.prototype,\"timeExtent\",void 0),t([s({type:Number,json:{write:!0}})],a.prototype,\"tolerance\",void 0),t([s({type:Number,json:{write:!0}})],a.prototype,\"width\",void 0),a=m=t([p(\"esri.rest.support.IdentifyParameters\")],a);const u=a;export{u as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../chunks/tslib.es6.js\";import\"../../geometry.js\";import e from\"../../Graphic.js\";import{JSONSupport as t}from\"../../core/JSONSupport.js\";import{isSome as o}from\"../../core/maybe.js\";import{property as s}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/accessorSupport/ensureType.js\";import{reader as p}from\"../../core/accessorSupport/decorators/reader.js\";import{subclass as a}from\"../../core/accessorSupport/decorators/subclass.js\";import{writer as i}from\"../../core/accessorSupport/decorators/writer.js\";import{typeKebabDictionary as u}from\"../../geometry/support/typeUtils.js\";let m=class extends t{constructor(r){super(r),this.displayFieldName=null,this.feature=null,this.layerId=null,this.layerName=null}readFeature(r,t){return e.fromJSON({attributes:{...t.attributes},geometry:{...t.geometry}})}writeFeature(r,e){if(!r)return;const{attributes:t,geometry:s}=r;t&&(e.attributes={...t}),o(s)&&(e.geometry=s.toJSON(),e.geometryType=u.toJSON(s.type))}};r([s({type:String,json:{write:!0}})],m.prototype,\"displayFieldName\",void 0),r([s({type:e})],m.prototype,\"feature\",void 0),r([p(\"feature\",[\"attributes\",\"geometry\"])],m.prototype,\"readFeature\",null),r([i(\"feature\")],m.prototype,\"writeFeature\",null),r([s({type:Number,json:{write:!0}})],m.prototype,\"layerId\",void 0),r([s({type:String,json:{write:!0}})],m.prototype,\"layerName\",void 0),m=r([a(\"esri.rest.support.IdentifyResult\")],m);const y=m;export{y as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport r from\"../request.js\";import{normalizeCentralMeridian as e}from\"../geometry/support/normalizeUtils.js\";import{parseUrl as t,encode as o,asValidOptions as s}from\"./utils.js\";import{identifyToIdentifyRESTParameters as n}from\"./operations/identify.js\";import u from\"./support/IdentifyParameters.js\";import i from\"./support/IdentifyResult.js\";async function f(u,i,f){const c=(i=a(i)).geometry?[i.geometry]:[],l=t(u);return l.path+=\"/identify\",e(c).then((e=>{const t=n(i,{geometry:e&&e[0]}),u=o({...l.query,f:\"json\",...t}),a=s(u,f);return r(l.path,a).then(m).then((r=>p(r,i.sublayers)))}))}function m(r){const e=r.data;return e.results=e.results||[],e.exceededTransferLimit=Boolean(e.exceededTransferLimit),e.results=e.results.map((r=>i.fromJSON(r))),e}function a(r){return r=u.from(r)}function p(r,e){if(!e?.length)return r;const t=new Map;function o(r){t.set(r.id,r),r.sublayers&&r.sublayers.forEach(o)}e.forEach(o);for(const s of r.results)s.feature.sourceLayer=t.get(s.layerId);return r}export{f as identify};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import\"../../symbols.js\";import t from\"../../core/Error.js\";import has from\"../../core/has.js\";import{getOrCreateMapValue as r}from\"../../core/MapUtils.js\";import{isNone as s,isSome as i}from\"../../core/maybe.js\";import{debounce as o,eachAlways as a}from\"../../core/promiseUtils.js\";import{on as n}from\"../../core/reactiveUtils.js\";import{getMetersPerUnitForSR as l}from\"../../core/unitUtils.js\";import{property as p}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as u}from\"../../core/accessorSupport/decorators/subclass.js\";import h from\"../../geometry/Extent.js\";import{getResolutionForScale as c}from\"../../geometry/support/scaleUtils.js\";import{combinedViewLayerTimeExtentProperty as m}from\"../../layers/support/commonProperties.js\";import{ExportImageParameters as y}from\"../../layers/support/ExportImageParameters.js\";import{getLayerFloorFilterClause as d}from\"../../layers/support/floorFilterUtils.js\";import{calculateTolerance as f}from\"../../renderers/support/clickToleranceUtils.js\";import{identify as g}from\"../../rest/identify.js\";import w from\"../../rest/support/IdentifyParameters.js\";import{loadArcade as b}from\"../../support/arcadeOnDemand.js\";import{GraphicsCollection as x}from\"../../support/GraphicsCollection.js\";import{getRequiredFields as v,getFetchPopupTemplate as P}from\"./support/popupUtils.js\";import j from\"../../symbols/SimpleMarkerSymbol.js\";let _=null;const F=F=>{let I=class extends F{constructor(){super(...arguments),this._featuresResolutions=new WeakMap,this.highlightGraphics=new x,this.updateHighlightedFeatures=o((async e=>{this.destroyed||this.updatingHandles.addPromise(this._updateHighlightedFeaturesGeometries(e).catch((()=>{})))}))}initialize(){this.exportImageParameters=new y({layer:this.layer}),this.handles.add([n((()=>this.highlightGraphics),\"change\",(e=>{this.updatingHandles.addPromise(this._updateHighlightedFeaturesSymbols(e.added).catch((()=>{}))),this.updateHighlightedFeatures(this._highlightGeometriesResolution)}))])}destroy(){this.exportImageParameters.destroy(),this.exportImageParameters=null}get exportImageVersion(){return this.exportImageParameters?.commitProperty(\"version\"),this.commitProperty(\"timeExtent\"),(this._get(\"exportImageVersion\")||0)+1}async fetchPopupFeatures(e,r){const{layer:s}=this;if(!e)throw new t(\"mapimagelayer:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:s});const i=this.layer.capabilities?.operations?.supportsQuery??!0;if(!((this.layer.capabilities?.operations?.supportsIdentify??!0)&&this.layer.version>=10.5)&&!i)throw new t(\"mapimagelayer:fetchPopupFeatures-not-supported\",\"query operation is disabled for this service\",{layer:s});return i?this._fetchPopupFeaturesUsingQueries(e,r):this._fetchPopupFeaturesUsingIdentify(e,r)}canResume(){return!!super.canResume()&&!this.timeExtent?.isEmpty}async _updateHighlightedFeaturesSymbols(e){for(const t of e){const e=\"renderer\"in t.sourceLayer&&t.sourceLayer.renderer;\"geometryType\"in t.sourceLayer&&\"point\"===t.sourceLayer.geometryType&&e&&\"getSymbolAsync\"in e&&e.getSymbolAsync(t).then((async r=>{let s=\"width\"in r&&\"height\"in r&&null!=r.width&&null!=r.height?Math.max(r.width,r.height):\"size\"in r?r.size:null;const i=\"visualVariables\"in e&&e.visualVariables?.find((e=>\"size\"===e.type));i&&(_||(_=(await import(\"../../renderers/visualVariables/support/visualVariableUtils.js\")).getSize),s=_(i,t,{view:this.view.type,scale:this.view.scale,shape:\"simple-marker\"===r.type?r.style:null})),this.highlightGraphics.includes(t)&&(t.symbol=new j({style:\"square\",size:s,xoffset:\"xoffset\"in r?r.xoffset:0,yoffset:\"yoffset\"in r?r.yoffset:0}),t.visible=!0,this.highlightGraphicUpdated(t,\"symbol\"))}))}}async _updateHighlightedFeaturesGeometries(e){this._highlightGeometriesResolution=e;const t=this.highlightGraphics;if(!t.length||!this.layer.capabilities.operations.supportsQuery)return;const s=this._getTargetResolution(e),i=new Map;for(const n of t)if(!this._featuresResolutions.has(n)||this._featuresResolutions.get(n)>s){const e=n.sourceLayer;r(i,e,(()=>new Map)).set(n.getObjectId(),n)}const o=Array.from(i,(([e,t])=>{const r=e.createQuery();return r.objectIds=[...t.keys()],r.outFields=[e.objectIdField],r.returnGeometry=!0,r.maxAllowableOffset=s,r.outSpatialReference=this.view.spatialReference,e.queryFeatures(r)})),a=await Promise.all(o);if(!this.destroyed)for(const{features:r}of a)for(const e of r){const t=e.sourceLayer,r=i.get(t).get(e.getObjectId());r&&this.highlightGraphics.includes(r)&&(r.geometry=e.geometry,this.highlightGraphicUpdated(r,\"geometry\"),this._featuresResolutions.set(r,s))}}_getTargetResolution(e){const t=e*l(this.view.spatialReference),r=t/16;return r<=10?0:e/t*r}async _fetchPopupFeaturesUsingIdentify(e,t){const r=await this._createIdentifyParameters(e,t);if(s(r))return[];const{results:i}=await g(this.layer.parsedUrl,r);return i.map((e=>e.feature))}async _createIdentifyParameters(e,t){const{floors:r,spatialReference:s,scale:o}=this.view,a=i(t)?t.event:null,n=await this._collectPopupProviders(this.layer.sublayers,o,t);if(!n.length)return null;await Promise.all(n.map((({sublayer:e})=>e.load().catch((()=>{})))));const l=Math.min(has(\"mapimagelayer-popup-identify-max-tolerance\"),this.layer.allSublayers.reduce(((e,t)=>t.renderer?f({renderer:t.renderer,event:a}):e),2)),p=this.createFetchPopupFeaturesQueryGeometry(e,l),u=c(o,s),m=Math.round(p.width/u),y=new h({xmin:p.center.x-u*m,ymin:p.center.y-u*m,xmax:p.center.x+u*m,ymax:p.center.y+u*m,spatialReference:p.spatialReference});return new w({floors:r,gdbVersion:this.layer.gdbVersion,geometry:e,height:m,layerOption:\"popup\",mapExtent:y,returnGeometry:!0,spatialReference:s,sublayers:this.layer.sublayers,timeExtent:this.timeExtent,tolerance:l,width:m})}async _fetchPopupFeaturesUsingQueries(e,t){const r=await this._collectPopupProviders(this.layer.sublayers,this.view.scale,t),s=i(t)?t.event:null,o=r.map((async({sublayer:t,popupTemplate:r})=>{await t.load().catch((()=>{}));const o=t.createQuery(),a=f({renderer:t.renderer,event:s}),n=this.createFetchPopupFeaturesQueryGeometry(e,a);if(o.geometry=n,o.outFields=await v(t,r),o.timeExtent=this.timeExtent,\"floors\"in this.view){const e=this.view?.floors?.clone(),r=d(e,t);i(r)&&(o.where=o.where?`(${o.where}) AND (${r})`:r)}const l=this._getTargetResolution(n.width/a),p=await this._loadArcadeModules(r),u=\"point\"===t.geometryType||p&&p.arcadeUtils.hasGeometryOperations(r);u||(o.maxAllowableOffset=l);const{features:h}=await t.queryFeatures(o),c=u?0:l;for(const e of h)this._featuresResolutions.set(e,c);return h}));return(await a(o)).reverse().reduce(((e,t)=>t.value?[...e,...t.value]:e),[]).filter((e=>null!=e))}async _collectPopupProviders(e,t,r){const s=[],o=async e=>{const a=0===e.minScale||t<=e.minScale,n=0===e.maxScale||t>=e.maxScale;if(e.visible&&a&&n)if(e.sublayers)e.sublayers.forEach(o);else if(e.popupEnabled){const t=P(e,{...r,defaultPopupTemplateEnabled:!1});i(t)&&s.unshift({sublayer:e,popupTemplate:t})}},a=e.toArray().reverse().map(o);return await Promise.all(a),s}_loadArcadeModules(e){if(e.expressionInfos?.length||Array.isArray(e.content)&&e.content.some((e=>\"expression\"===e.type)))return b()}};return e([p()],I.prototype,\"highlightGraphics\",void 0),e([p()],I.prototype,\"exportImageParameters\",void 0),e([p({readOnly:!0})],I.prototype,\"exportImageVersion\",null),e([p()],I.prototype,\"layer\",void 0),e([p()],I.prototype,\"suspended\",void 0),e([p(m)],I.prototype,\"timeExtent\",void 0),I=e([u(\"esri.views.layers.MapImageLayerView\")],I),I};export{F as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import\"../../../core/Logger.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/Error.js\";import\"../../../core/has.js\";import{subclass as r}from\"../../../core/accessorSupport/decorators/subclass.js\";import t from\"./DynamicLayerView3D.js\";import s from\"../../layers/MapImageLayerView.js\";import{createQueryGeometry as i}from\"../../support/drapedUtils.js\";let o=class extends(s(t)){constructor(){super(...arguments),this.type=\"map-image-3d\"}initialize(){this.updatingHandles.add((()=>this.exportImageVersion),(()=>this.updatingHandles.addPromise(this.refreshDebounced())))}createFetchPopupFeaturesQueryGeometry(e,r){return i(e,r,this.view)}highlight(e){return{remove:()=>{}}}highlightGraphicUpdated(e,r){}getFetchOptions(){return{timeExtent:this.timeExtent}}};o=e([r(\"esri.views.3d.layers.MapImageLayerView3D\")],o);const a=o;export{a as default};\n"],"sourceRoot":""}