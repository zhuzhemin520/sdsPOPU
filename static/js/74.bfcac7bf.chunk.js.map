{"version":3,"sources":["../node_modules/@arcgis/core/views/layers/LayerView.js","../node_modules/@arcgis/core/views/3d/layers/LayerView3D.js","../node_modules/@arcgis/core/chunks/ImageMaterial.glsl.js","../node_modules/@arcgis/core/views/3d/webgl-engine/shaders/ImageMaterialTechnique.js","../node_modules/@arcgis/core/views/3d/webgl-engine/materials/ImageMaterial.js","../node_modules/@arcgis/core/geometry/support/normalizeUtilsSync.js","../node_modules/@arcgis/core/layers/support/mediaUtils.js","../node_modules/@arcgis/core/views/3d/layers/MediaLayerView3D.js"],"names":["d","s","i","l","r","EventedMixin","t","constructor","e","super","this","layer","parent","initialize","when","catch","name","id","title","o","getLogger","declaredClass","error","fullOpacity","n","get","suspended","canResume","suspendInfo","getSuspendInfo","legendEnabled","updating","updatingHandles","isUpdating","updatingProgress","visible","_overrideIfSome","loaded","view","ready","viewNotReady","layerNotLoaded","layerInvisible","a","prototype","readOnly","type","Boolean","p","u","c","arguments","slicePlaneEnabled","supportsHeightUnitConversion","postscript","addResolvingPromise","_validateHeightModelInfo","async","AbortController","signal","handles","add","abort","defaultsFromMap","heightModelInfoReady","heightModelInfo","effectiveScaleRange","minScale","maxScale","outsideScaleRange","f","w","vertex","h","fragment","b","include","attributes","v","POSITION","UV0","varyings","hasMultipassTerrain","uniforms","texture","descriptor","textureCoordinateScaleFactor","code","g","opacity","output","Alpha","float","transparencyPassType","m","Color","Object","freeze","defineProperty","__proto__","build","Symbol","toStringTag","value","N","_","initializeProgram","rctx","shader","configuration","_setPipelineState","y","NONE","FrontFace","j","blending","transparent","C","culling","O","cullFace","depthTest","func","depthWrite","writeDepth","S","colorWrite","stencilWrite","hasOccludees","stencilTest","polygonOffset","enableOffset","initializePipeline","_occludeePipelineState","getPipelineState","P","T","ONE","ONE_MINUS_SRC_ALPHA","None","hasSlicePlane","cullAboveGround","count","COUNT","supportsEdges","_configuration","getConfiguration","parameters","camera","relativeElevation","multipassTerrain","enabled","intersect","requiresSlot","Highlight","DRAPED_MATERIAL","OPAQUE_MATERIAL","TRANSPARENT_MATERIAL","TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL","createGLMaterial","createBufferWriter","material","_updateParameters","updateTexture","_material","textureId","setParameters","textureBindParameters","ensureTechnique","_updateOccludeeState","beginSlot","_output","initTextureTransparent","spatialReference","toJSON","I","maxX","minX","points","map","xmin","ymin","xmax","ymax","x","valid","frameId","push","extent","length","rings","Array","isArray","Math","ceil","abs","cut","paths","frameIds","_linesIn","_linesOut","_xCut","_closed","_minPts","moveTo","lineTo","close","_pushLineIn","_pushLineOut","_prevSide","_side","_moveTo","_prevPt","_firstPt","_intersect","_lineTo","_checkClosingPt","_lineIn","_lineOut","_addPolyVertex","pop","bounds","coords","element","georeference","geometry","normalizedCoords","fromJSON","normalizedBounds","drapeSourceType","RasterImage","updatePolicy","ASYNC","_uidToElement","Map","_renderedElements","_lastDrapingExtent","_update","_collectMediaElements","_synchronizeRenderElements","_renderer","basemapTerrain","overlayManager","registerGeometryDrapeSource","unregisterDrapeSource","source","_updateWithLastDrapingExtent","setDrapingExtent","overlays","getHit","Set","addPromise","Promise","all","queryElements","flat","_synchronizeRenderElementsRemove","_synchronizeRenderElementsAdd","forEach","has","renderData","renderGeometry","_removeElement","removeGeometries","E","REMOVE","_createRenderElement","handle","_destroyRenderData","delete","uid","remove","_updateGeometry","_initializeRenderData","content","set","load","_createTexture","_stage","loadImmediate","_positionVertexBufferFromCoordinates","data","size","exclusive","layerUid","graphicUid","addGeometries","ADD","vertexAttributes","modifyGeometries","D","VERTEXATTRS","Float64Array","dispose","HTMLImageElement","naturalWidth","width","naturalHeight","height","R","wrap","CLAMP_TO_EDGE","preMultiplyAlpha","mipmap","powerOfTwoResizeMode","STRETCH","updateCallback","setDrawTexturesDirty","test","numberOfElements","M"],"mappings":"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","file":"static/js/74.bfcac7bf.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import t from\"../../core/Accessor.js\";import r from\"../../core/Evented.js\";import{HandleOwnerMixin as s}from\"../../core/HandleOwner.js\";import{IdentifiableMixin as i}from\"../../core/Identifiable.js\";import o from\"../../core/Logger.js\";import{unwrapOr as n}from\"../../core/maybe.js\";import{EsriPromiseMixin as l}from\"../../core/Promise.js\";import{property as a}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as p}from\"../../core/accessorSupport/decorators/subclass.js\";let d=class extends(s(i(l(r.EventedMixin(t))))){constructor(e){super(e),this.layer=null,this.parent=null}initialize(){this.when().catch((e=>{if(\"layerview:create-error\"!==e.name){const t=this.layer&&this.layer.id||\"no id\",r=this.layer&&this.layer.title||\"no title\";o.getLogger(this.declaredClass).error(\"#resolve()\",`Failed to resolve layer view (layer title: '${r}', id: '${t}')`,e)}}))}get fullOpacity(){return n(this.get(\"layer.opacity\"),1)*n(this.get(\"parent.fullOpacity\"),1)}get suspended(){return!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){return!this.suspended&&!0===this.layer?.legendEnabled}get updating(){return!(!this.updatingHandles?.updating&&!this.isUpdating())}get updatingProgress(){return this.updating?0:1}get visible(){return!0===this.layer?.visible}set visible(e){this._overrideIfSome(\"visible\",e)}canResume(){return this.visible&&this.layer?.loaded&&!this.parent?.suspended&&this.view?.ready||!1}getSuspendInfo(){const e=this.parent&&this.parent.suspended?this.parent.suspendInfo:{},t=this;return t.view&&t.view.ready||(e.viewNotReady=!0),this.layer&&this.layer.loaded||(e.layerNotLoaded=!0),this.visible||(e.layerInvisible=!0),e}isUpdating(){return!1}};e([a()],d.prototype,\"fullOpacity\",null),e([a()],d.prototype,\"layer\",void 0),e([a()],d.prototype,\"parent\",void 0),e([a({readOnly:!0})],d.prototype,\"suspended\",null),e([a({readOnly:!0})],d.prototype,\"suspendInfo\",null),e([a({readOnly:!0})],d.prototype,\"legendEnabled\",null),e([a({type:Boolean,readOnly:!0})],d.prototype,\"updating\",null),e([a({readOnly:!0})],d.prototype,\"updatingProgress\",null),e([a()],d.prototype,\"visible\",null),e([a()],d.prototype,\"view\",void 0),d=e([p(\"esri.views.layers.LayerView\")],d);const u=d;export{u as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import{makeHandle as s}from\"../../../core/handleUtils.js\";import{throwIfAborted as t}from\"../../../core/promiseUtils.js\";import{whenOnce as r}from\"../../../core/reactiveUtils.js\";import{property as o}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as i}from\"../../../core/accessorSupport/decorators/subclass.js\";import{supportsHeightModelInfo as a,rejectLayerError as l}from\"../../../geometry/support/heightModelInfoUtils.js\";const n=n=>{let c=class extends n{constructor(){super(...arguments),this.slicePlaneEnabled=!1,this.supportsHeightUnitConversion=!1}postscript(e){super.postscript(e),a(this.layer)&&this.addResolvingPromise(this._validateHeightModelInfo())}async _validateHeightModelInfo(){const e=new AbortController,o=e.signal;this.handles.add(s((()=>e.abort()))),await r((()=>this.view.defaultsFromMap?.heightModelInfoReady),o),t(o);const i=l(this.layer,this.view.heightModelInfo,this.supportsHeightUnitConversion);if(i)throw i}canResume(){const e=this.layer&&\"effectiveScaleRange\"in this.layer?this.layer.effectiveScaleRange:null;return super.canResume()&&(!e||!e.minScale||!e.maxScale||e.minScale>=e.maxScale)}getSuspendInfo(){const e=super.getSuspendInfo(),s=this.layer&&\"effectiveScaleRange\"in this.layer?this.layer.effectiveScaleRange:null;return s&&s.minScale&&s.maxScale&&s.minScale<s.maxScale&&(e.outsideScaleRange=!0),e}};return e([o()],c.prototype,\"view\",void 0),e([o()],c.prototype,\"slicePlaneEnabled\",void 0),c=e([i(\"esri.views.3d.layers.LayerView3D\")],c),c};export{n as LayerView3D};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../core/maybe.js\";import{O as r}from\"./vec2f64.js\";import{ShaderOutput as o}from\"../views/3d/webgl-engine/core/shaderLibrary/ShaderOutput.js\";import{SliceDraw as i}from\"../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js\";import{Transform as a}from\"../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl.js\";import{multipassTerrainTest as t}from\"../views/3d/webgl-engine/core/shaderLibrary/shading/MultipassTerrainTest.glsl.js\";import{defaultMaskAlphaCutoff as s}from\"../views/3d/webgl-engine/core/shaderLibrary/util/AlphaCutoff.js\";import{ColorConversion as d}from\"../views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl.js\";import{addProjViewLocalOrigin as l}from\"../views/3d/webgl-engine/core/shaderLibrary/util/View.glsl.js\";import{Float2PassUniform as n}from\"../views/3d/webgl-engine/core/shaderModules/Float2PassUniform.js\";import{FloatPassUniform as g}from\"../views/3d/webgl-engine/core/shaderModules/FloatPassUniform.js\";import{glsl as p}from\"../views/3d/webgl-engine/core/shaderModules/interfaces.js\";import{ShaderBuilder as c}from\"../views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js\";import{Texture2DPassUniform as u}from\"../views/3d/webgl-engine/core/shaderModules/Texture2DPassUniform.js\";import{TransparencyPassType as m}from\"../views/3d/webgl-engine/lib/TransparencyPassType.js\";import{VertexAttribute as v}from\"../views/3d/webgl-engine/lib/VertexAttribute.js\";function f(f){const w=new c,{vertex:h,fragment:b}=w;return l(h,f),w.include(a,f),w.attributes.add(v.POSITION,\"vec3\"),w.attributes.add(v.UV0,\"vec2\"),w.varyings.add(\"vpos\",\"vec3\"),f.hasMultipassTerrain&&w.varyings.add(\"depth\",\"float\"),h.uniforms.add(new n(\"textureCoordinateScaleFactor\",(o=>e(o.texture)&&e(o.texture.descriptor.textureCoordinateScaleFactor)?o.texture.descriptor.textureCoordinateScaleFactor:r))),h.code.add(p`\n    void main(void) {\n      vpos = position;\n      ${f.hasMultipassTerrain?\"depth = (view * vec4(vpos, 1.0)).z;\":\"\"}\n      vTexCoord = uv0 * textureCoordinateScaleFactor;\n      gl_Position = transformPosition(proj, view, vpos);\n    }\n  `),w.include(i,f),w.include(t,f),b.uniforms.add([new u(\"tex\",(e=>e.texture)),new g(\"opacity\",(e=>e.opacity))]),w.varyings.add(\"vTexCoord\",\"vec2\"),f.output===o.Alpha?b.code.add(p`\n    void main() {\n      discardBySlice(vpos);\n      ${f.hasMultipassTerrain?\"terrainDepthTest(gl_FragCoord, depth);\":\"\"}\n\n      float alpha = texture2D(tex, vTexCoord).a * opacity;\n      if (alpha  < ${p.float(s)}) {\n        discard;\n      }\n\n      gl_FragColor = vec4(alpha);\n    }\n    `):(b.include(d),b.code.add(p`\n    void main() {\n      discardBySlice(vpos);\n      ${f.hasMultipassTerrain?\"terrainDepthTest(gl_FragCoord, depth);\":\"\"}\n      gl_FragColor = texture2D(tex, vTexCoord) * opacity;\n\n      if (gl_FragColor.a < ${p.float(s)}) {\n        discard;\n      }\n\n      gl_FragColor = highlightSlice(gl_FragColor, vpos);\n      ${f.transparencyPassType===m.Color?\"gl_FragColor = premultiplyAlpha(gl_FragColor);\":\"\"}\n    }\n    `)),w}const w=Object.freeze(Object.defineProperty({__proto__:null,build:f},Symbol.toStringTag,{value:\"Module\"}));export{w as I,f as b};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import{ShaderOutput as t}from\"../core/shaderLibrary/ShaderOutput.js\";import{NoParameters as r}from\"../core/shaderModules/interfaces.js\";import{ReloadableShaderModule as i}from\"../core/shaderTechnique/ReloadableShaderModule.js\";import{ShaderTechnique as s}from\"../core/shaderTechnique/ShaderTechnique.js\";import{parameter as o}from\"../core/shaderTechnique/ShaderTechniqueConfiguration.js\";import{CullFaceOptions as a}from\"../lib/basicInterfaces.js\";import{Default3D as n}from\"../lib/DefaultVertexAttributeLocations.js\";import{oitBlending as l,oitDepthTest as p,oitDepthWrite as c,getOITPolygonOffset as u}from\"../lib/OrderIndependentTransparency.js\";import{Program as h}from\"../lib/Program.js\";import{stencilWriteMaskOn as d,stencilToolMaskBaseParams as m,stencilBaseAllZerosParams as f}from\"../lib/StencilUtils.js\";import{TransparencyPassType as y}from\"../lib/TransparencyPassType.js\";import{DefaultTechniqueConfiguration as b}from\"../materials/DefaultTechniqueConfiguration.js\";import{I as g}from\"../../../../chunks/ImageMaterial.glsl.js\";import{BlendFactor as T}from\"../../../webgl/enums.js\";import{simpleBlendingParams as P,makePipelineState as j,cullingParams as O,defaultDepthWriteParams as S,defaultColorWriteParams as v}from\"../../../webgl/renderState.js\";class N extends r{}class _ extends s{initializeProgram(e){return new h(e.rctx,_.shader.get().build(this.configuration),n)}_setPipelineState(e,r){const i=this.configuration,s=e===y.NONE,o=e===y.FrontFace;return j({blending:i.output!==t.Color&&i.output!==t.Alpha||!i.transparent?null:s?C:l(e),culling:O(i.cullFace),depthTest:{func:p(e)},depthWrite:s?i.writeDepth&&S:c(e),colorWrite:v,stencilWrite:i.hasOccludees?d:null,stencilTest:i.hasOccludees?r?m:f:null,polygonOffset:s||o?null:u(i.enableOffset)})}initializePipeline(){return this._occludeePipelineState=this._setPipelineState(this.configuration.transparencyPassType,!0),this._setPipelineState(this.configuration.transparencyPassType,!1)}getPipelineState(e,t){return t?this._occludeePipelineState:super.getPipelineState(e,t)}}_.shader=new i(g,(()=>import(\"./ImageMaterial.glsl.js\")));const C=P(T.ONE,T.ONE_MINUS_SRC_ALPHA);class w extends b{constructor(){super(...arguments),this.output=t.Color,this.cullFace=a.None,this.hasSlicePlane=!1,this.transparent=!1,this.enableOffset=!0,this.writeDepth=!0,this.hasOccludees=!1,this.transparencyPassType=y.NONE,this.hasMultipassTerrain=!1,this.cullAboveGround=!1}}e([o({count:t.COUNT})],w.prototype,\"output\",void 0),e([o({count:a.COUNT})],w.prototype,\"cullFace\",void 0),e([o()],w.prototype,\"hasSlicePlane\",void 0),e([o()],w.prototype,\"transparent\",void 0),e([o()],w.prototype,\"enableOffset\",void 0),e([o()],w.prototype,\"writeDepth\",void 0),e([o()],w.prototype,\"hasOccludees\",void 0),e([o({count:y.COUNT})],w.prototype,\"transparencyPassType\",void 0),e([o()],w.prototype,\"hasMultipassTerrain\",void 0),e([o()],w.prototype,\"cullAboveGround\",void 0);export{N as ImageMaterialPassParameters,_ as ImageMaterialTechnique,w as ImageMaterialTechniqueConfiguration};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{ShaderOutput as e}from\"../core/shaderLibrary/ShaderOutput.js\";import{CullFaceOptions as t}from\"../lib/basicInterfaces.js\";import{GLTextureMaterial as r}from\"../lib/GLTextureMaterial.js\";import{Material as a,MaterialParameters as s}from\"../lib/Material.js\";import{OITPolygonOffsetLimit as i}from\"../lib/OrderIndependentTransparency.js\";import{RenderSlot as n}from\"../lib/RenderSlot.js\";import{DefaultBufferWriter as u,PositionUVLayout as o}from\"./internal/DefaultBufferWriter.js\";import{intersectTriangleGeometry as h}from\"./internal/MaterialUtil.js\";import{ImageMaterialTechniqueConfiguration as l,ImageMaterialTechnique as c}from\"../shaders/ImageMaterialTechnique.js\";class p extends a{constructor(e){super(e,new d),this.supportsEdges=!0,this._configuration=new l}getConfiguration(e,t){return this._configuration.output=e,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this.parameters.transparent,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.hasOccludees=this.parameters.hasOccludees,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.enableOffset=t.camera.relativeElevation<i,this._configuration.hasMultipassTerrain=t.multipassTerrain.enabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration}intersect(e,t,r,a,s,i,n){h(e,t,a,s,i,void 0,n)}requiresSlot(t,r){if(r===e.Color||r===e.Alpha||r===e.Highlight){if(t===n.DRAPED_MATERIAL)return!0;if(r===e.Highlight)return t===n.OPAQUE_MATERIAL;return t===(this.parameters.transparent?this.parameters.writeDepth?n.TRANSPARENT_MATERIAL:n.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL:n.OPAQUE_MATERIAL)}return!1}createGLMaterial(e){return new m(e)}createBufferWriter(){return new u(o)}}class m extends r{constructor(e){super({...e,...e.material.parameters})}_updateParameters(e){return this.updateTexture(this._material.parameters.textureId),this._material.setParameters(this.textureBindParameters),this.ensureTechnique(c,e)}_updateOccludeeState(e){e.hasOccludees!==this._material.parameters.hasOccludees&&(this._material.setParameters({hasOccludees:e.hasOccludees}),this._updateParameters(e))}beginSlot(t){return this._output!==e.Color&&this._output!==e.Alpha||this._updateOccludeeState(t),this._updateParameters(t)}}class d extends s{constructor(){super(...arguments),this.transparent=!1,this.writeDepth=!0,this.hasSlicePlane=!1,this.cullFace=t.None,this.hasOccludees=!1,this.opacity=1,this.textureId=null,this.initTextureTransparent=!0}}export{p as ImageMaterial,d as Parameters};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{isNone as t}from\"../../core/maybe.js\";import{create as i}from\"./aaBoundingRect.js\";import{getBoundsXY as s}from\"./boundsUtils.js\";import{closeRings as n}from\"./coordsUtils.js\";import{isPoint as e,isMultipoint as h,isExtent as o,isPolygon as r,isPolyline as u}from\"./jsonUtils.js\";import{cutParams as m,updatePolyGeometry as x,offsetMagnitude as _}from\"./normalizeUtilsCommon.js\";import{getInfo as l,isWebMercator as c}from\"./spatialReferenceUtils.js\";function a(t){return f(t,!0)}function p(t){return f(t,!1)}function f(i,n){if(t(i))return null;const a=i.spatialReference,p=l(a),f=\"toJSON\"in i?i.toJSON():i;if(!p)return f;const I=c(a)?102100:4326,g=m[I].maxX,v=m[I].minX;if(e(f))return y(f,g,v);if(h(f))return f.points=f.points.map((t=>y(t,g,v))),f;if(o(f))return d(f,p);if(r(f)||u(f)){const t=s(S,f),i={xmin:t[0],ymin:t[1],xmax:t[2],ymax:t[3]},e=_(i.xmin,v)*(2*g),h=0===e?f:x(f,e);return i.xmin+=e,i.xmax+=e,i.xmax>g?P(h,g,n):i.xmin<v?P(h,v,n):h}return f}function d(t,i){if(!i)return t;const s=I(t,i).map((t=>t.extent));return s.length<2?s[0]||t:s.length>2?(t.xmin=i.valid[0],t.xmax=i.valid[1],t):{rings:s.map((t=>[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]))}}function y(t,i,s){if(Array.isArray(t)){const n=t[0];if(n>i){const s=_(n,i);t[0]=n+s*(-2*i)}else if(n<s){const i=_(n,s);t[0]=n+i*(-2*s)}}else{const n=t.x;if(n>i){const s=_(n,i);t.x+=s*(-2*i)}else if(n<s){const i=_(n,s);t.x+=i*(-2*s)}}return t}function I(t,i){const s=[],{ymin:n,ymax:e,xmin:h,xmax:o}=t,r=t.xmax-t.xmin,[u,m]=i.valid,{x,frameId:_}=g(t.xmin,i),{x:l,frameId:c}=g(t.xmax,i),a=x===l&&r>0;if(r>2*m){const t={xmin:h<o?x:l,ymin:n,xmax:m,ymax:e},i={xmin:u,ymin:n,xmax:h<o?l:x,ymax:e},r={xmin:0,ymin:n,xmax:m,ymax:e},a={xmin:u,ymin:n,xmax:0,ymax:e},p=[],f=[];v(t,r)&&p.push(_),v(t,a)&&f.push(_),v(i,r)&&p.push(c),v(i,a)&&f.push(c);for(let s=_+1;s<c;s++)p.push(s),f.push(s);s.push(new C(t,[_]),new C(i,[c]),new C(r,p),new C(a,f))}else x>l||a?s.push(new C({xmin:x,ymin:n,xmax:m,ymax:e},[_]),new C({xmin:u,ymin:n,xmax:l,ymax:e},[c])):s.push(new C({xmin:x,ymin:n,xmax:l,ymax:e},[_]));return s}function g(t,i){const[s,n]=i.valid,e=2*n;let h,o=0;return t>n?(h=Math.ceil(Math.abs(t-n)/e),t-=h*e,o=h):t<s&&(h=Math.ceil(Math.abs(t-s)/e),t+=h*e,o=-h),{x:t,frameId:o}}function v(t,i){const{xmin:s,ymin:n,xmax:e,ymax:h}=i;return O(t,s,n)&&O(t,s,h)&&O(t,e,h)&&O(t,e,n)}function O(t,i,s){return i>=t.xmin&&i<=t.xmax&&s>=t.ymin&&s<=t.ymax}function P(t,i,s=!0){const e=!u(t);if(e&&n(t),s){return(new T).cut(t,i)}const h=e?t.rings:t.paths,o=e?4:2,r=h.length,m=-2*i;for(let n=0;n<r;n++){const t=h[n];if(t&&t.length>=o){const i=[];for(const s of t)i.push([s[0]+m,s[1]]);h.push(i)}}return e?t.rings=h:t.paths=h,t}class C{constructor(t,i){this.extent=t,this.frameIds=i}}const S=i();class T{constructor(){this._linesIn=[],this._linesOut=[]}cut(t,i){let s;if(this._xCut=i,t.rings)this._closed=!0,s=t.rings,this._minPts=4;else{if(!t.paths)return null;this._closed=!1,s=t.paths,this._minPts=2}for(const e of s){if(!e||e.length<this._minPts)continue;let t=!0;for(const i of e)t?(this.moveTo(i),t=!1):this.lineTo(i);this._closed&&this.close()}this._pushLineIn(),this._pushLineOut(),s=[];for(const e of this._linesIn)e&&e.length>=this._minPts&&s.push(e);const n=-2*this._xCut;for(const e of this._linesOut)if(e&&e.length>=this._minPts){for(const t of e)t[0]+=n;s.push(e)}return this._closed?t.rings=s:t.paths=s,t}moveTo(t){this._pushLineIn(),this._pushLineOut(),this._prevSide=this._side(t[0]),this._moveTo(t[0],t[1],this._prevSide),this._prevPt=t,this._firstPt=t}lineTo(t){const i=this._side(t[0]);if(i*this._prevSide==-1){const s=this._intersect(this._prevPt,t);this._lineTo(this._xCut,s,0),this._prevSide=0,this._lineTo(t[0],t[1],i)}else this._lineTo(t[0],t[1],i);this._prevSide=i,this._prevPt=t}close(){const t=this._firstPt,i=this._prevPt;t[0]===i[0]&&t[1]===i[1]||this.lineTo(t),this._checkClosingPt(this._lineIn),this._checkClosingPt(this._lineOut)}_moveTo(t,i,s){this._closed?(this._lineIn.push([s<=0?t:this._xCut,i]),this._lineOut.push([s>=0?t:this._xCut,i])):(s<=0&&this._lineIn.push([t,i]),s>=0&&this._lineOut.push([t,i]))}_lineTo(t,i,s){this._closed?(this._addPolyVertex(this._lineIn,s<=0?t:this._xCut,i),this._addPolyVertex(this._lineOut,s>=0?t:this._xCut,i)):s<0?(0===this._prevSide&&this._pushLineOut(),this._lineIn.push([t,i])):s>0?(0===this._prevSide&&this._pushLineIn(),this._lineOut.push([t,i])):this._prevSide<0?(this._lineIn.push([t,i]),this._lineOut.push([t,i])):this._prevSide>0&&(this._lineOut.push([t,i]),this._lineIn.push([t,i]))}_addPolyVertex(t,i,s){const n=t.length;n>1&&t[n-1][0]===i&&t[n-2][0]===i?t[n-1][1]=s:t.push([i,s])}_checkClosingPt(t){const i=t.length;i>3&&t[0][0]===this._xCut&&t[i-2][0]===this._xCut&&t[1][0]===this._xCut&&(t[0][1]=t[i-2][1],t.pop())}_side(t){return t<this._xCut?-1:t>this._xCut?1:0}_intersect(t,i){const s=(this._xCut-t[0])/(i[0]-t[0]);return t[1]+s*(i[1]-t[1])}_pushLineIn(){this._lineIn&&this._lineIn.length>=this._minPts&&this._linesIn.push(this._lineIn),this._lineIn=[]}_pushLineOut(){this._lineOut&&this._lineOut.length>=this._minPts&&this._linesOut.push(this._lineOut),this._lineOut=[]}}export{T as CutVertical,p as normalizeCentralMeridianForDisplay,a as normalizeCentralMeridianSync};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{_ as o}from\"../../chunks/tslib.es6.js\";import r from\"../../core/Accessor.js\";import{isNone as e,unwrap as t,isSome as s}from\"../../core/maybe.js\";import{property as n}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as p}from\"../../core/accessorSupport/decorators/subclass.js\";import m from\"../../geometry/Polygon.js\";import{projectOrLoad as i}from\"../../geometry/projection.js\";import{fromExtent as c}from\"../../geometry/support/aaBoundingRect.js\";import{normalizeCentralMeridianSync as l}from\"../../geometry/support/normalizeUtilsSync.js\";let a=class extends r{constructor(o){super(o)}get bounds(){const o=this.coords;return e(o)||e(o.extent)?null:c(o.extent)}get coords(){const o=t(this.element.georeference)?.coords;return i(o,this.spatialReference).geometry}get normalizedCoords(){return m.fromJSON(l(this.coords))}get normalizedBounds(){const o=s(this.normalizedCoords)?this.normalizedCoords.extent:null;return s(o)?c(o):null}};o([n()],a.prototype,\"spatialReference\",void 0),o([n()],a.prototype,\"element\",void 0),o([n()],a.prototype,\"bounds\",null),o([n()],a.prototype,\"coords\",null),o([n()],a.prototype,\"normalizedCoords\",null),o([n()],a.prototype,\"normalizedBounds\",null),a=o([p(\"esri.layers.support.media.MediaElementView\")],a);export{a as MediaElementView};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import{makeHandle as t,handlesGroup as r,destroyHandle as i}from\"../../../core/handleUtils.js\";import{isNone as s,isSome as a}from\"../../../core/maybe.js\";import{debounce as n,isPromiseLike as o}from\"../../../core/promiseUtils.js\";import{on as d}from\"../../../core/reactiveUtils.js\";import{property as l}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/accessorSupport/ensureType.js\";import{subclass as m}from\"../../../core/accessorSupport/decorators/subclass.js\";import{toExtent as p}from\"../../../geometry/support/aaBoundingRect.js\";import{MediaElementView as h}from\"../../../layers/support/mediaUtils.js\";import{DrapeSourceType as c}from\"./interfaces.js\";import{LayerView3D as u}from\"./LayerView3D.js\";import{DRAPED_Z as y}from\"../terrain/OverlayRenderer.js\";import{UpdatePolicy as _,PowerOfTwoResizeMode as g}from\"../webgl-engine/lib/basicInterfaces.js\";import{Geometry as f}from\"../webgl-engine/lib/Geometry.js\";import{DirtyOperation as E,DirtyState as D}from\"../webgl-engine/lib/ModelDirtyTypes.js\";import{RenderGeometry as w}from\"../webgl-engine/lib/RenderGeometry.js\";import{Texture as R}from\"../webgl-engine/lib/Texture.js\";import{VertexAttribute as v}from\"../webgl-engine/lib/VertexAttribute.js\";import{ImageMaterial as T}from\"../webgl-engine/materials/ImageMaterial.js\";import x from\"../../layers/LayerView.js\";import{TextureWrapMode as b}from\"../../webgl/enums.js\";let j=class extends(u(x)){constructor(){super(...arguments),this.type=\"media-3d\",this.drapeSourceType=c.RasterImage,this.updatePolicy=_.ASYNC,this._uidToElement=new Map,this._renderedElements=new Map,this._lastDrapingExtent=null,this._update=n((async(e,t,r)=>{const i=await this._collectMediaElements(e,t,r);this._synchronizeRenderElements(i)}),0)}initialize(){this._renderer=this.view.basemapTerrain.overlayManager.registerGeometryDrapeSource(this),this.handles.add([t((()=>this.view.basemapTerrain.overlayManager.unregisterDrapeSource(this))),d((()=>this.layer.source),\"refresh\",(()=>this._updateWithLastDrapingExtent()))]),this.updatingHandles.add((()=>this.suspended),(()=>this._updateWithLastDrapingExtent()))}setDrapingExtent(e,t){this._lastDrapingExtent={overlays:e,spatialReference:t},this._updateWithLastDrapingExtent()}getHit(e){const t=this._uidToElement.get(e);return t?{type:\"media\",element:t,layer:this.layer}:null}_updateWithLastDrapingExtent(){if(s(this._lastDrapingExtent)||this.suspended)return void(this._renderer&&this._synchronizeRenderElements(new Set));const{overlays:e,spatialReference:t}=this._lastDrapingExtent;this.updatingHandles.addPromise(this._update(e,t).catch((()=>{})))}async _collectMediaElements(e,t,r){const i=this.layer.source;return s(i)?new Set:new Set((await Promise.all(e.map((e=>i.queryElements(p(e.extent,t),{signal:r}))))).flat())}_synchronizeRenderElements(e){this._synchronizeRenderElementsRemove(e),this._synchronizeRenderElementsAdd(e)}_synchronizeRenderElementsRemove(e){const t=new Set,r=[];this._renderedElements.forEach(((i,s)=>{e.has(s)||(t.add(s),a(i.renderData)&&r.push(i.renderData.renderGeometry),this._removeElement(s,i))})),this._renderer.removeGeometries(r,E.REMOVE)}_synchronizeRenderElementsAdd(e){for(const t of e)this._renderedElements.has(t)||this._createRenderElement(t)}_removeElement(e,{renderData:t,handle:r}){this._destroyRenderData(t),this._renderedElements.delete(e),this._uidToElement.delete(e.uid),r.remove()}async _createRenderElement(e){const t=new h({spatialReference:this.view.spatialReference,element:e}),s={renderData:null,handle:r([this.updatingHandles.add((()=>e.opacity),(e=>{a(s.renderData)&&s.renderData.material.setParameters({opacity:e})})),this.updatingHandles.add((()=>t.coords),(e=>{a(s.renderData)?this._updateGeometry(s,s.renderData,e):this._initializeRenderData(t,s)})),this.updatingHandles.add((()=>e.content),(()=>this._initializeRenderData(t,s))),i(t)])};this._renderedElements.set(e,s),this._uidToElement.set(e.uid,e),this.updatingHandles.addPromise(e.load().catch((()=>{}))),this._initializeRenderData(t,s)}_initializeRenderData(e,t){const{coords:r,element:i}=e;if(s(r)||s(i.content))return void(t.renderData=this._destroyRenderData(t.renderData));if(a(t.renderData))return;const n=this._createTexture(i.content);this.view._stage.add(n);const d=this.view._stage.loadImmediate(n);o(d)&&this.updatingHandles.addPromise(d);const l=new T({initTextureTransparent:!0,textureId:n.id,opacity:i.opacity,transparent:!0}),m=this._positionVertexBufferFromCoordinates(r),p=[0,0,1,0,1,1,0,1],h=[0,1,2,0,2,3],c=new f([[v.POSITION,{data:m,size:3,exclusive:!0}],[v.UV0,{data:p,size:2,exclusive:!0}]],[[v.POSITION,h],[v.UV0,h]]),u=new w(c,l,{layerUid:this.layer.uid,graphicUid:i.uid});this._renderer.addGeometries([u],E.ADD),t.renderData={renderGeometry:u,texture:n,material:l}}_updateGeometry(e,t,r){if(s(r))return void(e.renderData=this._destroyRenderData(e.renderData));const i=this._positionVertexBufferFromCoordinates(r);t.renderGeometry.vertexAttributes.get(v.POSITION).data=i,this._renderer.modifyGeometries([t.renderGeometry],D.VERTEXATTRS)}_positionVertexBufferFromCoordinates(e){const[t,r,i,s]=e.rings[0];return new Float64Array([t[0],t[1],y,s[0],s[1],y,i[0],i[1],y,r[0],r[1],y])}_destroyRenderData(e){return s(e)||(this.view._stage.remove(e.texture),this._renderer.removeGeometries([e.renderGeometry],E.REMOVE),e.material.dispose()),null}_createTexture(e){const t=e instanceof HTMLImageElement?e.naturalWidth:e.width,r=e instanceof HTMLImageElement?e.naturalHeight:e.height;return new R(e,{wrap:{s:b.CLAMP_TO_EDGE,t:b.CLAMP_TO_EDGE},preMultiplyAlpha:!0,width:t,height:r,mipmap:!0,powerOfTwoResizeMode:g.STRETCH,updateCallback:()=>this.view.basemapTerrain.overlayManager.setDrawTexturesDirty()})}get test(){const e=this;return{get numberOfElements(){return e._renderedElements.size}}}};e([l({readOnly:!0})],j.prototype,\"type\",void 0),e([l()],j.prototype,\"layer\",void 0),j=e([m(\"esri.views.3d.layers.MediaLayerView3D\")],j);const M=j;export{M as default};\n"],"sourceRoot":""}