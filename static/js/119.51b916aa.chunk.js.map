{"version":3,"sources":["../node_modules/@arcgis/core/layers/support/ExportWMSImageParameters.js","../node_modules/@arcgis/core/views/layers/WMSLayerView.js","../node_modules/@arcgis/core/views/3d/layers/WMSLayerView3D.js"],"names":["o","visible","l","s","r","constructor","e","super","this","scale","layer","_get","_set","handles","remove","add","sublayers","on","notifyChange","propertyName","layers","visibleSublayers","filter","name","map","join","version","commitProperty","t","a","minScale","maxScale","i","forEach","push","toJSON","imageFormat","imageTransparency","format","request","service","styles","transparent","prototype","readOnly","type","Number","initialize","exportImageParameters","p","destroy","exportImageVersion","fetchPopupFeatures","Promise","reject","popupEnabled","createFetchPopupFeaturesQuery","resolve","extent","width","height","x","m","y","n","fetchFeatureInfo","arguments","serviceSupportsSpatialReference","view","spatialReference","addResolvingPromise","updatingHandles","addPromise","refreshDebounced","findExtentInfoAt","_spatialReference","imageSize","Math","round","xmin","ymax","getFetchOptions","timeExtent"],"mappings":"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","file":"static/js/119.51b916aa.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../core/Accessor.js\";import{HandleOwnerMixin as s}from\"../../core/HandleOwner.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as a}from\"../../core/accessorSupport/decorators/subclass.js\";const o={visible:\"visibleSublayers\"};let l=class extends(s(r)){constructor(e){super(e),this.scale=0}set layer(e){this._get(\"layer\")!==e&&(this._set(\"layer\",e),this.handles.remove(\"layer\"),e&&this.handles.add([e.sublayers.on(\"change\",(()=>this.notifyChange(\"visibleSublayers\"))),e.on(\"wms-sublayer-update\",(e=>this.notifyChange(o[e.propertyName])))],\"layer\"))}get layers(){return this.visibleSublayers.filter((({name:e})=>e)).map((({name:e})=>e)).join()}get version(){this.commitProperty(\"layers\");const e=this.layer;return e&&e.commitProperty(\"imageTransparency\"),(this._get(\"version\")||0)+1}get visibleSublayers(){const{layer:e,scale:r}=this,s=e?.sublayers,t=[],a=e=>{const{minScale:s,maxScale:o,sublayers:l,visible:i}=e;i&&(0===r||(0===s||r<=s)&&(0===o||r>=o))&&(l?l.forEach(a):t.push(e))};return s?.forEach(a),t}toJSON(){const{layer:e,layers:r}=this,{imageFormat:s,imageTransparency:t,version:a}=e;return{format:s,request:\"GetMap\",service:\"WMS\",styles:\"\",transparent:t?\"TRUE\":\"FALSE\",version:a,layers:r}}};e([t()],l.prototype,\"layer\",null),e([t({readOnly:!0})],l.prototype,\"layers\",null),e([t({type:Number})],l.prototype,\"scale\",void 0),e([t({readOnly:!0})],l.prototype,\"version\",null),e([t({readOnly:!0})],l.prototype,\"visibleSublayers\",null),l=e([a(\"esri.layers.support.ExportWMSImageParameters\")],l);export{l as ExportWMSImageParameters};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../core/Error.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/arrayUtils.js\";import\"../../core/accessorSupport/ensureType.js\";import{subclass as o}from\"../../core/accessorSupport/decorators/subclass.js\";import{combinedViewLayerTimeExtentProperty as s}from\"../../layers/support/commonProperties.js\";import{ExportWMSImageParameters as p}from\"../../layers/support/ExportWMSImageParameters.js\";const a=a=>{let i=class extends a{initialize(){this.exportImageParameters=new p({layer:this.layer})}destroy(){this.exportImageParameters.destroy(),this.exportImageParameters=null}get exportImageVersion(){return this.exportImageParameters?.commitProperty(\"version\"),this.commitProperty(\"timeExtent\"),(this._get(\"exportImageVersion\")||0)+1}fetchPopupFeatures(e){const{layer:t}=this;if(!e)return Promise.reject(new r(\"wmslayerview:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:t}));const{popupEnabled:o}=t;if(!o)return Promise.reject(new r(\"wmslayerview:fetchPopupFeatures\",\"popupEnabled should be true\",{popupEnabled:o}));const s=this.createFetchPopupFeaturesQuery(e);if(!s)return Promise.resolve([]);const{extent:p,width:a,height:i,x:m,y:n}=s;if(!(p&&a&&i))throw new r(\"wmslayerview:fetchPopupFeatures\",\"WMSLayer does not support fetching features.\",{extent:p,width:a,height:i});return t.fetchFeatureInfo(p,a,i,m,n)}};return e([t()],i.prototype,\"exportImageParameters\",void 0),e([t({readOnly:!0})],i.prototype,\"exportImageVersion\",null),e([t()],i.prototype,\"layer\",void 0),e([t(s)],i.prototype,\"timeExtent\",void 0),i=e([o(\"esri.layers.mixins.WMSLayerView\")],i),i};export{a as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Error.js\";import\"../../../core/Logger.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/has.js\";import{subclass as r}from\"../../../core/accessorSupport/decorators/subclass.js\";import s from\"../../../geometry/Extent.js\";import i from\"./DynamicLayerView3D.js\";import o from\"../../layers/WMSLayerView.js\";let a=class extends(o(i)){constructor(){super(...arguments),this.type=\"wms-3d\"}initialize(){this.layer.serviceSupportsSpatialReference(this.view.spatialReference)||this.addResolvingPromise(Promise.reject(new t(\"layerview:spatial-reference-incompatible\",\"The spatial references supported by this WMS layer are incompatible with the spatial reference of the view\"))),this.updatingHandles.add((()=>this.exportImageParameters?.version),(()=>{this.updatingHandles.addPromise(this.refreshDebounced())}))}createFetchPopupFeaturesQuery(e){const t=this.findExtentInfoAt(e),r=t.extent,i=new s(r[0],r[1],r[2],r[3],this._spatialReference),o=t.imageSize,a=o.width,n=o.height,p=i.width/a;return{extent:i,width:a,height:n,x:Math.round((e.x-i.xmin)/p),y:Math.round((i.ymax-e.y)/p)}}getFetchOptions(){return{timeExtent:this.timeExtent}}};a=e([r(\"esri.views.3d.layers.WMSLayerView3D\")],a);const n=a;export{n as default};\n"],"sourceRoot":""}