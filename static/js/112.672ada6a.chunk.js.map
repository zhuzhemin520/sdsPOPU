{"version":3,"sources":["../node_modules/@arcgis/core/views/interactive/snapping/featureSources/sceneLayerSource/SceneLayerSnappingSourceWorkerHandle.js","../node_modules/@arcgis/core/views/interactive/snapping/featureSources/I3SSnappingSource.js","../node_modules/@arcgis/core/views/interactive/snapping/featureSources/SceneLayerSnappingSource.js","../node_modules/@arcgis/core/views/interactive/snapping/hints/PointSnappingHint.js","../node_modules/@arcgis/core/views/interactive/snapping/candidates/VertexSnappingCandidate.js"],"names":["p","t","constructor","e","super","this","availability","_ids","Set","_tmpP","s","destroy","_workerHandle","initialize","l","schedule","fetchAllEdgeLocations","_fetchAllEdgeLocations","async","r","coordinateHelper","o","toXYZ","point","renderCoordsHelper","toRenderCoords","spatialReference","distance","n","a","invoke","bounds","i","types","candidates","sort","map","_convertCandidate","add","id","invokeMethod","delete","type","d","objectId","targetPoint","_convertRenderCoordinate","target","edgeStart","start","edgeEnd","end","elevationInfo","c","fromRenderCoords","fromXYZ","uid","components","has","push","fetchEdgeLocations","signal","locations","buffer","objectIds","origin","result","Promise","all","filter","transferList","constructOnly","prototype","readOnly","strategy","client","h","_abortController","AbortController","updating","updatingHandles","_tracker","view","resourceController","_edgeWorker","Error","addPromise","_setupLayerView","handles","fetchCandidates","refresh","destroyed","getLayerView","trackSnappingSources","remove","_i3sSources","some","forEach","length","layerSource","layer","_getBuildingSceneI3SSources","_getSceneLayerI3SSource","flat","allSublayers","toArray","whenLayerView","whenSublayerView","equals","constraint","hints","domain"],"mappings":"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","file":"static/js/112.672ada6a.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import{HandleOwner as t}from\"../../../../../core/HandleOwner.js\";import{property as r}from\"../../../../../core/accessorSupport/decorators/property.js\";import\"../../../../../core/arrayUtils.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import{subclass as o}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{c as s}from\"../../../../../chunks/vec3f64.js\";import{WorkerHandle as n}from\"../../../../../core/workers/WorkerHandle.js\";import{f as i}from\"../../../../../chunks/sphere.js\";import{absoluteHeightElevationInfo as a}from\"../../../../../support/elevationInfoUtils.js\";import{EdgeSnappingCandidate as d}from\"../../candidates/EdgeSnappingCandidate.js\";import{VertexSnappingCandidate as c}from\"../../candidates/VertexSnappingCandidate.js\";let p=class extends t{constructor(e){super(e),this.availability=0,this._ids=new Set,this._tmpP=s()}destroy(){this._workerHandle.destroy(),this._workerHandle=null}initialize(){this._workerHandle=new l(this.schedule,{fetchAllEdgeLocations:(e,t)=>this._fetchAllEdgeLocations(e,t)})}async fetchCandidates(e,t){const r=e.coordinateHelper,o=r.toXYZ(e.point);this.renderCoordsHelper.toRenderCoords(o,r.spatialReference,o);const s=e.distance,n=\"number\"==typeof s?s:s.distance,a=await this._workerHandle.invoke({bounds:i(o[0],o[1],o[2],n),types:e.types},t);return a.candidates.sort(((e,t)=>e.distance-t.distance)),a.candidates.map((e=>this._convertCandidate(r,e)))}async add(e,t){this._ids.add(e.id),await this._workerHandle.invokeMethod(\"add\",e,t)}async remove(e,t){this._ids.delete(e.id),await this._workerHandle.invokeMethod(\"remove\",e,t)}_convertCandidate(e,t){switch(t.type){case\"edge\":return new d({coordinateHelper:e,objectId:t.objectId,targetPoint:this._convertRenderCoordinate(e,t.target),edgeStart:this._convertRenderCoordinate(e,t.start),edgeEnd:this._convertRenderCoordinate(e,t.end),elevationInfo:a});case\"vertex\":return new c({coordinateHelper:e,objectId:t.objectId,targetPoint:this._convertRenderCoordinate(e,t.target),elevationInfo:a})}}_convertRenderCoordinate(e,t){return this.renderCoordsHelper.fromRenderCoords(t,this._tmpP,e.spatialReference),e.fromXYZ(this._tmpP)}async _fetchAllEdgeLocations(e,t){const r=[],o=[];for(const{id:s,uid:n}of e.components)this._ids.has(s)&&r.push((async()=>{const e=await this.fetchEdgeLocations(s,t.signal);return o.push(e.locations.buffer),{id:s,uid:n,objectIds:e.objectIds,locations:e.locations.buffer,origin:e.origin,type:e.type}})());return{result:{components:(await Promise.all(r)).filter((({id:e})=>this._ids.has(e)))},transferList:o}}};e([r({constructOnly:!0})],p.prototype,\"renderCoordsHelper\",void 0),e([r({constructOnly:!0})],p.prototype,\"fetchEdgeLocations\",void 0),e([r({constructOnly:!0})],p.prototype,\"schedule\",void 0),e([r({readOnly:!0})],p.prototype,\"availability\",void 0),p=e([o(\"esri.views.interactive.snapping.featureSources.sceneLayerSource.SceneLayerSnappingSourceWorker\")],p);class l extends n{constructor(e,t){super(\"SceneLayerSnappingSourceWorker\",\"fetchCandidates\",{},e,{strategy:\"dedicated\",client:t})}}export{p as SceneLayerSnappingSourceWorkerHandle};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import{HandleOwner as r}from\"../../../../core/HandleOwner.js\";import{destroyHandle as t}from\"../../../../core/handleUtils.js\";import{removeMaybe as o,abortMaybe as s,isNone as i,applySome as a}from\"../../../../core/maybe.js\";import{isAborted as n}from\"../../../../core/promiseUtils.js\";import{property as d}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/arrayUtils.js\";import\"../../../../core/accessorSupport/ensureType.js\";import{subclass as c}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{EdgeWorkerHandle as l}from\"../../../3d/webgl-engine/lib/edgeRendering/EdgeWorkerHandle.js\";import{SceneLayerSnappingSourceWorkerHandle as p}from\"./sceneLayerSource/SceneLayerSnappingSourceWorkerHandle.js\";let h=class extends r{constructor(e){super(e),this.availability=1,this._abortController=new AbortController}get updating(){return this.updatingHandles.updating}destroy(){this._tracker=o(this._tracker),this._abortController=s(this._abortController)}initialize(){const{view:e}=this,r=e.resourceController;this._edgeWorker=new l((e=>r.schedule(e))),this._workerHandle=new p({renderCoordsHelper:this.view.renderCoordsHelper,schedule:e=>r.schedule(e),fetchEdgeLocations:async(e,r)=>{if(i(this._tracker))throw new Error(\"tracker-not-initialized\");return this._tracker.fetchEdgeLocations(e,this._edgeWorker,r)}}),this.updatingHandles.addPromise(this._setupLayerView()),this.handles.add([t(this._workerHandle),t(this._edgeWorker)])}async fetchCandidates(e,r){return this._workerHandle.fetchCandidates(e,r)}refresh(){}async _setupLayerView(){if(this.destroyed)return;const e=a(this._abortController,(e=>e.signal)),r=await this.getLayerView();i(r)||n(e)||(this._tracker=r.trackSnappingSources({add:(r,t)=>{this.updatingHandles.addPromise(this._workerHandle.add({id:r,bounds:t},e))},remove:r=>{this.updatingHandles.addPromise(this._workerHandle.remove({id:r},e))}}))}};e([d({constructOnly:!0})],h.prototype,\"getLayerView\",void 0),e([d({constructOnly:!0})],h.prototype,\"view\",void 0),e([d({readOnly:!0})],h.prototype,\"updating\",null),e([d({readOnly:!0})],h.prototype,\"availability\",void 0),h=e([c(\"esri.views.interactive.snapping.featureSources.I3SSnappingSource\")],h);export{h as I3SSnappingSource};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import r from\"../../../../core/Accessor.js\";import{isSome as t}from\"../../../../core/maybe.js\";import{throwIfAborted as s}from\"../../../../core/promiseUtils.js\";import{property as i}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/arrayUtils.js\";import\"../../../../core/accessorSupport/ensureType.js\";import{subclass as o}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{I3SSnappingSource as a}from\"./I3SSnappingSource.js\";let c=class extends r{constructor(e){super(e),this.availability=1,this._i3sSources=[]}get updating(){return this._i3sSources.some((e=>e.updating))}destroy(){this._i3sSources.forEach((e=>e.destroy())),this._i3sSources.length=0}initialize(){const{view:e}=this,r=this.layerSource.layer;this._i3sSources=\"building-scene\"===r.type?this._getBuildingSceneI3SSources(e,r):[this._getSceneLayerI3SSource(e,r)]}async fetchCandidates(e,r){const t=await Promise.all(this._i3sSources.map((t=>t.fetchCandidates(e,r))));return s(r),t.flat()}refresh(){this._i3sSources.forEach((e=>e.refresh()))}_getBuildingSceneI3SSources(e,r){return r.allSublayers.toArray().map((t=>\"building-component\"===t.type?new a({getLayerView:async()=>(await e.whenLayerView(r)).whenSublayerView(t),view:e}):null)).filter(t)}_getSceneLayerI3SSource(e,r){return new a({getLayerView:async()=>{const t=await e.whenLayerView(r);return\"scene-layer-graphics-3d\"===t.type?void 0:t},view:e})}};e([i({constructOnly:!0})],c.prototype,\"layerSource\",void 0),e([i({constructOnly:!0})],c.prototype,\"view\",void 0),e([i({readOnly:!0})],c.prototype,\"updating\",null),e([i({readOnly:!0})],c.prototype,\"availability\",void 0),c=e([o(\"esri.views.interactive.snapping.featureSources.SceneLayerSnappingSource\")],c);export{c as SceneLayerSnappingSource};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{objectEqual as t}from\"../snappingUtils.js\";import{SnappingHint as n}from\"./SnappingHint.js\";class s extends n{constructor(t,n,s){super(n,s),this.point=t}equals(n){return n instanceof s&&t(this.point,n.point)}}export{s as PointSnappingHint};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.25/esri/copyright.txt for details.\n*/\nimport{PointConstraint as t}from\"../SnappingConstraint.js\";import{FeatureSnappingCandidate as n}from\"./FeatureSnappingCandidate.js\";import{PointSnappingHint as i}from\"../hints/PointSnappingHint.js\";class o extends n{constructor(n){super({...n,constraint:new t(n.coordinateHelper,n.targetPoint)})}get hints(){return[new i(this.targetPoint,this.elevationInfo,this.domain)]}}export{o as VertexSnappingCandidate};\n"],"sourceRoot":""}